@{
    Layout = null;
    string FD = Request.QueryString["FD"].ToString();
    string TD = Request.QueryString["TD"].ToString();
    string PC = Request.QueryString["Plant"].ToString();
    string PT = Request.QueryString["PT"].ToString();
    string PN = Request.QueryString["PN"].ToString();

    if (PN == "ALL")
    {
        PN = "";
    }
}

<!DOCTYPE html>

<html>
<head>
    <script src="~/Scripts/jquery-1.7.1.js"></script>
    <meta name="viewport" content="width=device-width" />
    <title>Closed Complaints Account With Defect Types</title>


    @Styles.Render("~/bundles/Allcss")
    <link href="~/plugins/datepicker/datepicker3.css" rel="stylesheet" />
    <link href="~/plugins/daterangepicker/daterangepicker-bs3.css" rel="stylesheet" />
    <link href="~/dist/css/AdminLTE.min.css" rel="stylesheet" />
    <link href="~/bootstrap/font-awesome/css/font-awesome.min.css" rel="stylesheet" />
    <link href="~/bootstrap/ionicons/css/ionicons.min.css" rel="stylesheet" />


    @Styles.Render("~/bundles/DataTablecss")
    <link href="~/bootstrap/css/jquery.sumoselect.min.css" rel="stylesheet" />
    <script src="~/bootstrap/DataTables-1.10.5/js/jquery.js"></script>
    <script src="~/plugins/jQueryUI/jquery-ui.min1.js"></script>
    <script src="~/bootstrap/DataTables-1.10.5/js/jquery.dataTables.min.js"></script>
    <script src="~/bootstrap/js/bootstrap.min.js"></script>
    <script src="~/bootstrap/js/fileinput.js"></script>
    <script src="~/bootstrap/DataTables-1.10.5/js/dataTables.responsive.js"></script>
    <script src="~/bootstrap/js/dataTables.cellEdit.js"></script>





    @Scripts.Render("~/bundles/AllJs")
    @Scripts.Render("~/bundles/Angularjs")

    <script src="~/plugins/daterangepicker/daterangepicker.js"></script>
    <script src="~/plugins/datepicker/bootstrap-datepicker.js"></script>
    <script src="~/bootstrap/js/jquery.sumoselect.min.js"></script>
    <script src="~/dist/js/app.min.js"></script>
    <script src="~/bootstrap/js/bootstrap.typeahead.js"></script>
    <link href="~/Scripts/MultiSelect/css/style.css" rel="stylesheet" />
    <script src="~/Scripts/MultiSelect/js/multiselect.min.js"></script>
    <script src="~/Scripts/SFDCScripts/SFDCScript.js"></script>

    @Scripts.Render("~/bundles/modernizr")


    <script src="~/Scripts/DataTableScripts/jquery-1.12.3.min.js"></script>
    <script src="~/Scripts/DataTableScripts/jquery.dataTables.min.js"></script>
    <script src="~/Scripts/DataTableScripts/dataTables.buttons.min.js"></script>
    <script src="~/Scripts/DataTableScripts/buttons.flash.min.js"></script>
    <script src="~/Scripts/DataTableScripts/jszip.min.js"></script>
    <script src="~/Scripts/DataTableScripts/pdfmake.min.js"></script>
    <script src="~/Scripts/DataTableScripts/vfs_fonts.js"></script>
    <script src="~/Scripts/DataTableScripts/buttons.html5.min.js"></script>
    <script src="~/Scripts/DataTableScripts/buttons.print.min.js"></script>

    <link href="~/Scripts/DataTableScripts/jquery.dataTables.min.css" rel="stylesheet" />
    <link href="~/Scripts/DataTableScripts/buttons.dataTables.min.css" rel="stylesheet" />



    <style>
        .ListTable thead tr {
            background-color: #d2401a;
            color: white;
            font-size: 13px;
        }
    </style>

</head>
<body>

    <div style="width: 100%; height: 100%;">
        <table border="0" align="center" style="width: 98%">
            <tbody>
                <tr>
                    <td>
                        <div align="center" style="width: 100%; margin-bottom: 15px;" class="row">
                            <label style="font-size: 18px; color: #0165C4">
                                <b>HIL Limited</b></label><br>
                            <label style="font-size: 18px; color: #0026ff">
                                <b>Closed Complaints Account With Defect Types</b></label><br>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>

        <input type="text" style="display:none;" value="@FD" id="FD"/>
        <input type="text" style="display:none;" value="@TD" id="TD"/>
        <input type="text" style="display:none;" value="@PC" id="PC"/>
        <input type="text" style="display:none;" value="@PN" id="PN" />
        <input type="text" style="display:none;" value="@PT" id="PT" />



        <div id="SheetingDiv">
            <table class="ListTable" id="ClosedComplaintsAccount">

                <thead>
                    <tr>
                        <td>Complaint Tracking No</td>
                        <td>Complaint Code</td>
                        <td>Customer Name</td>
                        <td>Sub Stockiest</td>
                        <td>Party Code</td>
                        <td>Visit Date</td>
                        <td>City</td>
                        <td>State</td>
                        <td>Invoice Details</td>
                        <td>Product Division</td>
                        <td>Supplied Qty. [Tons]</td>
                        <td>Complaint Qty. [Tons]</td>
                        <td>UOM</td>
                        <td>Total Compensation</td>
                        <td>Compensation In 3.6 Size</td>
                        <td>Compensation In Others Size</td>
                        <td>Compensation  Mode</td>
                        <td>Compensation No</td>
                        <td>Compensation Issued Date</td>
                    </tr>
                </thead>

                <tbody></tbody>

                <tfoot style="display: none;">
                    <tr>
                        <td>Complaint Tracking No</td>
                        <td>Complaint Code</td>
                        <td>Customer Name</td>
                        <td>Sub Stockiest</td>
                        <td>Party Code</td>
                        <td>Visit Date</td>
                        <td>City</td>
                        <td>State</td>
                        <td>Invoice Details</td>
                        <td>Product Division</td>
                        <td>Supplied Qty. [Tons]</td>
                        <td>Complaint Qty. [Tons]</td>
                        <td>UOM</td>
                        <td>Total Compensation</td>
                        <td>Compensation In 3.6 Size</td>
                        <td>Compensation In Others Size</td>
                        <td>Compensation Mode</td>
                        <td>Compensation No</td>
                        <td>Compensation Issued Date</td>
                    </tr>
                </tfoot>


            </table>
        </div>


        <div id="OthersDiv">
            <table class="ListTable" id="ClosedComplaintsAccountOthers">

                <thead>
                    <tr>
                        <td>Complaint Tracking No</td>
                        <td>Complaint Code</td>
                        <td>Customer Name</td>
                        <td>Sub Stockiest</td>
                        <td>Party Code</td>
                        <td>Visit Date</td>
                        <td>City</td>
                        <td>State</td>
                        <td>Invoice Details</td>
                        <td>Product Division</td>
                        <td>Supplied Qty. [No's]</td>
                        <td>Complaint Qty. [No's]</td>
                        <td>UOM</td>
                        <td>Total Compensation</td>
                        <td>Compensation Mode</td>
                        <td>Compensation No</td>
                        <td>Compensation Issued Date</td>
                    </tr>
                </thead>

                <tbody></tbody>

                <tfoot style="display: none;">
                    <tr>
                        <td>Complaint Tracking No</td>
                        <td>Complaint Code</td>
                        <td>Customer Name</td>
                        <td>Sub Stockiest</td>
                        <td>Party Code</td>
                        <td>Visit Date</td>
                        <td>City</td>
                        <td>State</td>
                        <td>Invoice Details</td>
                        <td>Product Division</td>
                        <td>Supplied Qty. [No's]</td>
                        <td>Complaint Qty. [No's]</td>
                        <td>UOM</td>
                        <td>Total Compensation</td>
                        <td>Compensation Mode</td>
                        <td>Compensation No</td>
                        <td>Compensation Issued Date</td>
                    </tr>
                </tfoot>

            </table>
        </div>


        <div id="FPDiv">
            <table class="ListTable" id="ClosedComplaintsAccountDefectTypeFP">

                <thead>
                    <tr>
                        <td>Complaint Tracking No</td>
                        <td>Complaint Code</td>
                        <td>Complaint Type</td>
                        <td>Customer Code</td>
                        <td>Customer Name</td>
                        <td>Secondary Customer</td>
                        <td>Visit Date</td>
                        <td>City</td>
                        <td>State</td>
                        <td>Invoice Details</td>
                        <td>Compensation Mode</td>
                        <td>Compensation Issued Date</td>
                        <td>Product Division</td>
                        <td>Product Code</td>
                        <td>Product Description</td>
                        <td>Supplied Qty. [No's]</td>
                        <td>Defect Qty. [No's]</td>
                        <td>Defect Type</td>
                        <td>UOM</td>
                        <td>Actual Compensation Qty</td>
                    </tr>
                </thead>

                <tbody></tbody>

                <tfoot style="display: none;">
                    <tr>
                        <td>Complaint Tracking No</td>
                        <td>Complaint Code</td>
                        <td>Complaint Type</td>
                        <td>Customer Code</td>
                        <td>Customer Name</td>
                        <td>Secondary Customer</td>
                        <td>Visit Date</td>
                        <td>City</td>
                        <td>State</td>
                        <td>Invoice Details</td>
                        <td>Compensation Mode</td>
                        <td>Compensation Issued Date</td>
                        <td>Product Division</td>
                        <td>Product Code</td>
                        <td>Product Description</td>
                        <td>Supplied Qty. [No's]</td>
                        <td>Defect Qty. [No's]</td>
                        <td>Defect Type</td>
                        <td>UOM</td>
                        <td>Actual Compensation Qty</td>
                    </tr>
                </tfoot>

            </table>
        </div>



    </div>

</body>
</html>


<script type="text/javascript">

    $(document).ready(function () {

        var FD = $("#FD").val();
        var TD = $("#TD").val();
        var PC = $("#PC").val();
        var PT = $("#PT").val();

        var Data = JSON.stringify({
            Report: "LastFiveReports",
            ReportName: "ClosedComplaintsAccountDefectType",
            FD: DateToForeign(FD),
            TD: DateToForeign(TD),
            PC: PC,
            PT: PT
        });

        $.ajax({
            method: 'POST',
            url: '../../ComplaintReports/GetReportData',
            data: { Data: Data },
        }).then(function successCallback(Resp) {
            if (Resp == "") {
                $('#ClosedComplaintsAccount').dataTable({});
                alert("No Data Available");
                window.close();
            }
            else {
                Resp = JSON.parse(Resp);

                var TRCode = "";

                if (PT == "") {
                    window.close();
                }
                else if (PT == "Sheeting") {

                    $("#SheetingDiv").css('display', 'block');
                    $("#OthersDiv").css('display', 'none');
                    $("#FPDiv").css('display', 'none');

                    for (var i = 0; i < Resp.length; i++) {

                        TRCode = TRCode + "<tr>";

                        TRCode = TRCode + "<td>" + Resp[i]["COMPLAINT_TRACKING_NO"] + "</td>";
                        TRCode = TRCode + "<td>" + Resp[i]["COMPLAINT_CODE"] + "</td>";
                        TRCode = TRCode + "<td>" + Resp[i]["CUSTOMER_NAME"] + "</td>";
                        TRCode = TRCode + "<td>" + Resp[i]["END_CUSTOMER_DETAILS"] + "</td>";

                        TRCode = TRCode + "<td>" + Resp[i]["CUSTOMER_CODE"] + "</td>";
                        TRCode = TRCode + "<td>" + Resp[i]["VISITED_DATE"] + "</td>";
                        TRCode = TRCode + "<td>" + Resp[i]["CITY_CODE"] + "</td>";
                        TRCode = TRCode + "<td>" + Resp[i]["STATE_NAME"] + "</td>";

                        TRCode = TRCode + "<td>" + Resp[i]["INVOICE_DETAILS"] + "</td>";
                        TRCode = TRCode + "<td>" + Resp[i]["DIVISION_NAME"] + "</td>";
                        TRCode = TRCode + "<td>" + Resp[i]["supply_qty"] + "</td>";
                        TRCode = TRCode + "<td>" + Resp[i]["breakage_qty"] + "</td>";

                        //TRCode = TRCode + "<td>" + Resp[i]["UOM"] + "</td>";
                        TRCode = TRCode + "<td>" + Resp[i]["COMPENSATION_IN_METER_OTHER"] + "</td>";
                        TRCode = TRCode + "<td>" + Resp[i]["TOTAL_COMPENSATION"] + "</td>";


                        if (Resp[i]["SIZE3.6"] == "" || Resp[i]["SIZE3.6"] == 0) {
                            TRCode = TRCode + "<td>0</td>";
                        }
                        else {
                            //var Size = ((parseFloat(Resp[i]["SIZE3.6"]) * 12.69) / 1000);
                            //Size = Math.round(Size * 100) / 100;
                            TRCode = TRCode + "<td>" + Resp[i]["SIZE3.6"] + "</td>";
                        }

                        if (Resp[i]["COMP_OTR_SIZE"] == "" || Resp[i]["COMP_OTR_SIZE"] == 0) {
                            TRCode = TRCode + "<td>0</td>";
                        }
                        else {
                            //var Size = ((parseFloat(Resp[i]["COMP_OTR_SIZE"]) * 12.69) / 1000);
                            //Size = Math.round(Size * 100) / 100;
                            TRCode = TRCode + "<td>" + Resp[i]["COMP_OTR_SIZE"] + "</td>";
                        }

                        TRCode = TRCode + "<td>" + Resp[i]["COMPENSATION_MODE_NAME"] + "</td>";
                        TRCode = TRCode + "<td>" + Resp[i]["ID"] + "</td>";
                        TRCode = TRCode + "<td>" + Resp[i]["APPROVED_DATE"] + "</td>";

                        TRCode = TRCode + "</tr>";

                    }
                    $("#ClosedComplaintsAccount tbody").empty();
                    $("#ClosedComplaintsAccount tbody").append(TRCode);
                    $('#ClosedComplaintsAccount').DataTable({
                        paging: true,
                        scrollX: "100%",
                        scrollY: true,
                        dom: 'Bfrtip',
                        buttons: [
                            {
                                extend: 'pdfHtml5',
                                orientation: 'landscape',
                                pageSize: 'A3'
                            },
                            'copy', 'csv', 'excel', 'print'
                        ]
                    });
                }
                else if (PT == "Others") {

                    $("#SheetingDiv").css('display', 'none');
                    $("#OthersDiv").css('display', 'block');
                    $("#FPDiv").css('display', 'none');

                    for (var i = 0; i < Resp.length; i++) {

                        TRCode = TRCode + "<tr>";

                        TRCode = TRCode + "<td>" + Resp[i]["COMPLAINT_TRACKING_NO"] + "</td>";
                        TRCode = TRCode + "<td>" + Resp[i]["COMPLAINT_CODE"] + "</td>";
                        TRCode = TRCode + "<td>" + Resp[i]["CUSTOMER_NAME"] + "</td>";
                        TRCode = TRCode + "<td>" + Resp[i]["END_CUSTOMER_DETAILS"] + "</td>";

                        TRCode = TRCode + "<td>" + Resp[i]["CUSTOMER_CODE"] + "</td>";
                        TRCode = TRCode + "<td>" + Resp[i]["VISITED_DATE"] + "</td>";
                        TRCode = TRCode + "<td>" + Resp[i]["CITY_CODE"] + "</td>";
                        TRCode = TRCode + "<td>" + Resp[i]["STATE_NAME"] + "</td>";

                        TRCode = TRCode + "<td>" + Resp[i]["INVOICE_DETAILS"] + "</td>";
                        TRCode = TRCode + "<td>" + Resp[i]["DIVISION_NAME"] + "</td>";



                        TRCode = TRCode + "<td>" + Resp[i]["SUPPLIED_QTY"] + "</td>";
                        TRCode = TRCode + "<td>" + Resp[i]["TOTAL_BREAKAGE_QTY"] + "</td>";
                        TRCode = TRCode + "<td>" + Resp[i]["COMPENSATION_IN_METER_OTHER"] + "</td>";

                        TRCode = TRCode + "<td>" + Resp[i]["COMPENSATION_IN_CUBIC_METER"] + "</td>";
                        TRCode = TRCode + "<td>" + Resp[i]["COMPENSATION_MODE_NAME"] + "</td>";
                        TRCode = TRCode + "<td>" + Resp[i]["ID"] + "</td>";

                        TRCode = TRCode + "<td>" + Resp[i]["APPROVED_DATE"] + "</td>";




                        TRCode = TRCode + "</tr>";

                    }

                    $("#ClosedComplaintsAccountOthers tbody").empty();
                    $("#ClosedComplaintsAccountOthers tbody").append(TRCode);
                    $('#ClosedComplaintsAccountOthers').DataTable({
                        paging: true,
                        scrollX: "100%",
                        scrollY: true,
                        dom: 'Bfrtip',
                        buttons: [
                            {
                                extend: 'pdfHtml5',
                                orientation: 'landscape',
                                pageSize: 'A3'
                            },
                            'copy', 'csv', 'excel', 'print'
                        ]
                    });

                }

                else if (PT == "PF") {
                    console.log("Entered");
                    console.log(Resp.length);
                    console.log(Resp);
                    $("#SheetingDiv").css('display', 'none');
                    $("#OthersDiv").css('display', 'none');
                    $("#FPDiv").css('display', 'block');


                    for (var i = 0; i < Resp.length; i++) {

                        TRCode = TRCode + "<tr>";

                        TRCode = TRCode + "<td>" + Resp[i]["COMPLAINT_ID"] + "</td>";
                        TRCode = TRCode + "<td>" + Resp[i]["COMPLAINT_CODE"] + "</td>";
                        TRCode = TRCode + "<td>" + Resp[i]["COMPLAINT_TYPE_NAME"] + "</td>";
                        TRCode = TRCode + "<td>" + Resp[i]["Customer_Code"] + "</td>";

                        TRCode = TRCode + "<td>" + Resp[i]["CUSTOMER_NAME"] + "</td>";
                        TRCode = TRCode + "<td>" + Resp[i]["END_CUSTOMER_DETAILS"] + "</td>";
                        TRCode = TRCode + "<td>" + Resp[i]["VISITED_DATE"] + "</td>";

                        TRCode = TRCode + "<td>" + Resp[i]["CITY_CODE"] + "</td>";
                        TRCode = TRCode + "<td>" + Resp[i]["STATE_NAME"] + "</td>";
                        TRCode = TRCode + "<td>" + Resp[i]["INVOICE_DETAILS"] + "</td>";

                        TRCode = TRCode + "<td>" + Resp[i]["COMPENSATION_MODE_NAME"] + "</td>";
                        TRCode = TRCode + "<td>" + Resp[i]["APPROVED_DATE"] + "</td>";
                        TRCode = TRCode + "<td>" + Resp[i]["DIVISION_NAME"] + "</td>";

                        TRCode = TRCode + "<td>" + Resp[i]["PRODCODE"] + "</td>";
                        TRCode = TRCode + "<td>" + Resp[i]["PRODUCT_NAME"] + "</td>";
                        TRCode = TRCode + "<td>" + Resp[i]["SUPPLYQTY"] + "</td>";

                        TRCode = TRCode + "<td>" + Resp[i]["DEFQTY"] + "</td>";
                        TRCode = TRCode + "<td>" + Resp[i]["DEFECT_TYPE"] + "</td>";
                        TRCode = TRCode + "<td>" + Resp[i]["UOM"] + "</td>";
                        TRCode = TRCode + "<td>" + Resp[i]["ACTDFTQTY"] + "</td>";

                        TRCode = TRCode + "</tr>";

                    }

                    $("#ClosedComplaintsAccountDefectTypeFP tbody").empty();
                    $("#ClosedComplaintsAccountDefectTypeFP tbody").append(TRCode);
                    $('#ClosedComplaintsAccountDefectTypeFP').DataTable({
                        paging: true,
                        scrollX: "100%",
                        scrollY: true,
                        dom: 'Bfrtip',
                        buttons: [
                            {
                                extend: 'pdfHtml5',
                                orientation: 'landscape',
                                pageSize: 'A3'
                            },
                            'copy', 'csv', 'excel', 'print'
                        ]
                    });

                }


            }

        },
        function errorCallback(response) {
            alert("Error : " + response);
        });
    });


    function DateToForeign(IndDate) {
        IndDate = IndDate.split('/');
        return (IndDate[2] + "-" + IndDate[1] + "-" + IndDate[0]);
    }


</script>

