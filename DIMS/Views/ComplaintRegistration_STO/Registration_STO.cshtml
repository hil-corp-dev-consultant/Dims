@*

    Module              : CMS - DIMS Solution.
    DocumentName        : RegistrationList_STO.cs
    Project Name        : Dealer Information Management System (DIMS).
    Client Name         : HIL :: CK BIRLA GROUP.
    Description         : This Doc is for used for Complaint Registration STO.
    Developer Name      : SVPRASADK.
    Change Log          : NA.
    Date Started        : 17-07-2020


*@



@using LabelName = DIMS.Content.Resource_Files.ComplaintRegistration;
@{
    Layout = null;
    DIMS.Models.UserProperties UP = (DIMS.Models.UserProperties)Session["UP"];
    string SessionSITEDETAIL_CODE_STO = UP.SITEDETAIL_CODE;
    string SessionUserCode_STO = UP.UserCode;
    string SessionUserName_STO = UP.UserName;
    string SessionCOMPANYDETAIL_CODE_STO = UP.COMPANYDETAIL_CODE;
    string SessionUserType_STO = UP.UserType;
    string SessionUserTypeID_STO = UP.UserTypeCode;

    string ThreeMonthsBack_STO = DateTime.Now.AddDays(-100).ToString("dd/MM/yyyy");  
  
    string UserType_STO = UP.UserTypeCode;
}


}

<style type="text/css">
    .modal-content {
        padding: 10px;
    }

    table tr {
        cursor: pointer;
    }

    .filestyle {
        border: 1px solid;
        border-radius: 6px;
    }
</style>

<section class="content-header" style="padding: 1px 15px 0;">

    <h2>Complaint Registration STO</h2>
    <ol class="breadcrumb">
        <li><a href ng-click="go('home')"><i class="fa fa-dashboard"></i>Home</a></li>
        <li>Complaint Management STO</li>
        <li class="active">Complaint Registration STO</li>
    </ol>
    <nav style="padding: 1px 10px 1px 10px;">
        <div class="row">
            <div class="col-sm-11" id="IconsNavBar">
                <a href ng-click="go('ComplaintPendingApproval_STO')" id="PendingApprovalsList" style="float: left; display: none;">
                    <i class="fa fa-list fa-4" title="Pending Approvals List"></i>
                </a>
                <a href ng-click="go('RegistrationList_STO')" id="RegList" style="float: left;">
                    <i class="fa fa-list fa-4" title="Registration List"></i>
                </a>
                <a href onclick="RegisterComplaintWithFiles_STO()" id="CompRegSave" style="float: left;">
                    <i class="fa fa-floppy-o fa-4" title="Save Complaint"></i>
                </a>
                <a href ng-click="go('Registration_STO')" id="NewReg" style="float: left;">
                    <i class="fa fa-file-o fa-4" title="Create New Complaint"></i>
                </a>
                <a href ng-click="SendRegistrationForApproval_STO()" id="SendRegistrationApproval" style="float: left;">
                    <i class="fa fa-forward" title="Send Complaint for Review"></i>
                </a>
                @*<a href ng-click="SendRegistrationForApproval_STO()" id="SendRegistrationApproval" style="float: left;">
                        <i class=" fa fa-thumbs-o-up" title="Send Complaint for Review"></i>
                    </a>*@
                <a href ng-click="GetApprovalPopUp_STO()" id="MakeApproved" style="float: left; display:none">
                    <i class="fa fa-check" title="Approve Complaint"></i>
                </a>
                <span style="float:left; padding-right:10px;">RECEIVING PLANT </span>
             <select id="FROM_PLANT_CODE" ng-model="FROM_PLANT_CODE" disabled="disabled" ng-change="PlantChange()" style="float:left;"></select>
                <a href onclick="RegisterComplaintWithFiles_STO()" id="SuperSave" style="float: left; display: none; margin-left: 10px;">
                    <i class="fa fa-floppy-o fa-4" title="Change Action"></i>
                </a>
                <a href ng-click="RegisterComplaint_STO()" id="hiddenCompRegSave" style="display:none">
                </a>
            </div>
        </div>
    </nav>
</section>

<div class="CustomHeight_Section" style="overflow: auto;">
    <section style="padding: 0 15px 90px;">
        <div class="row">
            <div class="col-md-12">
                <div class="box box-primary" style="background: white none repeat scroll 0 0; padding: 4px;">
                    <div class="box-header">
                        <form class="form-horizontal ng-pristine ng-valid" role="form" method="get" action="#" style="font-size: 12px; font-weight: normal" enctype="multipart/form-data">
                            <div class="row">
                                <input type="text" id="MyTest" style="display: none;" />
                                <div class="col-sm-12">
                                    <input type="text" class="form-control" id="FormIdentity_STO" readonly="readonly" style="display: none" />
                                    <input type="text" class="form-control" id="UserCode_STO" readonly="readonly" style="display: none;" value="@SessionUserCode_STO" />
                                    <input type="text" class="form-control" id="UserName_STO" readonly="readonly" style="display: none;" value="@SessionUserName_STO" />
                                    <input type="text" class="form-control" id="UserType_STO" readonly="readonly" style="display: none;" value="@SessionUserType_STO" />
                                    <input type="text" class="form-control" id="UserType_ID_STO" readonly="readonly" style="display: none" value="@SessionUserTypeID_STO" />
                                    <input type="text" class="form-control" id="SITEDETAIL_CODE_STO" readonly="readonly" style="display: none;" value="@SessionSITEDETAIL_CODE_STO" />
                                    <input type="text" class="form-control" id="COMPANYDETAIL_CODE_STO" readonly="readonly" style="display: none" value="@SessionCOMPANYDETAIL_CODE_STO" />

                                    <input type="text" readonly="readonly" style="display:none;" value="@ThreeMonthsBack_STO" id="ThreeMonthsBack_STO" />

                                    <div class="col-sm-12 form-group">
                                        <label class="col-sm-3 control-label">COMPLAINT RECEIVED DATE<span class="Mandatory">*</span></label>
                                        <div class="col-sm-3">
                                            <input type="text" class="form-control" id="COMPLAINT_RECEIVED_DATE" data-ng-model="COMPLAINT_RECEIVED_DATE" readonly="readonly" />
                                        </div>
                                        <label class="col-sm-2 control-label Complaint_NumberDiv" style="display: none;">Complaint Number</label>
                                        <div class="col-sm-3">
                                            <input type="text" class="form-control gray Complaint_NumberDiv" style="display: none;" id="Complaint_Number" data-ng-model="Complaint_Number" disabled="disabled" />
                                        </div>
                                    </div>
                                    <div class="col-sm-12 form-group">
                                        <label class="col-sm-3 control-label">COMPLAINT REGISTRATION DATE</label>
                                        <div class="col-sm-3">
                                            <input type="text" class="form-control gray" id="COMPLAINT_REGISTRATION_DATE" data-ng-model="COMPLAINT_REGISTRATION_DATE" disabled="disabled" />
                                        </div>
                                        <label class="col-sm-2 control-label">COMPLAINT TRACKING NO</label>
                                        <div class="col-sm-3">
                                            <input type="text" class="form-control gray" id="COMPLAINT_TRACKING_NO" data-ng-model="COMPLAINT_TRACKING_NO" disabled="disabled" />
                                        </div>
                                    </div>
                                    <div class="col-sm-12 form-group">
                                        <label class="col-sm-3 control-label">REGISTRANT TYPE<span class="Mandatory">*</span></label>
                                        <div class="col-sm-3">
                                            <input type="text" class="form-control gray" id="REGISTRANT_TYPE_NAME" data-ng-model="REGISTRANT_TYPE_NAME" disabled="disabled" />
                                            <input type="text" class="form-control" id="REGISTRANT_TYPE_CODE" data-ng-model="REGISTRANT_TYPE_CODE" style="display: none;" />
                                        </div>
                                        <label class="col-sm-2 control-label">DOC SERIES CODE</label>
                                        <div class="col-sm-3">
                                            <div class="input-group add-on">
                                                <input class="form-control" id="DOC_SERIES_CODE" type="text" disabled="disabled" data-ng-model="DOC_SERIES_CODE">
                                                <div class="input-group-btn">
                                                    <span class="btn btn-default" id="CR_Series_CodeSpan" type="submit" ng-click="Getdata('GetCRSeriesCode_STO','CRSeriesCode','Document Series')"><i class="glyphicon glyphicon-new-window"></i></span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-12 form-group">
                                        <label class="col-sm-3 control-label">BUSINESS UNIT<span class="Mandatory">*</span></label>
                                        <div class="col-sm-3">
                                            <div class="input-group add-on">
                                                <input class="form-control" id="PRODUCT_TYPE_NAME" type="text" readonly="readonly" data-ng-model="PRODUCT_TYPE_NAME" disabled="disabled">
                                                <input type="text" class="form-control" id="PRODUCT_TYPE_CODE" data-ng-model="PRODUCT_TYPE_CODE" readonly="readonly" style="display: none;" />
                                                @*<div class="input-group-btn">
                                                        <span class="btn btn-default" id="Prod_Typ_MastSapn" ng-click="Getdata('GetProductTypeCode_STO','ProductTypeCode_STO','Business Unit List')"><i class="glyphicon glyphicon-new-window"></i></span>
                                                    </div>*@
                                            </div>
                                        </div>
                                        <label class="col-sm-2 control-label">COMPLAINT STATUS</label>
                                        <div class="col-sm-3">
                                            <input type="text" class="form-control gray" id="COMPLAINT_STATUS" data-ng-model="COMPLAINT_STATUS" disabled="disabled" />
                                        </div>
                                    </div>
                                    <div class="col-sm-12 form-group">
                                        @*VIKAS G , 1-2-2022 CHANGE AS PER JOSEPH REQUIREMENT RECIEVING PLANT MHD CODE TO SUPPLY PLANT MHD CODE*@
                                        <label class="col-sm-3 control-label">SUPPLY PLANT MHD CODE<span class="Mandatory">*</span></label>
                                        <div class="col-sm-3">
                                            <div class="input-group add-on">
                                                <input class="form-control" id="PLANT_MHD_CODE" type="text" readonly="readonly" data-ng-model="PLANT_MHD_CODE" disabled="disabled">
                                                <div class="input-group-btn">
                                                    <span class="btn btn-default" id="SalesRepMasterSpan" ng-click="Getdata('GetPlantMHD_STO','PlantMHDMaster_STO','Plant MHD List')"><i class="glyphicon glyphicon-new-window"></i></span>
                                                </div>
                                            </div>
                                        </div>

                                        <label class="col-sm-2 control-label">COMPLAINT CODE</label>
                                        <div class="col-sm-3">
                                            <input type="text" class="form-control gray" id="COMPLAINT_CODE" data-ng-model="COMPLAINT_CODE" disabled="disabled" />
                                        </div>
                                    </div>
                                    @*VIKAS G , 1-2-2022 CHANGE AS PER JOSEPH REQUIREMENT RECIEVING PLANT MHD NAME TO SUPPLY PLANT MHD NAME*@
                                    <div class="col-sm-12 form-group">
                                        <label class="col-sm-3 control-label">SUPPLY PLANT MHD NAME<span class="Mandatory">*</span></label>
                                        <div class="col-sm-3">
                                            <input type="text" class="form-control gray" id="PLANT_MHD_NAME" data-ng-model="PLANT_MHD_NAME" disabled="disabled" />
                                        </div>

                                        <label class="col-sm-2 control-label">APPROVED DATE</label>
                                        <div class="col-sm-3">
                                            <input type="text" class="form-control gray" id="APPROVED_DATE" data-ng-model="APPROVED_DATE" disabled="disabled" />
                                        </div>
                                    </div>
                                    <div class="col-sm-12 form-group">
                                        <label class="col-sm-3 control-label">COMPLAINT DESC</label>
                                        <div class="col-sm-3">
                                            <input type="text" class="form-control" id="COMPLAINT_DESC" data-ng-model="COMPLAINT_DESC" maxlength="300" />
                                        </div>
                                    </div>

                                    <div class="col-sm-12 form-group">
                                        <label class="col-sm-3 control-label">REMARKS</label>
                                        <div class="col-sm-3">
                                            <input type="text" class="form-control" id="REMARKS" data-ng-model="REMARKS" maxlength="300" />
                                        </div>
                                        <label id="lblAttachments" class="col-sm-2 control-label">FileUpload</label>
                                        <div class="col-sm-3" id="NewComplaintFileUploadDiv">
                                            <label class="col-sm-2 control-label" id="SelectedFiles" data-ng-model="FilesPath" style="width: 100%;"></label>
                                            <input type="file" id="ComplaintFile" name="ComplaintFile" class="filestyle" onchange="FileUploaded()" multiple="" />
                                            <input type="button" value="Upload" id="btnUpload" class="btn btn-info navbar-btn" onclick="UploadFiles()" />
                                            <input type="button" value="Clear" id="btnClear" class="btn btn-info navbar-btn" onclick="ClearFiles()" />
                                            <input type="hidden" id="ClickUploadFile" class="form-control" value="0" style="display: none;" />
                                            <input type="hidden" id="ClickSaveComplaint" class="form-control" value="0" style="display: none;" />
                                        </div>
                                        <div class="col-sm-3" id="LoadComplaintFileUploadDiv">
                                            <ul id="ComplaintFilesUploaded"></ul>
                                        </div>
                                    </div>

                                </div>

                                <div class="col-sm-12 tabdiv" id="CustomerDetails">
                                    <div class="col-sm-12 CloseOpen" onclick="FormToggle('CustDetails')">
                                        <img src="~/Images/en_next.png" id="CustDetails_Img" />
                                        <a class="Expand">Supply Plant Details</a>
                                    </div>
                                    <div class="row" style="padding-top: 30px; display: none;" id="CustDetails_Form">
                                        <div class="col-sm-12 form-group">
                                            <label class="col-sm-3 control-label">PLANT CODE<span class="Mandatory">*</span></label>
                                            <div class="col-sm-3">
                                                <div class="input-group add-on">
                                                    <input type="text" class="form-control" id="TO_PLANT_CODE" data-ng-model="TO_PLANT_CODE" disabled="disabled" />
                                                    <div class="input-group-btn">
                                                        <span class="btn btn-default" id="StockistMasterSpan" ng-click="Getdata('GetPlant_STO','PlantMaster_STO','Plant List')"><i class="glyphicon glyphicon-new-window"></i></span>
                                                    </div>
                                                </div>
                                            </div>
                                            <label class="col-sm-3 control-label">PLANT NAME<span class="Mandatory">*</span></label>
                                            <div class="col-sm-3">
                                                <input type="text" class="form-control gray" id="TO_PLANT_NAME" data-ng-model="TO_PLANT_NAME" disabled="disabled" />
                                            </div>
                                            <div style="display:none">
                                                <label class="col-sm-3 control-label">SUB STOCKIEST / DIRECT CUSTOMER</label>
                                                <div class="col-sm-3">
                                                    <textarea class="form-control SubStockiest_Direct_CustomerDIV" id="END_CUSTOMER_DETAILS" data-ng-model="END_CUSTOMER_DETAILS" maxlength="300"></textarea>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-sm-12 form-group">
                                            @*<label class="col-sm-3 control-label">PLANT NAME<span class="Mandatory">*</span></label>
                                            <div class="col-sm-3">
                                                <input type="text" class="form-control gray" id="TO_PLANT_NAME" data-ng-model="TO_PLANT_NAME" disabled="disabled" />
                                            </div>*@
                                            <div style="display:none">
                                            <label class="col-sm-3 control-label">SITE ADDRESS</label>
                                            <div class="col-sm-3">
                                                <textarea class="form-control" id="SITE_ADDRESS" data-ng-model="SITE_ADDRESS" maxlength="300"></textarea>
                                            </div>
                                                </div>
                                        </div>
                                        <div class="col-sm-12 form-group">
                                            <label class="col-sm-3 control-label">COMPLAINT MODE</label>
                                            <div class="col-sm-3">
                                                <div class="input-group add-on">
                                                    <input type="text" class="form-control" id="COMPLAINT_MODE_NAME" data-ng-model="COMPLAINT_MODE_NAME" disabled="disabled" />
                                                    <input type="text" class="form-control" id="COMPLAINT_MODE_CODE" data-ng-model="COMPLAINT_MODE_CODE" readonly="readonly" style="display: none;" />
                                                    <div class="input-group-btn">
                                                        <span class="btn btn-default" id="ComplaintModeSpan" ng-click="Getdata('GetComplaint_Mode_STO','Complaint_Mode','Complaint Mode List')"><i class="glyphicon glyphicon-new-window"></i></span>
                                                    </div>
                                                </div>
                                            </div>
                                            <label class="col-sm-3 control-label">PRODUCT TYPE<span class="Mandatory">*</span></label>
                                            <div class="col-sm-3">
                                                <div class="input-group add-on">
                                                    <input type="text" class="form-control" id="PRODUCT_CATEGORY_NAME" data-ng-model="PRODUCT_CATEGORY_NAME" disabled="disabled" />
                                                    <input type="text" class="form-control" id="PRODUCT_CATEGORY_CODE" data-ng-model="PRODUCT_CATEGORY_CODE" readonly="readonly" style="display: none;" />
                                                    <div class="input-group-btn">
                                                        <span class="btn btn-default" id="ProductDivisionMasterSpan" ng-click="Getdata('GetProductDivisionMaster_STO','ProductDivisionMaster','Product Type List')"><i class="glyphicon glyphicon-new-window"></i></span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-sm-12 tabdiv" id="MaterialSupplyDetailsTab">
                                    <div class="col-sm-12 CloseOpen" onclick="FormToggle('Material_Supply_Detail')">
                                        <img src="~/Images/en_next.png" id="Material_Supply_Detail_Img" />
                                        <a class="Expand">Material Supply Detail</a>
                                    </div>

                                    <div class="row" style="padding-top: 30px; display: none;" id="Material_Supply_Detail_Form">
                                        <div class="col-sm-12">
                                            <table class="table innertable" id="Material_Supply_Details_Table">
                                                <thead>
                                                    <tr>
                                                        <th>S.No</th>
                                                        <th>Mat_MaterialBelongsTo</th>
                                                        <th>Mat_ProductSuppliedFrom</th>
                                                        <th>Mat_Name</th>
                                                    </tr>
                                                </thead>
                                                <tbody></tbody>
                                            </table>

                                            <input type="button" value="Add" id="Mat_Sup_Det_Add" class="smallbutton" data-toggle="modal" data-target="#" onclick="OpenMSDModel()" />

                                        </div>
                                    </div>
                                </div>

                                <div class="col-sm-12 tabdiv" id="Priortize_ClassifyTab">
                                    <div class="col-sm-12 CloseOpen" onclick="FormToggle('Priortize_Classify')">
                                        <img src="~/Images/en_next.png" id="Priortize_Classify_Img" />
                                        <a class="Expand">Prioritize & Classify</a>
                                    </div>

                                    <div class="row" style="padding-top: 30px; display: none;" id="Priortize_Classify_Form">
                                        <div class="col-sm-12">
                                            <div class="col-sm-12 form-group">
                                                <label class="col-sm-3 control-label">Complaint Type<span class="Mandatory">*</span></label>
                                                <div class="col-sm-3">
                                                    <div class="input-group add-on">
                                                        <input type="text" class="form-control" id="COMPLAINT_TYPE_NAME" data-ng-model="COMPLAINT_TYPE_NAME" disabled="disabled" />
                                                        @*<input type="text" class="form-control" id="Complaint_Type_ID" data-ng-model="Complaint_Type_ID" readonly="readonly" style="display: none;" />*@
                                                        <input type="text" class="form-control" id="COMPLAINT_TYPE_CODE" data-ng-model="COMPLAINT_TYPE_CODE" readonly="readonly" style="display: none;" />
                                                        <div class="input-group-btn">
                                                            <span class="btn btn-default" id="GetComplaintTypeSpan" ng-click="Getdata('GetComplaintType_STO','ComplaintType','Complaint Type List')"><i class="glyphicon glyphicon-new-window"></i></span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <label class="col-sm-3 control-label">Complaint Priority</label>
                                                <div class="col-sm-3">
                                                    <div class="input-group add-on">
                                                        <input type="text" class="form-control" id="COMPLAINT_PRIORITY_NAME" data-ng-model="COMPLAINT_PRIORITY_NAME" disabled="disabled" />
                                                        @*<input type="text" class="form-control" id="Complaint_Priority_ID" data-ng-model="Complaint_Priority_ID" readonly="readonly" style="display: none;" />*@
                                                        <input type="text" class="form-control" id="COMPLAINT_PRIORITY_CODE" data-ng-model="COMPLAINT_PRIORITY_CODE" readonly="readonly" style="display: none;" />
                                                        <div class="input-group-btn">
                                                            <span class="btn btn-default" id="GetComplaintPrioritySpan" ng-click="Getdata('GetComplaintPriority_STO','ComplaintPriority','Complaint Priority List')"><i class="glyphicon glyphicon-new-window"></i></span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-sm-12 form-group">
                                                <label class="col-sm-3 control-label">Complaint Category<span class="Mandatory" id="CompCatMandSpan">*</span></label>
                                                <div class="col-sm-3">
                                                    <div class="input-group add-on">
                                                        <input type="text" class="form-control" id="COMPLAINT_CATEGORY_NAME" data-ng-model="COMPLAINT_CATEGORY_NAME" disabled="disabled" />
                                                        @*<input type="text" class="form-control" id="Complaint_Category_ID" data-ng-model="Complaint_Category_ID" readonly="readonly" style="display: none;" />*@
                                                        <input type="text" class="form-control" id="COMPLAINT_CATEGORY_CODE" data-ng-model="COMPLAINT_CATEGORY_CODE" readonly="readonly" style="display: none;" />
                                                        <div class="input-group-btn">
                                                            <span class="btn btn-default" id="GetComplaintCategorySpan" ng-click="Getdata('GetComplaintCategory_STO','ComplaintCategory','Complaint Category List')"><i class="glyphicon glyphicon-new-window"></i></span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <label class="col-sm-3 control-label">Complaint Severity</label>
                                                <div class="col-sm-3">
                                                    <div class="input-group add-on">
                                                        <input type="text" class="form-control" id="COMPLAINT_SEVERITY_NAME" data-ng-model="COMPLAINT_SEVERITY_NAME" disabled="disabled" />
                                                        @*<input type="text" class="form-control" id="Complaint_Severity_ID" data-ng-model="Complaint_Severity_ID" readonly="readonly" style="display: none;" />*@
                                                        <input type="text" class="form-control" id="COMPLAINT_SEVERITY_CODE" data-ng-model="COMPLAINT_SEVERITY_CODE" readonly="readonly" style="display: none;" />
                                                        <div class="input-group-btn">
                                                            <span class="btn btn-default" id="GetComplaintSeveritySpan" ng-click="Getdata('GetComplaintSeverity_STO','ComplaintSeverity','Complaint Severity List')"><i class="glyphicon glyphicon-new-window"></i></span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-sm-12 tabdiv" id="SupplyDetailsDiv">
                                    <div class="col-sm-12 CloseOpen" onclick="FormToggle('SupplyDetails')">
                                        <img src="~/Images/en_next.png" id="SupplyDetails_Img" />
                                        <a class="Expand">Supply Details</a>
                                    </div>

                                    <div class="row" style="padding-top: 30px; display: none;" id="SupplyDetails_Form">
                                        <div class="col-sm-12">
                                            <table class="table innertable" id="Supply_Details_Table">
                                                <thead>
                                                    <tr>
                                                        <th>S No</th>
                                                        <th>Product Details</th>
                                                        <th>Invoice No</th>
                                                        <th>Invoice Date</th>
                                                        <th>Batch No</th>
                                                        <th>Supplied Qty (Nos)</th>
                                                        <th class="BreakageQtyLabel">Breakage Qty (Nos)</th>
                                                        <th>TRANSPORTER</th>
                                                        <th>Defect Type</th>
                                                        <th>REMARKS </th>
                                                    </tr>
                                                </thead>
                                                <tbody></tbody>
                                            </table>

                                            <input type="button" value="Add" id="SupplyDetails_Add" class="smallbutton" data-toggle="modal" data-target="#" onclick="OpenSupDetModel()" />

                                        </div>
                                    </div>
                                </div>

                                <div class="col-sm-12 tabdiv" id="ComplaintDetailedDescDiv">
                                    <div class="col-sm-12 CloseOpen" onclick="FormToggle('ComplaintDetailedDescription')">
                                        <img src="~/Images/en_next.png" id="ComplaintDetailedDescription_Img" />
                                        <a class="Expand">Complaint Detailed Description</a>
                                    </div>

                                    <div class="row" style="padding-top: 30px; display: none;" id="ComplaintDetailedDescription_Form">
                                        <div class="col-sm-12">
                                            <div class="col-sm-10">
                                                <div class="row">
                                                    <div class="form-group">
                                                        <label for="label-2-2" class="col-sm-5 control-label" style="text-align: right;">
                                                            NATURE OF COMPLAINT
                                                        </label>
                                                        <div class="col-sm-7">
                                                            <textarea class="form-control" id="NATURE_OF_COMPLAINT" data-ng-model="NATURE_OF_COMPLAINT" maxlength="3000"></textarea>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>                                            
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <br />
    </section>

    <div class="modal fade" id="MaterialSupplyDetailModal" tabindex="-1" role="dialog" aria-labelledby="MSDModalLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    @*<h4 class="modal-title" id="MSDModalLabel">Material Supply Detail</h4>*@
                    <h4 class="modal-title" id="MSDModalLabel">MaterialSupplyDetail_PopUp</h4>
                </div>
                <div class="modal-body">
                    <form class="form-horizontal ng-pristine ng-valid" role="form" method="get" action="#">
                        <div class="row">
                            <input type="hidden" id="MSD_id" data-ng-model="MSD_id" />
                            <div class="col-sm-12">
                                <div class="row">
                                    <div class="form-group">
                                        <label for="label-2-2" class="col-sm-5 control-label" style="text-align: right;">
                                            PLANT NAME<span class="Mandatory">*</span>
                                        </label>
                                        <div class="col-sm-5">
                                            <div class="input-group add-on">
                                                <input type="text" class="form-control" id="PLANT_NAME" data-ng-model="PLANT_NAME" disabled="disabled" />
                                                <div class="input-group-btn">
                                                    <span class="btn btn-default" ng-click="Getdata('GetPlantMaster_STO','GetPlantMaster','Plant List')"><i class="glyphicon glyphicon-new-window"></i></span>
                                                </div>
                                                <input type="text" class="form-control" id="Material_Belongs_To_ID" data-ng-model="Material_Belongs_To_ID" style="display: none;" />
                                                <input type="text" class="form-control" id="PLANT_CODE" data-ng-model="PLANT_CODE" style="display: none;" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-12">
                                <div class="row">
                                    <div class="form-group">
                                        <label for="label-2-2" class="col-sm-5 control-label" style="text-align: right;">
                                            SUPPLIER TYPE
                                        </label>
                                        <div class="col-sm-5">
                                            <div class="input-group add-on">
                                                <input type="text" class="form-control" id="SUPPLIER_TYPE_NAME" data-ng-model="SUPPLIER_TYPE_NAME" disabled="disabled" />
                                                <input type="text" class="form-control" id="Product_Supplied_From_ID" data-ng-model="Product_Supplied_From_ID" style="display: none;" />
                                                <input type="text" class="form-control" id="SUPPLIER_TYPE_CODE" data-ng-model="SUPPLIER_TYPE_CODE" style="display: none;" />
                                                <div class="input-group-btn">
                                                    <span class="btn btn-default" ng-click="Getdata('GetProductSuppliedFrom_STO','SUPPLIER_TYPE_CODE_STO','Supplier List')"><i class="glyphicon glyphicon-new-window"></i></span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-12">
                                <div class="row">
                                    <div class="form-group">
                                        <label for="label-2-2" class="col-sm-5 control-label" style="text-align: right;">
                                            SUPPLIER NAME
                                        </label>
                                        <div class="col-sm-5">
                                            <div class="input-group add-on">
                                                <input type="text" class="form-control" id="SUPPLIER_NAME" data-ng-model="SUPPLIER_NAME" disabled="disabled" />
                                                <input type="text" class="form-control" id="MSD_Name_ID" data-ng-model="MSD_Name_ID" style="display: none;" />
                                                <input type="text" class="form-control" id="SUPPLIER_CODE" data-ng-model="SUPPLIER_CODE" style="display: none;" />
                                                <div class="input-group-btn">
                                                    <span class="btn btn-default" ng-click="Getdata('GetMSD_Name_STO','MSD_Name','')"><i class="glyphicon glyphicon-new-window"></i></span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" id="MSD_Save" class="btn btn-info" onclick="SaveMSDData()">Save</button>
                    <button type="button" id="MSD_Delete" class="btn btn-info" onclick="DeleteMSD()">Delete</button>
                    <button type="button" id="MSD_Close" class="btn btn-info" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="SupplyDetailModal" tabindex="-1" role="dialog" aria-labelledby="SDModalLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    @*<h4 class="modal-title" id="MSDModalLabel">Material Supply Detail</h4>*@
                    <h4 class="modal-title" id="SDModalLabel">SupplyDetail_PopUp</h4>
                </div>
                <div class="modal-body">
                    <form class="form-horizontal ng-pristine ng-valid" role="form" method="get" action="#">
                        <div class="row">
                            <input type="text" id="SD_id" data-ng-model="SD_id" style="display: none" />
                            <div class="col-sm-12">
                                <div class="row">
                                    <div class="form-group">
                                        <label for="label-2-2" class="col-sm-5 control-label" style="text-align: right;">
                                            PRODUCT NAME<span class="Mandatory">*</span>
                                        </label>
                                        <div class="col-sm-4">
                                            <div class="input-group add-on">
                                                <input type="text" class="form-control" id="SD_ProductDetails" data-ng-model="SD_ProductDetails" disabled="disabled" />
                                                <input type="text" class="form-control" id="SD_ProductDetails_ID" data-ng-model="SD_ProductDetails_ID" style="display: none" />
                                                <input type="text" class="form-control" id="PRODUCT_CODE" data-ng-model="PRODUCT_CODE" style="display: none" />
                                                <input type="text" class="form-control" id="SIZE" data-ng-model="SIZE" style="display: none" />

                                                <div class="input-group-btn">
                                                    <span class="btn btn-default" ng-click="Getdata('GetSD_ProductMaster_STO','GetProductMaster_STO','Product Details')"><i class="glyphicon glyphicon-new-window"></i></span>
                                                </div>
                                            </div>
                                        </div>



                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-12">
                                <div class="row">
                                    <div class="form-group">
                                        <label for="label-2-2" class="col-sm-5 control-label" style="text-align: right;">
                                            INVOICE NO@*<span class="Mandatory SBU3Mandatory">*</span>*@
                                        </label>
                                        <div class="col-sm-4">
                                            <input type="text" class="form-control" id="INVOICE_NO" data-ng-model="INVOICE_NO" maxlength="10" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-12">
                                <div class="row">
                                    <div class="form-group">
                                        <label for="label-2-2" class="col-sm-5 control-label" style="text-align: right;">
                                            INVOICE DATE<span class="Mandatory SBU3Mandatory">*</span>
                                        </label>
                                        <div class="col-sm-4">
                                            <input type="text" class="form-control" id="INVOICE_DATE" data-ng-model="INVOICE_DATE" readonly="readonly" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-12">
                                <div class="row">
                                    <div class="form-group">
                                        <label for="label-2-2" class="col-sm-5 control-label" style="text-align: right;">
                                            BATCH NO
                                        </label>
                                        <div class="col-sm-4">
                                            <input type="text" class="form-control" id="BATCH_NO" data-ng-model="BATCH_NO" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-12">
                                <div class="row">
                                    <div class="form-group">
                                        <label for="label-2-2" class="col-sm-5 control-label" style="text-align: right;">
                                            SUPPLIED NO<span class="Mandatory">*</span>
                                        </label>
                                        <div class="col-sm-4">
                                            <input type="text" class="form-control" id="SUPPLIED_NO" data-ng-model="SUPPLIED_NO" onkeypress="return isInteger(event)" onchange="SuppliedBreakageQtyNosChange('SUPPLY')" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-12">
                                <div class="row">
                                    <div class="form-group">
                                        <label for="label-2-2" class="col-sm-5 control-label BreakageQtyLabel" style="text-align: right; float: left;">
                                            DEFECTED NO
                                        </label><span class="Mandatory" style="float: left;">*</span>
                                        <div class="col-sm-4">
                                            <input type="text" class="form-control" id="DEFECTED_NO" data-ng-model="DEFECTED_NO" onkeypress="return isInteger(event)" onchange="SuppliedBreakageQtyNosChange('BREAK')" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-12">
                                <div class="row">
                                    <div class="form-group">
                                        <label for="label-2-2" class="col-sm-5 control-label" style="text-align: right;">
                                            TRANSPORTER
                                        </label>
                                        <div class="col-sm-4">
                                            <input type="text" class="form-control" id="TRANSPORTER" data-ng-model="TRANSPORTER" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-12">
                                <div class="row">
                                    <div class="form-group">
                                        <label for="label-2-2" class="col-sm-5 control-label" style="text-align: right;">
                                            DEFECT TYPE<span class="Mandatory">*</span>
                                        </label>
                                        <div class="col-sm-4">
                                            <div class="input-group add-on">
                                                <input type="text" class="form-control" id="SD_DefectType" data-ng-model="SD_DefectType" disabled="disabled" />
                                                <input type="text" class="form-control" id="SD_DefectType_ID" data-ng-model="SD_DefectType_ID" style="display: none" />
                                                <input type="text" class="form-control" id="DEFECT_TYPE_CODE" data-ng-model="DEFECT_TYPE_CODE" style="display: none" />
                                                <div class="input-group-btn">
                                                    <span class="btn btn-default" ng-click="Getdata('GetSD_DefectTypeMaster_STO','DefectTypeMaster_STO','Defect Type List')"><i class="glyphicon glyphicon-new-window"></i></span>
                                                </div>
                                            </div>
                                        </div>


                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-12">
                                <div class="row">
                                    <div class="form-group">
                                        <label for="label-2-2" class="col-sm-5 control-label" style="text-align: right;">
                                            REMARKS
                                        </label>
                                        <div class="col-sm-4">
                                            <input type="text" class="form-control" id="REMARKS" data-ng-model="REMARKS" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" id="SD_Save" class="btn btn-info" onclick="SaveSDData()">Save</button>
                    <button type="button" id="SD_Delete" class="btn btn-info" onclick="DeleteSD()">Delete</button>
                    <button type="button" id="SD_Close" class="btn btn-info" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
  
    <div class="modal fade" id="ApprovalsActionForm" tabindex="-1" role="dialog" aria-labelledby="ApprovalsLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="ApprovalsLabel">Approvals Action Form</h4>
                </div>
                <div class="modal-body">
                    <form class="form-horizontal ng-pristine ng-valid" role="form" method="get" action="#">
                        <div class="row">

                            <div class="col-sm-12">
                                <div class="row">
                                    <div class="form-group">
                                        <label for="label-2-2" class="col-sm-5 control-label" style="text-align: right;">
                                            REMARKS
                                        </label>
                                        <div class="col-sm-4">
                                            <textarea class="form-control" id="APPROVALS_REMARKS" data-ng-model="APPROVALS_REMARKS" maxlength="300"></textarea>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-info" ng-click="MakeApproved('Approved')">Approve</button>
                    <button type="button" class="btn btn-info" ng-click="MakeApproved('Rejected')">Reject</button>
                    <button type="button" class="btn btn-info" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">

    $(window).resize(function () {
        $('.CustomHeight_Section').height($(window).height() - 170);
    });
    $('.CustomHeight_Section').height($(window).trigger('resize'));

    //Date Pickers
    $(function () {

        var ForeignDate = TodayDateTime;

        var ThreeMonthsBack_STO = $("#ThreeMonthsBack_STO").val();
        //20-05-2016 12:53:20
        //18/08/2016
        ThreeMonthsBack_STO = (ThreeMonthsBack_STO.split(' ')[0]).split('-');

        ForeignDate = ForeignDate.split('/')[1] + "/" + ForeignDate.split('/')[0] + "/" + ForeignDate.split('/')[2];
        ThreeMonthsBack_STO = ThreeMonthsBack_STO[1] + "/" + ThreeMonthsBack_STO[0] + "/" + ThreeMonthsBack_STO[2];

        $('#COMPLAINT_RECEIVED_DATE').datepicker({
            format: 'dd/mm/yyyy',
            autoclose: true,
            endDate: new Date(ForeignDate),
            startDate: new Date(ThreeMonthsBack_STO),
        });

        $('#COMPLAINT_RECEIVED_DATE').on('show', function (e) {
            console.debug('show', e.date, $(this).data('stickyDate'));

            if (e.date) {
                $(this).data('stickyDate', e.date);
            }
            else {
                $(this).data('stickyDate', null);
            }
        });

        $('#COMPLAINT_RECEIVED_DATE').on('hide', function (e) {
            console.debug('hide', e.date, $(this).data('stickyDate'));
            var stickyDate = $(this).data('stickyDate');

            if (!e.date && stickyDate) {
                console.debug('restore stickyDate', stickyDate);
                $(this).datepicker('setDate', stickyDate);
                $(this).data('stickyDate', null);
            }
        });

        $("#COMPLAINT_REGISTRATION_DATE").datepicker({
            format: 'dd/mm/yyyy',
            autoclose: true,
            endDate: new Date(ForeignDate)
        });
        //$("#APPROVED_DATE").datepicker({
        //    format: 'dd/mm/yyyy',
        //    autoclose: true
        //});
        $("#Invoice_Date").datepicker({
            format: 'dd/mm/yyyy',
            autoclose: true,
            endDate: new Date(ForeignDate)
        });
        $("#INVOICE_DATE").datepicker({
            format: 'dd/mm/yyyy',
            autoclose: true,
            endDate: new Date(ForeignDate)
        });
        $("#FormIdentity_STO").bind('change', function () {
            enabledisableFileUpload();
        });
        $("#SelectedFiles").on('change', function () {
            enabledisableFileUpload();
        });
        $("#COMPLAINT_STATUS").on('change', function () {
            enabledisableFileUpload();
        });
        $("#INVOICE_NO").focusout(function () {
            //ValidateInvoice();
        });

        if ($("#PRODUCT_TYPE_NAME").val() == "SBU3" || $("#PRODUCT_TYPE_CODE").val() == "SBU3") {
            $("#SupplyDetailsDiv").show();
            $("#ComplaintDetailedDescDiv").show();
            $("#MaterialSupplyDetailsTab").css('display', 'block');
            $("#Priortize_ClassifyTab").css('display', 'block');
            //$("#SubStockistDirectCustomer_Lbl").text("Distributor/ Wholesaler/ Dealer/ Project");
            $("#CompCatMandSpan").show();
            //$(".BreakageQtyLabel").text("Defect Qty (Nos)");
            $("#COMPLAINT_TYPE_CODE").val("CTC1");
            $("#COMPLAINT_TYPE_NAME").val("Product Complaints");
            $(".SBU3Mandatory").show();
        }
    });

    //for validating Supplied and Breakage Quantity Nos Change
    function SuppliedBreakageQtyNosChange(Req) {
        try {

            var Supply = $("#SUPPLIED_NO").val();
            var Breakage = $("#DEFECTED_NO").val();

            if (Supply == "" || Supply == null || Supply == undefined || isNaN(Supply)) {
                $("#SUPPLIED_NO").val("");
                Supply = "";
            }
            else {
                $("#SUPPLIED_NO").val(parseInt(Supply));
            }

            if (Breakage == "" || Breakage == null || Breakage == undefined || isNaN(Breakage)) {
                $("#DEFECTED_NO").val("");
                Breakage = "";
            }
            else {
                $("#DEFECTED_NO").val(parseFloat(Breakage));
            }


            if (Supply == "" || Breakage == "") {
                return;
            }
            else {
                if (parseInt(Breakage) > parseInt(Supply)) {
                    alert("Breakage Quantity Cannot be morethan Supply Quantity");
                    $("#DEFECTED_NO").val("");
                }
                else {

                }
            }
        }
        catch (e) {
            alert("Error SuppliedBreakageQtyNosChange : " + e);
        }


    }

    /*       Material Supply Detail       */

    /*
   The Below functions are for Open Save Edit Delete operations on the Material Supply Details table
   */

    function OpenMSDModel() {
        try {
            var CNO = $("#TO_PLANT_CODE").val();
            if (CNO == "") {
                alert("Please Select Plant Details");
                return;
            }

            $("#MSD_id").val("");
            $("#PLANT_NAME").val("");
            $("#SUPPLIER_TYPE_NAME").val("");
            $("#SUPPLIER_NAME").val("");


            $("#Material_Belongs_To_ID").val("");
            $("#PLANT_CODE").val("");
            $("#Product_Supplied_From_ID").val("");
            $("#SUPPLIER_TYPE_CODE").val("");
            $("#MSD_Name_ID").val("");
            $("#SUPPLIER_CODE").val("");


            $("#MSD_Delete").hide();
            $("#MSD_Save").text("Save");

            $("#MaterialSupplyDetailModal").modal('show');
        }
        catch (e) {
            alert("Error : MaterialSupplyDetailModal :" + e);
        }
    }


    function SaveMSDData() {
        try {
            var MSD_id = $("#MSD_id").val();
            var PLANT_NAME = $("#PLANT_NAME").val();
            var SUPPLIER_TYPE_NAME = $("#SUPPLIER_TYPE_NAME").val();
            var SUPPLIER_NAME = $("#SUPPLIER_NAME").val();


            var Material_Belongs_To_ID = $("#Material_Belongs_To_ID").val();
            var PLANT_CODE = $("#PLANT_CODE").val();
            var Product_Supplied_From_ID = $("#Product_Supplied_From_ID").val();
            var SUPPLIER_TYPE_CODE = $("#SUPPLIER_TYPE_CODE").val();
            var MSD_Name_ID = $("#MSD_Name_ID").val();
            var SUPPLIER_CODE = $("#SUPPLIER_CODE").val();

            var Flag = 0;

            if (PLANT_NAME == "") {
                Flag = Flag + 1;
                $("#PLANT_NAME").css("border-color", "red");
            }
            else {
                $("#PLANT_NAME").css("border-color", "#d2d6de");
            }

            if (Flag > 0) {
                return;
            }
            else {
                var TRCode = "";

                TRCode = TRCode + "<td>" + PLANT_NAME + "</td>";
                TRCode = TRCode + "<td>" + SUPPLIER_TYPE_NAME + "</td>";
                TRCode = TRCode + "<td>" + SUPPLIER_NAME + "</td>";

                TRCode = TRCode + "<td style='display:none'>" + Material_Belongs_To_ID + "</td>";
                TRCode = TRCode + "<td style='display:none'>" + PLANT_CODE + "</td>";
                TRCode = TRCode + "<td style='display:none'>" + Product_Supplied_From_ID + "</td>";
                TRCode = TRCode + "<td style='display:none'>" + SUPPLIER_TYPE_CODE + "</td>";
                TRCode = TRCode + "<td style='display:none'>" + MSD_Name_ID + "</td>";
                TRCode = TRCode + "<td style='display:none'>" + SUPPLIER_CODE + "</td>";

                if (MSD_id == "") {
                    MSD_id = $("#Material_Supply_Details_Table tbody tr").length + 1;

                    TRCode = "<tr class='MousePointer' id='MSD_" + MSD_id + "' onclick='EditMSD(this.id)'><td>" + MSD_id + "</td>" + TRCode + "</tr>";
                    $("#Material_Supply_Details_Table tbody").append(TRCode);
                }
                else {
                    $("#Material_Supply_Details_Table tbody #MSD_" + MSD_id + " td")[0].innerHTML = MSD_id;
                    $("#Material_Supply_Details_Table tbody #MSD_" + MSD_id + " td")[1].innerHTML = PLANT_NAME;
                    $("#Material_Supply_Details_Table tbody #MSD_" + MSD_id + " td")[2].innerHTML = SUPPLIER_TYPE_NAME;
                    $("#Material_Supply_Details_Table tbody #MSD_" + MSD_id + " td")[3].innerHTML = SUPPLIER_NAME;


                    $("#Material_Supply_Details_Table tbody #MSD_" + MSD_id + " td")[4].innerHTML = Material_Belongs_To_ID;
                    $("#Material_Supply_Details_Table tbody #MSD_" + MSD_id + " td")[5].innerHTML = PLANT_CODE;
                    $("#Material_Supply_Details_Table tbody #MSD_" + MSD_id + " td")[6].innerHTML = Product_Supplied_From_ID;
                    $("#Material_Supply_Details_Table tbody #MSD_" + MSD_id + " td")[7].innerHTML = SUPPLIER_TYPE_CODE;
                    $("#Material_Supply_Details_Table tbody #MSD_" + MSD_id + " td")[8].innerHTML = MSD_Name_ID;
                    $("#Material_Supply_Details_Table tbody #MSD_" + MSD_id + " td")[9].innerHTML = SUPPLIER_CODE;



                    $("#Material_Belongs_To_ID").val("");
                    $("#PLANT_CODE").val("");
                    $("#Product_Supplied_From_ID").val("");
                    $("#SUPPLIER_TYPE_CODE").val("");
                    $("#MSD_Name_ID").val("");
                    $("#SUPPLIER_CODE").val("");
                }


                $("#MSD_id").val("");
                $("#PLANT_NAME").val("");
                $("#SUPPLIER_TYPE_NAME").val("");
                $("#SUPPLIER_NAME").val("");


                $("#Material_Belongs_To_ID").val("");
                $("#PLANT_CODE").val("");
                $("#Product_Supplied_From_ID").val("");
                $("#SUPPLIER_TYPE_CODE").val("");
                $("#MSD_Name_ID").val("");
                $("#SUPPLIER_CODE").val("");


                $("#MaterialSupplyDetailModal").modal("hide");
            }

            SaveDataToServer('CMS_RC_Material_Supply_Details_STO');
            //OpenMSDModel();
        }
        catch (e) {
            alert("Error : SaveMSDData :" + e);
        }
    }


    function EditMSD(RowId) {
        try {

            var COMPLAINT_STATUS = $("#COMPLAINT_STATUS").val();

            var UserType_STO = $("#UserType_ID_STO").val();
            if (UserType_STO == "CSM" || UserType_STO == "QH" || UserType_STO == "CSM_BU2" || UserType_STO == "CSM_BU3") {
            }
            else if (COMPLAINT_STATUS == "Waiting for approval" || COMPLAINT_STATUS == "Complaint Registered" || COMPLAINT_STATUS == "DRAFT") {
            }
            else {
                return;
            }

            $("#MSD_id").val($("#Material_Supply_Details_Table tbody #" + RowId + " td")[0].innerHTML);
            $("#PLANT_NAME").val($("#Material_Supply_Details_Table tbody #" + RowId + " td")[1].innerHTML);
            $("#SUPPLIER_TYPE_NAME").val($("#Material_Supply_Details_Table tbody #" + RowId + " td")[2].innerHTML);
            $("#SUPPLIER_NAME").val($("#Material_Supply_Details_Table tbody #" + RowId + " td")[3].innerHTML);

            $("#Material_Belongs_To_ID").val($("#Material_Supply_Details_Table tbody #" + RowId + " td")[4].innerHTML);
            $("#PLANT_CODE").val($("#Material_Supply_Details_Table tbody #" + RowId + " td")[5].innerHTML);
            $("#Product_Supplied_From_ID").val($("#Material_Supply_Details_Table tbody #" + RowId + " td")[6].innerHTML);
            $("#SUPPLIER_TYPE_CODE").val($("#Material_Supply_Details_Table tbody #" + RowId + " td")[7].innerHTML);
            $("#MSD_Name_ID").val($("#Material_Supply_Details_Table tbody #" + RowId + " td")[8].innerHTML);
            $("#SUPPLIER_CODE").val($("#Material_Supply_Details_Table tbody #" + RowId + " td")[9].innerHTML);


            $("#MaterialSupplyDetailModal").modal('show');
            $("#MSD_Delete").show();
            $("#MSD_Save").text("Update");
        }
        catch (e) {
            alert("Error : EditMSD : " + e);
        }

    }


    function DeleteMSD() {
        try {
            var MSD_id = $("#MSD_id").val();

            $("#Material_Supply_Details_Table tbody #MSD_" + MSD_id + "").remove();

            $("#MSD_id").val("");
            $("#PLANT_NAME").val("");
            $("#SUPPLIER_TYPE_NAME").val("");
            $("#SUPPLIER_NAME").val("");

            $("#Material_Belongs_To_ID").val("");
            $("#PLANT_CODE").val("");
            $("#Product_Supplied_From_ID").val("");
            $("#SUPPLIER_TYPE_CODE").val("");
            $("#MSD_Name_ID").val("");
            $("#SUPPLIER_CODE").val("");

            $("#MaterialSupplyDetailModal").modal("hide");

            var i = 1;

            $("#Material_Supply_Details_Table tbody tr").each(function () {
                $(this).attr("id", "MSD_" + i);
                $("#Material_Supply_Details_Table tbody #MSD_" + i + " td")[0].innerHTML = i;
                i = i + 1;
            });

            $("#MaterialSupplyDetailModal").modal("hide");
            SaveDataToServer('CMS_RC_Material_Supply_Details_STO');
        }
        catch (e) {
            alert("Error : DeleteMSD : " + e);
        }

    }

    /*       Material Supply Detail       */



    /*      SupplyDetailsModel          */

    /*
   The Below functions are for Open Save Edit Delete operations on the Supply Deatils Table
   */


    function OpenSupDetModel() {
        try {
            var CNO = $("#TO_PLANT_CODE").val();
            if (CNO == "") {
                alert("Please Select Plant Details");
                return;
            }

            var PRODUCT_TYPE_NAME = $("#PRODUCT_TYPE_NAME").val();
            var PRODUCT_CATEGORY_NAME = $("#PRODUCT_CATEGORY_NAME").val();
            var PRODUCT_CATEGORY_CODE = $("#PRODUCT_CATEGORY_CODE").val();

            if (PRODUCT_TYPE_NAME == "") {
                alert("Please Select Product Type");
                return;
            }
            if (PRODUCT_CATEGORY_NAME == "") {
                alert("Please Select Product Division");
                return;
            }

            $("#SD_id").val("");
            $("#SD_ProductDetails").val("");
            $("#INVOICE_NO").val("");
            $("#INVOICE_DATE").val("");
            $("#BATCH_NO").val("");
            $("#SUPPLIED_NO").val("");
            $("#DEFECTED_NO").val("");
            $("#TRANSPORTER").val("");
            $("#SD_DefectType").val("");
            $("#REMARKS").val("");

            //For SBU2 ProductType
            $("#SD_id_SBU2").val("");
            $("#SD_ProductDetails_SBU2").val("");
            $("#INVOICE_NO").val("");
            $("#INVOICE_DATE").val("");
            $("#BATCH_NO").val("");
            $("#SUPPLIED_NO").val("");
            $("#DEFECTED_NO").val("");
            $("#TRANSPORTER").val("");
            $("#SD_DefectType_SBU2").val("");
            $("#REMARKS").val("");

            $("#SD_ProductDetails_ID").val("");
            $("#PRODUCT_CODE").val("");

            $("#SD_ProductDetails_ID_SBU2").val("");
            $("#PRODUCT_CODE").val("");

            $("#SD_DefectType_ID").val("");
            $("#DEFECT_TYPE_CODE").val("");

            $("#SD_DefectType_ID_SBU2").val("");
            $("#DEFECT_TYPE_CODE").val("");

            $("#SIZE").val("");
            $("#SIZE").val("");


            $("#SD_Delete").hide();
            $("#SD_Save").text("Save");

            $("#SD_Delete_SBU2").hide();
            $("#SD_Save_SBU2").text("Save");
            
                $("#SupplyDetailModal").modal('show');           
        }
        catch (e) {
            alert("Error : OpenSupDetModel :" + e);
        }
    }


    function SaveSDData() {
        try {
            var ProdType = $("#PRODUCT_TYPE_NAME").val();
            var SD_id;
            var SD_ProductDetails;
            var SD_ProductDetails_ID;
            var PRODUCT_CODE;
            var INVOICE_NO;
            var INVOICE_DATE;
            var BATCH_NO;
            var SUPPLIED_NO;
            var DEFECTED_NO;
            var TRANSPORTER;
            var SD_DefectType;
            var SD_DefectType_ID;
            var DEFECT_TYPE_CODE;
            var REMARKS;
            var SIZE;
            var Flag = 0;
            var PRODUCT_CATEGORY_CODE = $("#PRODUCT_CATEGORY_CODE").val();

            if (ProdType != "SBU2") {
                if (ProdType == "SBU3" && PRODUCT_CATEGORY_CODE == "36") {
                    SD_id = $("#SD_id_SBU2").val();
                    SD_ProductDetails = $("#SD_ProductDetails_SBU2").val();

                    SD_ProductDetails_ID = $("#SD_ProductDetails_ID_SBU2").val();
                    PRODUCT_CODE = $("#PRODUCT_CODE").val();


                    INVOICE_NO = $("#INVOICE_NO").val();
                    INVOICE_DATE = $("#INVOICE_DATE").val();
                    BATCH_NO = $("#BATCH_NO").val();
                    SUPPLIED_NO = $("#SUPPLIED_NO").val();
                    DEFECTED_NO = $("#DEFECTED_NO").val();
                    TRANSPORTER = $("#TRANSPORTER").val();
                    SD_DefectType = $("#SD_DefectType_SBU2").val();

                    SD_DefectType_ID = $("#SD_DefectType_ID_SBU2").val();
                    DEFECT_TYPE_CODE = $("#DEFECT_TYPE_CODE").val();

                    REMARKS = $("#REMARKS").val();

                    SIZE = $("#SIZE").val();

                    //if (INVOICE_NO == "") {
                    //    Flag = Flag + 1;
                    //    $("#INVOICE_NO").css("border-color", "red");
                    //}
                    //else {
                    //    $("#INVOICE_NO").css("border-color", "#d2d6de");
                    //}

                    if (SD_ProductDetails == "") {
                        Flag = Flag + 1;
                        $("#SD_ProductDetails_SBU2").css("border-color", "red");
                    }
                    else {
                        $("#SD_ProductDetails_SBU2").css("border-color", "#d2d6de");
                    }

                    if (SUPPLIED_NO == "") {
                        Flag = Flag + 1;
                        $("#SUPPLIED_NO").css("border-color", "red");
                    }
                    else {
                        $("#SUPPLIED_NO").css("border-color", "#d2d6de");
                    }

                    if (DEFECTED_NO == "") {
                        Flag = Flag + 1;
                        $("#DEFECTED_NO").css("border-color", "red");
                    }
                    else {
                        $("#DEFECTED_NO").css("border-color", "#d2d6de");
                    }

                    if (SD_DefectType == "") {
                        Flag = Flag + 1;
                        $("#SD_DefectType_SBU2").css("border-color", "red");
                    }
                    else {
                        $("#SD_DefectType_SBU2").css("border-color", "#d2d6de");
                    }
                }
                else {
                    SD_id = $("#SD_id").val();
                    SD_ProductDetails = $("#SD_ProductDetails").val();

                    SD_ProductDetails_ID = $("#SD_ProductDetails_ID").val();
                    PRODUCT_CODE = $("#PRODUCT_CODE").val();


                    INVOICE_NO = $("#INVOICE_NO").val();
                    INVOICE_DATE = $("#INVOICE_DATE").val();
                    BATCH_NO = $("#BATCH_NO").val();
                    SUPPLIED_NO = $("#SUPPLIED_NO").val();
                    DEFECTED_NO = $("#DEFECTED_NO").val();
                    TRANSPORTER = $("#TRANSPORTER").val();
                    SD_DefectType = $("#SD_DefectType").val();

                    SD_DefectType_ID = $("#SD_DefectType_ID").val();
                    DEFECT_TYPE_CODE = $("#DEFECT_TYPE_CODE").val();

                    REMARKS = $("#REMARKS").val();

                    SIZE = $("#SIZE").val();

                    if (SD_ProductDetails == "") {
                        Flag = Flag + 1;
                        $("#SD_ProductDetails").css("border-color", "red");
                    }
                    else {
                        $("#SD_ProductDetails").css("border-color", "#d2d6de");
                    }

                    if (SUPPLIED_NO == "") {
                        Flag = Flag + 1;
                        $("#SUPPLIED_NO").css("border-color", "red");
                    }
                    else {
                        $("#SUPPLIED_NO").css("border-color", "#d2d6de");
                    }

                    if (DEFECTED_NO == "") {
                        Flag = Flag + 1;
                        $("#DEFECTED_NO").css("border-color", "red");
                    }
                    else {
                        $("#DEFECTED_NO").css("border-color", "#d2d6de");
                    }

                    if (SD_DefectType == "") {
                        Flag = Flag + 1;
                        $("#SD_DefectType").css("border-color", "red");
                    }
                    else {
                        $("#SD_DefectType").css("border-color", "#d2d6de");
                    }
                }
            }
            else {
                SD_id = $("#SD_id_SBU2").val();
                SD_ProductDetails = $("#SD_ProductDetails_SBU2").val();

                SD_ProductDetails_ID = $("#SD_ProductDetails_ID_SBU2").val();
                PRODUCT_CODE = $("#PRODUCT_CODE").val();


                INVOICE_NO = $("#INVOICE_NO").val();
                INVOICE_DATE = $("#INVOICE_DATE").val();
                BATCH_NO = $("#BATCH_NO").val();
                SUPPLIED_NO = $("#SUPPLIED_NO").val();
                DEFECTED_NO = $("#DEFECTED_NO").val();
                TRANSPORTER = $("#TRANSPORTER").val();
                SD_DefectType = $("#SD_DefectType_SBU2").val();

                SD_DefectType_ID = $("#SD_DefectType_ID_SBU2").val();
                DEFECT_TYPE_CODE = $("#DEFECT_TYPE_CODE").val();

                REMARKS = $("#REMARKS").val();

                SIZE = $("#SIZE").val();

                //if (INVOICE_NO == "") {
                //    Flag = Flag + 1;
                //    $("#INVOICE_NO").css("border-color", "red");
                //}
                //else {
                //    $("#INVOICE_NO").css("border-color", "#d2d6de");
                //}

                if (SD_ProductDetails == "") {
                    Flag = Flag + 1;
                    $("#SD_ProductDetails_SBU2").css("border-color", "red");
                }
                else {
                    $("#SD_ProductDetails_SBU2").css("border-color", "#d2d6de");
                }

                if (SUPPLIED_NO == "") {
                    Flag = Flag + 1;
                    $("#SUPPLIED_NO").css("border-color", "red");
                }
                else {
                    $("#SUPPLIED_NO").css("border-color", "#d2d6de");
                }

                if (DEFECTED_NO == "") {
                    Flag = Flag + 1;
                    $("#DEFECTED_NO").css("border-color", "red");
                }
                else {
                    $("#DEFECTED_NO").css("border-color", "#d2d6de");
                }

                if (SD_DefectType == "") {
                    Flag = Flag + 1;
                    $("#SD_DefectType_SBU2").css("border-color", "red");
                }
                else {
                    $("#SD_DefectType_SBU2").css("border-color", "#d2d6de");
                }
            }

            if (ProdType == "SBU3" && PRODUCT_CATEGORY_CODE != "36") {
                //if (INVOICE_NO == "") {
                //    Flag = Flag + 1;
                //    $("#INVOICE_NO").css("border-color", "red");
                //}
                //else {
                //    $("#INVOICE_NO").css("border-color", "#d2d6de");
                //}


                if (INVOICE_DATE == "") {
                    Flag = Flag + 1;
                    $("#INVOICE_DATE").css("border-color", "red");
                }
                else {
                    $("#INVOICE_DATE").css("border-color", "#d2d6de");
                }

            }


            if (Flag > 0) {
                return;
            }
            else {

                if (INVOICE_NO == "") {
                }
                else if (INVOICE_NO.length == 10) {
                }
                else {
                    alert("Invalid Invoice Number");
                    return
                }


                var TRCode = "";

                TRCode = TRCode + "<td>" + SD_ProductDetails + "</td>";
                TRCode = TRCode + "<td>" + INVOICE_NO + "</td>";
                TRCode = TRCode + "<td>" + INVOICE_DATE + "</td>";

                TRCode = TRCode + "<td>" + BATCH_NO + "</td>";
                TRCode = TRCode + "<td>" + SUPPLIED_NO + "</td>";
                TRCode = TRCode + "<td>" + DEFECTED_NO + "</td>";

                TRCode = TRCode + "<td>" + TRANSPORTER + "</td>";
                TRCode = TRCode + "<td>" + SD_DefectType + "</td>";
                TRCode = TRCode + "<td>" + REMARKS + "</td>";


                TRCode = TRCode + "<td style='display:none'>" + SD_ProductDetails_ID + "</td>";
                TRCode = TRCode + "<td style='display:none'>" + PRODUCT_CODE + "</td>";

                TRCode = TRCode + "<td style='display:none'>" + SD_DefectType_ID + "</td>";
                TRCode = TRCode + "<td style='display:none'>" + DEFECT_TYPE_CODE + "</td>";

                TRCode = TRCode + "<td style='display:none'>" + SIZE + "</td>";


                if (SD_id == "") {
                    SD_id = $("#Supply_Details_Table tbody tr").length + 1;

                    TRCode = "<tr class='MousePointer' id='SD_" + SD_id + "' onclick='EditSD(this.id)'><td>" + SD_id + "</td>" + TRCode + "</tr>";
                    $("#Supply_Details_Table tbody").append(TRCode);
                }
                else {
                    $("#Supply_Details_Table tbody #SD_" + SD_id + " td")[0].innerHTML = SD_id;
                    $("#Supply_Details_Table tbody #SD_" + SD_id + " td")[1].innerHTML = SD_ProductDetails;
                    $("#Supply_Details_Table tbody #SD_" + SD_id + " td")[2].innerHTML = INVOICE_NO;
                    $("#Supply_Details_Table tbody #SD_" + SD_id + " td")[3].innerHTML = INVOICE_DATE;

                    $("#Supply_Details_Table tbody #SD_" + SD_id + " td")[4].innerHTML = BATCH_NO;
                    $("#Supply_Details_Table tbody #SD_" + SD_id + " td")[5].innerHTML = SUPPLIED_NO;
                    $("#Supply_Details_Table tbody #SD_" + SD_id + " td")[6].innerHTML = DEFECTED_NO;
                    $("#Supply_Details_Table tbody #SD_" + SD_id + " td")[7].innerHTML = TRANSPORTER;

                    $("#Supply_Details_Table tbody #SD_" + SD_id + " td")[8].innerHTML = SD_DefectType;
                    $("#Supply_Details_Table tbody #SD_" + SD_id + " td")[9].innerHTML = REMARKS;

                    $("#Supply_Details_Table tbody #SD_" + SD_id + " td")[10].innerHTML = SD_ProductDetails_ID;
                    $("#Supply_Details_Table tbody #SD_" + SD_id + " td")[11].innerHTML = PRODUCT_CODE;

                    $("#Supply_Details_Table tbody #SD_" + SD_id + " td")[12].innerHTML = SD_DefectType_ID;
                    $("#Supply_Details_Table tbody #SD_" + SD_id + " td")[13].innerHTML = DEFECT_TYPE_CODE;

                    $("#Supply_Details_Table tbody #SD_" + SD_id + " td")[14].innerHTML = SIZE;

                }


                $("#SD_id").val("");
                $("#SD_ProductDetails").val("");
                $("#INVOICE_NO").val("");
                $("#INVOICE_DATE").val("");
                $("#BATCH_NO").val("");
                $("#SUPPLIED_NO").val("");
                $("#DEFECTED_NO").val("");
                $("#TRANSPORTER").val("");
                $("#SD_DefectType").val("");
                $("#REMARKS").val("");

                $("#SD_ProductDetails_ID").val("");
                $("#PRODUCT_CODE").val("");

                $("#SD_DefectType_ID").val("");
                $("#DEFECT_TYPE_CODE").val("");

                $("#SIZE").val("");

                $("#SD_id_SBU2").val("");
                $("#SD_ProductDetails_SBU2").val("");
                $("#INVOICE_NO").val("");
                $("#INVOICE_DATE").val("");
                $("#BATCH_NO").val("");
                $("#SUPPLIED_NO").val("");
                $("#DEFECTED_NO").val("");
                $("#TRANSPORTER").val("");
                $("#SD_DefectType_SBU2").val("");
                $("#REMARKS").val("");

                $("#SD_ProductDetails_ID_SBU2").val("");
                $("#PRODUCT_CODE").val("");

                $("#SD_DefectType_ID_SBU2").val("");
                $("#DEFECT_TYPE_CODE").val("");

                $("#SIZE").val("");

                $("#SupplyDetailModal").modal("hide");
                SaveDataToServer('CMS_RC_Supply_Details_STO');
            }
            //OpenSupDetModel();
        }
        catch (e) {
            alert("Error : SaveSDData :" + e);
        }
    }


    function EditSD(RowId) {
        try {

            var COMPLAINT_STATUS = $("#COMPLAINT_STATUS").val();
            var ProdType = $("#PRODUCT_TYPE_NAME").val();
            var UserType_STO = $("#UserType_ID_STO").val();
            var PRODUCT_CATEGORY_CODE = $("#PRODUCT_CATEGORY_CODE").val();
            if (UserType_STO == "CSM" || UserType_STO == "QH" || UserType_STO == "CSM_BU2" || UserType_STO == "CSM_BU3") {

            }
            else if (COMPLAINT_STATUS == "Waiting for approval" || COMPLAINT_STATUS == "Complaint Registered" || COMPLAINT_STATUS == "DRAFT") {
            }
            else {
                return;
            }
            if (ProdType != "SBU2") {
                if (ProdType == "SBU3" && PRODUCT_CATEGORY_CODE == "36") {
                    $("#SD_id_SBU2").val($("#Supply_Details_Table tbody #" + RowId + " td")[0].innerHTML);
                    $("#SD_ProductDetails_SBU2").val($("#Supply_Details_Table tbody #" + RowId + " td")[1].innerHTML);
                    $("#INVOICE_NO").val($("#Supply_Details_Table tbody #" + RowId + " td")[2].innerHTML);
                    $("#INVOICE_DATE").val($("#Supply_Details_Table tbody #" + RowId + " td")[3].innerHTML);
                    $("#BATCH_NO").val($("#Supply_Details_Table tbody #" + RowId + " td")[4].innerHTML);
                    $("#SUPPLIED_NO").val($("#Supply_Details_Table tbody #" + RowId + " td")[5].innerHTML);
                    $("#DEFECTED_NO").val($("#Supply_Details_Table tbody #" + RowId + " td")[6].innerHTML);
                    $("#TRANSPORTER").val($("#Supply_Details_Table tbody #" + RowId + " td")[7].innerHTML);
                    $("#SD_DefectType_SBU2").val($("#Supply_Details_Table tbody #" + RowId + " td")[8].innerHTML);
                    $("#REMARKS").val($("#Supply_Details_Table tbody #" + RowId + " td")[9].innerHTML);

                    $("#SD_ProductDetails_ID_SBU2").val($("#Supply_Details_Table tbody #" + RowId + " td")[10].innerHTML);
                    $("#PRODUCT_CODE").val($("#Supply_Details_Table tbody #" + RowId + " td")[11].innerHTML);

                    $("#SD_DefectType_ID_SBU2").val($("#Supply_Details_Table tbody #" + RowId + " td")[12].innerHTML);
                    $("#DEFECT_TYPE_CODE").val($("#Supply_Details_Table tbody #" + RowId + " td")[13].innerHTML);

                    $("#SIZE").val($("#Supply_Details_Table tbody #" + RowId + " td")[14].innerHTML);


                    $("#SD_Delete_SBU2").show();
                    $("#SD_Save_SBU2").text("Update");
                }
                else {
                    $("#SD_id").val($("#Supply_Details_Table tbody #" + RowId + " td")[0].innerHTML);
                    $("#SD_ProductDetails").val($("#Supply_Details_Table tbody #" + RowId + " td")[1].innerHTML);
                    $("#INVOICE_NO").val($("#Supply_Details_Table tbody #" + RowId + " td")[2].innerHTML);
                    $("#INVOICE_DATE").val($("#Supply_Details_Table tbody #" + RowId + " td")[3].innerHTML);
                    $("#BATCH_NO").val($("#Supply_Details_Table tbody #" + RowId + " td")[4].innerHTML);
                    $("#SUPPLIED_NO").val($("#Supply_Details_Table tbody #" + RowId + " td")[5].innerHTML);
                    $("#DEFECTED_NO").val($("#Supply_Details_Table tbody #" + RowId + " td")[6].innerHTML);
                    $("#TRANSPORTER").val($("#Supply_Details_Table tbody #" + RowId + " td")[7].innerHTML);
                    $("#SD_DefectType").val($("#Supply_Details_Table tbody #" + RowId + " td")[8].innerHTML);
                    $("#REMARKS").val($("#Supply_Details_Table tbody #" + RowId + " td")[9].innerHTML);

                    $("#SD_ProductDetails_ID").val($("#Supply_Details_Table tbody #" + RowId + " td")[10].innerHTML);
                    $("#PRODUCT_CODE").val($("#Supply_Details_Table tbody #" + RowId + " td")[11].innerHTML);

                    $("#SD_DefectType_ID").val($("#Supply_Details_Table tbody #" + RowId + " td")[12].innerHTML);
                    $("#DEFECT_TYPE_CODE").val($("#Supply_Details_Table tbody #" + RowId + " td")[13].innerHTML);

                    $("#SIZE").val($("#Supply_Details_Table tbody #" + RowId + " td")[14].innerHTML);


                    $("#SupplyDetailModal").modal('show');
                    $("#SD_Delete").show();
                    $("#SD_Save").text("Update");
                }
            } else {
                $("#SD_id_SBU2").val($("#Supply_Details_Table tbody #" + RowId + " td")[0].innerHTML);
                $("#SD_ProductDetails_SBU2").val($("#Supply_Details_Table tbody #" + RowId + " td")[1].innerHTML);
                $("#INVOICE_NO").val($("#Supply_Details_Table tbody #" + RowId + " td")[2].innerHTML);
                $("#INVOICE_DATE").val($("#Supply_Details_Table tbody #" + RowId + " td")[3].innerHTML);
                $("#BATCH_NO").val($("#Supply_Details_Table tbody #" + RowId + " td")[4].innerHTML);
                $("#SUPPLIED_NO").val($("#Supply_Details_Table tbody #" + RowId + " td")[5].innerHTML);
                $("#DEFECTED_NO").val($("#Supply_Details_Table tbody #" + RowId + " td")[6].innerHTML);
                $("#TRANSPORTER").val($("#Supply_Details_Table tbody #" + RowId + " td")[7].innerHTML);
                $("#SD_DefectType_SBU2").val($("#Supply_Details_Table tbody #" + RowId + " td")[8].innerHTML);
                $("#REMARKS").val($("#Supply_Details_Table tbody #" + RowId + " td")[9].innerHTML);

                $("#SD_ProductDetails_ID_SBU2").val($("#Supply_Details_Table tbody #" + RowId + " td")[10].innerHTML);
                $("#PRODUCT_CODE").val($("#Supply_Details_Table tbody #" + RowId + " td")[11].innerHTML);

                $("#SD_DefectType_ID_SBU2").val($("#Supply_Details_Table tbody #" + RowId + " td")[12].innerHTML);
                $("#DEFECT_TYPE_CODE").val($("#Supply_Details_Table tbody #" + RowId + " td")[13].innerHTML);

                $("#SIZE").val($("#Supply_Details_Table tbody #" + RowId + " td")[14].innerHTML);


                $("#SD_Delete_SBU2").show();
                $("#SD_Save_SBU2").text("Update");
            }
            //SaveDataToServer('CMS_RC_Supply_Details_STO');
        }
        catch (e) {
            alert("Error : EditSD : " + e);
        }

    }


    function DeleteSD() {
        try {
            var ProdType = $("#PRODUCT_TYPE_NAME").val();
            var PRODUCT_CATEGORY_CODE = $("#PRODUCT_CATEGORY_CODE").val();
            var SD_id;
            if (ProdType != "SBU2") {
                if (ProdType == "SBU3" && PRODUCT_CATEGORY_CODE == "36") {
                    SD_id = $("#SD_id_SBU2").val();

                    $("#Supply_Details_Table tbody #SD_" + SD_id + "").remove();

                    $("#SD_id_SBU2").val("");
                    $("#SD_ProductDetails_SBU2").val("");
                    $("#INVOICE_NO").val("");
                    $("#INVOICE_DATE").val("");
                    $("#BATCH_NO").val("");
                    $("#SUPPLIED_NO").val("");
                    $("#DEFECTED_NO").val("");
                    $("#TRANSPORTER").val("");
                    $("#SD_DefectType_SBU2").val("");
                    $("#REMARKS").val("");

                    $("#SD_ProductDetails_ID_SBU2").val("");
                    $("#PRODUCT_CODE").val("");

                    $("#SD_DefectType_ID_SBU2").val("");
                    $("#DEFECT_TYPE_CODE").val("");

                    $("#SIZE").val("");


                    var i = 1;

                    $("#Supply_Details_Table tbody tr").each(function () {
                        $(this).attr("id", "SD_" + i);
                        $("#Supply_Details_Table tbody #SD_" + i + " td")[0].innerHTML = i;
                        i = i + 1;
                    });
                }
                else {
                    SD_id = $("#SD_id").val();

                    $("#Supply_Details_Table tbody #SD_" + SD_id + "").remove();

                    $("#SD_id").val("");
                    $("#SD_ProductDetails").val("");
                    $("#INVOICE_NO").val("");
                    $("#INVOICE_DATE").val("");
                    $("#BATCH_NO").val("");
                    $("#SUPPLIED_NO").val("");
                    $("#DEFECTED_NO").val("");
                    $("#TRANSPORTER").val("");
                    $("#SD_DefectType").val("");
                    $("#REMARKS").val("");

                    $("#SD_ProductDetails_ID").val("");
                    $("#PRODUCT_CODE").val("");

                    $("#SD_DefectType_ID").val("");
                    $("#DEFECT_TYPE_CODE").val("");

                    $("#SIZE").val("");

                    $("#SupplyDetailModal").modal("hide");

                    var i = 1;

                    $("#Supply_Details_Table tbody tr").each(function () {
                        $(this).attr("id", "SD_" + i);
                        $("#Supply_Details_Table tbody #SD_" + i + " td")[0].innerHTML = i;
                        i = i + 1;
                    });
                }
            } else {
                SD_id = $("#SD_id_SBU2").val();

                $("#Supply_Details_Table tbody #SD_" + SD_id + "").remove();

                $("#SD_id_SBU2").val("");
                $("#SD_ProductDetails_SBU2").val("");
                $("#INVOICE_NO").val("");
                $("#INVOICE_DATE").val("");
                $("#BATCH_NO").val("");
                $("#SUPPLIED_NO").val("");
                $("#DEFECTED_NO").val("");
                $("#TRANSPORTER").val("");
                $("#SD_DefectType_SBU2").val("");
                $("#REMARKS").val("");

                $("#SD_ProductDetails_ID_SBU2").val("");
                $("#PRODUCT_CODE").val("");

                $("#SD_DefectType_ID_SBU2").val("");
                $("#DEFECT_TYPE_CODE").val("");

                $("#SIZE").val("");


                var i = 1;

                $("#Supply_Details_Table tbody tr").each(function () {
                    $(this).attr("id", "SD_" + i);
                    $("#Supply_Details_Table tbody #SD_" + i + " td")[0].innerHTML = i;
                    i = i + 1;
                });
            }
            $("#SupplyDetailModal").modal("hide");
            SaveDataToServer('CMS_RC_Supply_Details_STO');
        }
        catch (e) {
            alert("Error : DeleteSD : " + e);
        }

    }


    /*      SupplyDetailsModel          */



    //Common function for differentiating the form for different product types
    function ProductTypeChanges(PRODUCT_TYPE_NAME) {
        try {

            if (PRODUCT_TYPE_NAME == "") {
                $("#SupplyDetailsDiv").hide();
                $("#ComplaintDetailedDescDiv").hide();


                $("#COMPLAINT_TYPE_NAME").val("");
                $("#COMPLAINT_TYPE_CODE").val("");

                $(".SBU3Mandatory").hide();

            }
            else if (PRODUCT_TYPE_NAME == "SBU3") {

                $("#SupplyDetailsDiv").show();
                $("#ComplaintDetailedDescDiv").show();

                $("#MaterialSupplyDetailsTab").css('display', 'block');
                $("#Priortize_ClassifyTab").css('display', 'block');

                //$("#SubStockistDirectCustomer_Lbl").text("Distributor/ Wholesaler/ Dealer/ Project");

                $("#CompCatMandSpan").show();

                //$(".BreakageQtyLabel").text("Defect Qty (Nos)");

                $("#COMPLAINT_TYPE_CODE").val("CTC1");
                $("#COMPLAINT_TYPE_NAME").val("Product Complaints");
                $(".SBU3Mandatory").show();

            }
        }
        catch (e) {
            alert("Error : ProductTypeChanges :" + e);
        }
    }


    //Draft Save function
    function SaveDataToServer(TableName) {
        var Flag = 0;
        try {            
            if (Flag > 0) {
                return;
            }
            else {
                var CMS_RC_Material_Supply_Details_STO = new Array();
                var CMS_RC_Supply_Details_STO = new Array();

                CMS_RC_Material_Supply_Details_STO = new Array();

                $("#Material_Supply_Details_Table tbody tr").each(function () {
                    RowId = ($(this).attr("id"));
                    CMS_RC_Material_Supply_Details_STO.push({
                        SlNo: $("#Material_Supply_Details_Table tbody #" + RowId + " td")[0].innerHTML,
                        MaterialBelongsTo: $("#Material_Supply_Details_Table tbody #" + RowId + " td")[1].innerHTML,
                        ProductSuppliedFrom: $("#Material_Supply_Details_Table tbody #" + RowId + " td")[2].innerHTML,
                        Name: $("#Material_Supply_Details_Table tbody #" + RowId + " td")[3].innerHTML,
                        Material_Belongs_To_ID: $("#Material_Supply_Details_Table tbody #" + RowId + " td")[4].innerHTML,
                        PLANT_CODE: $("#Material_Supply_Details_Table tbody #" + RowId + " td")[5].innerHTML,
                        Product_Supplied_From_ID: $("#Material_Supply_Details_Table tbody #" + RowId + " td")[6].innerHTML,
                        SUPPLIER_TYPE_CODE: $("#Material_Supply_Details_Table tbody #" + RowId + " td")[7].innerHTML,
                        MSD_Name_ID: $("#Material_Supply_Details_Table tbody #" + RowId + " td")[8].innerHTML,
                        SUPPLIER_CODE: $("#Material_Supply_Details_Table tbody #" + RowId + " td")[9].innerHTML

                    });
                });

                CMS_RC_Supply_Details_STO = new Array();

                $("#Supply_Details_Table tbody tr").each(function () {
                    RowId = ($(this).attr("id"));
                    CMS_RC_Supply_Details_STO.push({
                        SlNo: $("#Supply_Details_Table tbody #" + RowId + " td")[0].innerHTML,
                        ProductDetails: $("#Supply_Details_Table tbody #" + RowId + " td")[1].innerHTML,
                        INVOICE_NO: $("#Supply_Details_Table tbody #" + RowId + " td")[2].innerHTML,
                        INVOICE_DATE: DateToWestern($("#Supply_Details_Table tbody #" + RowId + " td")[3].innerHTML),
                        BATCH_NO: $("#Supply_Details_Table tbody #" + RowId + " td")[4].innerHTML,
                        SUPPLIED_NO: $("#Supply_Details_Table tbody #" + RowId + " td")[5].innerHTML,
                        DEFECTED_NO: $("#Supply_Details_Table tbody #" + RowId + " td")[6].innerHTML,
                        TRANSPORTER: $("#Supply_Details_Table tbody #" + RowId + " td")[7].innerHTML,
                        Defect_Type: $("#Supply_Details_Table tbody #" + RowId + " td")[8].innerHTML,
                        REMARKS: $("#Supply_Details_Table tbody #" + RowId + " td")[9].innerHTML,
                        SD_ProductDetails_ID: $("#Supply_Details_Table tbody #" + RowId + " td")[10].innerHTML,
                        PRODUCT_CODE: $("#Supply_Details_Table tbody #" + RowId + " td")[11].innerHTML,
                        SD_DefectType_ID: $("#Supply_Details_Table tbody #" + RowId + " td")[12].innerHTML,
                        DEFECT_TYPE_CODE: $("#Supply_Details_Table tbody #" + RowId + " td")[13].innerHTML,
                        SIZE: $("#Supply_Details_Table tbody #" + RowId + " td")[14].innerHTML
                    });
                });


                var RegistrationData = JSON.stringify({
                    FormIdentity_STO: $("#FormIdentity_STO").val(),

                    FROM_PLANT_CODE: $("#FROM_PLANT_CODE").val(),
                    COMPLAINT_RECEIVED_DATE: $("#COMPLAINT_RECEIVED_DATE").val(),
                    COMPLAINT_REGISTRATION_DATE: $("#COMPLAINT_REGISTRATION_DATE").val(),
                    COMPLAINT_TRACKING_NO: $("#COMPLAINT_TRACKING_NO").val(),
                    REGISTRANT_TYPE_NAME: $("#REGISTRANT_TYPE_NAME").val(),
                    REGISTRANT_TYPE_CODE: $("#REGISTRANT_TYPE_CODE").val(),
                    DOC_SERIES_CODE: $("#DOC_SERIES_CODE").val(),
                    PRODUCT_TYPE_CODE: $("#PRODUCT_TYPE_CODE").val(),
                    PRODUCT_TYPE_NAME: $("#PRODUCT_TYPE_NAME").val(),
                    COMPLAINT_STATUS: $("#COMPLAINT_STATUS").val(),
                    PLANT_MHD_CODE: $("#PLANT_MHD_CODE").val(),
                    PLANT_MHD_NAME: $("#PLANT_MHD_NAME").val(),
                    COMPLAINT_CODE: $("#COMPLAINT_CODE").val(),
                    APPROVED_DATE: $("#APPROVED_DATE").val(),
                    COMPLAINT_DESC: $("#COMPLAINT_DESC").val(),
                    REMARKS: $("#REMARKS").val(),
                    FilesPath: $("#SelectedFiles").text(),

                    TO_PLANT_CODE: $("#TO_PLANT_CODE").val(),
                    TO_PLANT_NAME: $("#TO_PLANT_NAME").val(),
                    END_CUSTOMER_DETAILS: $("#END_CUSTOMER_DETAILS").val(),
                    SITE_ADDRESS: $("#SITE_ADDRESS").val(),
                    COMPLAINT_MODE_NAME: $("#COMPLAINT_MODE_NAME").val(),
                    COMPLAINT_MODE_CODE: $("#COMPLAINT_MODE_CODE").val(),
                    PRODUCT_CATEGORY_NAME: $("#PRODUCT_CATEGORY_NAME").val(),
                    PRODUCT_CATEGORY_CODE: $("#PRODUCT_CATEGORY_CODE").val(),

                    COMPLAINT_TYPE_NAME: $("#COMPLAINT_TYPE_NAME").val(),
                    COMPLAINT_TYPE_CODE: $("#COMPLAINT_TYPE_CODE").val(),
                    COMPLAINT_PRIORITY_NAME: $("#COMPLAINT_PRIORITY_NAME").val(),
                    COMPLAINT_PRIORITY_CODE: $("#COMPLAINT_PRIORITY_CODE").val(),
                    COMPLAINT_CATEGORY_NAME: $("#COMPLAINT_CATEGORY_NAME").val(),
                    COMPLAINT_CATEGORY_CODE: $("#COMPLAINT_CATEGORY_CODE").val(),
                    COMPLAINT_SEVERITY_NAME: $("#COMPLAINT_SEVERITY_NAME").val(),
                    COMPLAINT_SEVERITY_CODE: $("#COMPLAINT_SEVERITY_CODE").val(),

                    NATURE_OF_COMPLAINT: $("#NATURE_OF_COMPLAINT").val(),

                    SITEDETAIL_CODE_STO: $("#SITEDETAIL_CODE_STO").val(),
                    COMPANYDETAIL_CODE_STO: $("#COMPANYDETAIL_CODE_STO").val(),
                    CREATED_BY: $("#UserCode_STO").val(),
                    CMS_RC_Material_Supply_Details_STO: CMS_RC_Material_Supply_Details_STO,
                    CMS_RC_Supply_Details_STO: CMS_RC_Supply_Details_STO
                });
                console.log('RegistrationData', RegistrationData, JSON.parse(RegistrationData))
                $.ajax({
                    method: 'POST',
                    url: '../../ComplaintRegistrationSTO/SaveComplaint',
                    async: false,
                    data: { RegistrationData: RegistrationData },
                }).then(function successCallback(response) {
                    //alert(response);
                    if (response == "FALSE") {
                        alert("Error Occured try later");
                        return;
                    }
                    if (response == "TRUE") {
                        //$(".Complaint_NumberDiv").css("display", "block");
                        alert("Successfully Saved the data");
                    }
                    else {
                        var RD = JSON.parse(response);
                        if (RD["Result"] == "TRUE") {

                            $("#SendRegistrationApproval").css('display', 'block');
                            $("#FormIdentity_STO").val(RD["ID"]);
                            $("#COMPLAINT_CODE").val(RD["CC"]);
                            //$(".Complaint_NumberDiv").css("display", "block");
                            $("#Complaint_Number").val(RD["ID"]);
                        }
                    }

                    if ($("#COMPLAINT_STATUS").val() == "DRAFT") {
                        $("#SendRegistrationApproval").css('display', 'block');
                    }
                    else {
                        $("#SendRegistrationApproval").css('display', 'none');
                    }

                }, function errorCallback(response) {
                    alert("Error : " + response);
                });
            }
        }
        catch (e) {
            //console('e', e);
            alert("Error : SaveDataToServer : " + e);
        }
    }

    function FileUploaded() {
        var filename = $("#ComplaintFile").val();
        var file = document.getElementById('ComplaintFile').files[0];
        var extension = filename.replace(/^.*\./, '');
        //if (extension.toUpperCase() == "XLSX" || extension.toUpperCase() == "XLS") {
        //}
        //else {
        //    alert("Invalid File");
        //    $("#ComplaintFile").val("");
        //}
        if (file.size > 5242880) {
            alert("File size must not exceed 5MB.");
            $("#ComplaintFile").val("");
        }
    }
    var AttachedFiles = new Array();
    function UploadFiles() {
        var filename = $("#ComplaintFile").val();
        var file = document.getElementById('ComplaintFile').files[0];
        if (filename == "") {
            return;
        }
        if (AttachedFiles != null && AttachedFiles.length > 0) {
            for (var i = 0; i < AttachedFiles.length; i++) {
                if (AttachedFiles[i].filename.includes(filename)) {
                    alert("File already selected");
                    $("#ComplaintFile").val("");
                    return;
                }
            }
        }
        if (AttachedFiles != null && AttachedFiles.length >= 3) {
            alert("Maximum 3 files can be selected");
            $("#ComplaintFile").val("");
            return;
        }
        if (filename.includes(",")) {
            alert("File name must not contain comma(,)");
            $("#ComplaintFile").val("");
            return;
        }
        AttachedFiles.push({
            file: file,
            filename: filename
        });
        $("#ComplaintFile").val("");
        var splitFilename = filename.split("\\");
        $('#SelectedFiles').append("" + splitFilename[2].trim() + "<br/>");
        $("#ClickUploadFile").val(1);
        RegisterComplaintWithFiles_STO();
    }
    function ClearFiles() {
        AttachedFiles = new Array();
        $('#SelectedFiles').text('');
    }
    function RegisterComplaintWithFiles_STO() {
        try {
            var MyTest = $("#MyTest").val();
            if (MyTest == "") {
                if (confirm("Do you want to Save data?")) {
                    $("#MyTest").val("Save");
                }
                else {
                    return;
                }
            }
            if ($("#SelectedFiles").text() != "") {
                $("#ClickUploadFile").val(1);
                $("#ClickSaveComplaint").val(1);
            }
            //$("#PRODUCT_TYPE_NAME").val() == "SBU1" &&
            //var file = document.getElementById('ComplaintFile').files.length;
            //if ($("#PRODUCT_TYPE_NAME").val() == "SBU3" && file == 0 && ($("#ComplaintFilesUploaded").children().length <= 0 || $("#SelectedFiles").text() == "") && $("#ClickUploadFile").val() == 0) {
            //    alert("Please Select Attachment and Press Upload and then click on Save button");
            //    return;
            //}
            //if ($("#PRODUCT_TYPE_NAME").val() == "SBU3" && file >= 0 && $("#ClickUploadFile").val() == 0) {
            //    alert("Please Upload Attachment and then click on Save button");
            //    return;
            //}
            var formData = new FormData();
            for (var i = 0; i < AttachedFiles.length; i++) {
                formData.append('RegisterFile_' + i, AttachedFiles[i].file);
            }
            if (AttachedFiles.length > 0) {
                ShowLoader();
                $.ajax({
                    url: '../../ComplaintRegistrationSTO/UploadFile',
                    type: 'POST',
                    data: formData,
                    async: true,
                    success: function (Resp) {
                        if (Resp != "") {
                            AttachedFiles = new Array();
                            $('#SelectedFiles').text('');
                            $("#ComplaintFile").val("");
                            $('#SelectedFiles').text(Resp);
                            HideFileUpload();
                            HideLoader();
                            if ($("#PRODUCT_TYPE_NAME").val() == "SBU3") {
                                $("#ClickSaveComplaint").val(1);
                            }
                            $('#hiddenCompRegSave').click();
                        }
                        else {
                            HideLoader();
                            $("#ComplaintFile").val("");
                        }
                    },
                    cache: false,
                    contentType: false,
                    processData: false
                });
            }
            else {
                $('#hiddenCompRegSave').click();
            }
        }
        catch (e) {
            alert("Error : SaveDataToServer : " + e);
        }
    }

    function enabledisableFileUpload() {
        if ($("#FormIdentity_STO").val() != "") {
            if (($("#COMPLAINT_STATUS").val() == "DRAFT") && ($("#SelectedFiles").text() == ""))
                ShowFileUpload();
            else
                HideFileUpload();
        } else {
            ShowFileUpload();
        }
    }
    function HideFileUpload() {
        $("#NewComplaintFileUploadDiv").hide();
        $("#LoadComplaintFileUploadDiv").show();
        if ($("#SelectedFiles").text() != "") {
            $("#lblAttachments").show();
            var Paths = $("#SelectedFiles").text().split(',');
            var mydiv = document.getElementById("LoadComplaintFileUploadDiv");
            $("#ComplaintFilesUploaded").empty();
            for (var i = 0; i < Paths.length; i++) {
                var myList = document.getElementById("ComplaintFilesUploaded");
                var liTag = document.createElement('li');
                var aTag = document.createElement('a');
                aTag.setAttribute('href', window.location.origin + '/DIMSFiles/ComplaintFiles/' + Paths[i]);
                aTag.setAttribute('target', "_blank");
                aTag.innerHTML = Paths[i].substring(0, 30);
                liTag.appendChild(aTag);
                myList.appendChild(liTag);
                mydiv.appendChild(myList);
            }
        }
        else {
            $("#lblAttachments").hide();
        }
    }
    function ShowFileUpload() {
        $("#LoadComplaintFileUploadDiv").hide();
        $("#NewComplaintFileUploadDiv").show();
    }
    function ValidateInvoice() {
        var INVOICE_NO = $("#INVOICE_NO").val();
        if (INVOICE_NO.trim() == "") {
            $("#INVOICE_NO").val('');
            $("#SD_ProductDetails_SBU2").val("");
            $("#SD_ProductDetails_ID_SBU2").val("");
            $("#PRODUCT_CODE").val("");
            $("#SIZE").val("");
            $("#INVOICE_DATE").val("");
            alert("Enter Valid Invoice Number");
            return false;
        } else {
            $.ajax({
                type: 'POST',
                data: { Data: INVOICE_NO },
                url: '../../ComplaintRegistrationSTO/GetInvoiceValidation',
                success: function (response) {
                    if (response["complaintNo"] != "FALSE") {
                        alert("Invoice Already Registered With Complaint Number : " + response["complaintNo"]);
                        $("#INVOICE_NO").val('');
                        //$("#INVOICE_NO").focus();
                        return false;
                    } else {
                        $("#SD_ProductDetails_SBU2").val("");
                        $("#SD_ProductDetails_ID_SBU2").val("");
                        $("#PRODUCT_CODE").val("");
                        $("#SIZE").val("");
                        $("#INVOICE_DATE").val("");
                    }
                },
                error: function (data) {
                    alert("Error Saving Data.");
                }
            });
        }
    }

</script>
