
var MasterScope;
var MasterName;
var txtUserRoleCnt;
var txtUserNameCnt;
var DocSeriesName;
var DocDate_CreditNote = "";

DIMS.factory('DIMSSAPFactory', function ($http) {
    return {
        GetOrgLevelList: function () { //Get Org Level for Employee Role Config
            return $http.get('../../SAP/GetOrgLevelList');
        },
        GetEmployeeList: function () { //For Employee Role Config
            return $http.get('../../SAP/GetEmployeeList');
        },
        GetCustomerList: function () { //For Customer Config
            return $http.get('../../SAP/GetCustomerList');
        },
        GetFSOList: function () { //For FSO Config
            return $http.get('../../SAP/GetFSOList');
        },
        getMasterData: function (masterType) {
            return $http({ url: '../../SAP/GetEmployeewreList', method: 'POST', data: { MasterType: masterType } });
        },
        GetZoneDropdownEmpRole: function () {//for GetZoneDropdownEmpRole
            return $http.get('../../SAP/GetZoneDropdownEmpRole');
        },
        GetStateDropdownEmpRole: function () {//for GetStateDropdownEmpRole
            return $http.get('../../SAP/GetStateDropdownEmpRole');
        },
        GetRoleDropdownEmpRole: function () {//for GetStateDropdownEmpRole
            return $http.get('../../SAP/GetRoleDropdownEmpRole');
        },
        SaveEmpRoleConfigData: function (TotalEmpRoleConfigData) {
            return $http({ url: '../../SAP/SaveEmpRoleConfigData', method: 'POST', data: { RoleData: TotalEmpRoleConfigData } });
        },
        SaveEmpCustomerConfigData: function (TotalEmpCustomerConfigData) {
            return $http({ url: '../../SAP/SaveEmpCustomerConfigData', method: 'POST', data: { CustomerData: TotalEmpCustomerConfigData } });
        },
        SendEmailInvoice: function () {
            return $http.get('../../SAP/Invoice_List_View_Data');
        },
        GetCreditNoteDetails: function (Data) {
            return $http({ url: '../../SAP/GetCreditNoteDetails', method: 'POST', data: { Data: Data } });
        },
        GetCustomerDetails: function (EditId) {
            return $http({ url: '../../SAP/GetCustomerDetails', method: 'POST', data: { Data: EditId } });
        },
        GetYearNamesFor: function () {
            return $http.get('../../SAP/GetYearNamesFor');
        },
        GetTDS_Certificate: function (Data) {
            return $http({ url: '../../SAP/TDS_Certificate', method: 'POST', data: { Data: Data } });
        },
        GetTotalSumCreditDebit: function (WhereClause) {
            ShowLoader();
            return $http({ url: '../../SAP/TotalCreditDebit', method: 'POST', data: { Data: WhereClause } });
        },
        GetTotalSumOutstanding: function (WhereClause) {
            return $http({ url: '../../SAP/TotalAmtOutStanding', method: 'POST', data: { Data: WhereClause } });
        },
        GetTotalAmtpaymentStockist: function (WhereClause) {
            return $http({ url: '../../SAP/TotalAmtpaymentStockist', method: 'POST', data: { Data: WhereClause } });
        },
        GetTotalAmtInvoice: function (WhereClause) {
            return $http({ url: '../../SAP/TotalAmtInvoice', method: 'POST', data: { Data: WhereClause } });
        }

    }
});
function addAllColumnHeadersForMasters(myList, TableName) {
    var columnSet = [];
    var html = "";
    html += '<thead><tr style="background-color: #d2401a; color: white; font-size: 13px;">';
    var headerTr$ = $('<tr/>');
    for (var i = 0 ; i < myList.length ; i++) {

        var rowHash = myList[i];
        for (var key in rowHash) {

            if ($.inArray(key, columnSet) == -1) {

                columnSet.push(key);
                // headerTr$.append($('<th/>').html(key));

                html += '<th>' + key + '</th>';

            }

        }
    }
    html += "<th>Edit</th>";
    html += "<th>Delete</th>";
    html += "</tr></thead>";
    $("#" + TableName).append(html);


    return columnSet;
}

function addAllColumnHeadersForAsgnCmpl(myList, TableName, USER_PRODUCT_TYPE_CODE) {
    var columnSet = [];
    var html = "";
    html += '<thead><tr style="background-color: #d2401a; color: white; font-size: 13px;">';
    var headerTr$ = $('<tr/>');
    //svprasadk 25-06-2020 SBU 1 requirement to bulk assign complaints start
    if (myList.length > 0) {
        html += '<th><input type="checkbox" id="AssignComplaintCheckAll" onchange="AssignComplaintCheckAllChange()" /></th>';
    } else {
        html += '<th></th>';
    }
    //svprasadk 26-06-2020 SBU 1 requirement to bulk assign complaints end
    //html += "<th></th>";
    //debugger;
    for (var i = 0 ; i < myList.length ; i++) {

        var rowHash = myList[i];
        for (var key in rowHash) {

            if ($.inArray(key, columnSet) == -1) {

                columnSet.push(key);
                // headerTr$.append($('<th/>').html(key));

                html += '<th>' + key + '</th>';

            }

        }
    }

    //svprasadk 18-06-2020 SBU 1 requirement to bulk assign complaints start
    if (USER_PRODUCT_TYPE_CODE != "SBU1") {
        html += "<th>User Role</th>";
        html += "<th>User Name</th>";
    }
    //svprasadk 18-06-2020 SBU 1 requirement to bulk assign complaints end

    html += "</tr></thead>";
    $("#" + TableName).append(html);


    return columnSet;
}

//svprasadk 25-06-2020 SBU 1 requirement to bulk assign complaints start
//Check All function in the Assign Complaint table
function AssignComplaintCheckAllChange() {
    //alert($("#AssignComplaintCheckAll").is(":checked"))
    try {
        if ($("#AssignComplaintCheckAll").is(":checked")) {
            $(".roles").each(function () {
                this.checked = true;
            })
        } else {
            $(".roles").each(function () {
                this.checked = false;
            })
        }
    }
    catch (e) {
        alert("Error UsersCheckAllChange: " + e);
    }
}
//svprasadk 25-06-2020 SBU 1 requirement to bulk assign complaints end

function addAllColumnHeadersForFormMaster(myList, TableName) {
    var columnSet = [];
    var html = "";
    html += '<thead><tr style="background-color: #d2401a; color: white; font-size: 13px;">';
    var headerTr$ = $('<tr/>');
    html += "<th></th>";
    for (var i = 0 ; i < myList.length ; i++) {

        var rowHash = myList[i];
        for (var key in rowHash) {

            if ($.inArray(key, columnSet) == -1) {

                columnSet.push(key);
                // headerTr$.append($('<th/>').html(key));

                html += '<th>' + key + '</th>';

            }

        }
    }
    html += "<th>View</th>";
    html += "<th>Create</th>";
    html += "<th>Update</th>";
    html += "<th>Approve</th>";
    html += "<th>Export To Excel</th>";
    html += "</tr></thead>";
    $("#" + TableName).append(html);


    return columnSet;
}

function getMasterLookUpData(response, PageHeading) {
    var data = JSON.parse(response.tabledata);
    var element = angular.element('#LookUpModal');
    element.modal('show');
    $("#PopHeading").text(PageHeading);
    if (data == "") {

        $("#MasterStatus").text("No Records found");
        //$("#PopUpTable").dataTable().fnDestroy();
        $('#PopUpTable').empty();
    } else {
        $("#MasterStatus").text("");

        $("#PopUpTable").dataTable().fnDestroy();
        $('#PopUpTable').empty();

        var columns = addAllColumnHeaders(data, "PopUpTable");
        for (var i = 0 ; i < data.length ; i++) {
            var row$ = $('<tr onclick="GetTableRowData(this)" style="cursor:pointer;" />');
            for (var colIndex = 0 ; colIndex < columns.length ; colIndex++) {
                var cellValue = data[i][columns[colIndex]];

                if (cellValue == null) { cellValue = ""; }
                row$.append($('<td/>').html(cellValue));
            }
            $("#PopUpTable").append(row$);
        }

        $("#PopUpTable tr td:nth-child(1)").hide();
        $("#PopUpTable tr th:nth-child(1)").hide();

        var table = $("#PopUpTable").dataTable({
            "bDestroy": true,
            'scroll': true
        });

        $('#PopUpTable tbody').on('click', 'tr', function () {
            if ($(this).hasClass('selected')) {
                $(this).removeClass('selected');
            }
            else {
                table.$('tr.selected').removeClass('selected');
                $(this).addClass('selected');
            }
        });
    }
}

function GetMasterResponse(Master_Name) {
    var scope = angular.element(document.getElementById("MainWrap")).scope();
    angular.injector(['ng', 'DIMSApp']).get("DIMSFactory").getMasterClickData(Master_Name).success(function (response) {
        alert(response);
        var data = JSON.parse(response.tabledata);
        $("#MasterTable").dataTable().fnDestroy();
        $('#MasterTable').empty();
        var columns = addAllColumnHeadersForMasters(data, "MasterTable");
        for (var i = 0 ; i < data.length ; i++) {
            var row$ = $('<tr />');
            for (var colIndex = 0 ; colIndex < columns.length ; colIndex++) {
                var cellValue = data[i][columns[colIndex]];

                if (cellValue == null) { cellValue = ""; }
                row$.append($('<td/>').html(cellValue));
            }

            //row$.append($("<td data-ng-click='EditMasterData_Model();'> <a style='background-color: #9760b3; border-color: #9760b3; padding: 6px 6px;' class='btn btn-info'><i class='fa fa-fw fa-pencil-square-o'></i>Edit</a> </td>"));

            row$.append($('<td onclick="EditMasterData(this)" />').html('<a style="background-color: #9760b3; border-color: #9760b3; padding: 6px 6px;" class="btn btn-info"><i class="fa fa-fw fa-pencil-square-o"></i>Edit</a>'));
            row$.append($('<td/>').html('<a class="btn btn-danger" style="background-color: #c71c22; border-color: #c71c22; padding: 6px 6px;" onclick="DeleteMasterData(' + Master_Name + ')" title="delete"><i class="fa fa-fw fa-trash-o"></i>Delete</a>'));
            // row$.append($('<td onclick="DeleteMasterData(this)"/>').html('<a class="btn btn-danger" style="background-color: #c71c22; border-color: #c71c22; padding: 6px 6px;"  title="delete"><i class="fa fa-fw fa-trash-o"></i>Delete</a>'));

            $("#MasterTable").append(row$);

            //var html = $compile(TableRow)($scope);

            //var el = angular.element($("#NoticeConfigurationTable tbody"));
            //el.append(html);
            //$compile(html)($scope)
        }

        $("#MasterTable tr td:nth-child(1)").hide();
        $("#MasterTable tr th:nth-child(1)").hide();

        ManageMasterVisibility(Master_Name);

        var table = $("#MasterTable").dataTable({
            "bDestroy": true,
            'scroll': true
        });

    });
}

function ManageMasterVisibility(Master_Name) {
    if (Master_Name == "Area Master") {
        $("#MasterTable tr td:nth-child(4)").hide();
        $("#MasterTable tr th:nth-child(4)").hide();
    }
    else if (Master_Name == "Location") {
        $("#MasterTable tr td:nth-child(4)").hide();
        $("#MasterTable tr th:nth-child(4)").hide();
    }
    else if (Master_Name == "Currency") {
        $("#MasterTable tr td:nth-child(4)").hide();
        $("#MasterTable tr th:nth-child(4)").hide();
        $("#MasterTable tr td:nth-child(5)").hide();
        $("#MasterTable tr th:nth-child(5)").hide();
    }
    else if (Master_Name == "Group Company Details") {
        $("#MasterTable tr td:nth-child(5)").hide();
        $("#MasterTable tr th:nth-child(5)").hide();
        $("#MasterTable tr td:nth-child(6)").hide();
        $("#MasterTable tr th:nth-child(6)").hide();
        $("#MasterTable tr td:nth-child(7)").hide();
        $("#MasterTable tr th:nth-child(7)").hide();
        $("#MasterTable tr td:nth-child(8)").hide();
        $("#MasterTable tr th:nth-child(8)").hide();
        $("#MasterTable tr td:nth-child(9)").hide();
        $("#MasterTable tr th:nth-child(9)").hide();
        $("#MasterTable tr td:nth-child(10)").hide();
        $("#MasterTable tr th:nth-child(10)").hide();
        $("#MasterTable tr td:nth-child(11)").hide();
        $("#MasterTable tr th:nth-child(11)").hide();
        $("#MasterTable tr td:nth-child(12)").hide();
        $("#MasterTable tr th:nth-child(12)").hide();
        $("#MasterTable tr td:nth-child(13)").hide();
        $("#MasterTable tr th:nth-child(13)").hide();
        $("#MasterTable tr td:nth-child(14)").hide();
        $("#MasterTable tr th:nth-child(14)").hide();
        $("#MasterTable tr td:nth-child(15)").hide();
        $("#MasterTable tr th:nth-child(15)").hide();
        $("#MasterTable tr td:nth-child(16)").hide();
        $("#MasterTable tr th:nth-child(16)").hide();
        $("#MasterTable tr td:nth-child(17)").hide();
        $("#MasterTable tr th:nth-child(17)").hide();
    }
    else if (Master_Name == "Company Details") {
        $("#MasterTable tr td:nth-child(6)").hide();
        $("#MasterTable tr th:nth-child(6)").hide();
        $("#MasterTable tr td:nth-child(7)").hide();
        $("#MasterTable tr th:nth-child(7)").hide();
        $("#MasterTable tr td:nth-child(8)").hide();
        $("#MasterTable tr th:nth-child(8)").hide();
        $("#MasterTable tr td:nth-child(9)").hide();
        $("#MasterTable tr th:nth-child(9)").hide();
        $("#MasterTable tr td:nth-child(10)").hide();
        $("#MasterTable tr th:nth-child(10)").hide();
        $("#MasterTable tr td:nth-child(11)").hide();
        $("#MasterTable tr th:nth-child(11)").hide();
        $("#MasterTable tr td:nth-child(12)").hide();
        $("#MasterTable tr th:nth-child(12)").hide();
        $("#MasterTable tr td:nth-child(13)").hide();
        $("#MasterTable tr th:nth-child(13)").hide();
        $("#MasterTable tr td:nth-child(14)").hide();
        $("#MasterTable tr th:nth-child(14)").hide();
        $("#MasterTable tr td:nth-child(15)").hide();
        $("#MasterTable tr th:nth-child(15)").hide();
        $("#MasterTable tr td:nth-child(16)").hide();
        $("#MasterTable tr th:nth-child(16)").hide();
        $("#MasterTable tr td:nth-child(17)").hide();
        $("#MasterTable tr th:nth-child(17)").hide();
        $("#MasterTable tr td:nth-child(18)").hide();
        $("#MasterTable tr th:nth-child(18)").hide();
        $("#MasterTable tr td:nth-child(19)").hide();
        $("#MasterTable tr th:nth-child(19)").hide();
    }
    else if (Master_Name == "Zone Details") {
        $("#MasterTable tr td:nth-child(6)").hide();
        $("#MasterTable tr th:nth-child(6)").hide();
    }
    else if (Master_Name == "Branch") {
        $("#MasterTable tr td:nth-child(4)").hide();
        $("#MasterTable tr th:nth-child(4)").hide();
    }
    else if (Master_Name == "Department") {
        $("#MasterTable tr td:nth-child(4)").hide();
        $("#MasterTable tr th:nth-child(4)").hide();
        $("#MasterTable tr td:nth-child(5)").hide();
        $("#MasterTable tr th:nth-child(5)").hide();
    }
    else if (Master_Name == "Nature Of Complaint") {
        $("#MasterTable tr td:nth-child(5)").hide();
        $("#MasterTable tr th:nth-child(5)").hide();
        $("#MasterTable tr td:nth-child(7)").hide();
        $("#MasterTable tr th:nth-child(7)").hide();
    }
    else if (MasterName == "Problem Type") {

        //$("#MasterTable tr td:nth-child(4)").hide();
        //$("#MasterTable tr th:nth-child(4)").hide();
        //$("#MasterTable tr td:nth-child(7)").hide();
        //$("#MasterTable tr th:nth-child(7)").hide();

    }
    else if (MasterName == "Problem Impact") {

        //$("#MasterTable tr td:nth-child(4)").hide();
        //$("#MasterTable tr th:nth-child(4)").hide();
        //$("#MasterTable tr td:nth-child(7)").hide();
        //$("#MasterTable tr th:nth-child(7)").hide();

    }
    else if (MasterName == "Response Action") {


        //$("#MasterTable tr td:nth-child(7)").hide();
        //$("#MasterTable tr th:nth-child(7)").hide();

    }
    else if (MasterName == "Control Measure") {

        $("#MasterTable tr td:nth-child(4)").hide();
        $("#MasterTable tr th:nth-child(4)").hide();
        $("#MasterTable tr td:nth-child(7)").hide();
        $("#MasterTable tr th:nth-child(7)").hide();
    } else if (MasterName == "Corrective Actions") {

        $("#MasterTable tr td:nth-child(4)").hide();
        $("#MasterTable tr th:nth-child(4)").hide();
        $("#MasterTable tr td:nth-child(7)").hide();
        $("#MasterTable tr th:nth-child(7)").hide();
    }
    else if (MasterName == "Preventive Actions") {

        //$("#MasterTable tr td:nth-child(4)").hide();
        //$("#MasterTable tr th:nth-child(4)").hide();
        //$("#MasterTable tr td:nth-child(7)").hide();
        //$("#MasterTable tr th:nth-child(7)").hide();
    }
    else if (MasterName == "Defect Type") {

        $("#MasterTable tr td:nth-child(4)").hide();
        $("#MasterTable tr th:nth-child(4)").hide();
        $("#MasterTable tr td:nth-child(8)").hide();
        $("#MasterTable tr th:nth-child(8)").hide();
        $("#MasterTable tr td:nth-child(9)").hide();
        $("#MasterTable tr th:nth-child(9)").hide();
        $("#MasterTable tr td:nth-child(6)").hide();
        $("#MasterTable tr th:nth-child(6)").hide();
        $("#MasterTable tr td:nth-child(5)").hide();
        $("#MasterTable tr th:nth-child(5)").hide();

        //$("#MasterTable tr td:nth-child(13)").hide();
        //$("#MasterTable tr th:nth-child(13)").hide();
    }
    else if (MasterName == "Survey Criteria") {

        $("#MasterTable tr td:nth-child(4)").hide();
        $("#MasterTable tr th:nth-child(4)").hide();
        $("#MasterTable tr td:nth-child(8)").hide();
        $("#MasterTable tr th:nth-child(8)").hide();
        $("#MasterTable tr td:nth-child(9)").hide();
        $("#MasterTable tr th:nth-child(9)").hide();
        $("#MasterTable tr td:nth-child(6)").hide();
        $("#MasterTable tr th:nth-child(6)").hide();
        $("#MasterTable tr td:nth-child(5)").hide();
        $("#MasterTable tr th:nth-child(5)").hide();
        $("#MasterTable tr td:nth-child(16)").hide();
        $("#MasterTable tr th:nth-child(16)").hide();
        $("#MasterTable tr td:nth-child(11)").hide();
        $("#MasterTable tr th:nth-child(11)").hide();
        $("#MasterTable tr td:nth-child(12)").hide();
        $("#MasterTable tr th:nth-child(12)").hide();
    }
    else if (MasterName == "Defect Type") {

        $("#MasterTable tr td:nth-child(4)").hide();
        $("#MasterTable tr th:nth-child(4)").hide();
        $("#MasterTable tr td:nth-child(8)").hide();
        $("#MasterTable tr th:nth-child(8)").hide();
        $("#MasterTable tr td:nth-child(9)").hide();
        $("#MasterTable tr th:nth-child(9)").hide();
        $("#MasterTable tr td:nth-child(6)").hide();
        $("#MasterTable tr th:nth-child(6)").hide();
        $("#MasterTable tr td:nth-child(5)").hide();
        $("#MasterTable tr th:nth-child(5)").hide();
        $("#MasterTable tr td:nth-child(13)").hide();
        $("#MasterTable tr th:nth-child(13)").hide();
    }
    else if (MasterName == "Observations Master") {
        $("#MasterTable tr td:nth-child(4)").hide();
        $("#MasterTable tr th:nth-child(4)").hide();
        $("#MasterTable tr td:nth-child(8)").hide();
        $("#MasterTable tr th:nth-child(8)").hide();
        $("#MasterTable tr td:nth-child(9)").hide();
        $("#MasterTable tr th:nth-child(9)").hide();
        $("#MasterTable tr td:nth-child(6)").hide();
        $("#MasterTable tr th:nth-child(6)").hide();
        $("#MasterTable tr td:nth-child(5)").hide();
        $("#MasterTable tr th:nth-child(5)").hide();
        //$("#MasterTable tr td:nth-child(13)").hide();
        //$("#MasterTable tr th:nth-child(13)").hide();
    }
}

function GetTableRowData(obj, DIMSFactory) {
    MasterName = $(obj).children().eq(1).html().trim();
    $("#btnCreateMaster").css("visibility", "visible");
    $("#btnCreateMaster").text("Create " + MasterName);

    var scope = angular.element(document.getElementById("MainWrap")).scope();
    angular.injector(['ng', 'DIMSApp']).get("DIMSFactory").getMasterClickData($(obj).children().eq(1).html()).success(function (response) {
        var data = JSON.parse(response.tabledata);
        $("#MasterTable").dataTable().fnDestroy();
        $('#MasterTable').empty();
        var columns = addAllColumnHeadersForMasters(data, "MasterTable");
        for (var i = 0 ; i < data.length ; i++) {
            var row$ = $('<tr />');
            for (var colIndex = 0 ; colIndex < columns.length ; colIndex++) {
                var cellValue = data[i][columns[colIndex]];

                if (cellValue == null) { cellValue = ""; }
                row$.append($('<td/>').html(cellValue));
            }

            //row$.append($("<td data-ng-click='EditMasterData_Model();'> <a style='background-color: #9760b3; border-color: #9760b3; padding: 6px 6px;' class='btn btn-info'><i class='fa fa-fw fa-pencil-square-o'></i>Edit</a> </td>"));

            row$.append($('<td onclick="EditMasterData(this)" />').html('<a style="background-color: #9760b3; border-color: #9760b3; padding: 6px 6px;" class="btn btn-info"><i class="fa fa-fw fa-pencil-square-o"></i>Edit</a>'));
            //row$.append($('<td/>').html('<a class="btn btn-danger" style="background-color: #c71c22; border-color: #c71c22; padding: 6px 6px;" onclick="DeleteMasterData(' + MasterName + ')" title="delete"><i class="fa fa-fw fa-trash-o"></i>Delete</a>'));
            row$.append($('<td  id="dialog-confirm" class="confirm" onclick="DeleteMasterData(this)"/>').html('<a class="btn btn-danger" style="background-color: #c71c22; border-color: #c71c22; padding: 6px 6px;" )" title="delete"><i class="fa fa-fw fa-trash-o"></i>Delete</a>'));

            $("#MasterTable").append(row$);

            //var html = $compile(TableRow)($scope);

            //var el = angular.element($("#NoticeConfigurationTable tbody"));
            //el.append(html);
            //$compile(html)($scope)
        }

        $("#MasterTable tr td:nth-child(1)").hide();
        $("#MasterTable tr th:nth-child(1)").hide();

        ManageMasterVisibility(MasterName);

        var table = $("#MasterTable").dataTable({
            "bDestroy": true,
            'scroll': true
        });

    });
    var element = angular.element('#LookUpModal');
    element.modal('hide');
}

function DeleteMasterData(obj, DIMSFactory) {
    var ID = $(obj).parent().children().eq(0).html();
    var txt;
    var r = confirm("Are You Sure To delete ID:" + $(obj).parent().children().eq(0).html());
    if (r == true) {
        var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"ID\":\"" + ID + "\"}";

        angular.injector(['ng', 'DIMSApp']).get("DIMSFactory").DeleteMasterData(Master_Data).success(function (response) {
            GetMasterResponse(MasterName);
        });
    } else {

    }
}

function EditMasterData(obj, DIMSFactory) {

    if (MasterName == "Country") {
        var element = angular.element('#CountryModal');
        element.modal('show');
        MasterScope.$apply(function () {
            MasterScope.Country_id_Model = $(obj).parent().children().eq(0).html();
            MasterScope.txtCountryCode_Model = $(obj).parent().children().eq(1).html();
            MasterScope.txtCountryName_Model = $(obj).parent().children().eq(2).html();
        });
        $("#Country_Save").text("Update");
    } else if (MasterName == "Area Master") {
        var element = angular.element('#AreaModal');
        element.modal('show');
        MasterScope.$apply(function () {
            MasterScope.Area_id_Model = $(obj).parent().children().eq(0).html();
            MasterScope.txtAreaCode_Model = $(obj).parent().children().eq(1).html();
            MasterScope.txtAreaName_Model = $(obj).parent().children().eq(2).html();
            MasterScope.txtAreaDesc_Model = $(obj).parent().children().eq(3).html();
            MasterScope.txtAreaCountryName_Model = $(obj).parent().children().eq(4).html();
        });
        $("#Area_Save").text("Update");
    }
    else if (MasterName == "State") {
        var element = angular.element('#StateModal');
        element.modal('show');
        MasterScope.$apply(function () {
            MasterScope.State_id_Model = $(obj).parent().children().eq(0).html();
            MasterScope.txtStateCode_Model = $(obj).parent().children().eq(1).html();
            MasterScope.txtStateName_Model = $(obj).parent().children().eq(2).html();
            MasterScope.txtStateArea_Model = $(obj).parent().children().eq(3).html();
            MasterScope.txtStateCountry_Model = $(obj).parent().children().eq(4).html();
        });
        $("#State_Save").text("Update");
    } else if (MasterName == "City") {
        var element = angular.element('#CityModal');
        element.modal('show');
        MasterScope.$apply(function () {
            MasterScope.City_id_Model = $(obj).parent().children().eq(0).html();
            MasterScope.txtCityCode_Model = $(obj).parent().children().eq(1).html();
            MasterScope.txtCityName_Model = $(obj).parent().children().eq(2).html();
            MasterScope.txtCityState_Model = $(obj).parent().children().eq(3).html();
            MasterScope.txtCityArea_Model = $(obj).parent().children().eq(4).html();
        });
        $("#City_Save").text("Update");
    } else if (MasterName == "Location") {
        var element = angular.element('#LocationModal');
        element.modal('show');
        MasterScope.$apply(function () {
            MasterScope.Location_id_Model = $(obj).parent().children().eq(0).html();
            MasterScope.txtLocationCode_Model = $(obj).parent().children().eq(1).html();
            MasterScope.txtLocationName_Model = $(obj).parent().children().eq(2).html();
            MasterScope.txtLocationDesc_Model = $(obj).parent().children().eq(3).html();
            MasterScope.txtLocationCity_Model = $(obj).parent().children().eq(4).html();
            MasterScope.txtLocationState_Model = $(obj).parent().children().eq(5).html();
            MasterScope.txtLocationArea_Model = $(obj).parent().children().eq(6).html();
            MasterScope.txtLocationCountry_Model = $(obj).parent().children().eq(7).html();
        });
        $("#Location_Save").text("Update");
    }
    else if (MasterName == "Depo Master") {
        var element = angular.element('#DepoModal');
        element.modal('show');
        MasterScope.$apply(function () {
            // Query = "SELECT ID, DEPO_CODE,DEPO_NAME,PLANT_CODE, PLANT_NAME,AREA_CODE,AREA_NAME,CITY_CODE,CITY_NAME,STATE_CODE,STATE_NAME,COUNTRY_CODE,COUNTRY_NAME,CREATED_BY,CREATED_DATE,ACTIVE FROM cms_depo_master";

            MasterScope.Depo_id_Model = $(obj).parent().children().eq(0).html();
            MasterScope.txtDepoCode_Model = $(obj).parent().children().eq(1).html();
            MasterScope.txtDepoName_Model = $(obj).parent().children().eq(2).html();
            MasterScope.DepoPlant_Code = $(obj).parent().children().eq(3).html();
            MasterScope.txtDepoPlantName_Model = $(obj).parent().children().eq(4).html();
            MasterScope.DepoArea_Code = $(obj).parent().children().eq(5).html();
            MasterScope.txtDepoAreaName_Model = $(obj).parent().children().eq(6).html();
            MasterScope.DepoCity_Code = $(obj).parent().children().eq(7).html();
            MasterScope.txtDepoCityName_Model = $(obj).parent().children().eq(8).html();
            MasterScope.DepoState_Code = $(obj).parent().children().eq(9).html();
            MasterScope.txtDepoStateName_Model = $(obj).parent().children().eq(10).html();
            MasterScope.DepoCountry_Code = $(obj).parent().children().eq(11).html();
            MasterScope.txtDepoCountryName_Model = $(obj).parent().children().eq(12).html();
            MasterScope.txtDepoDesc_Model = $(obj).parent().children().eq(13).html();
            MasterScope.txtDepoAddress_Model = $(obj).parent().children().eq(14).html();
            MasterScope.txtDepoActive_Model = $(obj).parent().children().eq(17).html();
        });
        $("#Depo_Save").text("Update");
    }
    else if (MasterName == "Currency") {
        var element = angular.element('#CurrencyModal');
        element.modal('show');
        MasterScope.$apply(function () {
            MasterScope.Currency_id_Model = $(obj).parent().children().eq(0).html();
            MasterScope.txtCurrencyCode_Model = $(obj).parent().children().eq(1).html();
            MasterScope.txtCurrencyDescription_Model = $(obj).parent().children().eq(2).html();
            MasterScope.txtBaseCurrency_Model = $(obj).parent().children().eq(3).html();
            MasterScope.txtCurrencyCountryCode_Model = $(obj).parent().children().eq(4).html();
            MasterScope.txtCreatedBy_Model = $(obj).parent().children().eq(5).html();
            MasterScope.txtCreatedDate_Model = $(obj).parent().children().eq(6).html();
        });
        $("#Currency_Save").text("Update");
    }
    else if (MasterName == "Group Company Details") {
        var element = angular.element('#GroupCompModal');
        element.modal('show');
        MasterScope.$apply(function () {
            MasterScope.GroupComp_id_Model = $(obj).parent().children().eq(0).html();
            MasterScope.txtGroupCompCode_Model = $(obj).parent().children().eq(1).html();
            MasterScope.txtGroupCompName_Model = $(obj).parent().children().eq(2).html();
            MasterScope.txtGroupAddress_Model = $(obj).parent().children().eq(3).html();
            MasterScope.txtGroupCompRoom_Model = $(obj).parent().children().eq(4).html();
            MasterScope.txtGroupCompBlock_Model = $(obj).parent().children().eq(5).html();
            MasterScope.txtGroupCompStreet_Model = $(obj).parent().children().eq(6).html();
            MasterScope.txtGroupCompCity_Model = $(obj).parent().children().eq(7).html();
            MasterScope.txtGroupCompState_Model = $(obj).parent().children().eq(8).html();
            MasterScope.txtGroupCompCountry_Model = $(obj).parent().children().eq(9).html();
            MasterScope.txtGroupCompZip_Model = $(obj).parent().children().eq(10).html();
            MasterScope.txtGroupCompMail_Model = $(obj).parent().children().eq(11).html();
            MasterScope.txtGroupCompWebsite_Model = $(obj).parent().children().eq(12).html();
            MasterScope.txtGroupCompPhone1_Model = $(obj).parent().children().eq(13).html();
            MasterScope.txtGroupCompPhone2_Model = $(obj).parent().children().eq(14).html();
            MasterScope.txtGroupCompMobile_Model = $(obj).parent().children().eq(15).html();
            MasterScope.txtGroupCompFax_Model = $(obj).parent().children().eq(16).html();
        });
        $("#GroupComp_Save").text("Update");
    }
    else if (MasterName == "Company Details") {
        var element = angular.element('#CompModal');
        element.modal('show');
        MasterScope.$apply(function () {
            MasterScope.Comp_id_Model = $(obj).parent().children().eq(0).html();
            MasterScope.txtCompCode_Model = $(obj).parent().children().eq(1).html();
            MasterScope.txtCompName_Model = $(obj).parent().children().eq(2).html();
            MasterScope.txtCompGroupCompCode_Model = $(obj).parent().children().eq(3).html();
            MasterScope.txtCompGroupCompName_Model = $(obj).parent().children().eq(4).html();
            MasterScope.txtCompAddress_Model = $(obj).parent().children().eq(5).html();
            MasterScope.txtCompRoom_Model = $(obj).parent().children().eq(6).html();
            MasterScope.txtCompBlock_Model = $(obj).parent().children().eq(7).html();
            MasterScope.txtCompStreet_Model = $(obj).parent().children().eq(8).html();
            MasterScope.txtCompCity_Model = $(obj).parent().children().eq(9).html();
            MasterScope.txtCompState_Model = $(obj).parent().children().eq(10).html();
            MasterScope.txtCompCountry_Model = $(obj).parent().children().eq(11).html();
            MasterScope.txtCompZip_Model = $(obj).parent().children().eq(12).html();
            MasterScope.txtCompMail_Model = $(obj).parent().children().eq(13).html();
            MasterScope.txtCompWebsite_Model = $(obj).parent().children().eq(14).html();
            MasterScope.txtCompPhone1_Model = $(obj).parent().children().eq(15).html();
            MasterScope.txtCompPhone2_Model = $(obj).parent().children().eq(16).html();
            MasterScope.txtCompMobile_Model = $(obj).parent().children().eq(17).html();
            MasterScope.txtCompFax_Model = $(obj).parent().children().eq(18).html();
            MasterScope.GroupComp_id_Model = $(obj).parent().children().eq(19).html();
        });

        $("#Comp_Save").text("Update");
    }
    else if (MasterName == "Zone Details") {
        var element = angular.element('#ZoneModal');
        element.modal('show');
        MasterScope.$apply(function () {
            MasterScope.Zone_id_Model = $(obj).parent().children().eq(0).html();
            MasterScope.txtZoneCode_Model = $(obj).parent().children().eq(1).html();
            MasterScope.txtZoneName_Model = $(obj).parent().children().eq(2).html();
            MasterScope.txtZoneCompCode_Model = $(obj).parent().children().eq(3).html();
            MasterScope.txtZoneCompName_Model = $(obj).parent().children().eq(4).html();
            MasterScope.txtZoneCountry_Model = $(obj).parent().children().eq(5).html();
        });

        $("#Zone_Save").text("Update");
    }
    else if (MasterName == "Branch") {
        var element = angular.element('#BranchModal');
        element.modal('show');
        MasterScope.$apply(function () {
            MasterScope.Branch_id_Model = $(obj).parent().children().eq(0).html();
            MasterScope.txtBranchCode_Model = $(obj).parent().children().eq(1).html();
            MasterScope.txtBranchName_Model = $(obj).parent().children().eq(2).html();
            MasterScope.txtBranchCompName_Model = $(obj).parent().children().eq(3).html();
        });

        $("#Branch_Save").text("Update");
    }
    else if (MasterName == "Department") {
        var element = angular.element('#DeptModal');
        element.modal('show');
        MasterScope.$apply(function () {
            MasterScope.Dept_id_Model = $(obj).parent().children().eq(0).html();
            MasterScope.txtDeptCode_Model = $(obj).parent().children().eq(1).html();
            MasterScope.txtDeptName_Model = $(obj).parent().children().eq(2).html();
            MasterScope.txtDeptCompCode_Model = $(obj).parent().children().eq(3).html();
            MasterScope.txtDeptCompName_Model = $(obj).parent().children().eq(4).html();
        });

        $("#Dept_Save").text("Update");
    }
    else if (MasterName == "Complaint Mode") {
        var element = angular.element('#CmplModeModal');
        element.modal('show');
        MasterScope.$apply(function () {
            MasterScope.CmplMode_id_Model = $(obj).parent().children().eq(0).html();
            MasterScope.txtCmplModeCode_Model = $(obj).parent().children().eq(1).html();
            MasterScope.txtCmplModeName_Model = $(obj).parent().children().eq(2).html();
            MasterScope.txtCmplModeDesc_Model = $(obj).parent().children().eq(3).html();
        });
        $("#CmplMode_Save").text("Update");
    }
    else if (MasterName == "Complaint Type") {
        var element = angular.element('#CmplTypeModal');
        element.modal('show');
        MasterScope.$apply(function () {
            MasterScope.CmplType_id_Model = $(obj).parent().children().eq(0).html();
            MasterScope.txtCmplTypeCode_Model = $(obj).parent().children().eq(1).html();
            MasterScope.txtCmplTypeName_Model = $(obj).parent().children().eq(2).html();
            MasterScope.txtCmplTypeDesc_Model = $(obj).parent().children().eq(3).html();
        });
        $("#CmplType_Save").text("Update");
    }
    else if (MasterName == "Complaint Category") {
        var element = angular.element('#CmplCategoryModal');
        element.modal('show');
        MasterScope.$apply(function () {
            MasterScope.CmplCategory_id_Model = $(obj).parent().children().eq(0).html();
            MasterScope.txtCmplCategoryCode_Model = $(obj).parent().children().eq(1).html();
            MasterScope.txtCmplCategoryName_Model = $(obj).parent().children().eq(2).html();
            MasterScope.txtCmplCategoryDesc_Model = $(obj).parent().children().eq(3).html();
        });
        $("#CmplCategory_Save").text("Update");
    }
    else if (MasterName == "Nature Of Complaint") {
        var element = angular.element('#CmplNatureModal');
        element.modal('show');
        MasterScope.$apply(function () {
            MasterScope.CmplNature_id_Model = $(obj).parent().children().eq(0).html();
            MasterScope.txtCmplNatureCode_Model = $(obj).parent().children().eq(1).html();
            MasterScope.txtCmplNatureName_Model = $(obj).parent().children().eq(2).html();
            MasterScope.txtCmplNatureDesc_Model = $(obj).parent().children().eq(3).html();
            MasterScope.txtCmplNatureCmplCategory_Model = $(obj).parent().children().eq(4).html();
            MasterScope.txtCmplNatureCmplType_Model = $(obj).parent().children().eq(5).html();
        });
        $("#CmplNature_Save").text("Update");
    }
    else if (MasterName == "Complaint Priority") {
        var element = angular.element('#CmplPriorityModal');
        element.modal('show');
        MasterScope.$apply(function () {
            MasterScope.CmplPriority_id_Model = $(obj).parent().children().eq(0).html();
            MasterScope.txtCmplPriorityCode_Model = $(obj).parent().children().eq(1).html();
            MasterScope.txtCmplPriorityName_Model = $(obj).parent().children().eq(2).html();
            MasterScope.txtCmplPriorityDesc_Model = $(obj).parent().children().eq(3).html();
        });
        $("#CmplPriority_Save").text("Update");
    }
    else if (MasterName == "ComplaintAssign") {
        var element = angular.element('#CmplAssnModal');
        element.modal('show');
        MasterScope.$apply(function () {
            MasterScope.CmplAssn_id_Model = $(obj).children().eq(0).html();
            MasterScope.txtCmplNo_Model = $(obj).children().eq(1).html();
            MasterScope.txtCmplDate_Model = $(obj).children().eq(2).html();
            MasterScope.txtAssToUserRole_Model = $(obj).children().eq(3).html();
            MasterScope.txtAssToUser_Model = $(obj).children().eq(5).html();
            MasterScope.txtAssBy_Model = $(obj).children().eq(6).html();
            MasterScope.txtAssOn_Model = $(obj).children().eq(7).html();
        });
        $("#CmplAssign_Save").text("Update");
    }
    else if (MasterName == "ComplaintAssignCreate") {
        var element = angular.element('#CmplAssnModal');
        element.modal('show');
        MasterScope.$apply(function () {
            MasterScope.CmplAssn_id_Model = $(obj).children().eq(0).html();
            MasterScope.txtCmplNo_Model = $(obj).children().eq(1).html();
            MasterScope.txtCmplDate_Model = $(obj).children().eq(3).html();
            MasterScope.txtAssToUserRole_Model = $(obj).children().eq(5).html();
            MasterScope.txtAssToUser_Model = $(obj).children().eq(7).html();
            MasterScope.txtAssBy_Model = $(obj).children().eq(8).html();
            MasterScope.txtAssOn_Model = $(obj).children().eq(9).html();
        });
        $("#CmplAssign_Save").text("Update");
    }
    else if (MasterName == "GetFormData") {
        var element = angular.element('#CmplAssnModal');
        element.modal('show');
        MasterScope.$apply(function () {
            MasterScope.CmplAssn_id_Model = $(obj).children().eq(0).html();
            MasterScope.txtCmplNo_Model = $(obj).children().eq(1).html();
            MasterScope.txtCmplDate_Model = $(obj).children().eq(3).html();
            MasterScope.txtAssToUserRole_Model = $(obj).children().eq(5).html();
            MasterScope.txtAssToUser_Model = $(obj).children().eq(7).html();
            MasterScope.txtAssBy_Model = $(obj).children().eq(8).html();
            MasterScope.txtAssOn_Model = $(obj).children().eq(9).html();
        });
        $("#CmplAssign_Save").text("Update");
    }
    else if (MasterName == "Product Type") {

        var element = angular.element('#ProductTypeModal');
        element.modal('show');
        MasterScope.$apply(function () {
            MasterScope.Productype_id_Model = $(obj).parent().children().eq(0).html();
            MasterScope.txtProductTypeCode_Model = $(obj).parent().children().eq(1).html();
            MasterScope.txtProductTypeName_Model = $(obj).parent().children().eq(2).html();
            MasterScope.txtProductTypeDescription_Model = $(obj).parent().children().eq(3).html();
            MasterScope.txtProductTypeCreatedBy_Model = $(obj).parent().children().eq(4).html();
            MasterScope.txtProductTypeCreatedDate_Model = $(obj).parent().children().eq(5).html();
            MasterScope.txtProductTypeActive_Model = $(obj).parent().children().eq(6).html();
        });

        //$("#Productype_id").val($(obj).parent().children().eq(0).html());
        //$("#txtProductTypeCode").val($(obj).parent().children().eq(1).html());
        //$("#txtProductTypeName").val($(obj).parent().children().eq(2).html());
        //$("#txtProductTypeDescription").val($(obj).parent().children().eq(3).html());
        //$("#txtProductTypeCreatedBy").val($(obj).parent().children().eq(4).html());
        //$("#txtProductTypeCreatedDate").val($(obj).parent().children().eq(5).html());
        //$("#txtProductTypeActive").val($(obj).parent().children().eq(6).html());

        $("#ProductType_Save").text("Update");
    }
    else if (MasterName == "Product Category") {

        var element = angular.element('#ProductCategoryModal');
        element.modal('show');
        MasterScope.$apply(function () {
            MasterScope.ProductCategory_id_Model = $(obj).parent().children().eq(0).html();
            MasterScope.txtProductCategory_Model = $(obj).parent().children().eq(1).html();
            MasterScope.txtProductCategoryName_Model = $(obj).parent().children().eq(2).html();
            MasterScope.txtProductCategoryDescription_Model = $(obj).parent().children().eq(5).html();
            MasterScope.txtProductType_code_Model = $(obj).parent().children().eq(3).html();

            MasterScope.txtProductType_Model = $(obj).parent().children().eq(4).html();
            MasterScope.txtProductCategoryCreatedBy_Model = $(obj).parent().children().eq(6).html();
            MasterScope.txtProductCategoryCreatedDate_Model = $(obj).parent().children().eq(7).html();
            MasterScope.txtProductCategoryActive_Model = $(obj).parent().children().eq(8).html();
        });

        //$("#ProductCategory_id").val($(obj).parent().children().eq(0).html());
        //$("#txtProductCategory").val($(obj).parent().children().eq(1).html());
        //$("#txtProductCategoryName").val($(obj).parent().children().eq(2).html());
        //$("#txtProductType").val($(obj).parent().children().eq(4).html());
        //$("#txtProductCategoryDescription").val($(obj).parent().children().eq(5).html());
        //$("#txtProductCategoryCreatedBy").val($(obj).parent().children().eq(6).html());
        //$("#txtProductCategoryCreatedDate").val($(obj).parent().children().eq(7).html());
        //$("#txtProductCategoryActive").val($(obj).parent().children().eq(8).html());

        $("#ProductCategory_Save").text("Update");
    }

    else if (MasterName == "Product Master") {

        var element = angular.element('#ProductMasterModal');
        element.modal('show');
        MasterScope.$apply(function () {
            MasterScope.ProductMaster_id_Model = $(obj).parent().children().eq(0).html();
            MasterScope.txtProductCode_Model = $(obj).parent().children().eq(1).html();
            MasterScope.txtProductName_Model = $(obj).parent().children().eq(2).html();
            MasterScope.txtProductDescription_Model = $(obj).parent().children().eq(5).html();

            MasterScope.txtProductMasterProductType_code_Model = $(obj).parent().children().eq(3).html();

            MasterScope.txtProductMasterProductType_Model = $(obj).parent().children().eq(4).html();

            MasterScope.txtProductMasterProductCategory_code_Model = $(obj).parent().children().eq(6).html();


            MasterScope.txtProductMasterProductCategory_Model = $(obj).parent().children().eq(7).html();
            MasterScope.txtSize_Model = $(obj).parent().children().eq(8).html();
            MasterScope.txtGrossWeight_Model = $(obj).parent().children().eq(15).html();
            MasterScope.txtNetWeight_Model = $(obj).parent().children().eq(9).html();
            MasterScope.txtDeviation_Model = $(obj).parent().children().eq(11).html();
            MasterScope.txtBasicUnit_Model = $(obj).parent().children().eq(10).html();
            MasterScope.txtProductCreatedBy_Model = $(obj).parent().children().eq(12).html();
            MasterScope.txtProductCreatedDate_Model = $(obj).parent().children().eq(13).html();
            MasterScope.txtProductActive_Model = $(obj).parent().children().eq(14).html();


        });
        //$("#ProductMaster_id").val($(obj).parent().children().eq(0).html());
        //$("#txtProductCode").val($(obj).parent().children().eq(1).html());
        //$("#txtProductName").val($(obj).parent().children().eq(2).html());
        //$("#txtProductDescription").val($(obj).parent().children().eq(5).html());
        //$("#txtProductMasterProductType").val($(obj).parent().children().eq(4).html());
        //$("#txtProductMasterProductCategory").val($(obj).parent().children().eq(6).html());
        //$("#txtSize").val($(obj).parent().children().eq(7).html());
        //$("#txtGrossWeight").val($(obj).parent().children().eq(8).html());
        //$("#txtNetWeight").val($(obj).parent().children().eq(9).html());
        //$("#txtDeviation").val($(obj).parent().children().eq(11).html());
        //$("#txtBasicUnit").val($(obj).parent().children().eq(10).html());
        //$("#txtProductCreatedBy").val($(obj).parent().children().eq(12).html());
        //$("#txtProductCreatedDate").val($(obj).parent().children().eq(13).html());
        //$("#txtProductActive").val($(obj).parent().children().eq(14).html());

        $("#Product_Save").text("Update");
    }
    else if (MasterName == "Customer Type") {

        var element = angular.element('#CustomerTypeModal');
        element.modal('show');
        MasterScope.$apply(function () {
            MasterScope.CustomerType_id_Model = $(obj).parent().children().eq(0).html();
            MasterScope.txtCustomerTypeCode_Model = $(obj).parent().children().eq(1).html();
            MasterScope.txtCustomerTypeName_Model = $(obj).parent().children().eq(2).html();
            MasterScope.txtCustomerTypeDescription_Model = $(obj).parent().children().eq(3).html();
            MasterScope.txtCustomerTypeCreatedBy_Model = $(obj).parent().children().eq(4).html();
            MasterScope.txtCustomerTypeCreatedDate_Model = $(obj).parent().children().eq(5).html();
            MasterScope.txtCustomerTypeActive_Model = $(obj).parent().children().eq(6).html();
        });
        //$("#CustomerType_id").val($(obj).parent().children().eq(0).html());
        //$("#txtCustomerTypeCode").val($(obj).parent().children().eq(1).html());
        //$("#txtCustomerTypeName").val($(obj).parent().children().eq(2).html());
        //$("#txtCustomerTypeDescription").val($(obj).parent().children().eq(3).html());
        //$("#txtCustomerTypeCreatedBy").val($(obj).parent().children().eq(4).html());
        //$("#txtCustomerTypeCreatedDate").val($(obj).parent().children().eq(5).html());
        //$("#txtCustomerTypeActive").val($(obj).parent().children().eq(6).html());

        $("#CustomerType_Save").text("Update");
    }
    else if (MasterName == "Customer Category") {

        var element = angular.element('#CustomerCategoryModal');
        element.modal('show');
        MasterScope.$apply(function () {
            MasterScope.CustomerCategory_id_Model = $(obj).parent().children().eq(0).html();
            MasterScope.txtCustomerCategoryCode_Model = $(obj).parent().children().eq(1).html();
            MasterScope.txtCustomerCategoryName_Model = $(obj).parent().children().eq(2).html();
            MasterScope.txtCustomerCategoryDescription_Model = $(obj).parent().children().eq(3).html();
            MasterScope.txtCustomerType_code_Model = $(obj).parent().children().eq(4).html();
            MasterScope.txtCustomerType_Model = $(obj).parent().children().eq(5).html();
            MasterScope.txtCustomerCategoryCreatedBy_Model = $(obj).parent().children().eq(6).html();
            MasterScope.txtCustomerCategoryCreatedDate_Model = $(obj).parent().children().eq(7).html();
            MasterScope.txtCustomerCategoryActive_Model = $(obj).parent().children().eq(8).html();


        });
        //$("#CustomerCategory_id").val($(obj).parent().children().eq(0).html());
        //$("#txtCustomerCategoryCode").val($(obj).parent().children().eq(1).html());
        //$("#txtCustomerCategoryName").val($(obj).parent().children().eq(2).html());
        //$("#txtCustomerCategoryDescription").val($(obj).parent().children().eq(3).html());
        //$("#txtCustomerType").val($(obj).parent().children().eq(5).html());
        //$("#txtCustomerCategoryCreatedBy").val($(obj).parent().children().eq(6).html());
        //$("#txtCustomerCategoryCreatedDate").val($(obj).parent().children().eq(7).html());
        //$("#txtCustomerCategoryActive").val($(obj).parent().children().eq(8).html());

        $("#CustomerCategory_Save").text("Update");
    }
    else if (MasterName == "Customer Group") {

        var element = angular.element('#CustomerGroupModal');
        element.modal('show');
        MasterScope.$apply(function () {
            MasterScope.CustomerGroup_id_Model = $(obj).parent().children().eq(0).html();
            MasterScope.txtCustomerGroupCode_Model = $(obj).parent().children().eq(1).html();
            MasterScope.txtCustomerGroupName_Model = $(obj).parent().children().eq(2).html();
            MasterScope.txtCustomerGroupDescription_Model = $(obj).parent().children().eq(3).html();
            MasterScope.txtCustomerGroupCreatedBy_Model = $(obj).parent().children().eq(4).html();
            MasterScope.txtCustomerGroupCreatedDate_Model = $(obj).parent().children().eq(5).html();
            MasterScope.txtCustomerGroupActive_Model = $(obj).parent().children().eq(6).html();
        });


        //$("#CustomerGroup_id").val($(obj).parent().children().eq(0).html());
        //$("#txtCustomerGroupCode").val($(obj).parent().children().eq(1).html());
        //$("#txtCustomerGroupName").val($(obj).parent().children().eq(2).html());
        //$("#txtCustomerGroupDescription").val($(obj).parent().children().eq(3).html());
        //$("#txtCustomerGroupCreatedBy").val($(obj).parent().children().eq(4).html());
        //$("#txtCustomerGroupCreatedDate").val($(obj).parent().children().eq(5).html());
        //$("#txtCustomerGroupActive").val($(obj).parent().children().eq(6).html());

        $("#CustomerGroup_Save").text("Update");
    }
    else if (MasterName == "Sales Representative") {

        var element = angular.element('#SalesRepresentativeModal');
        element.modal('show');
        MasterScope.$apply(function () {
            MasterScope.SalesRepresentative_id_Model = $(obj).parent().children().eq(0).html();
            MasterScope.txtSalesRepresentativeEmployeeCode_Model = $(obj).parent().children().eq(1).html();
            MasterScope.txtSalesRepresentativeEmployeeName_Model = $(obj).parent().children().eq(2).html();
            MasterScope.txtSalesRepresentativeCreatedBy_Model = $(obj).parent().children().eq(3).html();
            MasterScope.txtSalesRepresentativeCreatedDate_Model = $(obj).parent().children().eq(4).html();
        });


        //$("#SalesRepresentative_id").val($(obj).parent().children().eq(0).html());
        //$("#txtSalesRepresentativeEmployeeCode").val($(obj).parent().children().eq(1).html());
        //$("#txtSalesRepresentativeEmployeeName").val($(obj).parent().children().eq(2).html());
        //$("#txtSalesRepresentativeCreatedBy").val($(obj).parent().children().eq(3).html());
        //$("#txtSalesRepresentativeCreatedDate").val($(obj).parent().children().eq(4).html());

        $("#SalesRepresentative_Save").text("Update");
    }
    else if (MasterName == "Problem Type") {

        var element = angular.element('#ProblemTypeModal');
        element.modal('show');
        MasterScope.$apply(function () {
            MasterScope.ProblemType_id_Model = $(obj).parent().children().eq(0).html();
            MasterScope.txtProblemTypeCode_Model = $(obj).parent().children().eq(1).html();
            MasterScope.txtProblemTypeName_Model = $(obj).parent().children().eq(2).html();
            MasterScope.txtProblemTypeDescription_Model = $(obj).parent().children().eq(3).html();
            MasterScope.txtProblemTypeCreatedBy_Model = $(obj).parent().children().eq(4).html();
            MasterScope.txtProblemTypeCreatedDate_Model = $(obj).parent().children().eq(5).html();
            MasterScope.txtProblemTypeActive_Model = $(obj).parent().children().eq(6).html();


        });



        //$("#ProblemType_id").val($(obj).parent().children().eq(0).html());
        //$("#txtProblemTypeCode").val($(obj).parent().children().eq(1).html());
        //$("#txtProblemTypeName").val($(obj).parent().children().eq(2).html());
        //$("#txtProblemTypeDescription").val($(obj).parent().children().eq(3).html());
        //$("#txtProblemTypeCreatedBy").val($(obj).parent().children().eq(4).html());
        //$("#txtProblemTypeCreatedDate").val($(obj).parent().children().eq(5).html());
        //$("#txtProblemTypeActive").val($(obj).parent().children().eq(6).html());

        $("#ProblemType_Save").text("Update");
    }
    else if (MasterName == "Problem Impact") {

        var element = angular.element('#ProblemImpactModal');
        element.modal('show');
        MasterScope.$apply(function () {
            MasterScope.ProblemImpact_id_Model = $(obj).parent().children().eq(0).html();
            MasterScope.txtProblemImpactCode_Model = $(obj).parent().children().eq(1).html();
            MasterScope.txtProblemImpactName_Model = $(obj).parent().children().eq(2).html();
            MasterScope.txtProblemImpactDescription_Model = $(obj).parent().children().eq(3).html();
            MasterScope.txtProblemImpactCreatedBy_Model = $(obj).parent().children().eq(4).html();
            MasterScope.txtProblemImpactCreatedDate_Model = $(obj).parent().children().eq(5).html();
            MasterScope.txtProblemImpactActive_Model = $(obj).parent().children().eq(6).html();


        });


        //$("#ProblemImpact_id").val($(obj).parent().children().eq(0).html());
        //$("#txtProblemImpactCode").val($(obj).parent().children().eq(1).html());
        //$("#txtProblemImpactName").val($(obj).parent().children().eq(2).html());
        //$("#txtProblemImpactDescription").val($(obj).parent().children().eq(3).html());
        //$("#txtProblemImpactCreatedBy").val($(obj).parent().children().eq(4).html());
        //$("#txtProblemImpactCreatedDate").val($(obj).parent().children().eq(5).html());
        //$("#txtProblemImpactActive").val($(obj).parent().children().eq(6).html());

        $("#ProblemImpact_Save").text("Update");
    }
    else if (MasterName == "Response Action") {

        var element = angular.element('#ResponseActionModal');
        element.modal('show');
        MasterScope.$apply(function () {
            MasterScope.ResponseAction_id_Model = $(obj).parent().children().eq(0).html();
            MasterScope.txtResponseActionCode_Model = $(obj).parent().children().eq(1).html();
            MasterScope.txtResponseAction_Model = $(obj).parent().children().eq(2).html();
            MasterScope.txtResponseActionDescription_Model = $(obj).parent().children().eq(3).html();
            MasterScope.txtResponseActionCreatedBy_Model = $(obj).parent().children().eq(4).html();
            MasterScope.txtResponseActionCreatedDate_Model = $(obj).parent().children().eq(5).html();
            MasterScope.txtResponseActionActive_Model = $(obj).parent().children().eq(6).html();
        });



        //$("#ResponseAction_id").val($(obj).parent().children().eq(0).html());
        //$("#txtResponseActionCode").val($(obj).parent().children().eq(1).html());
        //$("#txtResponseAction").val($(obj).parent().children().eq(2).html());
        //$("#txtResponseActionDescription").val($(obj).parent().children().eq(3).html());
        //$("#txtResponseActionCreatedBy").val($(obj).parent().children().eq(4).html());
        //$("#txtResponseActionCreatedDate").val($(obj).parent().children().eq(5).html());
        //$("#txtResponseActionActive").val($(obj).parent().children().eq(6).html());

        $("#ResponseAction_Save").text("Update");
    }
    else if (MasterName == "Control Measure") {

        var element = angular.element('#ControlMeasureModal');
        element.modal('show');
        MasterScope.$apply(function () {
            MasterScope.Control_id_Model = $(obj).parent().children().eq(0).html();
            MasterScope.txtControlCode_Model = $(obj).parent().children().eq(1).html();
            MasterScope.txtControlName_Model = $(obj).parent().children().eq(2).html();
            MasterScope.txtControlDescription_Model = $(obj).parent().children().eq(3).html();
            MasterScope.txtControlCreatedBy_Model = $(obj).parent().children().eq(4).html();
            MasterScope.txtControlCreatedDate_Model = $(obj).parent().children().eq(5).html();
            MasterScope.txtControlActive_Model = $(obj).parent().children().eq(6).html();
        });
        //$("#Control_id").val($(obj).parent().children().eq(0).html());
        //$("#txtControlCode").val($(obj).parent().children().eq(1).html());
        //$("#txtControlName").val($(obj).parent().children().eq(2).html());
        //$("#txtControlDescription").val($(obj).parent().children().eq(3).html());
        //$("#txtControlCreatedBy").val($(obj).parent().children().eq(4).html());
        //$("#txtControlCreatedDate").val($(obj).parent().children().eq(5).html());
        //$("#txtControlActive").val($(obj).parent().children().eq(6).html());

        $("#Control_Save").text("Update");
    }
    else if (MasterName == "Corrective Actions") {

        var element = angular.element('#CorrectiveActionsModal');
        element.modal('show');
        MasterScope.$apply(function () {
            MasterScope.CorrectiveMaster_id_Model = $(obj).parent().children().eq(0).html();
            MasterScope.txtCorrectiveMasterCode_Model = $(obj).parent().children().eq(1).html();
            MasterScope.txtCorrectiveMasterName_Model = $(obj).parent().children().eq(2).html();
            MasterScope.txtCorrectiveMasterDescription_Model = $(obj).parent().children().eq(3).html();
            MasterScope.txtCorrectiveMasterCreatedBy_Model = $(obj).parent().children().eq(4).html();
            MasterScope.txtCorrectiveMasterCreatedDate_Model = $(obj).parent().children().eq(5).html();
            MasterScope.txtCorrectiveMasterActive_Model = $(obj).parent().children().eq(6).html();
        });


        //$("#CorrectiveMaster_id").val($(obj).parent().children().eq(0).html());
        //$("#txtCorrectiveMasterCode").val($(obj).parent().children().eq(1).html());
        //$("#txtCorrectiveMasterName").val($(obj).parent().children().eq(2).html());
        //$("#txtCorrectiveMasterDescription").val($(obj).parent().children().eq(3).html());
        //$("#txtCorrectiveMasterCreatedBy").val($(obj).parent().children().eq(4).html());
        //$("#txtCorrectiveMasterCreatedDate").val($(obj).parent().children().eq(5).html());
        //$("#txtCorrectiveMasterActive").val($(obj).parent().children().eq(6).html());

        $("#CorrectiveMaster_Save").text("Update");
    }

    else if (MasterName == "Preventive Actions") {

        var element = angular.element('#PreventiveActionsModal');
        element.modal('show');
        MasterScope.$apply(function () {
            MasterScope.PreventiveMaster_id_Model = $(obj).parent().children().eq(0).html();
            MasterScope.txtPreventiveMasterCode_Model = $(obj).parent().children().eq(1).html();
            MasterScope.txtPreventiveMasterName_Model = $(obj).parent().children().eq(2).html();
            MasterScope.txtPreventiveMasterDescription_Model = $(obj).parent().children().eq(3).html();
            MasterScope.txtPreventiveMasterCreatedBy_Model = $(obj).parent().children().eq(4).html();
            MasterScope.txtPreventiveMasterCreatedDate_Model = $(obj).parent().children().eq(5).html();
            MasterScope.txtPreventiveMasterActive_Model = $(obj).parent().children().eq(6).html();
        });


        //$("#PreventiveMaster_id").val($(obj).parent().children().eq(0).html());
        //$("#txtPreventiveMasterCode").val($(obj).parent().children().eq(1).html());
        //$("#txtPreventiveMasterName").val($(obj).parent().children().eq(2).html());
        //$("#txtPreventiveMasterDescription").val($(obj).parent().children().eq(3).html());
        //$("#txtPreventiveMasterCreatedBy").val($(obj).parent().children().eq(4).html());
        //$("#txtPreventiveMasterCreatedDate").val($(obj).parent().children().eq(5).html());
        //$("#txtPreventiveMasterActive").val($(obj).parent().children().eq(6).html());

        $("#PreventiveMaster_Save").text("Update");
    }
    else if (MasterName == "Cause Master") {

        var element = angular.element('#CauseModal');
        element.modal('show');
        MasterScope.$apply(function () {
            MasterScope.Cause_id_Model = $(obj).parent().children().eq(0).html();
            MasterScope.txtCauseCode_Model = $(obj).parent().children().eq(1).html();
            MasterScope.txtCauseName_Model = $(obj).parent().children().eq(2).html();
            MasterScope.txtCauseDescription_Model = $(obj).parent().children().eq(3).html();
            MasterScope.txtProblemType_code_Model = $(obj).parent().children().eq(4).html();

            MasterScope.txtProblemType_Model = $(obj).parent().children().eq(5).html();
            MasterScope.txtCauseCreatedBy_Model = $(obj).parent().children().eq(6).html();
            MasterScope.txtCauseCreatedDate_Model = $(obj).parent().children().eq(7).html();
            MasterScope.txtCauseActive_Model = $(obj).parent().children().eq(8).html();
        });


        //$("#Cause_id").val($(obj).parent().children().eq(0).html());
        //$("#txtCauseCode").val($(obj).parent().children().eq(1).html());
        //$("#txtCauseName").val($(obj).parent().children().eq(2).html());
        //$("#txtCauseDescription").val($(obj).parent().children().eq(3).html());
        //$("#txtProblemType").val($(obj).parent().children().eq(6).html());

        //$("#txtCauseCreatedBy").val($(obj).parent().children().eq(7).html());
        //$("#txtCauseCreatedDate").val($(obj).parent().children().eq(8).html());
        //$("#txtCauseActive").val($(obj).parent().children().eq(9).html());

        $("#Cause_Save").text("Update");
    }
    else if (MasterName == "Complaint Severity") {
        var element = angular.element('#ComplaintSeverityModal');
        element.modal('show');
        MasterScope.$apply(function () {
            MasterScope.ComplaintSeverity_id_Model = $(obj).parent().children().eq(0).html();
            MasterScope.txtComplaintSeverityCode_Model = $(obj).parent().children().eq(1).html();
            MasterScope.txtComplaintSeverityName_Model = $(obj).parent().children().eq(2).html();
            MasterScope.txtComplaintSeverityDescription_Model = $(obj).parent().children().eq(3).html();
            MasterScope.txtComplaintSeverityCreatedBy_Model = $(obj).parent().children().eq(4).html();
            MasterScope.txtComplaintSeverityCreatedDate_Model = $(obj).parent().children().eq(5).html();
            MasterScope.txtComplaintSeverityActive_Model = $(obj).parent().children().eq(6).html();
        });


        //$("#ComplaintSeverity_id").val($(obj).parent().children().eq(0).html());
        //$("#txtComplaintSeverityCode").val($(obj).parent().children().eq(1).html());
        //$("#txtComplaintSeverityName").val($(obj).parent().children().eq(2).html());
        //$("#txtComplaintSeverityDescription").val($(obj).parent().children().eq(3).html());
        //$("#txtComplaintSeverityCreatedBy").val($(obj).parent().children().eq(4).html());
        //$("#txtComplaintSeverityCreatedDate").val($(obj).parent().children().eq(5).html());
        //$("#txtComplaintSeverityActive").val($(obj).parent().children().eq(6).html());

        $("#ComplaintSeverity_Save").text("Update");
    }

    else if (MasterName == "Supplier Type") {
        var element = angular.element('#SupplierTypeModal');
        element.modal('show');
        MasterScope.$apply(function () {
            MasterScope.SupplierType_id_Model = $(obj).parent().children().eq(0).html();
            MasterScope.txtSupplierType_Model = $(obj).parent().children().eq(1).html();
            MasterScope.txtSupplierTypeName_Model = $(obj).parent().children().eq(2).html();
            MasterScope.txtSupplierTypeDescription_Model = $(obj).parent().children().eq(3).html();
            MasterScope.txtSupplierTypeCreatedBy_Model = $(obj).parent().children().eq(4).html();
            MasterScope.txtSupplierTypeCreatedDate_Model = $(obj).parent().children().eq(5).html();
            MasterScope.txtSupplierTypeActive_Model = $(obj).parent().children().eq(6).html();
        });

        //$("#SupplierType_id").val($(obj).parent().children().eq(0).html());
        //$("#txtSupplierTypeCode").val($(obj).parent().children().eq(1).html());
        //$("#txtSupplierTypeName").val($(obj).parent().children().eq(2).html());
        //$("#txtSupplierTypeDescription").val($(obj).parent().children().eq(3).html());
        //$("#txtSupplierTypeCreatedBy").val($(obj).parent().children().eq(4).html());
        //$("#txtSupplierTypeCreatedDate").val($(obj).parent().children().eq(5).html());
        //$("#txtSupplierTypeActive").val($(obj).parent().children().eq(6).html());

        $("#SupplierType_Save").text("Update");
    }
    else if (MasterName == "Breakage Category") {
        var element = angular.element('#BreakageCategoryModal');
        element.modal('show');
        MasterScope.$apply(function () {
            MasterScope.BreakageCategory_id_Model = $(obj).parent().children().eq(0).html();
            MasterScope.txtBreakageCategory_Model = $(obj).parent().children().eq(1).html();
            MasterScope.txtBreakageCategoryName_Model = $(obj).parent().children().eq(2).html();
            MasterScope.txtBreakageCategoryDescription_Model = $(obj).parent().children().eq(3).html();
            MasterScope.txtBreakageCategoryCreatedBy_Model = $(obj).parent().children().eq(4).html();
            MasterScope.txtBreakageCategoryCreatedDate_Model = $(obj).parent().children().eq(5).html();
            MasterScope.txtBreakageCategoryActive_Model = $(obj).parent().children().eq(6).html();
        });


        //$("#BreakageCategory_id").val($(obj).parent().children().eq(0).html());
        //$("#txtBreakageCategoryCode").val($(obj).parent().children().eq(1).html());
        //$("#txtBreakageCategoryName").val($(obj).parent().children().eq(2).html());
        //$("#txtBreakageCategoryDescription").val($(obj).parent().children().eq(3).html());
        //$("#txtBreakageCategoryCreatedBy").val($(obj).parent().children().eq(4).html());
        //$("#txtBreakageCategoryCreatedDate").val($(obj).parent().children().eq(5).html());
        //$("#txtBreakageCategoryActive").val($(obj).parent().children().eq(6).html());

        $("#BreakageCategory_Save").text("Update");
    }
    else if (MasterName == "Defect Type") {

        var element = angular.element('#DefectTypeModal');
        element.modal('show');
        MasterScope.$apply(function () {
            MasterScope.DefectType_id_Model = $(obj).parent().children().eq(0).html();
            MasterScope.txtDefectTypeCode_Model = $(obj).parent().children().eq(1).html();
            MasterScope.txtDefectTypeName_Model = $(obj).parent().children().eq(2).html();
            MasterScope.txtDefectTypeDescription_Model = $(obj).parent().children().eq(3).html();
            MasterScope.txtDefectProductType_code_Model = $(obj).parent().children().eq(5).html();
            MasterScope.txtDefectProductType_Model = $(obj).parent().children().eq(6).html();
            MasterScope.txtDefectProductCategory_code_Model = $(obj).parent().children().eq(8).html();
            MasterScope.txtDefectProductCategory_Model = $(obj).parent().children().eq(9).html();
            MasterScope.txtDefectTypeCreatedBy_Model = $(obj).parent().children().eq(10).html();
            MasterScope.txtDefectTypeCreatedDate_Model = $(obj).parent().children().eq(9).html();
            MasterScope.txtDefectTypeActive_Model = $(obj).parent().children().eq(10).html();
        });


        //$("#DefectType_id").val($(obj).parent().children().eq(0).html());
        //$("#txtDefectTypeCode").val($(obj).parent().children().eq(1).html());
        //$("#txtDefectTypeName").val($(obj).parent().children().eq(2).html());
        //$("#txtDefectTypeDescription").val($(obj).parent().children().eq(3).html());
        //$("#txtDefectProductType").val($(obj).parent().children().eq(6).html());
        //$("#txtDefectProductCategory").val($(obj).parent().children().eq(9).html());
        //$("#txtDefectTypeCreatedBy").val($(obj).parent().children().eq(10).html());
        //$("#txtDefectTypeCreatedDate").val($(obj).parent().children().eq(11).html());
        //$("#txtDefectTypeActive").val($(obj).parent().children().eq(12).html());

        $("#DefectType_Save").text("Update");
    }
    else if (MasterName == "Recovery Type") {
        var element = angular.element('#RecoveryTypeModal');
        element.modal('show');
        MasterScope.$apply(function () {
            MasterScope.RecoveryType_id_Model = $(obj).parent().children().eq(0).html();
            MasterScope.txtRecoveryTypeCode_Model = $(obj).parent().children().eq(1).html();
            MasterScope.txtRecoveryTypeName_Model = $(obj).parent().children().eq(2).html();
            MasterScope.txtRecoveryTypeDescription_Model = $(obj).parent().children().eq(3).html();
            MasterScope.txtRecoveryTypeCreatedBy_Model = $(obj).parent().children().eq(4).html();
            MasterScope.txtRecoveryTypeCreatedDate_Model = $(obj).parent().children().eq(5).html();
            MasterScope.txtRecoveryTypeActive_Model = $(obj).parent().children().eq(6).html();
        });
        //$("#RecoveryType_id").val($(obj).parent().children().eq(0).html());
        //$("#txtRecoveryTypeCode").val($(obj).parent().children().eq(1).html());
        //$("#txtRecoveryTypeName").val($(obj).parent().children().eq(2).html());
        //$("#txtRecoveryTypeDescription").val($(obj).parent().children().eq(3).html());
        //$("#txtRecoveryTypeCreatedBy").val($(obj).parent().children().eq(4).html());
        //$("#txtRecoveryTypeCreatedDate").val($(obj).parent().children().eq(5).html());
        //$("#txtRecoveryTypeActive").val($(obj).parent().children().eq(6).html());

        $("#RecoveryType_Save").text("Update");
    }
    else if (MasterName == "Survey Criteria") {

        var element = angular.element('#SurveyCriteriaModal');
        element.modal('show');
        MasterScope.$apply(function () {
            MasterScope.SurveyCriteria_id_Model = $(obj).parent().children().eq(0).html();
            MasterScope.txtSurveyCriteriaCode_Model = $(obj).parent().children().eq(1).html();
            MasterScope.txtSurveyCriteriaName_Model = $(obj).parent().children().eq(2).html();
            MasterScope.txtSurveyCriteriaDescription_Model = $(obj).parent().children().eq(3).html();
            MasterScope.txtSurveyCriteriaProductType_code_Model = $(obj).parent().children().eq(5).html();

            MasterScope.txtSurveyCriteriaProductType_Model = $(obj).parent().children().eq(6).html();
            MasterScope.txtSurveyCriteriaProductCategory_code_Model = $(obj).parent().children().eq(8).html();

            MasterScope.txtSurveyCriteriaProductCategory_Model = $(obj).parent().children().eq(9).html();
            MasterScope.txtSurveyCriteriaBreakageCategory_code_Model = $(obj).parent().children().eq(11).html();

            MasterScope.txtSurveyCriteriaBreakageCategoryName_Model = $(obj).parent().children().eq(12).html();


            MasterScope.txtSurveyCriteriaCreatedBy_Model = $(obj).parent().children().eq(13).html();
            MasterScope.txtSurveyCriteriaCreatedDate_Model = $(obj).parent().children().eq(14).html();
            MasterScope.txtSurveyCriteriaActive_Model = $(obj).parent().children().eq(15).html();
        });


        //$("#SurveyCriteria_id").val($(obj).parent().children().eq(0).html());
        //$("#txtSurveyCriteriaCode").val($(obj).parent().children().eq(1).html());
        //$("#txtSurveyCriteriaName").val($(obj).parent().children().eq(2).html());
        //$("#txtSurveyCriteriaDescription").val($(obj).parent().children().eq(3).html());
        //$("#txtSurveyCriteriaProductType").val($(obj).parent().children().eq(6).html());
        //$("#txtSurveyCriteriaProductCategory").val($(obj).parent().children().eq(9).html());
        //$("#txtSurveyCriteriaBreakageCategoryName").val($(obj).parent().children().eq(12).html());
        //$("#txtSurveyCriteriaCreatedBy").val($(obj).parent().children().eq(13).html());
        //$("#txtSurveyCriteriaCreatedDate").val($(obj).parent().children().eq(14).html());
        //$("#txtSurveyCriteriaActive").val($(obj).parent().children().eq(15).html());

        $("#SurveyCriteria_Save").text("Update");
    }
    else if (MasterName == "Compensation Mode") {

        var element = angular.element('#CompensationModeModal');
        element.modal('show');
        MasterScope.$apply(function () {
            MasterScope.CompensationMode_id_Model = $(obj).parent().children().eq(0).html();
            MasterScope.txtCompensationModeCode_Model = $(obj).parent().children().eq(1).html();
            MasterScope.txtCompensationModeName_Model = $(obj).parent().children().eq(2).html();
            MasterScope.txtCompensationModeDescription_Model = $(obj).parent().children().eq(3).html();
            MasterScope.txtCompensationModeProductType_code_Model = $(obj).parent().children().eq(5).html();

            MasterScope.txtCompensationModeProductType_Model = $(obj).parent().children().eq(6).html();
            MasterScope.txtCompensationModeCreatedBy_Model = $(obj).parent().children().eq(7).html();
            MasterScope.txtCompensationModeCreatedDate_Model = $(obj).parent().children().eq(8).html();
            MasterScope.txtCompensationModeActive_Model = $(obj).parent().children().eq(9).html();
        });

        //$("#CompensationMode_id").val($(obj).parent().children().eq(0).html());
        //$("#txtCompensationModeCode").val($(obj).parent().children().eq(1).html());
        //$("#txtCompensationModeName").val($(obj).parent().children().eq(2).html());
        //$("#txtCompensationModeDescription").val($(obj).parent().children().eq(3).html());
        //$("#txtCompensationModeProductType").val($(obj).parent().children().eq(6).html());
        //$("#txtCompensationModeCreatedBy").val($(obj).parent().children().eq(7).html());
        //$("#txtCompensationModeCreatedDate").val($(obj).parent().children().eq(8).html());
        //$("#txtCompensationModeActive").val($(obj).parent().children().eq(9).html());

        $("#CompensationMode_Save").text("Update");
    }
    else if (MasterName == "Observations Master") {

        var element = angular.element('#ObservationModal');
        element.modal('show');
        MasterScope.$apply(function () {
            MasterScope.Observation_id_Model = $(obj).parent().children().eq(0).html();
            MasterScope.txtObservationCode_Model = $(obj).parent().children().eq(1).html();
            MasterScope.txtObservationName_Model = $(obj).parent().children().eq(2).html();
            MasterScope.txtObservationDescription_Model = $(obj).parent().children().eq(3).html();
            MasterScope.txtObservationProductType_code_Model = $(obj).parent().children().eq(4).html();

            MasterScope.txtObservationProductType_Model = $(obj).parent().children().eq(5).html();
            MasterScope.txtObservationProductCategory_code_Model = $(obj).parent().children().eq(6).html();

            MasterScope.txtObservationProductCategory_Model = $(obj).parent().children().eq(7).html();
            MasterScope.txtObservationCreatedBy_Model = $(obj).parent().children().eq(8).html();
            MasterScope.txtObservationCreatedDate_Model = $(obj).parent().children().eq(9).html();
            MasterScope.txtObservationActive_Model = $(obj).parent().children().eq(10).html();
            alert(MasterScope.txtObservationProductCategory_Model);
        });


        //$("#Observation_id").val($(obj).parent().children().eq(0).html());
        //$("#txtObservationCode").val($(obj).parent().children().eq(1).html());
        //$("#txtObservationName").val($(obj).parent().children().eq(2).html());
        //$("#txtObservationDescription").val($(obj).parent().children().eq(3).html());
        //$("#txtObservationProductType").val($(obj).parent().children().eq(6).html());
        //$("#txtObservationProductCategory").val($(obj).parent().children().eq(9).html());
        //$("#txtObservationCreatedBy").val($(obj).parent().children().eq(10).html());
        //$("#txtObservationCreatedDate").val($(obj).parent().children().eq(11).html());
        //$("#txtObservationActive").val($(obj).parent().children().eq(12).html());

        $("#Observation_Save").text("Update");
    }
    else if (MasterName == "Document Master") {

        var element = angular.element('#DocumentMasterModal');
        element.modal('show');
        MasterScope.$apply(function () {
            MasterScope.txtDocumentMasterid_Model = $(obj).parent().children().eq(0).html();
            MasterScope.txtDocumentMasterCode_Model = $(obj).parent().children().eq(1).html();
            MasterScope.txtDocumentMasterName_Model = $(obj).parent().children().eq(2).html();
            MasterScope.txtDocumentMasterCreatedBy_Model = $(obj).parent().children().eq(3).html();
            MasterScope.txtDocumentMasterCreatedDate_Model = $(obj).parent().children().eq(4).html();
            $("#Active").val($(obj).parent().children().eq(5).html());
        });
        $("#DocumentMaster_Save").text("Update");

    }



    //var scope = angular.element(document.getElementById("MainWrap")).scope();
    //angular.injector(['ng', 'DIMSApp']).get("DIMSFactory").getMasterEditData(MasterName).success(function (response) {
    //    //scope.getMasterTableData(response.data);

    //    var data = JSON.parse(response.tabledata);
    //    alert(data.length);
    //    //$("#txtCountryCode").val()
    //});

    //$scope.Country_id_Model = "";
    //$scope.txtCountryCode_Model = "";
    //$("#Country_Save").text("Update");
    //$("#CountryModal").modal('show');
}

function getFieldLookUpData(response, name, pageHeading) {
    var data = JSON.parse(response.tabledata);
    var element = angular.element('#LookUpModal');
    element.modal('show');
    $("#PopHeading").text(pageHeading);

    if (data == "") {

        $("#MasterStatus").text("No Records found");
        //$("#PopUpTable").dataTable().fnDestroy();
        $('#PopUpTable').empty();
    } else {
        $("#MasterStatus").text("");

        $("#PopUpTable").dataTable().fnDestroy();
        $('#PopUpTable').empty();

        var columns = addAllColumnHeaders(data, "PopUpTable");

        for (var i = 0 ; i < data.length ; i++) {
            var row$ = $('<tr onclick="' + name + '(this)" style="cursor:pointer;" />');
            for (var colIndex = 0 ; colIndex < columns.length ; colIndex++) {
                var cellValue = data[i][columns[colIndex]];

                if (cellValue == null) { cellValue = ""; }
                row$.append($('<td/>').html(cellValue));
            }
            $("#PopUpTable").append(row$);
        }

        $("#PopUpTable tr td:nth-child(1)").hide();
        $("#PopUpTable tr th:nth-child(1)").hide();

        if (MasterName == "State") {
            $("#PopUpTable tr td:nth-child(4)").hide();
            $("#PopUpTable tr th:nth-child(4)").hide();
        } else if (MasterName == "City") {
            $("#PopUpTable tr td:nth-child(4)").hide();
            $("#PopUpTable tr th:nth-child(4)").hide();
        }
        else if (MasterName == "Location") {
            $("#PopUpTable tr td:nth-child(4)").hide();
            $("#PopUpTable tr th:nth-child(4)").hide();
            $("#PopUpTable tr td:nth-child(6)").hide();
            $("#PopUpTable tr th:nth-child(6)").hide();
            $("#PopUpTable tr td:nth-child(8)").hide();
            $("#PopUpTable tr th:nth-child(8)").hide();
        }
        else if (MasterName == "Depo Master") {
            $("#PopUpTable tr td:nth-child(3)").hide();
            $("#PopUpTable tr th:nth-child(3)").hide();
            $("#PopUpTable tr td:nth-child(5)").hide();
            $("#PopUpTable tr th:nth-child(5)").hide();
            $("#PopUpTable tr td:nth-child(7)").hide();
            $("#PopUpTable tr th:nth-child(7)").hide();

        }
        else if (MasterName == "CurrencyMaster") {

            //$("#PopUpTable tr td:nth-child(1)").hide();
            //$("#PopUpTable tr th:nth-child(1)").hide();

        }
        else if (MasterName == "Group Company Details") {
            $("#PopUpTable tr td:nth-child(4)").hide();
            $("#PopUpTable tr th:nth-child(4)").hide();
            $("#PopUpTable tr td:nth-child(6)").hide();
            $("#PopUpTable tr th:nth-child(6)").hide();
            $("#PopUpTable tr td:nth-child(8)").hide();
            $("#PopUpTable tr th:nth-child(8)").hide();
        }
        else if (MasterName == "Company Details") {
            $("#PopUpTable tr td:nth-child(4)").hide();
            $("#PopUpTable tr th:nth-child(4)").hide();
            $("#PopUpTable tr td:nth-child(6)").hide();
            $("#PopUpTable tr th:nth-child(6)").hide();
            $("#PopUpTable tr td:nth-child(8)").hide();
            $("#PopUpTable tr th:nth-child(8)").hide();
        }

        var table = $("#PopUpTable").dataTable({
            "bDestroy": true,
            'scroll': true
        });

        $('#PopUpTable tbody').on('click', 'tr', function () {
            if ($(this).hasClass('selected')) {
                $(this).removeClass('selected');
            }
            else {
                table.$('tr.selected').removeClass('selected');
                $(this).addClass('selected');
            }
        });
    }
}



// MASTER CONTROLLER
DIMS.controller('CustomerMasterCtrl', function ($scope, $location, $compile, $http, DIMSFactory) {
    MasterScope = $scope;
    $scope.templatesettings = { HeaderTitle: "CustomerMaster" };
    $scope.go = function (path) {
        CheckUserSession();
        $location.path(path);
    };
    $scope.GetFieldData = function (Methodname, MasterType, Heading) {


        DIMSFactory.getMasterClickData(MasterType).success(function (response) {
            $scope.txtCustomer_GroupName_Model;
            $scope.txtCustomer_Groupcode_Model;
            $scope.txtCustomer_Categorycode_Model;
            $scope.txtCustomer_CategoryName_Model;
            $scope.txtCustomer_Typecode_Model;
            $scope.txtCustomer_TypeName_Model;
            $scope.txtProduct_Typecode_Model;
            $scope.txtProduct_TypeName_Model;
            $scope.txtProduct_Categorycode_Model;
            $scope.txtProduct_CategoryName_Model;
            $scope.txtLocation_Code_Model;
            $scope.txtLocation_CodeName_Model;
            $scope.txtCity_Code_Model;
            $scope.txtCity_CodeName_Model;
            $scope.txtState_code_Model;
            $scope.txtState_Name_Model;
            $scope.txtArea_Code_Model;
            $scope.txtArea_CodeName_Model;
            $scope.txtCountry_Code_Model;
            $scope.txtCountry_CodeName_Model;
            getFieldLookUpData(response, Methodname, Heading);
        });
    };
    //SAVE
    $scope.SaveCUSTOMERFunction = function () {

        var Flag = 0;
        if ($scope.txtCustomerCode_Model == "" || $scope.txtCustomerCode_Model == null) {
            Flag = Flag + 1;
            $("#txtCustomerCode").css("border-color", "red");
        }
        else {
            $("#txtCustomerCode").css("border-color", "#d2d6de");
        }
        if ($scope.txtCustomerName_Model == "" || $scope.txtCustomerName_Model == null) {
            Flag = Flag + 1;
            $("#txtCustomerName").css("border-color", "red");
        }
        else {
            $("#txtCustomerName").css("border-color", "#d2d6de");
        }
        if ($scope.ddlcustomerActive_Model == "" || $scope.ddlcustomerActive_Model == null || $scope.ddlcustomerActive_Model == "---Please select---") {
            Flag = Flag + 1;
            $("#ddlcustomerActive").css("border-color", "red");
        }
        else {
            $("#ddlcustomerActive").css("border-color", "#d2d6de");
        }
        if (Flag > 0) {

            console.log("Flag : " + Flag);
        }
        else {

            console.log("Flag : " + Flag);

            if ($scope.txtCustomerOldCode_Model == undefined) { $scope.txtCustomerOldCode_Model = ""; }
            if ($scope.txtContactName1_Model == undefined) { $scope.txtContactName1_Model = ""; }
            if ($scope.txtContactDesignation1_Model == undefined) { $scope.txtContactDesignation1_Model = ""; }
            if ($scope.txtContactName2_Model == undefined) { $scope.txtContactName2_Model = ""; }
            if ($scope.txtContactDesignation2_Model == undefined) { $scope.txtContactDesignation2_Model = ""; }            // if ($scope.Delay == true) { } else { $scope.Delay = false; }
            if ($scope.txtVATNo_Model == undefined) { $scope.txtVATNo_Model = ""; }
            if ($scope.txtCustomer_GroupName_Model == undefined) { $scope.txtCustomer_GroupName_Model = ""; }
            if ($scope.txtCustomer_Groupcode_Model == undefined) { $scope.txtCustomer_Groupcode_Model = ""; }
            if ($scope.txtCustomer_CategoryName_Model == undefined) { $scope.txtCustomer_CategoryName_Model = ""; }
            if ($scope.txtCustomer_Categorycode_Model == undefined) { $scope.txtCustomer_Categorycode_Model = ""; }
            if ($scope.txtCustomer_TypeName_Model == undefined) { $scope.txtCustomer_TypeName_Model = ""; }
            if ($scope.txtCustomer_Typecode_Model == undefined) { $scope.txtCustomer_Typecode_Model = ""; }
            if ($scope.txtProduct_TypeName_Model == undefined) { $scope.txtProduct_TypeName_Model = ""; }
            if ($scope.txtProduct_Typecode_Model == undefined) { $scope.txtProduct_Typecode_Model = ""; }
            if ($scope.txtProduct_CategoryName_Model == undefined) { $scope.txtProduct_CategoryName_Model = ""; }
            if ($scope.txtProduct_Categorycode_Model == undefined) { $scope.txtProduct_Categorycode_Model = ""; }


            if ($scope.txtRoomFloor_Model == undefined) { $scope.txtRoomFloor_Model = ""; }
            if ($scope.txtBlockBuilding_Model == undefined) { $scope.txtBlockBuilding_Model = ""; }
            if ($scope.txtStreetPoBox_Model == undefined) { $scope.txtStreetPoBox_Model = ""; }
            if ($scope.txtZipCode_Model == undefined) { $scope.txtZipCode_Model = ""; }
            if ($scope.txtAddress_Model == undefined) { $scope.txtAddress_Model = ""; }            // if ($scope.Delay == true) { } else { $scope.Delay = false; }
            if ($scope.txtEmail_Model == undefined) { $scope.txtEmail_Model = ""; }
            if ($scope.txtPhone1_Model == undefined) { $scope.txtPhone1_Model = ""; }
            if ($scope.txtPhone2_Model == undefined) { $scope.txtPhone2_Model = ""; }
            if ($scope.txtMobile_Model == undefined) { $scope.txtMobile_Model = ""; }
            if ($scope.txtFax_Model == undefined) { $scope.txtFax_Model = ""; }

            if ($scope.chbCustomerWebInterface_Model == true) { } else { $scope.chbCustomerWebInterface_Model = false; }
            if ($scope.txtLocation_CodeName_Model == undefined) { $scope.txtLocation_CodeName_Model = ""; }
            if ($scope.txtLocation_Code_Model == undefined) { $scope.txtLocation_Code_Model = ""; }
            if ($scope.txtCity_CodeName_Model == undefined) { $scope.txtCity_CodeName_Model = ""; }
            if ($scope.txtCity_Code_Model == undefined) { $scope.txtCity_Code_Model = ""; }
            if ($scope.txtState_Name_Model == undefined) { $scope.txtState_Name_Model = ""; }
            if ($scope.txtState_code_Model == undefined) { $scope.txtState_code_Model = ""; }
            if ($scope.txtArea_CodeName_Model == undefined) { $scope.txtArea_CodeName_Model = ""; }
            if ($scope.txtArea_Code_Model == undefined) { $scope.txtArea_Code_Model = ""; }
            if ($scope.txtCountry_CodeName_Model == true) { } else { $scope.txtCountry_CodeName_Model = false; }
            if ($scope.txtCountry_Code_Model == undefined) { $scope.txtCountry_Code_Model = ""; }
            if ($scope.txtTINNo_Model == undefined) { $scope.txtTINNo_Model }
            if ($scope.customermaster_id_Model == undefined) { $scope.customermaster_id_Model = "" }
            var RegistrationData = JSON.stringify({
                MasterType: "Customer Master",
                ID: $scope.customermaster_id_Model,
                CUSTOMER_CODE: $scope.txtCustomerCode_Model,
                CUSTOMER_NAME: $scope.txtCustomerName_Model,
                CUSTOMER_SAP_CODE: $scope.txtCustomerOldCode_Model,


                CONTACT_PERSON1_NAME: $scope.txtContactName1_Model,
                CONTACT_PERSON2_NAME: $scope.txtContactName2_Model,
                CONTACT_PERSON1_DESIGNATION: $scope.txtContactDesignation1_Model,
                CONTACT_PERSON2_DESIGNATION: $scope.txtContactDesignation2_Model,
                CUSTOMER_GROUP_CODE: $scope.txtCustomer_Groupcode_Model,
                CUSTOMER_GROUP_NAME: $scope.txtCustomer_GroupName_Model,
                CUSTOMER_CATEGORY_CODE: $scope.txtCustomer_Categorycode_Model,
                CUSTOMER_CATEGORY_NAME: $scope.txtCustomer_CategoryName_Model,
                CUSTOMER_TYPE_CODE: $scope.txtCustomer_Typecode_Model,
                CUSTOMER_TYPE_NAME: $scope.txtCustomer_TypeName_Model,
                PRODUCT_TYPE_CODE: $scope.txtProduct_Typecode_Model,
                PRODUCT_TYPE_NAME: $scope.txtProduct_TypeName_Model,
                PRODUCT_CATEGORY_CODE: $scope.txtProduct_Categorycode_Model,
                PRODUCT_CATEGORY_NAME: $scope.txtProduct_CategoryName_Model,

                EMAIL: $scope.txtEmail_Model,
                ROOM_FLOOR: $scope.txtRoomFloor_Model,
                BLOCK_BUILDING: $scope.txtBlockBuilding_Model,
                STREET_PO_BOX: $scope.txtStreetPoBox_Model,
                ZIP_CODE: $scope.txtZipCode_Model,
                ADDRESS: $scope.txtAddress_Model,
                PHONE1: $scope.txtPhone1_Model,
                PHONE2: $scope.txtPhone2_Model,
                MOBILE: $scope.txtMobile_Model,
                FAX: $scope.txtFax_Model,
                VAT_NO: $scope.txtVATNo_Model,
                TIN_NO: $scope.txtTINNo_Model,


                CUSTOMER_WEB_INTERFACE: $scope.chbCustomerWebInterface_Model,
                LOCATION_CODE: $scope.txtLocation_Code_Model,
                LOCATION_NAME: $scope.txtLocation_CodeName_Model,
                CITY_CODE: $scope.txtCity_Code_Model,
                CITY_NAME: $scope.txtCity_CodeName_Model,
                STATE_CODE: $scope.txtState_code_Model,
                STATE_NAME: $scope.txtState_Name_Model,
                AREA_CODE: $scope.txtArea_Code_Model,
                AREA_NAME: $scope.txtArea_CodeName_Model,
                COUNTRY_CODE: $scope.txtCountry_Code_Model,
                COUNTRY_NAME: $scope.txtCountry_CodeName_Model,
                CREATED_BY: $scope.txtCreatedBy_Model,
                CREATED_DATE: $scope.txtCreatedDate_Model,
                ACTIVE: $scope.ddlcustomerActive_Model
            });

            $http({
                method: 'POST',
                url: '../../Master/SaveCustomerMasterData',
                data: { RegistrationData: RegistrationData },
            }).then(function successCallback(response) {
                $scope.listcustomerFunction();

            }, function errorCallback(response) {
                alert("Error : " + response);
            });

        }
    }
    $scope.listcustomerFunction = function () {
        $("#save").prop('disabled', true);
        var Val = JSON.stringify({

            MasterType: "customerMasterData"
        });
        $http({
            method: 'POST',
            url: '../../Master/listcustomerMasterData',
            data: { val: Val }
        }).then(function successCallback(response) {
            $("#addcustomerview").hide();
            $("#listcustomer").show();
            var data = JSON.parse(response.data.tabledata);
            //alert(JSON.stringify(data));
            $("#listcustomerview").dataTable().fnDestroy();
            $('#listcustomerview').empty();
            var columns = addAllColumnHeadersForMasters(data, "listcustomerview");

            for (var i = 0 ; i < data.length ; i++) {

                var row$ = $('<tr />');
                for (var colIndex = 0 ; colIndex < columns.length ; colIndex++) {
                    var cellValue = data[i][columns[colIndex]];

                    if (cellValue == null) {
                        cellValue = "";
                    }
                    row$.append($('<td/>').html(cellValue));
                }

                row$.append($('<td onclick="EditcustomerData(this)" />').html('<a style="background-color: #9760b3; border-color: #9760b3; padding: 6px 6px;" class="btn btn-info"><i class="fa fa-fw fa-pencil-square-o"></i>Edit</a>'));
                row$.append($('<td/>').html('<a class="btn btn-danger" style="background-color: #c71c22; border-color: #c71c22; padding: 6px 6px;" onclick="DeleteMasterData(' + "" + ')" title="delete"><i class="fa fa-fw fa-trash-o"></i>Delete</a>'));

                $("#listcustomerview").append(row$);


            }

            $("#listcustomerview tr td:nth-child(1)").hide();
            $("#listcustomerview tr th:nth-child(1)").hide();
            $("#listcustomerview tr td:nth-child(6)").hide();
            $("#listcustomerview tr th:nth-child(6)").hide(); $("#listcustomerview tr td:nth-child(7)").hide();
            $("#listcustomerview tr th:nth-child(7)").hide(); $("#listcustomerview tr td:nth-child(8)").hide();
            $("#listcustomerview tr th:nth-child(8)").hide(); $("#listcustomerview tr td:nth-child(9)").hide();
            $("#listcustomerview tr th:nth-child(9)").hide(); $("#listcustomerview tr td:nth-child(10)").hide();
            $("#listcustomerview tr th:nth-child(10)").hide();
            $("#listcustomerview tr th:nth-child(11)").hide(); $("#listcustomerview tr td:nth-child(11)").hide();
            $("#listcustomerview tr th:nth-child(12)").hide(); $("#listcustomerview tr td:nth-child(12)").hide();
            $("#listcustomerview tr th:nth-child(13)").hide(); $("#listcustomerview tr td:nth-child(13)").hide();
            $("#listcustomerview tr th:nth-child(15)").hide(); $("#listcustomerview tr td:nth-child(15)").hide();
            $("#listcustomerview tr th:nth-child(17)").hide(); $("#listcustomerview tr td:nth-child(17)").hide();
            $("#listcustomerview tr th:nth-child(19)").hide(); $("#listcustomerview tr td:nth-child(19)").hide();
            $("#listcustomerview tr th:nth-child(21)").hide(); $("#listcustomerview tr td:nth-child(21)").hide();
            $("#listcustomerview tr th:nth-child(22)").hide(); $("#listcustomerview tr td:nth-child(22)").hide();
            $("#listcustomerview tr th:nth-child(23)").hide(); $("#listcustomerview tr td:nth-child(23)").hide();
            $("#listcustomerview tr th:nth-child(24)").hide(); $("#listcustomerview tr td:nth-child(24)").hide();

            $("#listcustomerview tr th:nth-child(28)").hide(); $("#listcustomerview tr td:nth-child(28)").hide();
            $("#listcustomerview tr th:nth-child(29)").hide(); $("#listcustomerview tr td:nth-child(29)").hide();
            $("#listcustomerview tr th:nth-child(30)").hide(); $("#listcustomerview tr td:nth-child(30)").hide();
            $("#listcustomerview tr th:nth-child(31)").hide(); $("#listcustomerview tr td:nth-child(31)").hide();
            $("#listcustomerview tr th:nth-child(32)").hide(); $("#listcustomerview tr td:nth-child(32)").hide();
            $("#listcustomerview tr th:nth-child(33)").hide(); $("#listcustomerview tr td:nth-child(33)").hide();
            $("#listcustomerview tr th:nth-child(34)").hide(); $("#listcustomerview tr td:nth-child(34)").hide();
            $("#listcustomerview tr th:nth-child(35)").hide(); $("#listcustomerview tr td:nth-child(35)").hide();
            $("#listcustomerview tr th:nth-child(36)").hide(); $("#listcustomerview tr td:nth-child(36)").hide();
            $("#listcustomerview tr th:nth-child(37)").hide(); $("#listcustomerview tr td:nth-child(37)").hide();

            $("#listcustomerview tr th:nth-child(38)").hide(); $("#listcustomerview tr td:nth-child(38)").hide();
            $("#listcustomerview tr th:nth-child(39)").hide(); $("#listcustomerview tr td:nth-child(39)").hide();
            $("#listcustomerview tr th:nth-child(40)").hide(); $("#listcustomerview tr td:nth-child(40)").hide();
            $("#listcustomerview tr th:nth-child(41)").hide(); $("#listcustomerview tr td:nth-child(41)").hide();
            $("#listcustomerview tr th:nth-child(42)").hide(); $("#listcustomerview tr td:nth-child(42)").hide();



            var table = $("#listcustomerview").dataTable({
                "bDestroy": true,
                'scroll': true
            });
        }, function errorCallback(response) {
            alert("Error : " + response);
        });

    }
    $scope.NewcustomerFunction = function () {
        $("#save").prop('disabled', false);

        $("#listcustomer").hide();
        $("#addcustomerview").show();
        $('#save').text("Save");
        $scope.customermaster_id_Model = "";
        $scope.txtCustomerCode_Model = "";
        $scope.txtCustomerName_Model = "";
        $scope.txtCustomerOldCode_Model = "";
        $scope.txtContactName1_Model = "";
        $scope.txtContactDesignation1_Model = "";
        $scope.txtContactName2_Model = "";
        $scope.txtContactDesignation2_Model = "";
        $scope.txtVATNo_Model = "";

        $scope.txtTINNo_Model = "";
        $scope.txtCustomer_Groupcode_Model = "";
        $scope.txtCustomer_GroupName_Model = "";
        $scope.txtCustomer_Categorycode_Model = "";
        $scope.txtCustomer_CategoryName_Model = "";
        $scope.txtCustomer_Typecode_Model = "";
        $scope.txtCustomer_TypeName_Model = "";
        $scope.txtProduct_Typecode_Model = "";


        $scope.txtProduct_TypeName_Model = "";
        $scope.txtProduct_Categorycode_Model = "";
        $scope.txtProduct_CategoryName_Model = "";
        $scope.txtRoomFloor_Model = "";
        $scope.txtBlockBuilding_Model = "";
        $scope.txtStreetPoBox_Model = "";
        $scope.txtZipCode_Model = "";
        $scope.txtAddress_Model = "";

        $scope.txtEmail_Model = "";
        $scope.txtPhone1_Model = "";
        $scope.txtPhone2_Model = "";
        $scope.txtMobile_Model = "";
        $scope.txtFax_Model = "";

        $scope.chbCustomerWebInterface_Model = false;

        // chbCustomerWebInterface_Model = $(obj).parent().children().eq(30).html();
        $scope.txtLocation_Code_Model = "";
        $scope.txtLocation_CodeName_Model = "";

        $scope.txtCity_Code_Model = "";
        $scope.txtCity_CodeName_Model = "";
        $scope.txtState_code_Model = "";
        $scope.txtState_Name_Model = "";
        $scope.txtArea_Code_Model = "";
        $scope.txtArea_CodeName_Model = "";
        $scope.txtCountry_Code_Model = "";
        $scope.txtCountry_CodeName_Model = "";

        $scope.txtCreatedBy_Model = "";
        $scope.txtCreatedDate_Model = "";
        $scope.ddlcustomerActive_Model = "---Please select---";
        //$('#ddlcustomerActive').val("0");

        //if ($(obj).parent().children().eq(43).html() == "Y") {
        //    $('#ddlcustomerActive').val("YES");
        //} else {
        //    $('#ddlcustomerActive').val("NO");
        //}

    }
});
function EditcustomerData(obj, DIMSFactory) {
    $("#listcustomer").hide();
    $("#addcustomerview").show();
    $('#save').text("Update");
    $("#save").prop('disabled', false);

    MasterScope.$apply(function () {
        MasterScope.customermaster_id_Model = $(obj).parent().children().eq(0).html();
        MasterScope.txtCustomerCode_Model = $(obj).parent().children().eq(1).html();
        MasterScope.txtCustomerName_Model = $(obj).parent().children().eq(2).html();
        MasterScope.txtCustomerOldCode_Model = $(obj).parent().children().eq(3).html();
        MasterScope.txtContactName1_Model = $(obj).parent().children().eq(4).html();
        MasterScope.txtContactDesignation1_Model = $(obj).parent().children().eq(5).html();
        MasterScope.txtContactName2_Model = $(obj).parent().children().eq(6).html();
        MasterScope.txtContactDesignation2_Model = $(obj).parent().children().eq(7).html();
        MasterScope.txtVATNo_Model = $(obj).parent().children().eq(8).html();

        MasterScope.txtTINNo_Model = $(obj).parent().children().eq(9).html();
        MasterScope.txtCustomer_Groupcode_Model = $(obj).parent().children().eq(10).html();
        MasterScope.txtCustomer_GroupName_Model = $(obj).parent().children().eq(11).html();
        MasterScope.txtCustomer_Categorycode_Model = $(obj).parent().children().eq(12).html();
        MasterScope.txtCustomer_CategoryName_Model = $(obj).parent().children().eq(13).html();
        MasterScope.txtCustomer_Typecode_Model = $(obj).parent().children().eq(14).html();
        MasterScope.txtCustomer_TypeName_Model = $(obj).parent().children().eq(15).html();
        MasterScope.txtProduct_Typecode_Model = $(obj).parent().children().eq(16).html();


        MasterScope.txtProduct_TypeName_Model = $(obj).parent().children().eq(17).html();


        MasterScope.txtProduct_Categorycode_Model = $(obj).parent().children().eq(18).html();
        MasterScope.txtProduct_CategoryName_Model = $(obj).parent().children().eq(19).html();
        MasterScope.txtRoomFloor_Model = $(obj).parent().children().eq(20).html();
        MasterScope.txtBlockBuilding_Model = $(obj).parent().children().eq(21).html();
        MasterScope.txtStreetPoBox_Model = $(obj).parent().children().eq(22).html();
        MasterScope.txtZipCode_Model = $(obj).parent().children().eq(23).html();
        MasterScope.txtAddress_Model = $(obj).parent().children().eq(24).html();

        MasterScope.txtEmail_Model = $(obj).parent().children().eq(25).html();
        MasterScope.txtPhone1_Model = $(obj).parent().children().eq(26).html();
        MasterScope.txtPhone2_Model = $(obj).parent().children().eq(27).html();
        MasterScope.txtMobile_Model = $(obj).parent().children().eq(28).html();
        MasterScope.txtFax_Model = $(obj).parent().children().eq(29).html();
        //alert($(obj).parent().children().eq(30).html());
        if ($(obj).parent().children().eq(30).html() == "True") {

            MasterScope.chbCustomerWebInterface_Model = true;
        }
        else {
            MasterScope.chbCustomerWebInterface_Model = false;
        }
        //MasterScope.chbCustomerWebInterface_Model = $(obj).parent().children().eq(30).html();
        MasterScope.txtLocation_Code_Model = $(obj).parent().children().eq(31).html();
        MasterScope.txtLocation_CodeName_Model = $(obj).parent().children().eq(32).html();

        MasterScope.txtCity_Code_Model = $(obj).parent().children().eq(33).html();
        MasterScope.txtCity_CodeName_Model = $(obj).parent().children().eq(34).html();
        MasterScope.txtState_code_Model = $(obj).parent().children().eq(35).html();
        MasterScope.txtState_Name_Model = $(obj).parent().children().eq(36).html();
        MasterScope.txtArea_Code_Model = $(obj).parent().children().eq(37).html();
        MasterScope.txtArea_CodeName_Model = $(obj).parent().children().eq(38).html();
        MasterScope.txtCountry_Code_Model = $(obj).parent().children().eq(39).html();
        MasterScope.txtCountry_CodeName_Model = $(obj).parent().children().eq(40).html();

        MasterScope.txtCreatedBy_Model = $(obj).parent().children().eq(41).html();
        var date = $(obj).parent().children().eq(42).html().split('T');
        var datefr = date[0].split('-');
        var date2 = datefr[2] + '/' + datefr[1] + '/' + datefr[0];
        MasterScope.txtNoticeCreatedDate_Model = date2;


        MasterScope.txtCreatedDate_Model = date2;
        //MasterScope.ddlcustomerActive_Model = $(obj).parent().children().eq(43).html();

        if ($(obj).parent().children().eq(43).html() == "Y") {
            //$('#ddlcustomerActive').val("YES");
            MasterScope.ddlcustomerActive_Model = "YES";
        } else {
            //$('#ddlcustomerActive').val("NO");
            MasterScope.ddlcustomerActive_Model = "NO";
        }
    });



}
function GetCustomer_groupNameLookupData(obj) {
    MasterScope.$apply(function () {
        MasterScope.txtCustomer_Groupcode_Model = $(obj).children().eq(1).html();
        MasterScope.txtCustomer_GroupName_Model = $(obj).children().eq(2).html();

    });
    var element = angular.element('#LookUpModal');
    element.modal('hide');
}
function GetCustomer_CategoryNameLookupData(obj) {
    MasterScope.$apply(function () {
        MasterScope.txtCustomer_Categorycode_Model = $(obj).children().eq(1).html();
        MasterScope.txtCustomer_CategoryName_Model = $(obj).children().eq(2).html();

    });
    var element = angular.element('#LookUpModal');
    element.modal('hide');
}
function GetCustomer_TypeNameLookupData(obj) {
    MasterScope.$apply(function () {
        MasterScope.txtCustomer_Typecode_Model = $(obj).children().eq(1).html();
        MasterScope.txtCustomer_TypeName_Model = $(obj).children().eq(2).html();

    });
    var element = angular.element('#LookUpModal');
    element.modal('hide');

}
function GetProduct_TypeNameLookupData(obj) {
    MasterScope.$apply(function () {
        MasterScope.txtProduct_Typecode_Model = $(obj).children().eq(1).html();
        MasterScope.txtProduct_TypeName_Model = $(obj).children().eq(2).html();

    });
    var element = angular.element('#LookUpModal');
    element.modal('hide');
}
function GetProduct_CategoryNameLookupData(obj) {
    MasterScope.$apply(function () {
        MasterScope.txtProduct_Categorycode_Model = $(obj).children().eq(1).html();
        MasterScope.txtProduct_CategoryName_Model = $(obj).children().eq(2).html();

    });
    var element = angular.element('#LookUpModal');
    element.modal('hide');
}
function GetCustom_Location_codeLookupData(obj) {
    MasterScope.$apply(function () {
        MasterScope.txtLocation_Code_Model = $(obj).children().eq(1).html();
        MasterScope.txtLocation_CodeName_Model = $(obj).children().eq(2).html();
        MasterScope.txtCity_Code_Model = $(obj).children().eq(3).html();
        MasterScope.txtCity_CodeName_Model = $(obj).children().eq(4).html();
        MasterScope.txtState_code_Model = $(obj).children().eq(5).html();
        MasterScope.txtState_Name_Model = $(obj).children().eq(6).html();
        MasterScope.txtArea_Code_Model = $(obj).children().eq(7).html();
        MasterScope.txtArea_CodeName_Model = $(obj).children().eq(8).html();
        MasterScope.txtCountry_Code_Model = $(obj).children().eq(9).html();
        MasterScope.txtCountry_CodeName_Model = $(obj).children().eq(10).html();
    });
    var element = angular.element('#LookUpModal');
    element.modal('hide');

}
function GetCustom_City_codeLookupData(obj) {
    MasterScope.$apply(function () {
        MasterScope.txtArea_Code_Model = $(obj).children().eq(6).html();
        MasterScope.txtArea_CodeName_Model = $(obj).children().eq(7).html();
        MasterScope.txtCountry_Code_Model = $(obj).children().eq(4).html();
        MasterScope.txtCountry_CodeName_Model = $(obj).children().eq(5).html();
        MasterScope.txtCity_Code_Model = $(obj).children().eq(1).html();
        MasterScope.txtCity_CodeName_Model = $(obj).children().eq(2).html();
        MasterScope.txtState_Name_Model = $(obj).children().eq(3).html();
    });
    var element = angular.element('#LookUpModal');
    element.modal('hide');

}


DIMS.controller('DocumentSeriesCtrl', function ($scope, $location, $compile, $http, DIMSFactory, $routeParams) {
    $("#listview").hide();
    $("#Addview").show();
    MasterScope = $scope;
    $scope.go = function (path) {
        CheckUserSession();
        $location.path(path);
    };
    $scope.ddlDocumentSeries_Model = "Select Document";
    $scope.templatesettings = { HeaderTitle: "DocumentSeries" };
    $scope.ID = "";
    if ($routeParams.ID == undefined || $routeParams.ID == "") {
        $scope.ID = "";
    } else {
        $("#listview").hide();
        $("#Addview").show();
        $scope.ID = $routeParams.ID;
        if (DocSeriesName == undefined) { DocSeriesName = "0"; }
        var ID1 = JSON.stringify({
            MasterType: "DocumentSeriesDataid",
            ID: $scope.ID,
            Doc_Name: DocSeriesName

        });
        $http({
            method: 'POST',
            url: '../../Master/DocumentSeriesDataid',
            data: { ID: ID1 }
        }).then(function successCallback(response) {
            var rsp = response.data.tabledata;
            var obj = JSON.parse(rsp);
            tcount = obj.length;
            var TableRow = "";
            //alert(DocSeriesName);
            $scope.ddlDocumentSeries_Model = DocSeriesName;
            $("#DocumentSeriesDetails_Table tbody").empty();
            id = $("#DocumentSeriesDetails_Table tbody tr").length + 1;
            for (var i = 0; i < tcount; i++) {
                TableRow = TableRow + "<tr class='MousePointer' id='DocumentSeriesDetails_" + id + "'  ng-click='EditDocumentSeriesDetails(obj,$event);'>";
                TableRow = TableRow + "<td>" + id + "</td>";
                TableRow = TableRow + "<td>" + obj[i].DOCUMENT_SERIES_CODE + "</td>";
                TableRow = TableRow + "<td>" + obj[i].FIRST_NO + "</td>";
                TableRow = TableRow + "<td>" + obj[i].LAST_NO + "</td>";
                TableRow = TableRow + "<td>" + obj[i].SERIES_PREFIX + "</td>";

                TableRow = TableRow + "<td>" + obj[i].NEXT_NO + "</td>";
                TableRow = TableRow + "<td>" + obj[i].SERIES_SUFFIX + "</td>";
                TableRow = TableRow + "<td>" + obj[i].DOC_LOCK + "</td>";
                TableRow = TableRow + "<td>" + obj[i].FINANCIAL_PERIOD + "</td>";

                TableRow = TableRow + "<td>" + obj[i].DEFAULT_SERIES + "</td>";
                id = id + 1;
                TableRow = TableRow + "</tr>";

            }

            var html = $compile(TableRow)($scope);
            var el = angular.element($("#DocumentSeriesDetails_Table tbody"));
            el.append(html);
            $compile(html)($scope);

            $scope.DocumentSeriesDetailsId_Model = "";
            $scope.txtModalDocumentSeriesCode_Model = "";
            $scope.txtModalFirstNum_Model = "";
            $scope.txtModalLastNum_Model = "";
            $scope.txtModalSeriesPrefix_Model = "";
            $scope.txtModalNextNo_Model = "";
            $scope.txtModalSeriesSuffix_Model = "";
            $scope.chkModalLock_Model = "";
            $scope.txtModalFinancialPeriod_Model = "";
            $scope.chkModalDefaultSeries_Model = "";
        }, function errorCallback(response) {
            alert("Error : " + response);
        });
    }

    $scope.DropDownChange = function () {
        if ($scope.ddlDocumentSeries_Model == "Select Document") {
            $("#PlantProductDetails_Add").css("visibility", "hidden");
            DocSeriesName = $scope.ddlDocumentSeries_Model;
            //$scope.ddlDocumentSeries_Model = DocSeriesName;
            $("#listview").hide();
            $("#Addview").show();
            $scope.ID = $routeParams.ID;

            var ID1 = JSON.stringify({
                MasterType: "DocumentSeriesDataid",
                ID: 0,
                Doc_Name: $scope.ddlDocumentSeries_Model

            });
            $http({
                method: 'POST',
                url: '../../Master/DocumentSeriesDataid',
                data: { ID: ID1 }
            }).then(function successCallback(response) {
                var rsp = response.data.tabledata;
                var obj = JSON.parse(rsp);
                tcount = obj.length;
                var TableRow = "";
                //alert(DocSeriesName);
                $scope.ddlDocumentSeries_Model = DocSeriesName;
                $("#DocumentSeriesDetails_Table tbody").empty();
                id = $("#DocumentSeriesDetails_Table tbody tr").length + 1;
                for (var i = 0; i < tcount; i++) {
                    TableRow = TableRow + "<tr class='MousePointer' id='DocumentSeriesDetails_" + id + "'  ng-click='EditDocumentSeriesDetails(obj,$event);'>";
                    TableRow = TableRow + "<td>" + id + "</td>";
                    TableRow = TableRow + "<td>" + obj[i].DOCUMENT_SERIES_CODE + "</td>";
                    TableRow = TableRow + "<td>" + obj[i].FIRST_NO + "</td>";
                    TableRow = TableRow + "<td>" + obj[i].LAST_NO + "</td>";
                    TableRow = TableRow + "<td>" + obj[i].SERIES_PREFIX + "</td>";

                    TableRow = TableRow + "<td>" + obj[i].NEXT_NO + "</td>";
                    TableRow = TableRow + "<td>" + obj[i].SERIES_SUFFIX + "</td>";
                    TableRow = TableRow + "<td>" + obj[i].DOC_LOCK + "</td>";
                    TableRow = TableRow + "<td>" + obj[i].FINANCIAL_PERIOD + "</td>";

                    TableRow = TableRow + "<td>" + obj[i].DEFAULT_SERIES + "</td>";
                    id = id + 1;
                    TableRow = TableRow + "</tr>";

                }

                var html = $compile(TableRow)($scope);
                var el = angular.element($("#DocumentSeriesDetails_Table tbody"));
                el.append(html);
                $compile(html)($scope);

                $scope.DocumentSeriesDetailsId_Model = "";
                $scope.txtModalDocumentSeriesCode_Model = "";
                $scope.txtModalFirstNum_Model = "";
                $scope.txtModalLastNum_Model = "";
                $scope.txtModalSeriesPrefix_Model = "";
                $scope.txtModalNextNo_Model = "";
                $scope.txtModalSeriesSuffix_Model = "";
                $scope.chkModalLock_Model = "";
                $scope.txtModalFinancialPeriod_Model = "";
                $scope.chkModalDefaultSeries_Model = "";
            }, function errorCallback(response) {
                alert("Error : " + response);
            });
        } else {
            $("#PlantProductDetails_Add").css("visibility", "visible");
            DocSeriesName = $scope.ddlDocumentSeries_Model;
            //$scope.ddlDocumentSeries_Model = DocSeriesName;
            $("#listview").hide();
            $("#Addview").show();
            $scope.ID = $routeParams.ID;

            var ID1 = JSON.stringify({
                MasterType: "DocumentSeriesDataid",
                ID: 0,
                Doc_Name: $scope.ddlDocumentSeries_Model

            });
            $http({
                method: 'POST',
                url: '../../Master/DocumentSeriesDataid',
                data: { ID: ID1 }
            }).then(function successCallback(response) {
                var rsp = response.data.tabledata;
                var obj = JSON.parse(rsp);
                tcount = obj.length;
                var TableRow = "";
                //alert(DocSeriesName);
                $scope.ddlDocumentSeries_Model = DocSeriesName;
                $("#DocumentSeriesDetails_Table tbody").empty();
                id = $("#DocumentSeriesDetails_Table tbody tr").length + 1;
                for (var i = 0; i < tcount; i++) {
                    TableRow = TableRow + "<tr class='MousePointer' id='DocumentSeriesDetails_" + id + "'  ng-click='EditDocumentSeriesDetails(obj,$event);'>";
                    TableRow = TableRow + "<td>" + id + "</td>";
                    TableRow = TableRow + "<td>" + obj[i].DOCUMENT_SERIES_CODE + "</td>";
                    TableRow = TableRow + "<td>" + obj[i].FIRST_NO + "</td>";
                    TableRow = TableRow + "<td>" + obj[i].LAST_NO + "</td>";
                    TableRow = TableRow + "<td>" + obj[i].SERIES_PREFIX + "</td>";

                    TableRow = TableRow + "<td>" + obj[i].NEXT_NO + "</td>";
                    TableRow = TableRow + "<td>" + obj[i].SERIES_SUFFIX + "</td>";
                    TableRow = TableRow + "<td>" + obj[i].DOC_LOCK + "</td>";
                    TableRow = TableRow + "<td>" + obj[i].FINANCIAL_PERIOD + "</td>";

                    TableRow = TableRow + "<td>" + obj[i].DEFAULT_SERIES + "</td>";
                    id = id + 1;
                    TableRow = TableRow + "</tr>";

                }

                var html = $compile(TableRow)($scope);
                var el = angular.element($("#DocumentSeriesDetails_Table tbody"));
                el.append(html);
                $compile(html)($scope);

                $scope.DocumentSeriesDetailsId_Model = "";
                $scope.txtModalDocumentSeriesCode_Model = "";
                $scope.txtModalFirstNum_Model = "";
                $scope.txtModalLastNum_Model = "";
                $scope.txtModalSeriesPrefix_Model = "";
                $scope.txtModalNextNo_Model = "";
                $scope.txtModalSeriesSuffix_Model = "";
                $scope.chkModalLock_Model = "";
                $scope.txtModalFinancialPeriod_Model = "";
                $scope.chkModalDefaultSeries_Model = "";
            }, function errorCallback(response) {
                alert("Error : " + response);
            });
        }
    }



    $scope.go = function (path) {
        $location.path(path);
    };

    $scope.OpenDocumentSeriesDetails = function () {
        $scope.txtModalDocumentSeriesCode_Model = "";
        $scope.txtModalFirstNum_Model = "";
        $scope.txtModalLastNum_Model = "";
        $scope.txtModalSeriesPrefix_Model = "";
        $scope.txtModalNextNo_Model = "";
        $scope.txtModalSeriesSuffix_Model = "";
        $scope.txtModalLock_Model = "";
        $scope.txtModalFinancialPeriod_Model = "";
        $scope.txtModalDefaultSeries_Model = "";
        $("#DocumentSeriesModal_Save").text("Save");
        $("#DocumentSeriesModal_Delete").hide();
        $("#DocumentSeriesDetailsModal").modal('show');
    }

    $scope.SaveDocumentSeriesDetails = function () {
        var id = $scope.DocumentSeriesDetailsId_Model;
        var Flag = 0;
        if (id == undefined || id == null) {
            id = "";
        }

        if (($scope.txtModalDocumentSeriesCode_Model) == "") {
            $("#txtModalDocumentSeriesCode").css("border-color", "red");
            Flag = Flag + 1;
        }
        else {
            $("#txtModalDocumentSeriesCode").css("border-color", "#d2d6de");
        }

        if (($scope.txtModalFirstNum_Model) == "") {
            $("#txtModalFirstNum").css("border-color", "red");
            Flag = Flag + 1;
        }
        else {
            $("#txtModalFirstNum").css("border-color", "#d2d6de");
        }

        if (($scope.txtModalLastNum_Model) == "") {
            $("#txtModalLastNum").css("border-color", "red");
            Flag = Flag + 1;
        }
        else {
            $("#txtModalLastNum").css("border-color", "#d2d6de");
        }

        if (Flag > 0) {
            return;
        }
        else {
            var TableRow = "";

            TableRow = TableRow + "<td>" + $scope.txtModalDocumentSeriesCode_Model + "</td>";
            TableRow = TableRow + "<td>" + $scope.txtModalFirstNum_Model + "</td>";
            TableRow = TableRow + "<td>" + $scope.txtModalLastNum_Model + "</td>";
            TableRow = TableRow + "<td>" + $scope.txtModalSeriesPrefix_Model + "</td>";
            TableRow = TableRow + "<td>" + $scope.txtModalNextNo_Model + "</td>";
            TableRow = TableRow + "<td>" + $scope.txtModalSeriesSuffix_Model + "</td>";
            TableRow = TableRow + "<td>" + $scope.chkModalLock_Model + "</td>";
            TableRow = TableRow + "<td>" + $scope.txtModalFinancialPeriod_Model + "</td>";
            TableRow = TableRow + "<td>" + $scope.chkModalDefaultSeries_Model + "</td>";

            if (id == "") {
                id = $("#DocumentSeriesDetails_Table tbody tr").length + 1;

                TableRow = "<tr class='MousePointer' id='DocumentSeriesDetails_" + id + "'  ng-click='EditDocumentSeriesDetails(obj,$event);'><td>" + id + "</td>" + TableRow + "</tr>";
                var html = $compile(TableRow)($scope);

                var el = angular.element($("#DocumentSeriesDetails_Table tbody"));
                el.append(html);
                $compile(html)($scope)
                $scope.DocumentSeriesDetailsId_Model = "";
                $scope.txtModalDocumentSeriesCode_Model = "";
                $scope.txtModalFirstNum_Model = "";
                $scope.txtModalLastNum_Model = "";
                $scope.txtModalSeriesPrefix_Model = "";
                $scope.txtModalNextNo_Model = "";
                $scope.txtModalSeriesSuffix_Model = "";
                $scope.chkModalLock_Model = "";
                $scope.txtModalFinancialPeriod_Model = "";
                $scope.chkModalDefaultSeries_Model = "";
            }
            else {
                $("#DocumentSeriesDetails_Table tbody #DocumentSeriesDetails_" + id + " td")[0].innerHTML = id;
                $("#DocumentSeriesDetails_Table tbody #DocumentSeriesDetails_" + id + " td")[1].innerHTML = $scope.txtModalDocumentSeriesCode_Model;
                $("#DocumentSeriesDetails_Table tbody #DocumentSeriesDetails_" + id + " td")[2].innerHTML = $scope.txtModalFirstNum_Model;
                $("#DocumentSeriesDetails_Table tbody #DocumentSeriesDetails_" + id + " td")[3].innerHTML = $scope.txtModalLastNum_Model;
                $("#DocumentSeriesDetails_Table tbody #DocumentSeriesDetails_" + id + " td")[4].innerHTML = $scope.txtModalSeriesPrefix_Model;
                $("#DocumentSeriesDetails_Table tbody #DocumentSeriesDetails_" + id + " td")[5].innerHTML = $scope.txtModalNextNo_Model;
                $("#DocumentSeriesDetails_Table tbody #DocumentSeriesDetails_" + id + " td")[6].innerHTML = $scope.txtModalSeriesSuffix_Model;
                $("#DocumentSeriesDetails_Table tbody #DocumentSeriesDetails_" + id + " td")[7].innerHTML = $scope.chkModalLock_Model;
                $("#DocumentSeriesDetails_Table tbody #DocumentSeriesDetails_" + id + " td")[8].innerHTML = $scope.txtModalFinancialPeriod_Model;
                $("#DocumentSeriesDetails_Table tbody #DocumentSeriesDetails_" + id + " td")[9].innerHTML = $scope.chkModalDefaultSeries_Model;

                $scope.DocumentSeriesDetailsId_Model = "";
                $scope.txtModalDocumentSeriesCode_Model = "";
                $scope.txtModalFirstNum_Model = "";
                $scope.txtModalLastNum_Model = "";
                $scope.txtModalSeriesPrefix_Model = "";
                $scope.txtModalNextNo_Model = "";
                $scope.txtModalSeriesSuffix_Model = "";
                $scope.chkModalLock_Model = "";
                $scope.txtModalFinancialPeriod_Model = "";
                $scope.chkModalDefaultSeries_Model = "";
                $("#DocumentSeriesDetailsModal").modal("hide");
            }
        }
    }

    $scope.EditDocumentSeriesDetails = function (obj, $event) {
        try {
            var id = $($event.target).parent().attr("id");
            $scope.DocumentSeriesDetailsId_Model = $("#DocumentSeriesDetails_Table tbody #" + id + " td")[0].innerHTML;
            $scope.txtModalDocumentSeriesCode_Model = ($("#DocumentSeriesDetails_Table tbody #" + id + " td")[1].innerHTML);
            $scope.txtModalFirstNum_Model = ($("#DocumentSeriesDetails_Table tbody #" + id + " td")[2].innerHTML);
            $scope.txtModalLastNum_Model = ($("#DocumentSeriesDetails_Table tbody #" + id + " td")[3].innerHTML);
            $scope.txtModalSeriesPrefix_Model = ($("#DocumentSeriesDetails_Table tbody #" + id + " td")[4].innerHTML);
            $scope.txtModalNextNo_Model = ($("#DocumentSeriesDetails_Table tbody #" + id + " td")[5].innerHTML);
            $scope.txtModalSeriesSuffix_Model = ($("#DocumentSeriesDetails_Table tbody #" + id + " td")[6].innerHTML);
            $scope.chkModalLock_Model = ($("#DocumentSeriesDetails_Table tbody #" + id + " td")[7].innerHTML);
            $scope.txtModalFinancialPeriod_Model = ($("#DocumentSeriesDetails_Table tbody #" + id + " td")[8].innerHTML);
            $scope.chkModalDefaultSeries_Model = ($("#DocumentSeriesDetails_Table tbody #" + id + " td")[9].innerHTML);
            $("#DocumentSeriesDetailsModal").modal('show');
            $("#DocumentSeriesModal_Delete").show();
            $("#DocumentSeriesModal_Save").text("Update");
        }
        catch (e) {
            alert("Error: EditDocumentSeriesDetails: " + e);
        }
    }

    $scope.DeleteDocumentSeriesDetails = function () {
        try {
            var id = $scope.DocumentSeriesDetailsId_Model;
            $("#DocumentSeriesDetails_Table tbody #DocumentSeriesDetails_" + id + "").remove();
            $scope.DocumentSeriesDetailsId_Model = "";
            $scope.txtModalDocumentSeriesCode_Model = "";
            $scope.txtModalFirstNum_Model = "";
            $scope.txtModalLastNum_Model = "";
            $scope.txtModalSeriesPrefix_Model = "";
            $scope.txtModalNextNo_Model = "";
            $scope.txtModalSeriesSuffix_Model = "";
            $scope.chkModalLock_Model = "";
            $scope.txtModalFinancialPeriod_Model = "";
            $scope.chkModalDefaultSeries_Model = "";

            var i = 1;
            $("#DocumentSeriesDetails_Table tbody tr").each(function () {
                $(this).attr("id", "DocumentSeriesDetails_" + i);
                $("#DocumentSeriesDetails_Table tbody #DocumentSeriesDetails_" + i + " td")[0].innerHTML = i;
                i = i + 1;
            });
            $("#DocumentSeriesDetailsModal").modal("hide");
        }
        catch (e) {
            alert("Error: DeleteDocumentSeriesDetails: " + e);
        }
    }

    $scope.GetFieldData = function (Methodname, MasterType, Heading) {
        $scope.txtModalProductTypeCode_Model;
        $scope.txtModalProductTypeName_Model;
        $scope.txtModalProductCategoryCode_Model;
        $scope.txtModalProductCategoryName_Model;
        $scope.txtPlantAreaName_Model;
        $scope.txtPlantAreacode_Model;

        $scope.txtPlantCountry_Model;
        $scope.txtPlantCountrycode_Model;

        $scope.txtPlantCity_Model;
        $scope.txtPlantCitycode_Model;
        $scope.txtPlantState_Model;
        $scope.txtPlantStatecode_Model;

        DIMSFactory.getMasterClickData(MasterType).success(function (response) {

            getFieldLookUpData(response, Methodname, Heading);
        });
    };
    $scope.NEWFunction = function () {
        if ($scope.ddlDocumentSeries_Model == "Select Document") {
            $("#PlantProductDetails_Add").css("visibility", "hidden");
            $("#listview").hide();
            $("#Addview").show();
            $("#Add").prop('disabled', false);

            $("#DocumentSeriesDetails_Table tbody").empty();
            MasterScope.DocumentSeries_id_Model = "";
            $scope.go("DocumentSeries");
        } else {
            $("#PlantProductDetails_Add").css("visibility", "visible");
            $("#listview").hide();
            $("#Addview").show();
            $("#Add").prop('disabled', false);

            $("#DocumentSeriesDetails_Table tbody").empty();
            MasterScope.DocumentSeries_id_Model = "";
            $scope.go("DocumentSeries");
        }
    }
    $scope.SaveFunction = function () {
        if ($scope.ddlDocumentSeries_Model == "Select Document") {
            alert("Please Select Document");
        } else {
            if ($("#DocumentSeriesDetails_Table tbody tr").length == 0) {
                alert("Please add atleat one Document Series")
            }
            else {
                var RowId = "";
                var DocumentSeriesDetails = new Array();
                $("#DocumentSeriesDetails_Table tbody tr").each(function () {
                    RowId = ($(this).attr("id"));

                    DocumentSeriesDetails.push({
                        DocumentSeriesSno: $("#DocumentSeriesDetails_Table tbody #" + RowId + " td")[0].innerHTML,
                        DocumentSeriesCode: $("#DocumentSeriesDetails_Table tbody #" + RowId + " td")[1].innerHTML,
                        FirstNum: $("#DocumentSeriesDetails_Table tbody #" + RowId + " td")[2].innerHTML,
                        LastNum: $("#DocumentSeriesDetails_Table tbody #" + RowId + " td")[3].innerHTML,
                        SeriesPrefix: $("#DocumentSeriesDetails_Table tbody #" + RowId + " td")[4].innerHTML,
                        NextNum: $("#DocumentSeriesDetails_Table tbody #" + RowId + " td")[5].innerHTML,
                        SeriesSuffix: $("#DocumentSeriesDetails_Table tbody #" + RowId + " td")[6].innerHTML,
                        Lock: $("#DocumentSeriesDetails_Table tbody #" + RowId + " td")[7].innerHTML,
                        FinancialPeriod: $("#DocumentSeriesDetails_Table tbody #" + RowId + " td")[8].innerHTML,
                        Default: $("#DocumentSeriesDetails_Table tbody #" + RowId + " td")[9].innerHTML,
                        Doc_Name: DocSeriesName
                    });
                });
                var RegistrationData = JSON.stringify({
                    MasterType: "Document Series",
                    DocumentSeriesDetails: DocumentSeriesDetails
                });

                $http({
                    method: 'POST',
                    url: '../../Master/SaveDocumentSeriesData',
                    data: { RegistrationData: RegistrationData },
                }).then(function successCallback(response) {
                    $scope.go("DocumentSeries");
                    $scope.listFunction();
                }, function errorCallback(response) {
                    alert("Error : " + response);
                });
            }
        }
    }
    $scope.listFunction = function () {
        $("#Add").prop('disabled', true);
        var Val = JSON.stringify({

            MasterType: "DocumentSeriesData"
        });
        $http({
            method: 'POST',
            url: '../../Master/listDocumentSeriesData',
            data: { val: Val }
        }).then(function successCallback(response) {
            $("#Addview").hide();
            $("#listview").show();
            var data = JSON.parse(response.data.tabledata);
            $("#list").dataTable().fnDestroy();
            $('#list tbody').empty();
            $scope.list = data;
            TRCode = "";
            for (var i = 0 ; i < data.length ; i++) {
                // $('#list').dataTable().fnAddData([Res[i]["ID"], Res[i]["PLANT_CODE"], Res[i]["AREA_NAME"], Res[i]["STATE_NAME"], Res[i]["COUNTRY_NAME"], Res[i]["CREATED_BY"]]);

                var date = data[i]["CREATED_DATE"].split('T');
                var datefr = date[0].split('-');
                var date2 = datefr[2] + '/' + datefr[1] + '/' + datefr[0];

                TRCode = TRCode + "<tr class='MousePointer' id='document_series" + (i + 1) + "'  ng-click='Editdocument_series(obj,$event);' ><td>" + (i + 1) + "</td>";
                TRCode = TRCode + "<td>" + data[i]["ID"] + "</td>";
                TRCode = TRCode + "<td>" + data[i]["DOCUMENT_CODE"] + "</td>";
                TRCode = TRCode + "<td>" + data[i]["DOCUMENT_NAME"] + "</td>";
                TRCode = TRCode + "<td>" + data[i]["CREATED_BY"] + "</td>";
                TRCode = TRCode + "<td>" + date2 + "</td>";
                TRCode = TRCode + "</tr>";
            }
            var html = $compile(TRCode)($scope);
            var el = angular.element($("#list tbody"));
            el.append(html);
            $compile(html)($scope);
            var table = $("#list").dataTable({
                "bDestroy": true,
                'scroll': true
            });
            $scope.go = function (path) {


                $location.path(path);
            };
            $('#list tbody').on('click', 'tr', function () {
                $("#PlantProductDetails_Add").css("visibility", "visible");
                var ID = $(this).find('td:eq(1)').text();
                DocSeriesName = $(this).find('td:eq(3)').text();

                if (ID != "") {
                    var scope = angular.element($("#Addview")).scope();
                    scope.$apply(function () {
                        scope.go("DocumentSeries/" + ID);
                    })
                }
                //if ($(this).hasClass('selected')) {
                //    $(this).removeClass('selected');
                //}
                //else {
                //    list.$('tr.selected').removeClass('selected');
                //    $(this).addClass('selected');
                //}



            });


        }, function errorCallback(response) {
            alert("Error : " + response);
        });


    }



    //$scope.Editplant_master(obj) = function () {

    //    alert();

    //}
    //var columns = addAllColumnHeadersForMasters(data, "list");

    //for (var i = 0 ; i < data.length ; i++) {

    //    var row$ = $('<tr />');
    //    for (var colIndex = 0 ; colIndex < columns.length ; colIndex++) {
    //        var cellValue = data[i][columns[colIndex]];
    //        if (cellValue == null) { cellValue = ""; }
    //        row$.append($('<td/>').html(cellValue));
    //    }


    //    row$.append($('<td onclick="EditData(this)" />').html('<a style="background-color: #9760b3; border-color: #9760b3; padding: 6px 6px;" class="btn btn-info"><i class="fa fa-fw fa-pencil-square-o"></i>Edit</a>'));
    //    //row$.append($('<td ng-click="EditData(this)" />').html('<a style="background-color: #9760b3; border-color: #9760b3; padding: 6px 6px;" class="btn btn-info"><i class="fa fa-fw fa-pencil-square-o"></i>Edit</a>'));

    //    row$.append($('<td/>').html('<a class="btn btn-danger" style="background-color: #c71c22; border-color: #c71c22; padding: 6px 6px;" onclick="DeleteMasterData(' + "" + ')" title="delete"><i class="fa fa-fw fa-trash-o"></i>Delete</a>'));
    //    //var html1 = $compile(row$)($scope);
    //    //$("#list").append(html1);


    //}
    //var html = $compile(row$)($scope);
    //var el = angular.element($("#list tbody"));
    //el.append(html);
    //$compile(html)($scope);

    //$("#list tr td:nth-child(0)").hide();
    //$("#list tr th:nth-child(0)").hide();
    //var table = $("#list").dataTable({
    //    "bDestroy": true,
    //    'scroll': true
    //});
    //$scope.EditData() = function () {

    //    alert();

    //}
});

DIMS.controller('PlantMasterCtrl', function ($scope, $location, $compile, $http, DIMSFactory, $routeParams) {
    $("#listview").hide();
    $("#Addview").show();
    MasterScope = $scope;
    $scope.go = function (path) {
        CheckUserSession();
        $location.path(path);
    };
    $scope.ddlPlantActive_Model = "---Please select---";
    $scope.templatesettings = { HeaderTitle: "PlantMaster" };
    $scope.ID = "";
    if ($routeParams.ID == undefined || $routeParams.ID == "") {
        $scope.ID = "";
    } else {
        $("#listview").hide();
        $("#Addview").show();
        $scope.ID = $routeParams.ID;

        var ID1 = JSON.stringify({
            MasterType: "PlantMasterDataid",
            ID: $scope.ID

        });
        $http({
            method: 'POST',
            url: '../../Master/PlantMasterDataid',
            data: { ID: ID1 }
        }).then(function successCallback(response) {

            var rsp = response.data.tabledata;
            var awet = rsp.split('$');

            var obj = JSON.parse(awet[0]);

            var obj1 = JSON.parse(awet[1]);

            MasterScope.Plant_id_Model = obj1[0].ID;
            MasterScope.txtPlantCode_Model = obj1[0].PLANT_CODE;
            MasterScope.txtPlantName_Model = obj1[0].PLANT_NAME;
            MasterScope.txtPlantCitycode_Model = obj1[0].CITY_CODE;
            MasterScope.txtPlantCity_Model = obj1[0].CITY_NAME;
            MasterScope.txtPlantStatecode_Model = obj1[0].STATE_CODE;
            MasterScope.txtPlantState_Model = obj1[0].STATE_NAME;
            MasterScope.txtPlantAreacode_Model = obj1[0].AREA_CODE;
            MasterScope.txtPlantAreaName_Model = obj1[0].AREA_NAME;
            MasterScope.txtPlantCountrycode_Model = obj1[0].COUNTRY_CODE;
            MasterScope.txtPlantCountry_Model = obj1[0].COUNTRY_NAME;
            MasterScope.txtPlantAddress_Model = obj1[0].ADDRESS;
            MasterScope.txtPlantRoom_Model = obj1[0].ROOM_FLOOR;
            MasterScope.txtPlantBuilding_Model = obj1[0].BLOCK_BUILDING;
            MasterScope.txtPlantStreet_Model = obj1[0].STREET_PO_BOX;
            MasterScope.txtPlantZip_Model = obj1[0].ZIP_CODE;
            MasterScope.txtPlantEmail_Model = obj1[0].EMAIL;
            MasterScope.txtPlantWebsite_Model = obj1[0].WEBSITE;
            MasterScope.txtPlantPhone1_Model = obj1[0].PHONE1;
            MasterScope.txtPlantPhone2_Model = obj1[0].PHONE2;
            MasterScope.txtPlantMobileNumber_Model = obj1[0].MOBILE;
            MasterScope.txtPlantFax_Model = obj1[0].FAX;
            MasterScope.txtPlantCreatedBy_Model = obj1[0].CREATED_BY;
            var date = obj1[0].CREATED_DATE.split('T');
            var datefr = date[0].split('-');
            var date2 = datefr[2] + '/' + datefr[1] + '/' + datefr[0];
            MasterScope.txtPlantCreatedDate_Model = date2;


            if (obj1[0].ACTIVE == "Y") {
                MasterScope.ddlPlantActive_Model = "Yes";
                //$('#ddlPlantActive').val("Yes");
            } else {
                //$('#ddlPlantActive').val("No");
                MasterScope.ddlPlantActive_Model = "No";
            }
            tcount = obj.length;
            var TableRow = "";
            $("#PlantProductDetails_Table tbody").empty();
            id = $("#PlantProductDetails_Table tbody tr").length + 1;

            for (var i = 0; i < tcount; i++) {
                TableRow = TableRow + "<tr class='MousePointer' id='PlantProductDetails_" + id + "'  ng-click='EditPlantProductDetails(obj,$event);'>";
                TableRow = TableRow + "<td>" + id + "</td>";
                TableRow = TableRow + "<td>" + obj[i].PRODUCT_TYPE_CODE + "</td>";
                TableRow = TableRow + "<td>" + obj[i].PRODUCT_TYPE_NAME + "</td>";
                TableRow = TableRow + "<td>" + obj[i].PRODUCT_CATEGORY_CODE + "</td>";
                TableRow = TableRow + "<td>" + obj[i].PRODUCT_CATEGORY_NAME + "</td>";
                id = id + 1;
                TableRow = TableRow + "</tr>";

            }

            var html = $compile(TableRow)($scope);
            var el = angular.element($("#PlantProductDetails_Table tbody"));
            el.append(html);
            $compile(html)($scope);


            //  $('#PlantProductDetails_Table tbody').append(TableRow);
            $scope.PlantProductDetailsId_Model = "";
            $scope.txtModalProductTypeCode_Model = "";
            $scope.txtModalProductTypeName_Model = "";
            $scope.txtModalProductCategoryCode_Model = "";
            $scope.txtModalProductCategoryName_Model = "";
        }, function errorCallback(response) {
            alert("Error : " + response);
        });


    }






    $scope.go = function (path) {
        $location.path(path);
    };

    $scope.OpenPlantProductDetails = function () {
        $scope.txtModalProductTypeCode_Model = "";
        $scope.txtModalProductTypeName_Model = "";
        $scope.txtModalProductCategoryCode_Model = "";
        $scope.txtModalProductCategoryName_Model = "";
        $("#PlantProductTypeModal_Save").text("Save");
        $("#PlantProductTypeModal_Delete").hide();
        $("#PlantProductDetailsModal").modal('show');
    }

    $scope.SavePlantProductDetails = function () {
        var id = $scope.PlantProductDetailsId_Model;
        var Flag = 0;
        if (id == undefined || id == null) {
            id = "";
        }

        if (($scope.txtModalProductTypeCode_Model) == "") {
            $("#txtModalProductTypeCode").css("border-color", "red");
            Flag = Flag + 1;
        }
        else {
            $("#txtModalProductTypeCode").css("border-color", "#d2d6de");
        }

        if (($scope.txtModalProductCategoryCode_Model) == "") {
            $("#txtModalProductCategoryCode").css("border-color", "red");
            Flag = Flag + 1;
        }
        else {
            $("#txtModalProductCategoryCode").css("border-color", "#d2d6de");
        }

        if (Flag > 0) {
            return;
        }
        else {
            var TableRow = "";

            TableRow = TableRow + "<td>" + $scope.txtModalProductTypeCode_Model + "</td>";
            TableRow = TableRow + "<td>" + $scope.txtModalProductTypeName_Model + "</td>";
            TableRow = TableRow + "<td>" + $scope.txtModalProductCategoryCode_Model + "</td>";
            TableRow = TableRow + "<td>" + $scope.txtModalProductCategoryName_Model + "</td>";

            if (id == "") {
                id = $("#PlantProductDetails_Table tbody tr").length + 1;

                TableRow = "<tr class='MousePointer' id='PlantProductDetails_" + id + "'  ng-click='EditPlantProductDetails(obj,$event);'><td>" + id + "</td>" + TableRow + "</tr>";
                var html = $compile(TableRow)($scope);

                var el = angular.element($("#PlantProductDetails_Table tbody"));
                el.append(html);
                $compile(html)($scope)
                $scope.PlantProductDetailsId_Model = "";
                $scope.txtModalProductTypeCode_Model = "";
                $scope.txtModalProductTypeName_Model = "";
                $scope.txtModalProductCategoryCode_Model = "";
                $scope.txtModalProductCategoryName_Model = "";
            }
            else {
                $("#PlantProductDetails_Table tbody #PlantProductDetails_" + id + " td")[0].innerHTML = id;
                $("#PlantProductDetails_Table tbody #PlantProductDetails_" + id + " td")[1].innerHTML = $scope.txtModalProductTypeCode_Model;
                $("#PlantProductDetails_Table tbody #PlantProductDetails_" + id + " td")[2].innerHTML = $scope.txtModalProductTypeName_Model;
                $("#PlantProductDetails_Table tbody #PlantProductDetails_" + id + " td")[3].innerHTML = $scope.txtModalProductCategoryCode_Model;
                $("#PlantProductDetails_Table tbody #PlantProductDetails_" + id + " td")[4].innerHTML = $scope.txtModalProductCategoryName_Model;

                $scope.PlantProductDetailsId_Model = "";
                $scope.txtModalProductTypeCode_Model = "";
                $scope.txtModalProductTypeName_Model = "";
                $scope.txtModalProductCategoryCode_Model = "";
                $scope.txtModalProductCategoryName_Model = "";
                $("#PlantProductDetailsModal").modal("hide");
            }
        }
    }

    $scope.EditPlantProductDetails = function (obj, $event) {
        try {
            var id = $($event.target).parent().attr("id");
            $scope.PlantProductDetailsId_Model = $("#PlantProductDetails_Table tbody #" + id + " td")[0].innerHTML;
            $scope.txtModalProductTypeCode_Model = ($("#PlantProductDetails_Table tbody #" + id + " td")[1].innerHTML);
            $scope.txtModalProductTypeName_Model = ($("#PlantProductDetails_Table tbody #" + id + " td")[2].innerHTML);
            $scope.txtModalProductCategoryCode_Model = ($("#PlantProductDetails_Table tbody #" + id + " td")[3].innerHTML);
            $scope.txtModalProductCategoryName_Model = ($("#PlantProductDetails_Table tbody #" + id + " td")[4].innerHTML);
            $("#PlantProductDetailsModal").modal('show');
            $("#PlantProductTypeModal_Delete").show();
            $("#PlantProductTypeModal_Save").text("Update");
        }
        catch (e) {
            alert("Error: EditPlantProductDetails: " + e);
        }
    }

    $scope.DeletePlantProductDetails = function () {
        try {
            var id = $scope.PlantProductDetailsId_Model;
            $("#PlantProductDetails_Table tbody #PlantProductDetails_" + id + "").remove();
            $scope.PlantProductDetailsId_Model = "";
            $scope.txtModalProductTypeCode_Model = "";
            $scope.txtModalProductTypeName_Model = "";
            $scope.txtModalProductCategoryCode_Model = "";
            $scope.txtModalProductCategoryName_Model = "";

            var i = 1;
            $("#PlantProductDetails_Table tbody tr").each(function () {
                $(this).attr("id", "PlantProductDetails_" + i);
                $("#PlantProductDetails_Table tbody #PlantProductDetails_" + i + " td")[0].innerHTML = i;
                i = i + 1;
            });
            $("#PlantProductDetailsModal").modal("hide");
        }
        catch (e) {
            alert("Error: DeletePlantProductDetails: " + e);
        }
    }

    $scope.GetFieldData = function (Methodname, MasterType, Heading) {
        $scope.txtModalProductTypeCode_Model;
        $scope.txtModalProductTypeName_Model;
        $scope.txtModalProductCategoryCode_Model;
        $scope.txtModalProductCategoryName_Model;
        $scope.txtPlantAreaName_Model;
        $scope.txtPlantAreacode_Model;

        $scope.txtPlantCountry_Model;
        $scope.txtPlantCountrycode_Model;

        $scope.txtPlantCity_Model;
        $scope.txtPlantCitycode_Model;
        $scope.txtPlantState_Model;
        $scope.txtPlantStatecode_Model;

        DIMSFactory.getMasterClickData(MasterType).success(function (response) {

            getFieldLookUpData(response, Methodname, Heading);
        });
    };
    $scope.NEWFunction = function () {
        $("#listview").hide();
        $("#Addview").show();
        $("#Add").prop('disabled', false);

        $("#PlantProductDetails_Table tbody").empty();
        MasterScope.Plant_id_Model = "";
        MasterScope.txtPlantCode_Model = "";
        MasterScope.txtPlantName_Model = "";

        MasterScope.txtPlantCitycode_Model = "";
        MasterScope.txtPlantCity_Model = "";

        MasterScope.txtPlantStatecode_Model = "";
        MasterScope.txtPlantState_Model = "";
        MasterScope.txtPlantAreacode_Model = "";
        MasterScope.txtPlantAreaName_Model = "";


        MasterScope.txtPlantCountrycode_Model = "";
        MasterScope.txtPlantCountry_Model = "";
        MasterScope.txtPlantAddress_Model = "";
        MasterScope.txtPlantRoom_Model = "";
        MasterScope.txtPlantBuilding_Model = "";
        MasterScope.txtPlantStreet_Model = "";
        MasterScope.txtPlantZip_Model = "";
        MasterScope.txtPlantEmail_Model = "";
        MasterScope.txtPlantWebsite_Model = "";
        MasterScope.txtPlantPhone1_Model = "";
        MasterScope.txtPlantPhone2_Model = "";
        MasterScope.txtPlantMobileNumber_Model = "";
        MasterScope.txtPlantFax_Model = "";
        MasterScope.txtPlantCreatedBy_Model = "";
        MasterScopetxtPlantCreatedDate_Model = "";

        MasterScope.ddlPlantActive_Model = "---Please select---";
        $scope.go("PlantMaster");


    }
    $scope.SaveFunction = function () {
        var Flag = 0;

        if ($scope.txtPlantCode_Model == "" || $scope.txtPlantCode_Model == null) {
            Flag = Flag + 1;
            $("#txtPlantCode").css("border-color", "red");
        }
        else {
            $("#txtPlantCode").css("border-color", "#d2d6de");
        }
        if ($scope.txtPlantName_Model == "" || $scope.txtPlantName_Model == null) {
            Flag = Flag + 1;
            $("#txtPlantName").css("border-color", "red");
        }
        else {
            $("#txtPlantName").css("border-color", "#d2d6de");
        }
        if ($scope.ddlPlantActive_Model == "" || $scope.ddlPlantActive_Model == null || $scope.ddlPlantActive_Model == "---Please select---") {
            Flag = Flag + 1;
            $("#ddlPlantActive").css("border-color", "red");
        }
        else {
            $("#ddlPlantActive").css("border-color", "#d2d6de");
        }
        if (Flag > 0) {
            console.log("Flag : " + Flag);
        }
        else {
            console.log("Flag : " + Flag);
            if ($scope.Plant_id_Model == undefined) { $scope.Plant_id_Model = ""; }

            if ($scope.txtPlantCity_Model == undefined) { $scope.txtPlantCity_Model = ""; }
            if ($scope.txtPlantState_Model == undefined) { $scope.txtPlantState_Model = ""; }
            if ($scope.txtPlantAreaName_Model == undefined) { $scope.txtPlantAreaName_Model = ""; }
            if ($scope.txtPlantCountry_Model == undefined) { $scope.txtPlantCountry_Model = ""; }
            if ($scope.txtPlantAddress_Model == undefined) { $scope.txtPlantAddress_Model = ""; }
            // if ($scope.Delay == true) { } else { $scope.Delay = false; }

            if ($scope.txtPlantRoom_Model == undefined) { $scope.txtPlantRoom_Model = ""; }
            if ($scope.txtPlantBuilding_Model == undefined) { $scope.txtPlantBuilding_Model = ""; }
            if ($scope.txtPlantStreet_Model == undefined) { $scope.txtPlantStreet_Model = ""; }
            if ($scope.txtPlantZip_Model == undefined) { $scope.txtPlantZip_Model = ""; }
            if ($scope.txtPlantEmail_Model == undefined) { $scope.txtPlantEmail_Model = ""; }
            if ($scope.txtPlantWebsite_Model == undefined) { $scope.txtPlantWebsite_Model = ""; }

            if ($scope.txtPlantPhone1_Model == undefined) { $scope.txtPlantPhone1_Model = ""; }
            if ($scope.txtPlantPhone2_Model == undefined) { $scope.txtPlantPhone2_Model = ""; }
            if ($scope.txtPlantMobileNumber_Model == undefined) { $scope.txtPlantMobileNumber_Model = ""; }
            if ($scope.txtPlantFax_Model == undefined) { $scope.txtPlantFax_Model = ""; }
            if ($scope.txtPlantAreacode_Model == undefined) { $scope.txtPlantAreacode_Model = "" }
            var RowId = "";
            var PlantProductDetails = new Array();
            $("#PlantProductDetails_Table tbody tr").each(function () {
                RowId = ($(this).attr("id"));

                PlantProductDetails.push({
                    ProductTypeSno: $("#PlantProductDetails_Table tbody #" + RowId + " td")[0].innerHTML,
                    ProductTypeCode: $("#PlantProductDetails_Table tbody #" + RowId + " td")[1].innerHTML,
                    ProductTypeName: $("#PlantProductDetails_Table tbody #" + RowId + " td")[2].innerHTML,
                    ProductCategoryCode: $("#PlantProductDetails_Table tbody #" + RowId + " td")[3].innerHTML,
                    ProductCategoryName: $("#PlantProductDetails_Table tbody #" + RowId + " td")[4].innerHTML
                });
            });
            var RegistrationData = JSON.stringify({
                MasterType: "Plant Master",
                ID: $scope.Plant_id_Model,
                PLANT_CODE: $scope.txtPlantCode_Model,
                PLANT_NAME: $scope.txtPlantName_Model,
                CITY_CODE: $scope.txtPlantCitycode_Model,
                CITY_NAME: $scope.txtPlantCity_Model,
                STATE_CODE: $scope.txtPlantStatecode_Model,
                STATE_NAME: $scope.txtPlantState_Model,

                AREA_CODE: $scope.txtPlantAreacode_Model,
                AREA_NAME: $scope.txtPlantAreaName_Model,
                COUNTRY_CODE: $scope.txtPlantCountrycode_Model,
                COUNTRY_NAME: $scope.txtPlantCountry_Model,
                ADDRESS: $scope.txtPlantAddress_Model,

                ROOM_FLOOR: $scope.txtPlantRoom_Model,
                BLOCK_BUILDING: $scope.txtPlantBuilding_Model,
                STREET_PO_BOX: $scope.txtPlantStreet_Model,
                ZIP_CODE: $scope.txtPlantZip_Model,
                EMAIL: $scope.txtPlantEmail_Model,

                WEBSITE: $scope.txtPlantWebsite_Model,
                PHONE1: $scope.txtPlantPhone1_Model,
                PHONE2: $scope.txtPlantPhone2_Model,
                MOBILE: $scope.txtPlantMobileNumber_Model,
                FAX: $scope.txtPlantFax_Model,

                CREATED_BY: $scope.txtPlantCreatedBy_Model,
                CREATED_DATE: $scope.txtPlantCreatedDate_Model,
                ACTIVE: $scope.ddlPlantActive_Model,

                PlantProductDetails: PlantProductDetails
            });

            $http({
                method: 'POST',
                url: '../../Master/SavePlantMasterData',
                data: { RegistrationData: RegistrationData },
            }).then(function successCallback(response) {
                $scope.go("PlantMaster");
                $scope.listFunction();
            }, function errorCallback(response) {
                alert("Error : " + response);
            });


        }
    }
    $scope.listFunction = function () {
        $("#Add").prop('disabled', true);
        var Val = JSON.stringify({

            MasterType: "PlantMasterData"
        });
        $http({
            method: 'POST',
            url: '../../Master/listPlantMasterData',
            data: { val: Val }
        }).then(function successCallback(response) {
            $("#Addview").hide();
            $("#listview").show();
            var data = JSON.parse(response.data.tabledata);
            $("#list").dataTable().fnDestroy();
            $('#list tbody').empty();
            $scope.list = data;
            TRCode = "";
            for (var i = 0 ; i < data.length ; i++) {
                // $('#list').dataTable().fnAddData([Res[i]["ID"], Res[i]["PLANT_CODE"], Res[i]["AREA_NAME"], Res[i]["STATE_NAME"], Res[i]["COUNTRY_NAME"], Res[i]["CREATED_BY"]]);

                var date = data[i]["CREATED_DATE"].split('T');
                var datefr = date[0].split('-');
                var date2 = datefr[2] + '/' + datefr[1] + '/' + datefr[0];

                TRCode = TRCode + "<tr class='MousePointer' id='plant_master_" + (i + 1) + "'  ng-click='Editplant_master(obj,$event);' ><td>" + (i + 1) + "</td>";
                TRCode = TRCode + "<td>" + data[i]["ID"] + "</td>";
                TRCode = TRCode + "<td>" + data[i]["PLANT_CODE"] + "</td>";
                TRCode = TRCode + "<td>" + data[i]["AREA_NAME"] + "</td>";
                TRCode = TRCode + "<td>" + data[i]["STATE_NAME"] + "</td>";
                TRCode = TRCode + "<td>" + data[i]["COUNTRY_NAME"] + "</td>";
                TRCode = TRCode + "<td>" + date2 + "</td>";
                TRCode = TRCode + "</tr>";
            }
            var html = $compile(TRCode)($scope);
            var el = angular.element($("#list tbody"));
            el.append(html);
            $compile(html)($scope);
            var table = $("#list").dataTable({
                "bDestroy": true,
                'scroll': true
            });
            $scope.go = function (path) {


                $location.path(path);
            };
            $('#list tbody').on('click', 'tr', function () {
                var ID = $(this).find('td:eq(1)').text();

                if (ID != "") {
                    var scope = angular.element($("#Addview")).scope();
                    scope.$apply(function () {
                        scope.go("PlantMaster/" + ID);
                    })
                }
                //if ($(this).hasClass('selected')) {
                //    $(this).removeClass('selected');
                //}
                //else {
                //    list.$('tr.selected').removeClass('selected');
                //    $(this).addClass('selected');
                //}



            });


        }, function errorCallback(response) {
            alert("Error : " + response);
        });


    }



    //$scope.Editplant_master(obj) = function () {

    //    alert();

    //}
    //var columns = addAllColumnHeadersForMasters(data, "list");

    //for (var i = 0 ; i < data.length ; i++) {

    //    var row$ = $('<tr />');
    //    for (var colIndex = 0 ; colIndex < columns.length ; colIndex++) {
    //        var cellValue = data[i][columns[colIndex]];
    //        if (cellValue == null) { cellValue = ""; }
    //        row$.append($('<td/>').html(cellValue));
    //    }


    //    row$.append($('<td onclick="EditData(this)" />').html('<a style="background-color: #9760b3; border-color: #9760b3; padding: 6px 6px;" class="btn btn-info"><i class="fa fa-fw fa-pencil-square-o"></i>Edit</a>'));
    //    //row$.append($('<td ng-click="EditData(this)" />').html('<a style="background-color: #9760b3; border-color: #9760b3; padding: 6px 6px;" class="btn btn-info"><i class="fa fa-fw fa-pencil-square-o"></i>Edit</a>'));

    //    row$.append($('<td/>').html('<a class="btn btn-danger" style="background-color: #c71c22; border-color: #c71c22; padding: 6px 6px;" onclick="DeleteMasterData(' + "" + ')" title="delete"><i class="fa fa-fw fa-trash-o"></i>Delete</a>'));
    //    //var html1 = $compile(row$)($scope);
    //    //$("#list").append(html1);


    //}
    //var html = $compile(row$)($scope);
    //var el = angular.element($("#list tbody"));
    //el.append(html);
    //$compile(html)($scope);

    //$("#list tr td:nth-child(0)").hide();
    //$("#list tr th:nth-child(0)").hide();
    //var table = $("#list").dataTable({
    //    "bDestroy": true,
    //    'scroll': true
    //});
    //$scope.EditData() = function () {

    //    alert();

    //}
});
function EditData(obj, DIMSFactory, $http, $scope, $compile) {
    $("#listview").hide();
    $("#Addview").show();
    MasterScope.$apply(function () {
        MasterScope.Plant_id_Model = $(obj).parent().children().eq(0).html();
        //MasterScope.txtPlantCode_Model = $(obj).parent().children().eq(1).html();
        //MasterScope.txtPlantName_Model = $(obj).parent().children().eq(2).html();
        //MasterScope.txtPlantCitycode_Model = $(obj).parent().children().eq(3).html();
        //MasterScope.txtPlantCity_Model = $(obj).parent().children().eq(4).html();
        //MasterScope.txtPlantStatecode_Model = $(obj).parent().children().eq(5).html();
        //MasterScope.txtPlantState_Model = $(obj).parent().children().eq(6).html();
        //MasterScope.txtPlantAreacode_Model = $(obj).parent().children().eq(7).html();
        //MasterScope.txtPlantAreaName_Model = $(obj).parent().children().eq(8).html();
    });
    var ID1 = JSON.stringify({
        MasterType: "PlantMasterDataid",
        ID: MasterScope.Plant_id_Model
    });

    $.ajax({
        url: "../../Master/PlantMasterDataid", data: { ID: ID1 }, success: function (result) {
            var rsp = (result.tabledata);
            var awet = rsp.split('$');
            var obj = JSON.parse(awet[0]);
            var obj1 = JSON.parse(awet[1]);
            MasterScope.$apply(function () {
                // alert("inside master scope");
                MasterScope.Plant_id_Model = obj1[0].ID;
                MasterScope.txtPlantCode_Model = obj1[0].PLANT_CODE;
                MasterScope.txtPlantName_Model = obj1[0].PLANT_NAME;
                MasterScope.txtPlantCitycode_Model = obj1[0].CITY_CODE;
                MasterScope.txtPlantCity_Model = obj1[0].CITY_NAME;
                MasterScope.txtPlantStatecode_Model = obj1[0].STATE_CODE;
                MasterScope.txtPlantState_Model = obj1[0].STATE_NAME;
                MasterScope.txtPlantAreacode_Model = obj1[0].AREA_CODE;
                MasterScope.txtPlantAreaName_Model = obj1[0].AREA_NAME;
                MasterScope.txtPlantCountrycode_Model = obj1[0].COUNTRY_CODE;
                MasterScope.txtPlantCountry_Model = obj1[0].COUNTRY_NAME;
                MasterScope.txtPlantAddress_Model = obj1[0].ADDRESS;
                MasterScope.txtPlantRoom_Model = obj1[0].ROOM_FLOOR;
                MasterScope.txtPlantBuilding_Model = obj1[0].BLOCK_BUILDING;
                MasterScope.txtPlantStreet_Model = obj1[0].STREET_PO_BOX;
                MasterScope.txtPlantZip_Model = obj1[0].ZIP_CODE;
                MasterScope.txtPlantEmail_Model = obj1[0].EMAIL;
                MasterScope.txtPlantWebsite_Model = obj1[0].WEBSITE;
                MasterScope.txtPlantPhone1_Model = obj1[0].PHONE1;
                MasterScope.txtPlantPhone2_Model = obj1[0].PHONE2;
                MasterScope.txtPlantMobileNumber_Model = obj1[0].MOBILE;
                MasterScope.txtPlantFax_Model = obj1[0].FAX;
                MasterScope.txtPlantCreatedBy_Model = obj1[0].CREATED_BY;
                MasterScopetxtPlantCreatedDate_Model = obj1[0].CREATED_DATE;
                if (obj1[0].ACTIVE == "Y") {
                    MasterScope.ddlPlantActive_Model = "Yes";
                    //$('#ddlPlantActive').val("Yes");
                } else {
                    //$('#ddlPlantActive').val("No");
                    MasterScope.ddlPlantActive_Model = "No";
                }
                tcount = obj.length;
                var TableRow = "";
                $("#PlantProductDetails_Table tbody").empty();
                id = $("#PlantProductDetails_Table tbody tr").length + 1;

                for (var i = 0; i < tcount; i++) {
                    TableRow = TableRow + "<tr class='MousePointer' id='PlantProductDetails_" + id + "'  ng-click='EditPlantProductDetails(obj,$event);'>";
                    TableRow = TableRow + "<td>" + id + "</td>";
                    TableRow = TableRow + "<td>" + obj[i].PRODUCT_TYPE_CODE + "</td>";
                    TableRow = TableRow + "<td>" + obj[i].PRODUCT_TYPE_NAME + "</td>";
                    TableRow = TableRow + "<td>" + obj[i].PRODUCT_CATEGORY_CODE + "</td>";
                    TableRow = TableRow + "<td>" + obj[i].PRODUCT_CATEGORY_NAME + "</td>";
                    id = id + 1;
                    TableRow = TableRow + "</tr>";

                }

                var html = $compile(TableRow)($scope);
                var el = angular.element($("#PlantProductDetails_Table tbody"));
                el.append(html);
                $compile(html)($scope);


                //  $('#PlantProductDetails_Table tbody').append(TableRow);
                $scope.PlantProductDetailsId_Model = "";
                $scope.txtModalProductTypeCode_Model = "";
                $scope.txtModalProductTypeName_Model = "";
                $scope.txtModalProductCategoryCode_Model = "";
                $scope.txtModalProductCategoryName_Model = "";
            });

            //$('#Plant_id').val(obj1[0].ID);
            //$('#txtPlantCode').val(obj1[0].PLANT_CODE);
            //$('#txtPlantName').val(obj1[0].PLANT_NAME);
            //$('#txtPlantCitycode').val(obj1[0].CITY_CODE);
            //$('#txtPlantCity').val(obj1[0].CITY_NAME);
            //$('#txtPlantStatecode').val(obj1[0].STATE_CODE);
            //$('#txtPlantState').val(obj1[0].STATE_NAME);
            //$('#txtPlantArea').val(obj1[0].AREA_CODE);
            //$('#txtPlantAreaName').val(obj1[0].AREA_NAME);
            //$('#txtPlantCountrycode').val(obj1[0].COUNTRY_CODE);
            //$('#txtPlantCountry').val(obj1[0].COUNTRY_NAME);
            //$('#txtPlantAddress').val(obj1[0].ADDRESS);
            //$('#txtPlantRoom').val(obj1[0].ROOM_FLOOR);
            //$('#txtPlantBuilding').val(obj1[0].BLOCK_BUILDING);
            //$('#txtPlantStreet').val(obj1[0].STREET_PO_BOX);
            //$('#txtPlantZip').val(obj1[0].ZIP_CODE);
            //$('#txtPlantEmail').val(obj1[0].EMAIL);
            //$('#txtPlantWebsite').val(obj1[0].WEBSITE);
            //$('#txtPlantPhone1').val(obj1[0].PHONE1);
            //$('#txtPlantPhone2').val(obj1[0].PHONE2);
            //$('#txtPlantMobileNumber').val(obj1[0].MOBILE);
            //$('#txtPlantFax').val(obj1[0].FAX);
            //$('#txtPlantCreatedBy').val(obj1[0].CREATED_BY);
            //$('#txtPlantCreatedDate').val(obj1[0].CREATED_DATE);

            //if (obj1[0].ACTIVE == "Y") { $('#ddlPlantActive').val("Yes"); } else {
            //    $('#ddlPlantActive').val("No");
            //}
            //tcount = obj.length;
            //var TableRow = "";

            //for (var i = 0; i < tcount; i++) {

            //    TableRow = TableRow + "<td>" + obj[i].PRODUCT_TYPE_CODE + "</td>";
            //    TableRow = TableRow + "<td>" + obj[i].PRODUCT_TYPE_NAME + "</td>";
            //    TableRow = TableRow + "<td>" + obj[i].PRODUCT_CATEGORY_CODE + "</td>";
            //    TableRow = TableRow + "<td>" + obj[i].PRODUCT_CATEGORY_NAME + "</td>";
            //}

        }, error: function (err) { alert("Inside Error"); }
    });


    //$http({
    //    method: 'POST',
    //    url: '../../Master/PlantMasterDataid',
    //    data: { ID: ID1 },
    //}).then(function successCallback(response) {
    //    //alert("Response : " + JSON.stringify(response));
    //    //alert("Response : " + JSON.stringify(response.data));
    //}, function errorCallback(response) {
    //    alert("Error : " + response);
    //});



}

function GetProduct_TypeLookupData(obj) {

    MasterScope.$apply(function () {
        MasterScope.txtModalProductTypeCode_Model = $(obj).children().eq(1).html();
        MasterScope.txtModalProductTypeName_Model = $(obj).children().eq(2).html();

    });
    var element = angular.element('#LookUpModal');
    element.modal('hide');
}

function GetProduct_CategoryLookupData(obj) {
    MasterScope.$apply(function () {
        MasterScope.txtModalProductCategoryCode_Model = $(obj).children().eq(1).html();
        MasterScope.txtModalProductCategoryName_Model = $(obj).children().eq(2).html();

    });
    var element = angular.element('#LookUpModal');
    element.modal('hide');
}
//area
function GetArea_MasterLookupData(obj) {
    MasterScope.$apply(function () {
        MasterScope.txtPlantAreacode_Model = $(obj).children().eq(1).html();
        MasterScope.txtPlantAreaName_Model = $(obj).children().eq(2).html();
        MasterScope.txtPlantCountry_Model = $(obj).children().eq(3).html();
        MasterScope.txtPlantCountrycode_Model = $(obj).children().eq(4).html();


    });
    var element = angular.element('#LookUpModal');
    element.modal('hide');
}
//city
function GetCity_MasterLookupData(obj) {
    MasterScope.$apply(function () {
        MasterScope.txtPlantAreacode_Model = $(obj).children().eq(6).html();
        MasterScope.txtPlantAreaName_Model = $(obj).children().eq(7).html();
        MasterScope.txtPlantCountrycode_Model = $(obj).children().eq(4).html();
        MasterScope.txtPlantCountry_Model = $(obj).children().eq(5).html();
        MasterScope.txtPlantCitycode_Model = $(obj).children().eq(1).html();
        MasterScope.txtPlantCity_Model = $(obj).children().eq(2).html();
        MasterScope.txtPlantState_Model = $(obj).children().eq(8).html();
        MasterScope.txtPlantStatecode_Model = $(obj).children().eq(3).html();


    });
    var element = angular.element('#LookUpModal');
    element.modal('hide');
}

DIMS.controller('NoticeConfigurationCtrl', function ($scope, $location, $compile, $http, DIMSFactory, $routeParams) {
    MasterScope = $scope;
    $scope.templatesettings = { HeaderTitle: "NoticeConfigurationCtrl" };
    $scope.ID = "";
    $scope.go = function (path) {
        CheckUserSession();
        $location.path(path);
    };
    MasterScope.CriteriaName = "---Please select---";
    $("#txtCriteriaValue").keypress(function (e) {
        //if the letter is not digit then display error and don't type anything
        if (e.which != 8 && e.which != 0 && (e.which < 48 || e.which > 57)) {
            //display error message
            $("#errmsg").html("Digits Only").show().fadeOut("slow");
            return false;
        }
    });
    if ($routeParams.ID == undefined || $routeParams.ID == "") {

        $scope.ID = "";
    } else {
        $scope.ID = $routeParams.ID;

        var ID1 = JSON.stringify({
            MasterType: "NoticeConfigurationDataid",
            ID: $scope.ID

        });
        $http({
            method: 'POST',
            url: '../../SetUp/NoticeConfigurationDataid',
            data: { ID: ID1 }
        }).then(function successCallback(response) {

            var rsp = response.data.tabledata;
            var awet = rsp.split('$');

            var obj = JSON.parse(awet[0]);

            var obj1 = JSON.parse(awet[1]);
            MasterScope.noticemaster_id_Model = obj1[0].ID;
            MasterScope.RuleCode = obj1[0].RULE_CODE;
            MasterScope.RuleName = obj1[0].RULE_NAME;
            MasterScope.RuleDescription = obj1[0].RULE_DESCRIPTION;
            MasterScope.txtNotice_Product_Type_code_Model = obj1[0].PRODUCT_TYPE_CODE;
            MasterScope.txtNotice_Product_Type_codeName_Model = obj1[0].PRODUCT_TYPE_NAME;
            MasterScope.UserRole_code = obj1[0].USER_CODE;
            MasterScope.UserRole = obj1[0].USER_NAME;
            MasterScope.NoticeTypeSelection = obj1[0].NOTICE_TYPE;
            MasterScope.CriteriaName = obj1[0].CRITERIA_NAME;

            MasterScope.CriteriaValue = obj1[0].CRITERIA_VALUE;
            MasterScope.MessageBody = obj1[0].MESSAGE_BODY;
            MasterScope.txtNoticeCreatedBy_Model = obj1[0].CREATED_BY;
            var date = obj1[0].CREATED_DATE.split('T');
            var datefr = date[0].split('-');
            var date2 = datefr[2] + '/' + datefr[1] + '/' + datefr[0];
            MasterScope.txtNoticeCreatedDate_Model = date2;
            //MasterScope.txtNoticeCreatedDate_Model = obj1[0].CREATED_DATE;
            var data = obj1[0].CRITERIA_NAME;
            $("#txtCriteriaName").val(data);
            if (obj1[0].ACTIVE == "Y") {
                MasterScope.Enable_Model = "YES";
                //$('#ddlPlantActive').val("Yes");
            } else {
                //$('#ddlPlantActive').val("No");
                MasterScope.Enable_Model = "NO";
            }
            tcount = obj.length;

            var TableRow = "";
            $("#NoticeConfigurationTable tbody").empty();
            id = $("#NoticeConfigurationTable tbody tr").length + 1;

            for (var i = 0; i < tcount; i++) {
                TableRow = TableRow + "<tr class='MousePointer' id='NoticeConfiguration" + id + "'  ng-click='EditNoticeConfigurationData(obj,$event);'>";
                TableRow = TableRow + "<td>" + id + "</td>";
                TableRow = TableRow + "<td>" + obj[i].USER_CODE + "</td>";
                TableRow = TableRow + "<td>" + obj[i].USER_NAME + "</td>";
                id = id + 1;
                TableRow = TableRow + "</tr>";

            }

            var html = $compile(TableRow)($scope);
            var el = angular.element($("#CustomerAddress_Form tbody"));
            el.append(html);
            $compile(html)($scope);


            //  $('#PlantProductDetails_Table tbody').append(TableRow);
            $scope.PlantProductDetailsId_Model = "";
            $scope.txtModalProductTypeCode_Model = "";
            $scope.txtModalProductTypeName_Model = "";
            $scope.txtModalProductCategoryCode_Model = "";
            $scope.txtModalProductCategoryName_Model = "";
        }, function errorCallback(response) {
            alert("Error : " + response);
        });


    }
    $scope.go = function (path) {
        $location.path(path);
    };
    $scope.ADD = function () {
        var Flag = 0;
        if ($scope.UserRole == "" || $scope.UserRole == null) {
            Flag = Flag + 1;
            alert("Please select User");
            $("#txtUserRole").css("border-color", "red");
        }
        else {
            $("#txtUserRole").css("border-color", "#d2d6de");
            $("#NoticeConfiguration_Delete").hide();
            $scope.NoticeConfigurationId_Model = "";
            $scope.txtModalUsercode_Model = "";
            $scope.txtModalUserName_Model = "";
            $("#NoticeConfiguration_Save").text("Save");
            $("#NoticeConfigurationModal").modal('show');
        }


    }

    $scope.SaveNoticeConfigurationData = function () {

        var id = $scope.NoticeconfigurationId;
        var Flag = 0;
        if (id == undefined || id == null) {
            id = "";
        }
        if (($scope.txtModalUsercode_Model) == "") {
            $("#txtModalUsercode").css("border-color", "red");
            Flag = Flag + 1;
        }
        else {
            $("#txtModalUsercode").css("border-color", "#d2d6de");
        }

        if (($scope.txtModalUserName_Model) == "") {
            $("#txtModalUserName").css("border-color", "red");
            Flag = Flag + 1;
        }
        else {
            $("#txtModalUserName").css("border-color", "#d2d6de");
        }

        if (Flag > 0) {
            return;
        }
        else {
            var TableRow = "";

            TableRow = TableRow + "<td>" + $scope.txtModalUsercode_Model + "</td>";
            TableRow = TableRow + "<td>" + $scope.txtModalUserName_Model + "</td>";

            if (id == "") {

                id = $("#NoticeConfigurationTable tbody tr").length + 1;

                TableRow = "<tr class='MousePointer' id='NoticeConfigurationLines" + id + "'  ng-click='EditNoticeConfigurationData(obj,$event);'><td>" + id + "</td>" + TableRow + "</tr>";
                var html = $compile(TableRow)($scope);

                var el = angular.element($("#NoticeConfigurationTable tbody"));
                el.append(html);
                $compile(html)($scope)
                $scope.NoticeconfigurationId = "";
                $scope.txtModalUsercode_Model = "";
                $scope.txtModalUserName_Model = "";
                $("#NoticeConfigurationModal").modal("hide");
            }
            else {

                $("#NoticeConfigurationTable tbody #NoticeConfigurationLines" + id + " td")[0].innerHTML = id;
                $("#NoticeConfigurationTable tbody #NoticeConfigurationLines" + id + " td")[1].innerHTML = $scope.txtModalUsercode_Model;
                $("#NoticeConfigurationTable tbody #NoticeConfigurationLines" + id + " td")[2].innerHTML = $scope.txtModalUserName_Model;

                $scope.NoticeconfigurationId = "";
                $scope.txtModalUsercode_Model = "";
                $scope.txtModalUserName_Model = "";
                $("#NoticeConfigurationModal").modal("hide");
            }
        }
    }
    $scope.EditNoticeConfigurationData = function (obj, $event) {
        try {
            var id = $($event.target).parent().attr("id");

            $scope.NoticeconfigurationId = $("#NoticeConfigurationTable tbody #" + id + " td")[0].innerHTML;
            $scope.txtModalUsercode_Model = ($("#NoticeConfigurationTable tbody #" + id + " td")[1].innerHTML);
            $scope.txtModalUserName_Model = ($("#NoticeConfigurationTable tbody #" + id + " td")[2].innerHTML);


            $("#NoticeConfigurationModal").modal('show');
            $("#NoticeConfiguration_Delete").show();
            $("#NoticeConfiguration_Save").text("Update");

        }
        catch (e) {
            alert("Error : EditObservationLines : " + e);
        }

    }
    $scope.DeleteNoticeConfigurationDetails = function () {
        try {
            var id = $scope.NoticeconfigurationId;

            $("#NoticeConfigurationTable tbody #NoticeConfigurationLines" + id + "").remove();
            $scope.NoticeconfigurationId = "";
            $scope.txtModalUsercode_Model = "";
            $scope.txtModalUserName_Model = "";

            var i = 1;
            $("#NoticeConfigurationTable tbody tr").each(function () {
                $(this).attr("id", "NoticeConfigurationLines" + i);
                $("#NoticeConfigurationTable tbody #NoticeConfigurationLines" + i + " td")[0].innerHTML = i;
                i = i + 1;
            });
            $("#NoticeConfigurationModal").modal("hide");


        }
        catch (e) {
            alert("Error : DeleteNoticeConfigurationLines : " + e);
        }
    }
    $scope.GetFieldData = function (Methodname, MasterType, Heading) {


        DIMSFactory.getMasterClickData(MasterType).success(function (response) {
            $scope.txtNotice_Product_Type_code_Model;
            $scope.txtNotice_Product_Type_codeName_Model;
            $scope.UserRole_code;
            $scope.UserRole;
            getFieldLookUpData(response, Methodname, Heading);
        });
    };
    $scope.SaveNoticeFunction = function () {
        var Flag = 0;

        if ($scope.RuleCode == "" || $scope.RuleCode == null) {
            Flag = Flag + 1;
            $("#txtRuleCode").css("border-color", "red");
        }
        else {
            $("#txtRuleCode").css("border-color", "#d2d6de");
        }
        if ($scope.RuleName == "" || $scope.RuleName == null) {
            Flag = Flag + 1;
            $("#txtRuleName").css("border-color", "red");
        }
        else {
            $("#txtRuleName").css("border-color", "#d2d6de");
        }
        if ($scope.CriteriaValue == "" || $scope.CriteriaValue == null) {
            Flag = Flag + 1;
            $("#txtCriteriaValue").css("border-color", "red");
        }
        else {
            $("#txtCriteriaValue").css("border-color", "#d2d6de");
        }
        if ($scope.Enable_Model == "" || $scope.Enable_Model == null || $scope.Enable_Model == "---Please select---") {
            Flag = Flag + 1;
            $("#ddlEnable").css("border-color", "red");
        }
        else {
            $("#ddlEnable").css("border-color", "#d2d6de");
        }
        if (Flag > 0) {
            console.log("Flag : " + Flag);
        }
        else {
            $scope.change = $scope.NoticeTypeSelection;
            if ($scope.NoticeConfigurationId_Model == undefined) { $scope.NoticeConfigurationId_Model = ""; }
            if ($scope.NoticeType == true) { } else { $scope.NoticeType = false; }
            if ($scope.RuleDescription == undefined) { $scope.RuleDescription = ""; }
            if ($scope.txtNotice_Product_Type_codeName_Model == undefined) { $scope.txtNotice_Product_Type_codeName_Model = ""; }
            if ($scope.UserRole == undefined) { $scope.UserRole = ""; }
            if ($scope.CriteriaName == undefined) { $scope.CriteriaName = ""; }
            if ($scope.CriteriaValue == undefined) { $scope.CriteriaValue = ""; }
            if ($scope.MessageBody == undefined) { $scope.MessageBody = ""; }
            if ($scope.UserRole_code == undefined) { $scope.UserRole_code = ""; }

            var RowId = "";
            var NoticeUserDetails = new Array();
            $("#NoticeConfigurationTable tbody tr").each(function () {
                RowId = ($(this).attr("id"));

                NoticeUserDetails.push({
                    Sno: $("#NoticeConfigurationTable tbody #" + RowId + " td")[0].innerHTML,
                    ComplaintCode: $("#NoticeConfigurationTable tbody #" + RowId + " td")[1].innerHTML,
                    ComplaintTrackingNo: $("#NoticeConfigurationTable tbody #" + RowId + " td")[2].innerHTML
                });
            });
            var RegistrationData = JSON.stringify({

                MasterType: "Notice Configuration",
                ID: $scope.noticemaster_id_Model,
                RULE_CODE: $scope.RuleCode,
                RULE_NAME: $scope.RuleName,
                RULE_DESCRIPTION: $scope.RuleDescription,
                PRODUCT_TYPE_CODE: $scope.txtNotice_Product_Type_code_Model,
                PRODUCT_TYPE_NAME: $scope.txtNotice_Product_Type_codeName_Model,
                USER_CODE: $scope.UserRole_code,
                USER_NAME: $scope.UserRole,
                NOTICE_TYPE: $scope.change,
                CRITERIA_NAME: $scope.CriteriaName,
                CRITERIA_VALUE: $scope.CriteriaValue,
                MESSAGE_BODY: $scope.MessageBody,
                CREATED_BY: $scope.txtNoticeCreatedBy_Model,
                CREATED_DATE: $scope.txtNoticeCreatedDate_Model,
                ACTIVE: $scope.Enable_Model,
                NoticeUserDetails: NoticeUserDetails
            });
            $scope.go = function (path) {

                $location.path(path);
            };
            $http({
                method: 'POST',
                url: '../../Master/SaveNoticeMasterData',
                data: { RegistrationData: RegistrationData },
            }).then(function successCallback(response) {
                $scope.go("NoticeConfiguration");
                $scope.listNoticeFunction();
                //var scope = angular.element($("#addnoticeview")).scope();

                //scope.$apply(function () {
                //    alert("inside scope apply");
                //    scope.go("NoticeConfiguration");
                //})
            }, function errorCallback(response) {
                alert("Error : " + response);
            });
        }
    }
    $scope.NewNoticeFunction = function () {
        $("#NoticeConfigurationTable tbody").empty();
        $("#save").prop('disabled', false);

        $("#addnoticeview").show();
        $("#listNOTICEVIEW").hide();
        $scope.go("NoticeConfiguration");
        MasterScope.noticemaster_id_Model = "";
        MasterScope.RuleCode = "";
        MasterScope.RuleName = "";
        MasterScope.RuleDescription = "";
        MasterScope.txtNotice_Product_Type_code_Model = "";
        MasterScope.txtNotice_Product_Type_codeName_Model = "";
        MasterScope.UserRole = "";
        MasterScope.UserRole_code = "";
        MasterScope.NoticeTypeSelection = false;
        MasterScope.CriteriaName = "";
        MasterScope.CriteriaValue = "";
        MasterScope.MessageBody = "";
        //MasterScope.txtNoticeCreatedBy_Model = "ADMIN";
        //MasterScope.txtNoticeCreatedDate_Model = '@System.DateTime.Now.ToString("dd/MM/yyyy")';
        MasterScope.Enable_Model = "---Please select---";

    }

    $scope.listNoticeFunction = function () {
        $("#save").prop('disabled', true);
        var Val = JSON.stringify({

            MasterType: "NoticeConfigurationlistdata"
        });
        $http({
            method: 'POST',
            url: '../../SetUp/listNoticeMasterData',
            data: { Val: Val }
        }).then(function successCallback(response) {
            $("#addnoticeview").hide();
            $("#listNOTICEVIEW").show();
            var data = JSON.parse(response.data.tabledata);
            $("#listNOTICE").dataTable().fnDestroy();
            $('#listNOTICE tbody').empty();
            $scope.list = data;


            TRCode = "";
            for (var i = 0 ; i < data.length ; i++) {
                var date = data[i]["CREATED_DATE"].split('T');
                var datefr = date[0].split('-');
                var date2 = datefr[2] + '/' + datefr[1] + '/' + datefr[0];
                // $('#list').dataTable().fnAddData([Res[i]["ID"], Res[i]["PLANT_CODE"], Res[i]["AREA_NAME"], Res[i]["STATE_NAME"], Res[i]["COUNTRY_NAME"], Res[i]["CREATED_BY"]]);
                TRCode = TRCode + "<tr class='MousePointer' id='plant_master_" + (i + 1) + "'  ng-click='Editplant_master(obj,$event);' ><td>" + (i + 1) + "</td>";
                TRCode = TRCode + "<td>" + data[i]["ID"] + "</td>";
                TRCode = TRCode + "<td>" + data[i]["RULE_CODE"] + "</td>";
                TRCode = TRCode + "<td>" + data[i]["RULE_NAME"] + "</td>";
                TRCode = TRCode + "<td>" + data[i]["CRITERIA_NAME"] + "</td>";
                TRCode = TRCode + "<td>" + data[i]["CRITERIA_VALUE"] + "</td>";
                TRCode = TRCode + "<td>" + data[i]["CREATED_BY"] + "</td>";
                TRCode = TRCode + "<td>" + date2 + "</td>";
                TRCode = TRCode + "</tr>";
            }
            var html = $compile(TRCode)($scope);
            var el = angular.element($("#listNOTICE tbody"));
            el.append(html);
            $compile(html)($scope);

            var table = $("#listNOTICE").dataTable({
                "bDestroy": true,
                'scroll': true
            }); $scope.go = function (path) {


                $location.path(path);
            };
            $('#listNOTICE tbody').on('click', 'tr', function () {
                var ID = $(this).find('td:eq(1)').text();

                if (ID != "") {
                    var scope = angular.element($("#addnoticeview")).scope();
                    scope.$apply(function () {
                        scope.go("NoticeConfiguration/" + ID);
                    })
                }
                //if ($(this).hasClass('selected')) {
                //    $(this).removeClass('selected');
                //}
                //else {
                //    list.$('tr.selected').removeClass('selected');
                //    $(this).addClass('selected');
                //}



            });
        }, function errorCallback(response) {
            alert("Error : " + response);
        });
    }
});
function GetNotice_Product_Type_codeNameLookupData(obj) {
    MasterScope.$apply(function () {
        MasterScope.txtNotice_Product_Type_code_Model = $(obj).children().eq(1).html();
        MasterScope.txtNotice_Product_Type_codeName_Model = $(obj).children().eq(2).html();
    });
    var element = angular.element('#LookUpModal');
    element.modal('hide');
}
function GetNotice_User_RoleLookupData(obj) {

    MasterScope.$apply(function () {
        MasterScope.UserRole_code = $(obj).children().eq(1).html();
        MasterScope.UserRole = $(obj).children().eq(2).html();
    });
    var element = angular.element('#LookUpModal');
    element.modal('hide');

}
DIMS.controller('MasterConfigCtrl', function ($scope, $location, $http, DIMSFactory) {
    $scope.templatesettings = { HeaderTitle: "Home" };
    MasterScope = $scope;


    $scope.go = function (path) {
        CheckUserSession();
        $location.path(path);
    };

    $scope.Getdata = function () {
        DIMSFactory.getAllMasters().success(function (response) {
            getMasterLookUpData(response, "Masters List");
        });
    };

    $scope.GetFieldData = function (Methodname, MasterType, Heading) {
        $scope.AreaCountry_Code = "";
        //$scope.StateAreaCountry_Code = "";
        $scope.txtAreaCountryName_Model = "";
        $scope.AreaCountry_Code = "";
        //$scope.StateArea_Code = "";
        //$scope.txtStateArea_Model = "";
        //$scope.txtStateCountry_Model = "";
        //$scope.CityState_Code = "";
        //$scope.txtCityState_Model = "";
        //$scope.CityArea_Code = "";
        //$scope.txtCityArea_Model = "";
        $scope.LocationCity_Code = "";
        //$scope.txtLocationCity_Model = "";
        $scope.LocationState_Code = "";
        //$scope.txtLocationState_Model = "";
        $scope.LocationArea_Code = "";
        //$scope.txtLocationArea_Model = "";
        $scope.LocationCountry_Code = "";
        //$scope.txtLocationCountry_Model = "";
        $scope.txtDepoPlantName_Model = "";
        $scope.txtDepoAreaName_Model = "";
        $scope.txtDepoCityName_Model = "";
        $scope.txtDepoStateName_Model = "";
        $scope.DepoCountry_Code = "";
        $scope.txtDepoCountryName_Model = "";
        $scope.DepoPlant_Code = "";
        $scope.DepoArea_Code = "";
        $scope.DepoCity_Code = "";
        $scope.DepoState_Code = "";
        $scope.txtCurrencyCountryCode_Model = "";
        $scope.txtCurrencyCountryName_Model = "";
        $scope.GroupCompCity_Code = "";
        $scope.GroupCompState_Code = "";
        $scope.GroupCompCountry_Code = "";
        $scope.GroupCompArea_Code = "";
        $scope.GroupCompArea_Name = "";
        //$scope.txtGroupCompCity_Model = "";
        //$scope.txtGroupCompState_Model = "";
        //$scope.txtGroupCompCountry_Model = "";
        //$scope.txtCompGroupCompCode_Model="";
        //$scope.txtCompGroupCompName_Model="";
        //$scope.CompGroupComp_Id = "";
        $scope.CompCity_Code = "";
        //$scope.txtCompCity_Model="";
        $scope.CompState_Code = "";
        //$scope.txtCompState_Model="";
        $scope.CompCountry_Code = "";
        //$scope.txtCompCountry_Model="";
        $scope.CompArea_Code = "";
        $scope.CompArea_Name = "";
        //$scope.txtZoneCompCode_Model="";
        //$scope.txtZoneCompName_Model="";
        $scope.ZoneCountry_Code = "";
        //$scope.txtZoneCountry_Model="";
        $scope.BranchComp_Code = "";
        //$scope.txtBranchCompName_Model="";
        //$scope.txtDeptCompCode_Model="";
        //$scope.txtDeptCompName_Model="";
        $scope.txtProductType_Model;
        $scope.txtProductType_code_Model = "";

        $scope.txtProductMasterProductType_code_Model;
        $scope.txtProductMasterProductType_Model;
        $scope.txtProductMasterProductCategory_code_Model;
        $scope.txtProductMasterProductCategory_Model;
        $scope.txtCustomerType_code_Model;

        $scope.txtCustomerType_Model;
        $scope.txtProblemType_Model;
        $scope.txtProblemType_code_Model;

        $scope.txtDefectProductType_code_Model;

        $scope.txtDefectProductType_Model;
        $scope.txtDefectProductCategory_code_Model;

        $scope.txtDefectProductCategory_Model;
        $scope.txtSurveyCriteriaProductCategory_code_Model;
        $scope.txtSurveyCriteriaProductCategory_Model;
        $scope.txtSurveyCriteriaBreakageCategoryName_Model;
        $scope.txtSurveyCriteriaBreakageCategory_code_Model;
        $scope.txtObservationProductCategory_Model;
        $scope.txtSurveyCriteriaProductType_code_Model;

        $scope.txtSurveyCriteriaProductType_Model;
        $scope.txtCompensationModeProductType_Model;
        $scope.txtCompensationModeProductType_code_Model;
        $scope.txtObservationProductType_Model;
        $scope.txtObservationProductType_code_Model;
        $scope.txtObservationProductCategory_Model;
        $scope.txtObservationProductCategory_code_Model;


        DIMSFactory.getMasterClickData(MasterType).success(function (response) {

            getFieldLookUpData(response, Methodname, Heading);
        });
    };

    $scope.CreateMaster = function () {
        var date = new Date();
        var SessionUserName = $("#txtSessionUserName").val();
        if (MasterName == "Country") {
            var element = angular.element('#CountryModal');
            element.modal('show');
            $scope.txtCountryCode_Model = "";
            $scope.txtCountryName_Model = "";
            $("#Country_Save").text("Save");
        }
        else if (MasterName == "Document Master") {
            var element = angular.element('#DocumentMasterModal');
            element.modal('show');
            $scope.txtDocumentMasterid_Model = "";
            $scope.txtDocumentMasterCode_Model = "";
            $scope.txtDocumentMasterName_Model = "";
            $scope.txtDocumentMasterCreatedBy_Model = SessionUserName;
            $scope.txtDocumentMasterCreatedDate_Model = date.getDate() + '/' + parseInt(date.getMonth() + 1) + '/' + date.getFullYear();
            //$("#txtDocumentMasterCreatedDate").val(date.getDate() + '/' + parseInt(date.getMonth() + 1) + '/' + date.getFullYear());
            $("#DocumentMaster_Save").text("Save");
        }


        else if (MasterName == "Area Master") {
            var element = angular.element('#AreaModal');
            element.modal('show');
            $scope.txtAreaCode_Model = "";
            $scope.txtAreaName_Model = "";
            $scope.txtAreaDesc_Model = "";
            //$("#txtAreaCountryName").val("");
            $scope.txtAreaCountryName_Model = "";
            $("#Area_Save").text("Save");
        }
        else if (MasterName == "State") {
            var element = angular.element('#StateModal');
            element.modal('show');
            $scope.txtStateCode_Model = "";
            $scope.txtStateName_Model = "";
            $scope.txtStateArea_Model = "";
            $scope.txtStateCountry_Model = "";
            $("#State_Save").text("Save");
        } else if (MasterName == "City") {
            var element = angular.element('#CityModal');
            element.modal('show');
            $scope.txtCityCode_Model = "";
            $scope.txtCityName_Model = "";
            $scope.txtCityState_Model = "";
            $scope.txtCityArea_Model = "";
            $("#City_Save").text("Save");
        } else if (MasterName == "Location") {
            var element = angular.element('#LocationModal');
            element.modal('show');
            $scope.txtLocationCode_Model = "";
            $scope.txtLocationName_Model = "";
            $scope.txtLocationDesc_Model = "";
            $scope.txtLocationCity_Model = "";
            $scope.txtLocationState_Model = "";
            $scope.txtLocationArea_Model = "";
            $scope.txtLocationCountry_Model = "";
            $("#Location_Save").text("Save");
        }
        else if (MasterName == "Depo Master") {
            var element = angular.element('#DepoModal');
            element.modal('show');
            $scope.txtDepoCode_Model = "";
            $scope.txtDepoName_Model = "";
            $scope.txtDepoAddress_Model = "";
            $scope.txtDepoPlantName_Model = "";
            $scope.txtDepoAreaName_Model = "";
            $scope.txtDepoCityName_Model = "";
            $scope.txtDepoStateName_Model = "";
            $scope.txtDepoCountryName_Model = "";
            $scope.txtDepoDesc_Model = "";
            $scope.txtDepoActive_Model = "";
            $("#Depo_Save").text("Save");
        }
        else if (MasterName == "Currency") {
            var element = angular.element('#CurrencyModal');
            element.modal('show');
            $scope.txtCurrencyCode_Model = "";
            $scope.txtCurrencyDescription_Model = "";
            $scope.txtBaseCurrency_Model = "";
            $scope.txtCurrencyCountryCode_Model = "";
            $scope.txtCreatedBy_Model = SessionUserName;
            $scope.txtCreatedDate_Model = date.getDate() + '/' + parseInt(date.getMonth() + 1) + '/' + date.getFullYear();
            $("#Currency_Save").text("Save");
        }
        else if (MasterName == "Group Company Details") {
            var element = angular.element('#GroupCompModal');
            element.modal('show');
            $scope.txtGroupCompCode_Model = "";
            $scope.txtGroupCompName_Model = "";
            $scope.txtGroupAddress_Model = "";
            $scope.txtGroupCompRoom_Model = "";
            $scope.txtGroupCompBlock_Model = "";
            $scope.txtGroupCompStreet_Model = "";
            $scope.txtGroupCompCity_Model = "";
            $scope.txtGroupCompState_Model = "";
            $scope.txtGroupCompCountry_Model = "";
            $scope.txtGroupCompZip_Model = "";
            $scope.txtGroupCompMail_Model = "";
            $scope.txtGroupCompWebsite_Model = "";
            $scope.txtGroupCompPhone1_Model = "";
            $scope.txtGroupCompPhone2_Model = "";
            $scope.txtGroupCompMobile_Model = "";
            $scope.txtGroupCompFax_Model = "";
            $("#GroupComp_Save").text("Save");
        }
        else if (MasterName == "Company Details") {
            var element = angular.element('#CompModal');
            element.modal('show');
            $scope.txtCompCode_Model = "";
            $scope.txtCompName_Model = "";
            $scope.txtCompGroupCompCode_Model = "";
            $scope.txtCompGroupCompName_Model = "";
            $scope.txtCompAddress_Model = "";
            $scope.txtCompRoom_Model = "";
            $scope.txtCompBlock_Model = "";
            $scope.txtCompStreet_Model = "";
            $scope.txtCompCity_Model = "";
            $scope.txtCompState_Model = "";
            $scope.txtCompCountry_Model = "";
            $scope.txtCompZip_Model = "";
            $scope.txtCompMail_Model = "";
            $scope.txtCompWebsite_Model = "";
            $scope.txtCompPhone1_Model = "";
            $scope.txtCompPhone2_Model = "";
            $scope.txtCompMobile_Model = "";
            $scope.txtCompFax_Model = "";
            $("#Comp_Save").text("Save");
        }
        else if (MasterName == "Zone Details") {
            var element = angular.element('#ZoneModal');
            element.modal('show');
            $scope.txtZoneCode_Model = "";
            $scope.txtZoneName_Model = "";
            $scope.txtZoneCompCode_Model = "";
            $scope.txtZoneCompName_Model = "";
            $scope.txtZoneCountry_Model = "";
            $("#Zone_Save").text("Save");
        }
        else if (MasterName == "Branch") {
            var element = angular.element('#BranchModal');
            element.modal('show');
            $scope.txtBranchCode_Model = "";
            $scope.txtBranchName_Model = "";
            $scope.txtBranchCompName_Model = "";
            $("#Branch_Save").text("Save");
        }
        else if (MasterName == "Department") {
            var element = angular.element('#DeptModal');
            element.modal('show');
            $scope.txtDeptCode_Model = "";
            $scope.txtDeptName_Model = "";
            $scope.txtDeptCompCode_Model = "";
            $scope.txtDeptCompName_Model = "";
            $("#Dept_Save").text("Save");
        }
        else if (MasterName == "Complaint Mode") {
            var element = angular.element('#CmplModeModal');
            element.modal('show');
            $scope.txtCmplModeCode_Model = "";
            $scope.txtCmplModeName_Model = "";
            $scope.txtCmplModeDesc_Model = "";
            $("#CmplMode_Save").text("Save");
        }
        else if (MasterName == "Complaint Type") {
            var element = angular.element('#CmplTypeModal');
            element.modal('show');
            $scope.txtCmplTypeCode_Model = "";
            $scope.txtCmplTypeName_Model = "";
            $scope.txtCmplTypeDesc_Model = "";
            $("#CmplType_Save").text("Save");
        }
        else if (MasterName == "Complaint Category") {
            var element = angular.element('#CmplCategoryModal');
            element.modal('show');
            $scope.txtCmplCategoryCode_Model = "";
            $scope.txtCmplCategoryName_Model = "";
            $scope.txtCmplCategoryDesc_Model = "";
            $("#CmplCategory_Save").text("Save");
        }
        else if (MasterName == "Nature Of Complaint") {
            var element = angular.element('#CmplNatureModal');
            element.modal('show');
            $scope.txtCmplNatureCode_Model = "";
            $scope.txtCmplNatureName_Model = "";
            $scope.txtCmplNatureDesc_Model = "";
            $scope.txtCmplNatureCmplCategory_Model = "";
            $scope.txtCmplNatureCmplType_Model = "";
            $("#CmplNature_Save").text("Save");
        }
        else if (MasterName == "Complaint Priority") {
            var element = angular.element('#CmplPriorityModal');
            element.modal('show');
            $scope.txtCmplPriorityCode_Model = "";
            $scope.txtCmplPriorityName_Model = "";
            $scope.txtCmplPriorityDesc_Model = "";
            $("#CmplPriority_Save").text("Save");
        }
            //hanumanth
            //investigation
        else if (MasterName == "Compensation Mode") {
            var element = angular.element('#CompensationModeModal');
            element.modal('show');
            //$("#CompensationMode_id").val("");
            //$("#txtCompensationModeCode").val("");
            //$("#txtCompensationModeName").val("");
            //$("#txtCompensationModeDescription").val("");
            //$("#txtCompensationModeProductType").val("");
            //$("#txtCompensationModeCreatedBy").val("");
            //$("#txtCompensationModeCreatedDate").val("");
            //$("#txtCompensationModeActive").val("");
            $scope.CompensationMode_id_Model = "";
            $scope.txtCompensationModeCode_Model = "";
            $scope.txtCompensationModeName_Model = "";
            $scope.txtCompensationModeDescription_Model = "";
            $scope.txtCompensationModeProductType_Model = "";
            $scope.txtCompensationModeCreatedBy_Model = SessionUserName;
            $scope.txtCompensationModeCreatedDate_Model = date.getDate() + '/' + parseInt(date.getMonth() + 1) + '/' + date.getFullYear();
            $scope.txtCompensationModeActive_Model = "";
            $("#CompensationMode_Save").text("Save");
        } else if (MasterName == "Observations Master") {
            var element = angular.element('#ObservationModal');
            element.modal('show');
            //$("#Observation_id").val("");
            //$("#txtObservationCode").val("");
            //$("#txtObservationName").val("");
            //$("#txtObservationDescription").val("");
            //$("#txtObservationProductType").val("");
            //$("#txtObservationCreatedBy").val("");
            //$("#txtObservationCreatedDate").val("");
            //$("#txtObservationActive").val("");
            //$("#txtObservationProductCategory").val("");
            $scope.Observation_id_Model = "";
            $scope.txtObservationCode_Model = "";
            $scope.txtObservationName_Model = "";
            $scope.txtObservationDescription_Model = "";
            $scope.txtObservationProductType_Model = "";
            $scope.txtObservationProductCategory_Model = "";
            $scope.txtObservationCreatedBy_Model = SessionUserName;
            $scope.txtObservationCreatedDate_Model = date.getDate() + '/' + parseInt(date.getMonth() + 1) + '/' + date.getFullYear();
            $scope.txtObservationActive_Model = "";
            $("#Observation_Save").text("Save");
        }
        else if (MasterName == "Survey Criteria") {
            var element = angular.element('#SurveyCriteriaModal');
            element.modal('show');

            //$("#SurveyCriteria_id").val("");
            //$("#txtSurveyCriteriaCode").val("");
            //$("#txtSurveyCriteriaName").val("");
            //$("#txtSurveyCriteriaDescription").val("");
            //$("#txtSurveyCriteriaProductType").val("");
            //$("#txtSurveyCriteriaProductCategory").val("");
            //$("#txtSurveyCriteriaCreatedBy").val("");
            //$("#txtSurveyCriteriaCreatedDate").val("");
            //$("#txtSurveyCriteriaActive").val("");
            //$("#txtSurveyCriteriaBreakageCategoryName").val("");

            $scope.SurveyCriteria_id_Model = "";
            $scope.txtSurveyCriteriaCode_Model = "";
            $scope.txtSurveyCriteriaName_Model = "";
            $scope.txtSurveyCriteriaDescription_Model = "";
            $scope.txtSurveyCriteriaProductType_Model = "";
            $scope.txtSurveyCriteriaProductCategory_Model = "";
            $scope.txtSurveyCriteriaBreakageCategoryName_Model = "";
            $scope.txtSurveyCriteriaCreatedBy_Model = SessionUserName;
            $scope.txtSurveyCriteriaCreatedDate_Model = date.getDate() + '/' + parseInt(date.getMonth() + 1) + '/' + date.getFullYear();
            $scope.txtSurveyCriteriaActive_Model = "";
            $("#SurveyCriteria_Save").text("Save");
        }
        else if (MasterName == "Recovery Type") {
            var element = angular.element('#RecoveryTypeModal');
            element.modal('show');
            //$("#RecoveryType_id_Model").val("");
            //$("#txtRecoveryType_Model").val("");
            //$("#txtRecoveryTypeName_Model").val("");
            //$("#txtRecoveryTypeDescription_Model").val("");
            //$("#txtRecoveryTypeCreatedBy_Model").val("");
            //$("#txtRecoveryTypeCreatedDate_Model").val("");
            //$("#txtRecoveryTypeActive_Model").val("");
            $scope.RecoveryType_id_Model = "";
            $scope.txtRecoveryType_Model = "";
            $scope.txtRecoveryTypeName_Model = "";
            $scope.txtRecoveryTypeDescription_Model = "";
            $scope.txtRecoveryTypeCreatedBy_Model = SessionUserName;
            $scope.txtRecoveryTypeCreatedDate_Model = date.getDate() + '/' + parseInt(date.getMonth() + 1) + '/' + date.getFullYear();
            $scope.txtRecoveryTypeActive_Model = "";
            $("#RecoveryType_Save").text("Save");
        }
        else if (MasterName == "Defect Type") {
            var element = angular.element('#DefectTypeModal');
            element.modal('show');
            //$("#DefectType_id").val("");
            //$("#txtDefectTypeCode").val("");
            //$("#txtDefectTypeName").val("");
            //$("#txtDefectTypeDescription").val("");
            //$("#txtDefectProductType").val("");
            //$("#txtDefectProductCategory").val("");
            //$("#txtDefectTypeCreatedBy").val("");
            //$("#txtDefectTypeCreatedDate").val("");
            //$("#txtDefectTypeActive").val("");
            $scope.DefectType_id_Model = "";
            $scope.txtDefectTypeCode_Model = "";
            $scope.txtDefectTypeName_Model = "";
            $scope.txtDefectTypeDescription_Model = "";
            $scope.txtDefectProductType_Model = "";
            $scope.txtDefectProductCategory_Model = "";
            $scope.txtDefectTypeCreatedBy_Model = SessionUserName;
            $scope.txtDefectTypeCreatedDate_Model = date.getDate() + '/' + parseInt(date.getMonth() + 1) + '/' + date.getFullYear();
            $scope.txtDefectTypeActive_Model = "";
            $("#DefectType_Save").text("Save");
        }
        else if (MasterName == "Breakage Category") {
            var element = angular.element('#BreakageCategoryModal');
            element.modal('show');
            //$("#BreakageCategory_id").val("");
            //$("#txtBreakageCategoryCode").val("");
            //$("#txtBreakageCategoryName").val("");
            //$("#txtBreakageCategoryDescription").val("");
            //$("#txtBreakageCategoryCreatedBy").val("");
            //$("#txtBreakageCategoryCreatedDate").val("");
            //$("#txtBreakageCategoryActive").val("");
            $scope.BreakageCategory_id_Model = "";
            $scope.txtBreakageCategory_Model = "";
            $scope.txtBreakageCategoryName_Model = "";
            $scope.txtBreakageCategoryDescription_Model = "";
            $scope.txtBreakageCategoryCreatedBy_Model = SessionUserName;
            $scope.txtBreakageCategoryCreatedDate_Model = date.getDate() + '/' + parseInt(date.getMonth() + 1) + '/' + date.getFullYear();
            $scope.txtBreakageCategoryActive_Model = "";
            $("#BreakageCategory_Save").text("Save");
        }
        else if (MasterName == "Supplier Type") {
            var element = angular.element('#SupplierTypeModal');
            element.modal('show');
            //$("#SupplierType_id").val("");
            //$("#txtSupplierTypeCode").val("");
            //$("#txtSupplierTypeName").val("");
            //$("#txtSupplierTypeDescription").val("");
            //$("#txtSupplierTypeCreatedBy").val("");
            //$("#txtSupplierTypeCreatedDate").val("");
            //$("#txtSupplierTypeActive").val("");
            $scope.SupplierType_id_Model = "";
            $scope.txtSupplierType_Model = "";
            $scope.txtSupplierTypeName_Model = "";
            $scope.txtSupplierTypeDescription_Model = "";
            $scope.txtSupplierTypeCreatedBy_Model = SessionUserName;
            $scope.txtSupplierTypeCreatedDate_Model = date.getDate() + '/' + parseInt(date.getMonth() + 1) + '/' + date.getFullYear();
            $scope.txtSupplierTypeActive_Model = "";
            $("#SupplierType_Save").text("Save");
        }
            //complaints
        else if (MasterName == "Complaint Severity") {
            var element = angular.element('#ComplaintSeverityModal');
            element.modal('show');
            $scope.ComplaintSeverity_id_Model = "";
            $scope.txtComplaintSeverityCode_Model = "";
            $scope.txtComplaintSeverityName_Model = "";
            $scope.txtComplaintSeverityDescription_Model = "";
            $scope.txtComplaintSeverityCreatedBy_Model = SessionUserName;
            $scope.txtComplaintSeverityCreatedDate_Model = date.getDate() + '/' + parseInt(date.getMonth() + 1) + '/' + date.getFullYear();
            $scope.txtComplaintSeverityActive_Model = "";
            $("#ComplaintSeverity_Save").text("Save");
        }
            //corrective Actions
        else if (MasterName == "Problem Type") {
            var element = angular.element('#ProblemTypeModal');
            element.modal('show');
            //$("#ProblemType_id").val("");
            //$("#txtProblemTypeCode").val("");
            //$("#txtProblemTypeName").val("");
            //$("#txtProblemTypeDescription").val("");
            //$("#txtProblemTypeCreatedBy").val("");
            //$("#txtProblemTypeCreatedDate").val("");
            //$("#txtProblemTypeActive").val("");
            $scope.ProblemType_id_Model = "";
            $scope.txtProblemTypeCode_Model = "";
            $scope.txtProblemTypeName_Model = "";
            $scope.txtProblemTypeDescription_Model = "";
            $scope.txtProblemTypeCreatedBy_Model = SessionUserName;
            $scope.txtProblemTypeCreatedDate_Model = date.getDate() + '/' + parseInt(date.getMonth() + 1) + '/' + date.getFullYear();
            $scope.txtProblemTypeActive_Model = "";
            $("#ProblemType_Save").text("Save");
        }
        else if (MasterName == "Problem Impact") {
            var element = angular.element('#ProblemImpactModal');
            element.modal('show');
            //$("#ProblemImpact_id").val("");
            //$("#txtProblemImpactCode").val("");
            //$("#txtProblemImpactName").val("");
            //$("#txtProblemImpactDescription").val("");
            //$("#txtProblemImpactCreatedBy").val("");
            //$("#txtProblemImpactCreatedDate").val("");
            //$("#txtProblemImpactActive").val("");
            $scope.ProblemImpact_id_Model = "";
            $scope.txtProblemImpactCode_Model = "";
            $scope.txtProblemImpactName_Model = "";
            $scope.txtProblemImpactDescription_Model = "";
            $scope.txtProblemImpactCreatedBy_Model = SessionUserName;
            $scope.txtProblemImpactCreatedDate_Model = date.getDate() + '/' + parseInt(date.getMonth() + 1) + '/' + date.getFullYear();
            $scope.txtProblemImpactActive_Model = "";
            $("#ProblemImpact_Save").text("Save");
        }
        else if (MasterName == "Response Action") {
            var element = angular.element('#ResponseActionModal');
            element.modal('show');
            //$("#ResponseAction_id").val("");
            //$("#txtResponseActionCode").val("");
            //$("#txtResponseAction").val("");
            //$("#txtResponseActionDescription").val("");
            //$("#txtResponseActionCreatedBy").val("");
            //$("#txtResponseActionCreatedDate").val("");
            //$("#txtResponseActionActive").val("");
            $scope.ResponseAction_id_Model = "";
            $scope.txtResponseActionCode_Model = "";
            $scope.txtResponseAction_Model = "";
            $scope.txtResponseActionDescription_Model = "";
            $scope.txtResponseActionCreatedBy_Model = SessionUserName;
            $scope.txtResponseActionCreatedDate_Model = date.getDate() + '/' + parseInt(date.getMonth() + 1) + '/' + date.getFullYear();
            $scope.txtResponseActionActive_Model = "";
            $("#ResponseAction_Save").text("Save");
        }
        else if (MasterName == "Control Measure") {
            var element = angular.element('#ControlMeasureModal');
            element.modal('show');
            //$("#Control_id").val("");
            //$("#txtControlCode").val("");
            //$("#txtControlName").val("");
            //$("#txtControlDescription").val("");
            //$("#txtControlCreatedBy").val("");
            //$("#txtControlCreatedDate").val("");
            //$("#txtControlActive").val("");
            $scope.Control_id_Model = "";
            $scope.txtControlCode_Model = "";
            $scope.txtControlName_Model = "";
            $scope.txtControlDescription_Model = "";
            $scope.txtControlCreatedBy_Model = SessionUserName;
            $scope.txtControlCreatedDate_Model = date.getDate() + '/' + parseInt(date.getMonth() + 1) + '/' + date.getFullYear();
            $scope.txtControlActive_Model = "";
            $("#Control_Save").text("Save");
        }
        else if (MasterName == "Cause Master") {
            var element = angular.element('#CauseModal');
            element.modal('show');
            //$("#Cause_id").val("");
            //$("#txtCauseCode").val("");
            //$("#txtCauseName").val("");
            //$("#txtCauseDescription").val("");
            //$("#txtProblemType").val("");
            //$("#txtCauseCreatedBy").val("");
            //$("#txtCauseCreatedDate").val("");
            //$("#txtCauseActive").val("");

            $scope.Cause_id_Model = "";
            $scope.txtCauseCode_Model = "";
            $scope.txtCauseName_Model = "";
            $scope.txtCauseDescription_Model = "";
            $scope.txtProblemType_Model = "";
            $scope.txtCauseCreatedBy_Model = SessionUserName;
            $scope.txtCauseCreatedDate_Model = date.getDate() + '/' + parseInt(date.getMonth() + 1) + '/' + date.getFullYear();
            $scope.txtCauseActive_Model = "";

            $("#Cause_Save").text("Save");
        }
        else if (MasterName == "Corrective Actions") {
            var element = angular.element('#CorrectiveActionsModal');
            element.modal('show');
            //$("#CorrectiveMaster_id").val("");
            //$("#txtCorrectiveMasterCode").val("");
            //$("#txtCorrectiveMasterName").val("");
            //$("#txtCorrectiveMasterDescription").val("");
            //$("#txtProblemType").val("");
            //$("#txtCorrectiveMasterCreatedBy").val("");
            //$("#txtCorrectiveMasterCreatedDate").val("");
            //$("#txtCorrectiveMasterActive").val("");
            $scope.CorrectiveMaster_id_Model = "";
            $scope.txtCorrectiveMasterCode_Model = "";
            $scope.txtCorrectiveMasterName_Model = "";
            $scope.txtCorrectiveMasterDescription_Model = "";
            $scope.txtCorrectiveMasterCreatedBy_Model = SessionUserName;
            $scope.txtCorrectiveMasterCreatedDate_Model = date.getDate() + '/' + parseInt(date.getMonth() + 1) + '/' + date.getFullYear();
            $scope.txtCorrectiveMasterActive_Model = "";

            $("#CorrectiveMaster_Save").text("Save");
        }
        else if (MasterName == "Preventive Actions") {
            var element = angular.element('#PreventiveActionsModal');
            element.modal('show');
            //$("#PreventiveMaster_id").val("");
            //$("#txtPreventiveMasterCode").val("");
            //$("#txtPreventiveMasterName").val("");
            //$("#txtPreventiveMasterDescription").val("");
            //$("#txtPreventiveMasterCreatedBy").val("");
            //$("#txtPreventiveMasterCreatedDate").val("");
            //$("#txtPreventiveMasterActive").val("");
            $scope.PreventiveMaster_id_Model = "";
            $scope.txtPreventiveMasterCode_Model = "";
            $scope.txtPreventiveMasterName_Model = "";
            $scope.txtPreventiveMasterDescription_Model = "";
            $scope.txtPreventiveMasterCreatedBy_Model = SessionUserName;
            $scope.txtPreventiveMasterCreatedDate_Model = date.getDate() + '/' + parseInt(date.getMonth() + 1) + '/' + date.getFullYear();
            $scope.txtPreventiveMasterActive_Model = "";

            $("#PreventiveMaster_Save").text("Save");
        }
            //customers
        else if (MasterName == "Sales Representative") {
            var element = angular.element('#SalesRepresentativeModal');
            element.modal('show');
            element.modal('show');
            //$("#SalesRepresentative_id").val("");
            //$("#txtSalesRepresentativeEmployeeCode").val("");
            //$("#txtSalesRepresentativeEmployeeName").val("");
            //$("#txtSalesRepresentativeCreatedBy").val("");
            //$("#txtSalesRepresentativeCreatedDate").val("");
            $scope.SalesRepresentative_id_Model = "";
            $scope.txtSalesRepresentativeEmployeeCode_Model = "";
            $scope.txtSalesRepresentativeEmployeeName_Model = "";
            $scope.txtSalesRepresentativeCreatedBy_Model = SessionUserName;
            $scope.txtSalesRepresentativeCreatedDate_Model = date.getDate() + '/' + parseInt(date.getMonth() + 1) + '/' + date.getFullYear();
            $("#SalesRepresentative_Save").text("Save");
        }
        else if (MasterName == "Customer Group") {
            var element = angular.element('#CustomerGroupModal');
            element.modal('show');
            //$("#CustomerGroup_id").val("");
            //$("#txtCustomerGroupCode").val("");
            //$("#txtCustomerGroupName").val("");
            //$("#txtCustomerGroupDescription").val("");
            //$("#txtCustomerGroupCreatedBy").val("");
            //$("#txtCustomerGroupCreatedDate").val("");
            //$("#txtCustomerGroupActive").val("");

            $scope.CustomerGroup_id_Model = "";
            $scope.txtCustomerGroupCode_Model = "";
            $scope.txtCustomerGroupName_Model = "";
            $scope.txtCustomerGroupDescription_Model = "";
            $scope.txtCustomerGroupCreatedBy_Model = SessionUserName;
            $scope.txtCustomerGroupCreatedDate_Model = date.getDate() + '/' + parseInt(date.getMonth() + 1) + '/' + date.getFullYear();
            $scope.txtCustomerGroupActive_Model = "";

            $("#CustomerGroup_Save").text("Save");
        }
        else if (MasterName == "Customer Category") {
            var element = angular.element('#CustomerCategoryModal');
            element.modal('show');

            //$("#CustomerCategory_id").val("");
            //$("#txtCustomerCategoryCode").val("");
            //$("#txtCustomerCategoryName").val("");
            //$("#txtCustomerCategoryDescription").val("");
            //$("#txtCustomerType").val("");
            //$("#txtCustomerCategoryCreatedBy").val("");
            //$("#txtCustomerCategoryCreatedDate").val("");
            //$("#txtCustomerCategoryActive").val("");
            $scope.CustomerCategory_id_Model = "";
            $scope.txtCustomerCategoryCode_Model = "";
            $scope.txtCustomerCategoryName_Model = "";
            $scope.txtCustomerCategoryDescription_Model = "";
            $scope.txtCustomerType_Model = "";
            $scope.txtCustomerCategoryCreatedBy_Model = SessionUserName;
            $scope.txtCustomerCategoryCreatedDate_Model = date.getDate() + '/' + parseInt(date.getMonth() + 1) + '/' + date.getFullYear();
            $scope.txtCustomerCategoryActive_Model = "";

            $("#CustomerCategory_Save").text("Save");
        }
        else if (MasterName == "Customer Type") {
            var element = angular.element('#CustomerTypeModal');
            element.modal('show');
            //$("#CustomerType_id").val("");
            //$("#txtCustomerTypeCode").val("");
            //$("#txtCustomerTypeName").val("");
            //$("#txtCustomerTypeDescription").val("");
            //$("#txtCustomerTypeCreatedBy").val("");
            //$("#txtCustomerTypeCreatedDate").val("");
            //$("#txtCustomerTypeActive").val("");
            $scope.CustomerType_id_Model = "";
            $scope.txtCustomerTypeCode_Model = "";
            $scope.txtCustomerTypeName_Model = "";
            $scope.txtCustomerTypeDescription_Model = "";
            $scope.txtCustomerTypeCreatedBy_Model = SessionUserName;
            $scope.txtCustomerTypeCreatedDate_Model = date.getDate() + '/' + parseInt(date.getMonth() + 1) + '/' + date.getFullYear();
            $scope.txtCustomerTypeActive_Model = "";

            $("#CustomerType_Save").text("Save");
        }
            //product
        else if (MasterName == "Product Master") {
            var element = angular.element('#ProductMasterModal');
            element.modal('show');
            //$("#ProductMaster_id").val("");
            //$("#txtProductCode").val("");
            //$("#txtProductName").val("");
            //$("#txtProductDescription").val("");
            //$("#txtProductMasterProductType").val("");
            //$("#txtProductMasterProductCategory").val("");
            //$("#txtSize").val("");
            //$("#txtGrossWeight").val("");
            //$("#txtNetWeight").val("");
            //$("#txtDeviation").val("");
            //$("#txtBasicUnit").val("");
            //$("#txtProductCreatedBy").val("");
            //$("#txtProductCreatedDate").val("");
            //$("#txtProductActive").val("");

            $scope.ProductMaster_id_Model = "";
            $scope.txtProductCode_Model = "";
            $scope.txtProductName_Model = "";
            $scope.txtProductDescription_Model = "";
            $scope.txtProductMasterProductType_Model = "";
            $scope.txtProductMasterProductCategory_Model = "";
            $scope.txtSize_Model = "";
            $scope.txtGrossWeight_Model = "";
            $scope.txtNetWeight_Model = "";
            $scope.txtDeviation_Model = "";
            $scope.txtBasicUnit_Model = "";
            $scope.txtProductCreatedBy_Model = SessionUserName;
            $scope.txtProductCreatedDate_Model = date.getDate() + '/' + parseInt(date.getMonth() + 1) + '/' + date.getFullYear();
            $scope.txtProductActive_Model = "";
            $("#Product_Save").text("Save");
        }
        else if (MasterName == "Product Category") {
            var element = angular.element('#ProductCategoryModal');
            element.modal('show');
            //$("#ProductCategory_id").val("");
            //$("#txtProductCategory").val("");
            //$("#txtProductCategoryName").val("");
            //$("#txtProductType").val("");
            //$("#txtProductCategoryDescription").val("");
            //$("#txtProductCategoryCreatedBy").val("");
            //$("#txtProductCategoryCreatedDate").val("");
            //$("#txtProductCategoryActive").val("");
            $scope.ProductCategory_id_Model = "";
            $scope.txtProductCategory_Model = "";
            $scope.txtProductCategoryName_Model = "";
            $scope.txtProductType_Model = "";
            $scope.txtProductCategoryDescription_Model = "";
            $scope.txtProductCategoryCreatedBy_Model = SessionUserName;
            $scope.txtProductCategoryCreatedDate_Model = date.getDate() + '/' + parseInt(date.getMonth() + 1) + '/' + date.getFullYear();
            $scope.txtProductCategoryActive_Model = "";

            $("#ProductCategory_Save").text("Save");
        }
        else if (MasterName == "Product Type") {
            var element = angular.element('#ProductTypeModal');
            element.modal('show');
            //$("#Productype_id").val("");
            //$("#txtProductTypeCode").val("");
            //$("#txtProductTypeName").val("");
            //$("#txtProductTypeDescription").val("");
            //$("#txtProductTypeCreatedBy").val("");
            //$("#txtProductTypeCreatedDate").val("");
            //$("#txtProductTypeActive").val("");

            $scope.Productype_id_Model = "";
            $scope.txtProductTypeCode_Model = "";
            $scope.txtProductTypeName_Model = "";
            $scope.txtProductTypeDescription_Model = "";
            $scope.txtProductTypeCreatedBy_Model = SessionUserName;
            $scope.txtProductTypeCreatedDate_Model = date.getDate() + '/' + parseInt(date.getMonth() + 1) + '/' + date.getFullYear();
            $scope.txtProductTypeActive_Model = "";
            $("#ProductType_Save").text("Save");
        }
    }



    //Save/Update Country hanumanth
    //$scope.SaveCountryData = function () {
    //    //Getting xml values from Controller for Country
    //    DIMSFactory.getXmlData(MasterName).success(function (response) {
    //        if ($scope.txtCountryCode_Model == "") {
    //            if (response.indexOf("COUNTRY_CODE") >= 0) {
    //                alert("Please Enter Country Code");
    //            }
    //        } else if ($scope.txtCountryName_Model == "") {
    //            if (response.indexOf("COUNTRY_NAME") >= 0) {
    //                alert("Please Enter Country Name");
    //            }
    //        } else {
    //            if ($("#Country_Save").text() == "Save") {
    //                var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"COUNTRY_CODE\":\"" + $scope.txtCountryCode_Model + "\",\"COUNTRY_NAME\":\"" + $scope.txtCountryName_Model + "\"}";
    //                DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
    //                    var element = angular.element('#CountryModal');
    //                    element.modal('hide');
    //                    GetMasterResponse(MasterName);
    //                });
    //            }
    //            else if ($("#Country_Save").text() == "Update") {
    //            }

    //            //alert("Update");
    //        }
    //    });
    //}

    //$scope.SaveAreaData = function () {
    //    //Getting xml values from Controller for Country
    //    DIMSFactory.getXmlData(MasterName).success(function (response) {
    //        if ($scope.txtAreaCode_Model == "") {
    //            if (response.indexOf("COUNTRY_CODE") >= 0) {
    //                alert("Please Enter Country Code");
    //            }
    //        } else if ($scope.txtAreaName_Model == "") {
    //            if (response.indexOf("COUNTRY_NAME") >= 0) {
    //                alert("Please Enter Country Name");
    //            }
    //        } else if ($scope.txtAreaDesc_Model == "") {
    //            if (response.indexOf("COUNTRY_NAME") >= 0) {
    //                alert("Please Enter Country Name");
    //            }
    //        } else if ($scope.txtAreaCountryName_Model == "") {
    //            if (response.indexOf("COUNTRY_NAME") >= 0) {
    //                alert("Please Enter Country Name");
    //            }
    //        } else {
    //            if ($("#Area_Save").text() == "Save") {
    //                var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"COUNTRY_CODE\":\"" + $scope.txtCountryCode_Model + "\",\"COUNTRY_NAME\":\"" + $scope.txtCountryName_Model + "\"}";
    //                DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
    //                    var element = angular.element('#AreaModal');
    //                    element.modal('hide');
    //                    GetMasterResponse(MasterName);
    //                });
    //            }
    //            else if ($("#Area_Save").text() == "Update") {
    //            }
    //        }
    //    });
    //}
    //hanumanth
    $scope.SaveDocumentMasterData = function () {
        DIMSFactory.getXmlData(MasterName).success(function (response) {

            if ($scope.txtDocumentMasterCode_Model == "" || $scope.txtDocumentMasterCode_Model == null) {

                if (response.indexOf("DOCUMENT_CODE") >= 0) {
                    alert("Please Enter Document Master Code");
                }
            } else if ($scope.txtDocumentMasterName_Model == "" || $scope.txtDocumentMasterName_Model == null) {
                if (response.indexOf("DOCUMENT_NAME") >= 0) {
                    alert("Please Enter Document Master Name");
                }
            } else {
                if ($("#DocumentMaster_Save").text() == "Save") {
                    var Active = $("#Active").val();
                    var Master_Data = "{\"Active\":\"" + Active + "\",\"MasterType\":\"" + MasterName + "\",\"DOCUMENT_CODE\":\"" + $scope.txtDocumentMasterCode_Model + "\",\"DOCUMENT_NAME\":\"" + $scope.txtDocumentMasterName_Model + "\",\"CREATED_BY\":\"" + $scope.txtDocumentMasterCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtDocumentMasterCreatedDate_Model + "\"}";


                    DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#DocumentMasterModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
                else if ($("#DocumentMaster_Save").text() == "Update") {
                    var Active = $("#Active").val();
                    var Master_Data = "{\"Active\":\"" + Active + "\",\"MasterType\":\"" + MasterName + "\",\"ID\":\"" + $scope.txtDocumentMasterid_Model + "\",\"DOCUMENT_CODE\":\"" + $scope.txtDocumentMasterCode_Model + "\",\"DOCUMENT_NAME\":\"" + $scope.txtDocumentMasterName_Model + "\",\"CREATED_BY\":\"" + $scope.txtDocumentMasterCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtDocumentMasterCreatedDate_Model + "\"}";
                    DIMSFactory.UpdateMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#DocumentMasterModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
            }
        });
    }
    //product
    $scope.SaveProductTypeData = function () {

        DIMSFactory.getXmlData(MasterName).success(function (response) {

            if ($scope.txtProductTypeCode_Model == "" || $scope.txtProductTypeCode_Model == null) {

                if (response.indexOf("PRODUCT_TYPE_CODE") >= 0) {
                    alert("Please Enter Product Type Code");
                }
            } else if ($scope.txtProductTypeName_Model == "" || $scope.txtProductTypeName_Model == null) {
                if (response.indexOf("PRODUCT_TYPE_NAME") >= 0) {
                    alert("Please Enter Product Type Name");
                }
            } else {
                if ($("#ProductType_Save").text() == "Save") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"PRODUCT_TYPE_CODE\":\"" + $scope.txtProductTypeCode_Model + "\",\"PRODUCT_TYPE_NAME\":\"" + $scope.txtProductTypeName_Model + "\",\"PRODUCT_TYPE_DESCRIPTION\":\"" + $scope.txtProductTypeDescription_Model + "\",\"CREATED_BY\":\"" + $scope.txtProductTypeCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtProductTypeCreatedDate_Model + "\",\"ACTIVE\":\"" + $scope.txtProductTypeActive_Model + "\"}";
                    DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#ProductTypeModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
                else if ($("#ProductType_Save").text() == "Update") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"ID\":\"" + $scope.Productype_id_Model + "\",\"PRODUCT_TYPE_CODE\":\"" + $scope.txtProductTypeCode_Model + "\",\"PRODUCT_TYPE_NAME\":\"" + $scope.txtProductTypeName_Model + "\",\"PRODUCT_TYPE_DESCRIPTION\":\"" + $scope.txtProductTypeDescription_Model + "\",\"CREATED_BY\":\"" + $scope.txtProductTypeCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtProductTypeCreatedDate_Model + "\",\"ACTIVE\":\"" + $scope.txtProductTypeActive_Model + "\"}";
                    DIMSFactory.UpdateMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#ProductTypeModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
            }
        });
    }
    $scope.SaveProductCategoryData = function () {
        DIMSFactory.getXmlData(MasterName).success(function (response) {
            if ($scope.txtProductCategory_Model == "" || $scope.txtProductCategory_Model == null) {
                if (response.indexOf("PRODUCT_CATEGORY_CODE") >= 0) {
                    alert("Please Enter Product Category Code");
                }
            } else if ($scope.txtProductCategoryName_Model == "" || $scope.txtProductCategoryName_Model == null) {
                if (response.indexOf("PRODUCT_CATEGORY_NAME") >= 0) {
                    alert("Please Enter Product Category Name");
                }
            } else if ($scope.txtProductType_Model == "" || $scope.txtProductType_Model == null) {

                if (response.indexOf("PRODUCT_TYPE_NAME") >= 0) {
                    alert("Please Enter Product Type Name");
                }

            }
            else {
                if ($("#ProductCategory_Save").text() == "Save") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"PRODUCT_CATEGORY_CODE\":\"" + $scope.txtProductCategory_Model + "\",\"PRODUCT_CATEGORY_NAME\":\"" + $scope.txtProductCategoryName_Model + "\",\"PRODUCT_TYPE_CODE\":\"" + $scope.txtProductType_code_Model + "\",\"PRODUCT_TYPE_NAME\":\"" + $scope.txtProductType_Model + "\",\"PRODUCT_CATEGORY_DESCRIPTION\":\"" + $scope.txtProductCategoryDescription_Model + "\",\"CREATED_BY\":\"" + $scope.txtProductCategoryCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtProductCategoryCreatedDate_Model + "\",\"ACTIVE\":\"" + $scope.txtProductCategoryActive_Model + "\"}";
                    DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#ProductCategoryModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
                else if ($("#ProductCategory_Save").text() == "Update") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"ID\":\"" + $scope.ProductCategory_id_Model + "\",\"PRODUCT_CATEGORY_CODE\":\"" + $scope.txtProductCategory_Model + "\",\"PRODUCT_CATEGORY_NAME\":\"" + $scope.txtProductCategoryName_Model + "\",\"PRODUCT_TYPE_CODE\":\"" + $scope.txtProductType_code_Model + "\",\"PRODUCT_TYPE_NAME\":\"" + $scope.txtProductType_Model + "\",\"PRODUCT_CATEGORY_DESCRIPTION\":\"" + $scope.txtProductCategoryDescription_Model + "\",\"CREATED_BY\":\"" + $scope.txtProductCategoryCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtProductCategoryCreatedDate_Model + "\",\"ACTIVE\":\"" + $scope.txtProductCategoryActive_Model + "\"}";
                    DIMSFactory.UpdateMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#ProductCategoryModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
            }
        });
    }
    $scope.SaveProductData = function () {
        DIMSFactory.getXmlData(MasterName).success(function (response) {
            if ($scope.txtProductCode_Model == "" || $scope.txtProductCode_Model == null) {
                if (response.indexOf("PRODUCT_CODE") >= 0) {
                    alert("Please Enter Product Code");
                }
            } else if ($scope.txtProductName_Model == "" || $scope.txtProductName_Model == null) {
                if (response.indexOf("PRODUCT_NAME") >= 0) {
                    alert("Please Enter Product Name");
                }
            } else if ($scope.txtProductMasterProductCategory_Model == "" || $scope.txtProductMasterProductCategory_Model == null) {

                if (response.indexOf("PRODUCT_CATEGORY_NAME") >= 0) {
                    alert("Please Enter Product Category Name");
                }

            }
            else {
                if ($("#Product_Save").text() == "Save") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"PRODUCT_CODE\":\"" + $scope.txtProductCode_Model + "\",\"PRODUCT_NAME\":\"" + $scope.txtProductName_Model + "\",\"PRODUCT_DESC\":\"" + $scope.txtProductDescription_Model + "\",\"PRODUCT_TYPE_CODE\":\"" + $scope.txtProductMasterProductType_code_Model + "\",\"PRODUCT_TYPE_NAME\":\"" + $scope.txtProductMasterProductType_Model + "\",\"PRODUCT_CATEGORY_CODE\":\"" + $scope.txtProductMasterProductCategory_code_Model + "\",\"PRODUCT_CATEGORY_NAME\":\"" + $scope.txtProductMasterProductCategory_Model + "\",\"SIZE\":\"" + $scope.txtSize_Model + "\",\"GROSS_WEIGHT\":\"" + $scope.txtNetWeight_Model + "\",\"NET_WEIGHT\":\"" + $scope.txtNetWeight_Model + "\",\"BASE_UNIT\":\"" + $scope.txtBasicUnit_Model + "\",\"DEVIATION\":\"" + $scope.txtDeviation_Model + "\",\"CREATED_BY\":\"" + $scope.txtProductCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtProductCreatedDate_Model + "\",\"ACTIVE\":\"" + $scope.txtProductActive_Model + "\"}";
                    DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#ProductMasterModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
                else if ($("#Product_Save").text() == "Update") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"ID\":\"" + $scope.ProductMaster_id_Model + "\",\"PRODUCT_CODE\":\"" + $scope.txtProductCode_Model + "\",\"PRODUCT_NAME\":\"" + $scope.txtProductName_Model + "\",\"PRODUCT_DESC\":\"" + $scope.txtProductDescription_Model + "\",\"PRODUCT_TYPE_CODE\":\"" + $scope.txtProductMasterProductType_code_Model + "\",\"PRODUCT_TYPE_NAME\":\"" + $scope.txtProductMasterProductType_Model + "\",\"PRODUCT_CATEGORY_CODE\":\"" + $scope.txtProductMasterProductCategory_code_Model + "\",\"PRODUCT_CATEGORY_NAME\":\"" + $scope.txtProductMasterProductCategory_Model + "\",\"SIZE\":\"" + $scope.txtSize_Model + "\",\"GROSS_WEIGHT\":\"" + $scope.txtNetWeight_Model + "\",\"NET_WEIGHT\":\"" + $scope.txtNetWeight_Model + "\",\"BASE_UNIT\":\"" + $scope.txtBasicUnit_Model + "\",\"DEVIATION\":\"" + $scope.txtDeviation_Model + "\",\"CREATED_BY\":\"" + $scope.txtProductCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtProductCreatedDate_Model + "\",\"ACTIVE\":\"" + $scope.txtProductActive_Model + "\"}";
                    DIMSFactory.UpdateMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#ProductMasterModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
            }
        });
    }
    //customers
    $scope.SaveCustomerTypeData = function () {
        DIMSFactory.getXmlData(MasterName).success(function (response) {
            if ($scope.txtCustomerTypeCode_Model == "" || $scope.txtCustomerTypeCode_Model == null) {
                if (response.indexOf("CUSTOMER_TYPE_CODE") >= 0) {
                    alert("Please Enter Customer Type Code");
                }
            } else if ($scope.txtCustomerTypeName_Model == "" || $scope.txtCustomerTypeName_Model == null) {
                if (response.indexOf("CUSTOMER_TYPE_NAME") >= 0) {
                    alert("Please Enter Customer Type Name");
                }
            }
            else {
                if ($("#CustomerType_Save").text() == "Save") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"CUSTOMER_TYPE_CODE\":\"" + $scope.txtCustomerTypeCode_Model + "\",\"CUSTOMER_TYPE_NAME\":\"" + $scope.txtCustomerTypeName_Model + "\",\"CUSTOMER_TYPE_DESCRIPTION\":\"" + $scope.txtCustomerTypeDescription_Model + "\",\"CREATED_BY\":\"" + $scope.txtCustomerTypeCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtCustomerTypeCreatedDate_Model + "\",\"ACTIVE\":\"" + $scope.txtCustomerTypeActive_Model + "\"}";
                    DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#CustomerTypeModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
                else if ($("#CustomerType_Save").text() == "Update") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"ID\":\"" + $scope.CustomerType_id_Model + "\",\"CUSTOMER_TYPE_CODE\":\"" + $scope.txtCustomerTypeCode_Model + "\",\"CUSTOMER_TYPE_NAME\":\"" + $scope.txtCustomerTypeName_Model + "\",\"CUSTOMER_TYPE_DESCRIPTION\":\"" + $scope.txtCustomerTypeDescription_Model + "\",\"CREATED_BY\":\"" + $scope.txtCustomerTypeCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtCustomerTypeCreatedDate_Model + "\",\"ACTIVE\":\"" + $scope.txtCustomerTypeActive_Model + "\"}";
                    DIMSFactory.UpdateMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#CustomerTypeModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
            }
        });
    }
    $scope.SaveCustomerCategoryData = function () {
        DIMSFactory.getXmlData(MasterName).success(function (response) {

            if ($scope.txtCustomerCategoryCode_Model == "" || $scope.txtCustomerCategoryCode_Model == null) {
                if (response.indexOf("CUSTOMER_CATEGORY_CODE") >= 0) {
                    alert("Please Enter Customer Category Code");
                }
            } else if ($scope.txtCustomerCategoryName_Model == "" || $scope.txtCustomerCategoryName_Model == null) {
                if (response.indexOf("CUSTOMER_CATEGORY_NAME") >= 0) {
                    alert("Please Enter Customer Category Name");
                }
            }
            else if ($scope.txtCustomerType_Model == "" || $scope.txtCustomerType_Model == null) {
                if (response.indexOf("CUSTOMER_TYPE_NAME") >= 0) {
                    alert("Please Enter Customer Type Description");
                }
            }
            else {
                if ($("#CustomerCategory_Save").text() == "Save") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"CUSTOMER_CATEGORY_CODE\":\"" + $scope.txtCustomerCategoryCode_Model + "\",\"CUSTOMER_CATEGORY_NAME\":\"" + $scope.txtCustomerCategoryName_Model + "\",\"CUSTOMER_CATEGORY_DESC\":\"" + $scope.txtCustomerCategoryDescription_Model + "\",\"CUSTOMER_TYPE_NAME\":\"" + $scope.txtCustomerType_Model + "\",\"CUSTOMER_TYPE_CODE\":\"" + $scope.txtCustomerType_code_Model + "\",\"CREATED_BY\":\"" + $scope.txtCustomerCategoryCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtCustomerCategoryCreatedDate_Model + "\",\"ACTIVE\":\"" + $scope.txtCustomerCategoryActive_Model + "\"}";
                    DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#CustomerCategoryModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
                else if ($("#CustomerCategory_Save").text() == "Update") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"ID\":\"" + $scope.CustomerCategory_id_Model + "\",\"CUSTOMER_CATEGORY_CODE\":\"" + $scope.txtCustomerCategoryCode_Model + "\",\"CUSTOMER_CATEGORY_NAME\":\"" + $scope.txtCustomerCategoryName_Model + "\",\"CUSTOMER_CATEGORY_DESC\":\"" + $scope.txtCustomerCategoryDescription_Model + "\",\"CUSTOMER_TYPE_CODE\":\"" + $scope.txtCustomerType_code_Model + "\",\"CUSTOMER_TYPE_NAME\":\"" + $scope.txtCustomerType_Model + "\",\"CREATED_BY\":\"" + $scope.txtCustomerCategoryCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtCustomerCategoryCreatedDate_Model + "\",\"ACTIVE\":\"" + $scope.txtCustomerCategoryActive_Model + "\"}";
                    DIMSFactory.UpdateMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#CustomerCategoryModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
            }
        });
    }
    $scope.SaveCustomerGroupData = function () {
        DIMSFactory.getXmlData(MasterName).success(function (response) {
            if ($scope.txtCustomerGroupCode_Model == "" || $scope.txtCustomerGroupCode_Model == null) {
                if (response.indexOf("CUSTOMER_GROUP_CODE") >= 0) {
                    alert("Please Enter Customer Group Code");
                }
            } else if ($scope.txtCustomerGroupName_Model == "" || $scope.txtCustomerGroupName_Model == null) {
                if (response.indexOf("CUSTOMER_GROUP_NAME") >= 0) {
                    alert("Please Enter Customer Group Name");
                }
            }
            else {
                if ($("#CustomerGroup_Save").text() == "Save") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"CUSTOMER_GROUP_CODE\":\"" + $scope.txtCustomerGroupCode_Model + "\",\"CUSTOMER_GROUP_NAME\":\"" + $scope.txtCustomerGroupName_Model + "\",\"CUSTOMER_GROUP_DESCRIPTION\":\"" + $scope.txtCustomerGroupDescription_Model + "\",\"CREATED_BY\":\"" + $scope.txtCustomerGroupCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtCustomerGroupCreatedDate_Model + "\",\"ACTIVE\":\"" + $scope.txtCustomerGroupActive_Model + "\"}";
                    DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#CustomerGroupModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
                else if ($("#CustomerGroup_Save").text() == "Update") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"ID\":\"" + $scope.CustomerGroup_id_Model + "\",\"CUSTOMER_GROUP_CODE\":\"" + $scope.txtCustomerGroupCode_Model + "\",\"CUSTOMER_GROUP_NAME\":\"" + $scope.txtCustomerGroupName_Model + "\",\"CUSTOMER_GROUP_DESCRIPTION\":\"" + $scope.txtCustomerGroupDescription_Model + "\",\"CREATED_BY\":\"" + $scope.txtCustomerGroupCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtCustomerGroupCreatedDate_Model + "\",\"ACTIVE\":\"" + $scope.txtCustomerGroupActive_Model + "\"}";
                    DIMSFactory.UpdateMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#CustomerGroupModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
            }
        });
    }
    $scope.SaveSalesRepresentativeData = function () {
        DIMSFactory.getXmlData(MasterName).success(function (response) {
            if ($scope.txtSalesRepresentativeEmployeeCode_Model == "" || $scope.txtSalesRepresentativeEmployeeCode_Model == null) {
                if (response.indexOf("SALES_REPRESENTATIVE_CODE") >= 0) {
                    alert("Please Enter Sales Representative Code");
                }
            }
            else {
                if ($("#SalesRepresentative_Save").text() == "Save") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"SALES_REPRESENTATIVE_CODE\":\"" + $scope.txtSalesRepresentativeEmployeeCode_Model + "\",\"SALES_REPRESENTATIVE_NAME\":\"" + $scope.txtSalesRepresentativeEmployeeName_Model + "\",\"CREATED_BY\":\"" + $scope.txtSalesRepresentativeCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtSalesRepresentativeCreatedDate_Model + "\"}";
                    DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#SalesRepresentativeModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
                else if ($("#SalesRepresentative_Save").text() == "Update") {

                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"ID\":\"" + $scope.SalesRepresentative_id_Model + "\",\"SALES_REPRESENTATIVE_CODE\":\"" + $scope.txtSalesRepresentativeEmployeeCode_Model + "\",\"SALES_REPRESENTATIVE_NAME\":\"" + $scope.txtSalesRepresentativeEmployeeName_Model + "\",\"CREATED_BY\":\"" + $scope.txtSalesRepresentativeCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtSalesRepresentativeCreatedDate_Model + "\"}";
                    DIMSFactory.UpdateMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#SalesRepresentativeModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
            }
        });
    }
    //Corrective Actions
    $scope.SaveProblemTypeData = function () {
        DIMSFactory.getXmlData(MasterName).success(function (response) {
            if ($scope.txtProblemTypeCode_Model == "" || $scope.txtProblemTypeCode_Model == null) {
                if (response.indexOf("PROBLEM_CODE") >= 0) {
                    alert("Please Enter Problem Type Code");
                }
            } else if ($scope.txtProblemTypeName_Model == "" || $scope.txtProblemTypeName_Model == null) {
                if (response.indexOf("PROBLEM_NAME") >= 0) {
                    alert("Please Enter Problem Type Name");
                }
            }
            else {
                if ($("#ProblemType_Save").text() == "Save") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"PROBLEM_CODE\":\"" + $scope.txtProblemTypeCode_Model + "\",\"PROBLEM_NAME\":\"" + $scope.txtProblemTypeName_Model + "\",\"PROBLEM_DESCRIPTION\":\"" + $scope.txtProblemTypeDescription_Model + "\",\"CREATED_BY\":\"" + $scope.txtProblemTypeCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtProblemTypeCreatedDate_Model + "\",\"ACTIVE\":\"" + $scope.txtProblemTypeActive_Model + "\"}";
                    DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#ProblemTypeModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
                else if ($("#ProblemType_Save").text() == "Update") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"ID\":\"" + $scope.ProblemType_id_Model + "\",\"PROBLEM_CODE\":\"" + $scope.txtProblemTypeCode_Model + "\",\"PROBLEM_NAME\":\"" + $scope.txtProblemTypeName_Model + "\",\"PROBLEM_DESCRIPTION\":\"" + $scope.txtProblemTypeDescription_Model + "\",\"CREATED_BY\":\"" + $scope.txtProblemTypeCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtProblemTypeCreatedDate_Model + "\",\"ACTIVE\":\"" + $scope.txtProblemTypeActive_Model + "\"}";
                    DIMSFactory.UpdateMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#ProblemTypeModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });

                }
            }
        });
    }
    $scope.SaveProblemImpactData = function () {
        DIMSFactory.getXmlData(MasterName).success(function (response) {
            if ($scope.txtProblemImpactCode_Model == "" || $scope.txtProblemImpactCode_Model == null) {
                if (response.indexOf("PROBLEMIMPACT_CODE") >= 0) {
                    alert("Please Enter Problem Impact Code");
                }
            } else if ($scope.txtProblemImpactName_Model == "" || $scope.txtProblemImpactName_Model == null) {
                if (response.indexOf("PROBLEMIMPACT_NAME") >= 0) {
                    alert("Please Enter Problem Impact Name");
                }
            }
            else {
                if ($("#ProblemImpact_Save").text() == "Save") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"PROBLEMIMPACT_CODE\":\"" + $scope.txtProblemImpactCode_Model + "\",\"PROBLEMIMPACT_NAME\":\"" + $scope.txtProblemImpactName_Model + "\",\"PROBLEMIMPACT_DESCRIPTION\":\"" + $scope.txtProblemImpactDescription_Model + "\",\"CREATED_BY\":\"" + $scope.txtProblemImpactCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtProblemImpactCreatedDate_Model + "\",\"ACTIVE\":\"" + $scope.txtProblemImpactActive_Model + "\"}";
                    DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#ProblemImpactModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
                else if ($("#ProblemImpact_Save").text() == "Update") {

                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"ID\":\"" + $scope.ProblemImpact_id_Model + "\",\"PROBLEMIMPACT_CODE\":\"" + $scope.txtProblemImpactCode_Model + "\",\"PROBLEMIMPACT_NAME\":\"" + $scope.txtProblemImpactName_Model + "\",\"PROBLEMIMPACT_DESCRIPTION\":\"" + $scope.txtProblemImpactDescription_Model + "\",\"CREATED_BY\":\"" + $scope.txtProblemImpactCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtProblemImpactCreatedDate_Model + "\",\"ACTIVE\":\"" + $scope.txtProblemImpactActive_Model + "\"}";
                    DIMSFactory.UpdateMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#ProblemImpactModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });


                }
            }
        });
    }
    $scope.SaveResponseActionData = function () {
        DIMSFactory.getXmlData(MasterName).success(function (response) {
            if ($scope.txtResponseActionCode_Model == "" || $scope.txtResponseActionCode_Model == null) {

                if (response.indexOf("Response_Action_CODE") >= 0) {
                    alert("Please Enter Response Action Code");
                }
            } else if ($scope.txtResponseAction_Model == "" || $scope.txtResponseAction_Model == null) {

                if (response.indexOf("Response_Action_NAME") >= 0) {
                    alert("Please Enter Response Action Name");
                }
            }
            else {
                if ($("#ResponseAction_Save").text() == "Save") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"RESPONSE_ACTION_CODE\":\"" + $scope.txtResponseActionCode_Model + "\",\"RESPONSE_ACTION_NAME\":\"" + $scope.txtResponseAction_Model + "\",\"RESPONSE_ACTION_DESCRIPTION\":\"" + $scope.txtResponseActionDescription_Model + "\",\"CREATED_BY\":\"" + $scope.txtResponseActionCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtResponseActionCreatedDate_Model + "\",\"ACTIVE\":\"" + $scope.txtResponseActionActive_Model + "\"}";
                    DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#ResponseActionModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
                else if ($("#ResponseAction_Save").text() == "Update") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"ID\":\"" + $scope.ResponseAction_id_Model + "\",\"RESPONSE_ACTION_CODE\":\"" + $scope.txtResponseActionCode_Model + "\",\"RESPONSE_ACTION_NAME\":\"" + $scope.txtResponseAction_Model + "\",\"RESPONSE_ACTION_DESCRIPTION\":\"" + $scope.txtResponseActionDescription_Model + "\",\"CREATED_BY\":\"" + $scope.txtResponseActionCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtResponseActionCreatedDate_Model + "\",\"ACTIVE\":\"" + $scope.txtResponseActionActive_Model + "\"}";
                    DIMSFactory.UpdateMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#ResponseActionModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
            }
        });
    }
    $scope.SaveControlData = function () {
        DIMSFactory.getXmlData(MasterName).success(function (response) {
            if ($scope.txtControlCode_Model == "" || $scope.txtControlCode_Model == null) {
                if (response.indexOf("CONTROL_MEASURES_CODE") >= 0) {
                    alert("Please Enter Control Code");
                }
            } else if ($scope.txtControlName_Model == "" || $scope.txtControlName_Model == null) {
                if (response.indexOf("CONTROL_MEASURES_NAME") >= 0) {
                    alert("Please Enter Control Name");
                }
            }
            else {
                if ($("#Control_Save").text() == "Save") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"CONTROL_MEASURES_CODE\":\"" + $scope.txtControlCode_Model + "\",\"CONTROL_MEASURES_NAME\":\"" + $scope.txtControlName_Model + "\",\"CONTROL_MEASURES_DESCRIPTION\":\"" + $scope.txtControlDescription_Model + "\",\"CREATED_BY\":\"" + $scope.txtControlCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtControlCreatedDate_Model + "\",\"ACTIVE\":\"" + $scope.txtControlActive_Model + "\"}";
                    DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#ControlMeasureModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
                else if ($("#Control_Save").text() == "Update") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"ID\":\"" + $scope.Control_id_Model + "\",\"CONTROL_MEASURES_CODE\":\"" + $scope.txtControlCode_Model + "\",\"CONTROL_MEASURES_NAME\":\"" + $scope.txtControlName_Model + "\",\"CONTROL_MEASURES_DESCRIPTION\":\"" + $scope.txtControlDescription_Model + "\",\"CREATED_BY\":\"" + $scope.txtControlCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtControlCreatedDate_Model + "\",\"ACTIVE\":\"" + $scope.txtControlActive_Model + "\"}";
                    DIMSFactory.UpdateMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#ControlMeasureModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
            }
        });
    }
    $scope.SaveCorrectiveMasterData = function () {
        DIMSFactory.getXmlData(MasterName).success(function (response) {
            if ($scope.txtCorrectiveMasterCode_Model == "" || $scope.txtCorrectiveMasterCode_Model == null) {
                if (response.indexOf("CORRECTIVE_ACTION_CODE") >= 0) {
                    alert("Please Enter Corrective Master Code");
                }
            } else if ($scope.txtCorrectiveMasterName_Model == "" || $scope.txtCorrectiveMasterName_Model == null) {
                if (response.indexOf("CORRECTIVE_ACTION_NAME") >= 0) {
                    alert("Please Enter Corrective Master Name");
                }
            }
            else {
                if ($("#CorrectiveMaster_Save").text() == "Save") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"CORRECTIVE_ACTION_CODE\":\"" + $scope.txtCorrectiveMasterCode_Model + "\",\"CORRECTIVE_ACTION_NAME\":\"" + $scope.txtCorrectiveMasterName_Model + "\",\"CORRECTIVE_ACTION_DESCRIPTION\":\"" + $scope.txtCorrectiveMasterDescription_Model + "\",\"CREATED_BY\":\"" + $scope.txtCorrectiveMasterCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtCorrectiveMasterCreatedDate_Model + "\",\"ACTIVE\":\"" + $scope.txtCorrectiveMasterActive_Model + "\"}";
                    DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#CorrectiveActionsModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
                else if ($("#CorrectiveMaster_Save").text() == "Update") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"ID\":\"" + $scope.CorrectiveMaster_id_Model + "\",\"CORRECTIVE_ACTION_CODE\":\"" + $scope.txtCorrectiveMasterCode_Model + "\",\"CORRECTIVE_ACTION_NAME\":\"" + $scope.txtCorrectiveMasterName_Model + "\",\"CORRECTIVE_ACTION_DESCRIPTION\":\"" + $scope.txtCorrectiveMasterDescription_Model + "\",\"CREATED_BY\":\"" + $scope.txtCorrectiveMasterCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtCorrectiveMasterCreatedDate_Model + "\",\"ACTIVE\":\"" + $scope.txtCorrectiveMasterActive_Model + "\"}";
                    DIMSFactory.UpdateMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#CorrectiveActionsModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });

                }
            }
        });
    }

    $scope.SavePreventiveMasterData = function () {
        DIMSFactory.getXmlData(MasterName).success(function (response) {
            if ($scope.txtPreventiveMasterCode_Model == "" || $scope.txtPreventiveMasterCode_Model == null) {
                if (response.indexOf("PREVENTIVE_ACTION_CODE") >= 0) {
                    alert("Please Enter Preventive Master Code");
                }
            } else if ($scope.txtPreventiveMasterName_Model == "" || $scope.txtPreventiveMasterName_Model == null) {
                if (response.indexOf("PREVENTIVE_ACTION_NAME") >= 0) {
                    alert("Please Enter Preventive Master Name");
                }
            }
            else {
                if ($("#PreventiveMaster_Save").text() == "Save") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"PREVENTIVE_ACTION_CODE\":\"" + $scope.txtPreventiveMasterCode_Model + "\",\"PREVENTIVE_ACTION_NAME\":\"" + $scope.txtPreventiveMasterName_Model + "\",\"PREVENTIVE_ACTION_DESCRIPTION\":\"" + $scope.txtPreventiveMasterDescription_Model + "\",\"CREATED_BY\":\"" + $scope.txtPreventiveMasterCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtPreventiveMasterCreatedDate_Model + "\",\"ACTIVE\":\"" + $scope.txtPreventiveMasterActive_Model + "\"}";
                    DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#PreventiveActionsModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
                else if ($("#PreventiveMaster_Save").text() == "Update") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"ID\":\"" + $scope.PreventiveMaster_id_Model + "\",\"PREVENTIVE_ACTION_CODE\":\"" + $scope.txtPreventiveMasterCode_Model + "\",\"PREVENTIVE_ACTION_NAME\":\"" + $scope.txtPreventiveMasterName_Model + "\",\"PREVENTIVE_ACTION_DESCRIPTION\":\"" + $scope.txtPreventiveMasterDescription_Model + "\",\"CREATED_BY\":\"" + $scope.txtPreventiveMasterCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtPreventiveMasterCreatedDate_Model + "\",\"ACTIVE\":\"" + $scope.txtPreventiveMasterActive_Model + "\"}";
                    DIMSFactory.UpdateMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#PreventiveActionsModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
            }
        });
    }
    $scope.SaveCauseData = function () {
        DIMSFactory.getXmlData(MasterName).success(function (response) {
            if ($scope.txtCauseCode_Model == "" || $scope.txtCauseCode_Model == null) {
                if (response.indexOf("CAUSE_CODE") >= 0) {
                    alert("Please Enter Cause Code");
                }
            } else if ($scope.txtCauseName_Model == "" || $scope.txtCauseName_Model == null) {
                if (response.indexOf("CAUSE_NAME") >= 0) {
                    alert("Please Enter Cause Name");
                }
            }
            else if ($scope.txtProblemType_Model == "" || $scope.txtProblemType_Model == null) {
                if (response.indexOf("PROBLEM_TYPE_NAME") >= 0) {
                    alert("Please Enter Problem Type Name");
                }
            }
            else {
                if ($("#Cause_Save").text() == "Save") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"CAUSE_CODE\":\"" + $scope.txtCauseCode_Model + "\",\"CAUSE_NAME\":\"" + $scope.txtCauseName_Model + "\",\"CAUSE_DESCRIPTION\":\"" + $scope.txtCauseDescription_Model + "\",\"PROBLEM_TYPE_NAME\":\"" + $scope.txtProblemType_Model + "\",\"PROBLEM_TYPE_CODE\":\"" + $scope.txtProblemType_code_Model + "\",\"CREATED_BY\":\"" + $scope.txtCauseCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtCauseCreatedDate_Model + "\",\"ACTIVE\":\"" + $scope.txtCauseActive_Model + "\"}";
                    DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#CauseModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
                else if ($("#Cause_Save").text() == "Update") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"ID\":\"" + $scope.Cause_id_Model + "\",\"CAUSE_CODE\":\"" + $scope.txtCauseCode_Model + "\",\"CAUSE_NAME\":\"" + $scope.txtCauseName_Model + "\",\"CAUSE_DESCRIPTION\":\"" + $scope.txtCauseDescription_Model + "\",\"PROBLEM_TYPE_NAME\":\"" + $scope.txtProblemType_Model + "\",\"PROBLEM_TYPE_CODE\":\"" + $scope.txtProblemType_code_Model + "\",\"CREATED_BY\":\"" + $scope.txtCauseCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtCauseCreatedDate_Model + "\",\"ACTIVE\":\"" + $scope.txtCauseActive_Model + "\"}";
                    DIMSFactory.UpdateMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#CauseModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
            }
        });
    }
    //complaints
    $scope.SaveComplaintSeverityData = function () {
        DIMSFactory.getXmlData(MasterName).success(function (response) {
            if ($scope.txtComplaintSeverityCode_Model == "") {
                if (response.indexOf("COMPLAINT_SEVERITY_CODE") >= 0) {
                    alert("Please Enter Complaint Severity Code");
                }
            } else if ($scope.txtComplaintSeverityName_Model == "") {
                if (response.indexOf("COMPLAINT_SEVERITY_NAME") >= 0) {
                    alert("Please Enter Complaint Severity Name");
                }
            }
            else {
                if ($("#ComplaintSeverity_Save").text() == "Save") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"COMPLAINT_SEVERITY_CODE\":\"" + $scope.txtComplaintSeverityCode_Model + "\",\"COMPLAINT_SEVERITY_NAME\":\"" + $scope.txtComplaintSeverityName_Model + "\",\"COMPLAINT_SEVERITY_DESCRIPTION\":\"" + $scope.txtComplaintSeverityDescription_Model + "\",\"CREATED_BY\":\"" + $scope.txtComplaintSeverityCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtComplaintSeverityCreatedDate_Model + "\",\"ACTIVE\":\"" + $scope.txtComplaintSeverityActive_Model + "\"}";
                    DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#ComplaintSeverityModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
                else if ($("#ComplaintSeverity_Save").text() == "Update") {

                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"ID\":\"" + $scope.ComplaintSeverity_id_Model + "\",\"COMPLAINT_SEVERITY_CODE\":\"" + $scope.txtComplaintSeverityCode_Model + "\",\"COMPLAINT_SEVERITY_NAME\":\"" + $scope.txtComplaintSeverityName_Model + "\",\"COMPLAINT_SEVERITY_DESCRIPTION\":\"" + $scope.txtComplaintSeverityDescription_Model + "\",\"CREATED_BY\":\"" + $scope.txtComplaintSeverityCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtComplaintSeverityCreatedDate_Model + "\",\"ACTIVE\":\"" + $scope.txtComplaintSeverityActive_Model + "\"}";
                    DIMSFactory.UpdateMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#ComplaintSeverityModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });


                }

            }
        });
    }
    //investigation
    $scope.SaveSupplierTypeData = function () {
        DIMSFactory.getXmlData(MasterName).success(function (response) {
            if ($scope.txtSupplierType_Model == "" || $scope.txtSupplierType_Model == null) {
                if (response.indexOf("SUPPLIER_TYPE_CODE") >= 0) {
                    alert("Please Enter Supplier Type Code");
                }
            } else if ($scope.txtSupplierTypeName_Model == "" || $scope.txtSupplierTypeName_Model == null) {
                alert($scope.txtSupplierTypeName_Model);
                if (response.indexOf("SUPPLIER_TYPE_NAME") >= 0) {
                    alert("Please Enter Supplier Type Name");
                }
            }
            else {
                if ($("#SupplierType_Save").text() == "Save") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"SUPPLIER_TYPE_CODE\":\"" + $scope.txtSupplierType_Model + "\",\"SUPPLIER_TYPE_NAME\":\"" + $scope.txtSupplierTypeName_Model + "\",\"SUPPLIER_TYPE_DESCRIPTION\":\"" + $scope.txtSupplierTypeDescription_Model + "\",\"CREATED_BY\":\"" + $scope.txtSupplierTypeCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtSupplierTypeCreatedDate_Model + "\",\"ACTIVE\":\"" + $scope.txtSupplierTypeActive_Model + "\"}";
                    DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#SupplierTypeModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
                else if ($("#SupplierType_Save").text() == "Update") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"ID\":\"" + $scope.SupplierType_id_Model + "\",\"SUPPLIER_TYPE_CODE\":\"" + $scope.txtSupplierType_Model + "\",\"SUPPLIER_TYPE_NAME\":\"" + $scope.txtSupplierTypeName_Model + "\",\"SUPPLIER_TYPE_DESCRIPTION\":\"" + $scope.txtSupplierTypeDescription_Model + "\",\"CREATED_BY\":\"" + $scope.txtSupplierTypeCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtSupplierTypeCreatedDate_Model + "\",\"ACTIVE\":\"" + $scope.txtSupplierTypeActive_Model + "\"}";
                    DIMSFactory.UpdateMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#SupplierTypeModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });

                }
            }
        });
    }
    $scope.SaveBreakageCategoryData = function () {
        DIMSFactory.getXmlData(MasterName).success(function (response) {
            if ($scope.txtBreakageCategory_Model == "" || $scope.txtBreakageCategory_Model == null) {
                if (response.indexOf("BREAKAGE_CATEGEORY_CODE") >= 0) {
                    alert("Please Enter Breakage Category Code");
                }
            } else if ($scope.txtBreakageCategoryName_Model == "" || $scope.txtBreakageCategoryName_Model == null) {
                if (response.indexOf("BREAKAGE_CATEGEORY_NAME") >= 0) {
                    alert("Please Enter Breakage Category Name");
                }
            }
            else {
                if ($("#BreakageCategory_Save").text() == "Save") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"BREAKAGE_CATEGEORY_CODE\":\"" + $scope.txtBreakageCategory_Model + "\",\"BREAKAGE_CATEGEORY_NAME\":\"" + $scope.txtBreakageCategoryName_Model + "\",\"BREAKAGE_CATEGEORY_DESCRIPTION\":\"" + $scope.txtBreakageCategoryDescription_Model + "\",\"CREATED_BY\":\"" + $scope.txtBreakageCategoryCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtBreakageCategoryCreatedDate_Model + "\",\"ACTIVE\":\"" + $scope.txtBreakageCategoryActive_Model + "\"}";
                    DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#BreakageCategoryModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
                else if ($("#BreakageCategory_Save").text() == "Update") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"ID\":\"" + $scope.BreakageCategory_id_Model + "\",\"BREAKAGE_CATEGEORY_CODE\":\"" + $scope.txtBreakageCategory_Model + "\",\"BREAKAGE_CATEGEORY_NAME\":\"" + $scope.txtBreakageCategoryName_Model + "\",\"BREAKAGE_CATEGEORY_DESCRIPTION\":\"" + $scope.txtBreakageCategoryDescription_Model + "\",\"CREATED_BY\":\"" + $scope.txtBreakageCategoryCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtBreakageCategoryCreatedDate_Model + "\",\"ACTIVE\":\"" + $scope.txtBreakageCategoryActive_Model + "\"}";
                    DIMSFactory.UpdateMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#BreakageCategoryModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });

                }
            }
        });
    }
    $scope.SaveDefectTypeData = function () {
        DIMSFactory.getXmlData(MasterName).success(function (response) {
            if ($scope.txtDefectTypeCode_Model == "" || $scope.txtDefectTypeCode_Model == null) {
                if (response.indexOf("DEFECT_TYPE_CODE") >= 0) {
                    alert("Please Enter Defect Type Code");
                }
            } else if ($scope.txtDefectTypeName_Model == "" || $scope.txtDefectTypeName_Model == null) {
                if (response.indexOf("DEFECT_TYPE_NAME") >= 0) {
                    alert("Please Enter Defect Type Name");
                }
            }
            else if ($scope.txtDefectProductType_Model == "" || $scope.txtDefectProductType_Model == null) {
                if (response.indexOf("PRODUCT_TYPE_NAME") >= 0) {
                    alert("Please Enter Product Type Name");
                }
            }
            else {
                if ($("#DefectType_Save").text() == "Save") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"DEFECT_TYPE_CODE\":\"" + $scope.txtDefectTypeCode_Model + "\",\"DEFECT_TYPE_NAME\":\"" + $scope.txtDefectTypeName_Model + "\",\"DEFECT_TYPE_DESCRIPTION\":\"" + $scope.txtDefectTypeDescription_Model + "\",\"PRODUCT_TYPE_NAME\":\"" + $scope.txtDefectProductType_Model + "\",\"PRODUCT_CATEGORY_NAME\":\"" + $scope.txtDefectProductCategory_Model + "\",\"PRODUCT_TYPE_CODE\":\"" + $scope.txtDefectProductType_code_Model + "\",\"PRODUCT_CATEGORY_CODE\":\"" + $scope.txtDefectProductCategory_code_Model + "\",\"CREATED_BY\":\"" + $scope.txtDefectTypeCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtDefectTypeCreatedDate_Model + "\",\"ACTIVE\":\"" + $scope.txtDefectTypeActive_Model + "\"}";
                    DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#DefectTypeModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
                else if ($("#DefectType_Save").text() == "Update") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"ID\":\"" + $scope.DefectType_id_Model + "\",\"DEFECT_TYPE_CODE\":\"" + $scope.txtDefectTypeCode_Model + "\",\"DEFECT_TYPE_NAME\":\"" + $scope.txtDefectTypeName_Model + "\",\"DEFECT_TYPE_DESCRIPTION\":\"" + $scope.txtDefectTypeDescription_Model + "\",\"PRODUCT_TYPE_NAME\":\"" + $scope.txtDefectProductType_Model + "\",\"PRODUCT_CATEGORY_NAME\":\"" + $scope.txtDefectProductCategory_Model + "\",\"PRODUCT_TYPE_CODE\":\"" + $scope.txtDefectProductType_code_Model + "\",\"PRODUCT_CATEGORY_CODE\":\"" + $scope.txtDefectProductCategory_code_Model + "\",\"CREATED_BY\":\"" + $scope.txtDefectTypeCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtDefectTypeCreatedDate_Model + "\",\"ACTIVE\":\"" + $scope.txtDefectTypeActive_Model + "\"}";
                    DIMSFactory.UpdateMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#DefectTypeModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });

                }
            }
        });
    }
    $scope.SaveRecoveryTypeData = function () {
        DIMSFactory.getXmlData(MasterName).success(function (response) {
            if ($scope.txtRecoveryType_Model == "" || $scope.txtRecoveryType_Model == null) {
                if (response.indexOf("RECOVERY_TYPE_CODE") >= 0) {
                    alert("Please Enter Recovery Type Code");
                }
            } else if ($scope.txtRecoveryTypeName_Model == "" || $scope.txtRecoveryTypeName_Model == null) {
                if (response.indexOf("RECOVERY_TYPE_NAME") >= 0) {
                    alert("Please Enter Recovery Type Name");
                }
            }
            else {
                if ($("#RecoveryType_Save").text() == "Save") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"RECOVERY_TYPE_CODE\":\"" + $scope.txtRecoveryType_Model + "\",\"RECOVERY_TYPE_NAME\":\"" + $scope.txtRecoveryTypeName_Model + "\",\"RECOVERY_TYPE_DESCRIPTION\":\"" + $scope.txtRecoveryTypeDescription_Model + "\",\"CREATED_BY\":\"" + $scope.txtRecoveryTypeCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtRecoveryTypeCreatedDate_Model + "\",\"ACTIVE\":\"" + $scope.txtRecoveryTypeActive_Model + "\"}";
                    DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#RecoveryTypeModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
                else if ($("#RecoveryType_Save").text() == "Update") {

                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"ID\":\"" + $scope.RecoveryType_id_Model + "\",\"RECOVERY_TYPE_CODE\":\"" + $scope.txtRecoveryType_Model + "\",\"RECOVERY_TYPE_NAME\":\"" + $scope.txtRecoveryTypeName_Model + "\",\"RECOVERY_TYPE_DESCRIPTION\":\"" + $scope.txtRecoveryTypeDescription_Model + "\",\"CREATED_BY\":\"" + $scope.txtRecoveryTypeCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtRecoveryTypeCreatedDate_Model + "\",\"ACTIVE\":\"" + $scope.txtRecoveryTypeActive_Model + "\"}";
                    DIMSFactory.UpdateMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#RecoveryTypeModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
            }
        });
    }
    $scope.SaveSurveyCriteriaData = function () {
        DIMSFactory.getXmlData(MasterName).success(function (response) {
            if ($scope.txtSurveyCriteriaCode_Model == "" || $scope.txtSurveyCriteriaCode_Model == null) {
                if (response.indexOf("SURVEY_CRITERIA_CODE") >= 0) {
                    alert("Please Enter Survey Criteria Code");
                }
            } else if ($scope.txtSurveyCriteriaName_Model == "" || $scope.txtSurveyCriteriaName_Model == null) {
                if (response.indexOf("SURVEY_CRITERIA_NAME") >= 0) {
                    alert("Please Enter Survey Criteria Name");
                }
            }
            else if ($scope.txtSurveyCriteriaBreakageCategoryName_Model == "" || $scope.txtSurveyCriteriaBreakageCategoryName_Model == null) {
                if (response.indexOf("BREAKAGE_CATEGORY_NAME") >= 0) {
                    alert("Please Enter Breakage Category Name");
                }
            }
            else {
                if ($("#SurveyCriteria_Save").text() == "Save") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"SURVEY_CRITERIA_CODE\":\"" + $scope.txtSurveyCriteriaCode_Model + "\",\"SURVEY_CRITERIA_NAME\":\"" + $scope.txtSurveyCriteriaName_Model + "\",\"SURVEY_CRITERIA_DESCRIPTION\":\"" + $scope.txtSurveyCriteriaDescription_Model + "\",\"PRODUCT_TYPE_CODE\":\"" + $scope.txtSurveyCriteriaProductType_code_Model + "\",\"PRODUCT_CATEGORY_CODE\":\"" + $scope.txtSurveyCriteriaProductCategory_code_Model + "\",\"PRODUCT_TYPE_NAME\":\"" + $scope.txtSurveyCriteriaProductType_Model + "\",\"PRODUCT_CATEGORY_NAME\":\"" + $scope.txtSurveyCriteriaProductCategory_Model + "\",\"BREAKAGE_CATEGORY_NAME\":\"" + $scope.txtSurveyCriteriaBreakageCategoryName_Model + "\",\"BREAKAGE_CATEGORY_CODE\":\"" + $scope.txtSurveyCriteriaBreakageCategory_code_Model + "\",\"CREATED_BY\":\"" + $scope.txtSurveyCriteriaCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtSurveyCriteriaCreatedDate_Model + "\",\"ACTIVE\":\"" + $scope.txtSurveyCriteriaActive_Model + "\"}";
                    DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#SurveyCriteriaModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
                else if ($("#SurveyCriteria_Save").text() == "Update") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"ID\":\"" + $scope.SurveyCriteria_id_Model + "\",\"SURVEY_CRITERIA_CODE\":\"" + $scope.txtSurveyCriteriaCode_Model + "\",\"SURVEY_CRITERIA_NAME\":\"" + $scope.txtSurveyCriteriaName_Model + "\",\"SURVEY_CRITERIA_DESCRIPTION\":\"" + $scope.txtSurveyCriteriaDescription_Model + "\",\"PRODUCT_TYPE_CODE\":\"" + $scope.txtSurveyCriteriaProductType_code_Model + "\",\"PRODUCT_CATEGORY_CODE\":\"" + $scope.txtSurveyCriteriaProductCategory_code_Model + "\",\"PRODUCT_TYPE_NAME\":\"" + $scope.txtSurveyCriteriaProductType_Model + "\",\"PRODUCT_CATEGORY_NAME\":\"" + $scope.txtSurveyCriteriaProductCategory_Model + "\",\"BREAKAGE_CATEGORY_NAME\":\"" + $scope.txtSurveyCriteriaBreakageCategoryName_Model + "\",\"BREAKAGE_CATEGORY_CODE\":\"" + $scope.txtSurveyCriteriaBreakageCategory_code_Model + "\",\"CREATED_BY\":\"" + $scope.txtSurveyCriteriaCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtSurveyCriteriaCreatedDate_Model + "\",\"ACTIVE\":\"" + $scope.txtSurveyCriteriaActive_Model + "\"}";
                    DIMSFactory.UpdateMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#SurveyCriteriaModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });

                }
            }
        });
    }
    $scope.SaveObservationData = function () {
        DIMSFactory.getXmlData(MasterName).success(function (response) {
            if ($scope.txtObservationCode_Model == "" || $scope.txtObservationCode_Model == null) {
                if (response.indexOf("OBSERVATION_CODE") >= 0) {
                    alert("Please Enter Observation Code");
                }
            } else if ($scope.txtObservationName_Model == "" || $scope.txtObservationName_Model == null) {
                if (response.indexOf("OBSERVATION_NAME") >= 0) {
                    alert("Please Enter Observation Name");
                }
            }
                //else if ($scope.txtObservationDescription_Model == "" || $scope.txtObservationDescription_Model == null) {
                //    if (response.indexOf("OBSERVATION_DESCRIPTION") >= 0) {
                //        alert("Please Enter Observation Description");
                //    }
                //}
            else if ($scope.txtObservationProductType_Model == "" || $scope.txtObservationProductType_Model == null) {
                if (response.indexOf("PRODUCT_TYPE_NAME") >= 0) {
                    alert("Please Enter Product Type Name");
                }
            }
            else {
                if ($("#Observation_Save").text() == "Save") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"OBSERVATION_CODE\":\"" + $scope.txtObservationCode_Model + "\",\"OBSERVATION_NAME\":\"" + $scope.txtObservationName_Model + "\",\"OBSERVATION_DESCRIPTION\":\"" + $scope.txtObservationDescription_Model + "\",\"PRODUCT_TYPE_NAME\":\"" + $scope.txtObservationProductType_Model + "\",\"PRODUCT_CATEGORY_NAME\":\"" + $scope.txtObservationProductCategory_Model + "\",\"PRODUCT_TYPE_code\":\"" + $scope.txtObservationProductType_code_Model + "\",\"PRODUCT_CATEGORY_CODE\":\"" + $scope.txtObservationProductCategory_code_Model + "\",\"CREATED_BY\":\"" + $scope.txtObservationCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtObservationCreatedDate_Model + "\",\"ACTIVE\":\"" + $scope.txtObservationActive_Model + "\"}";
                    DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#ObservationModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
                else if ($("#Observation_Save").text() == "Update") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"ID\":\"" + $scope.Observation_id_Model + "\",\"OBSERVATION_CODE\":\"" + $scope.txtObservationCode_Model + "\",\"OBSERVATION_NAME\":\"" + $scope.txtObservationName_Model + "\",\"OBSERVATION_DESCRIPTION\":\"" + $scope.txtObservationDescription_Model + "\",\"PRODUCT_TYPE_NAME\":\"" + $scope.txtObservationProductType_Model + "\",\"PRODUCT_CATEGORY_NAME\":\"" + $scope.txtObservationProductCategory_Model + "\",\"PRODUCT_TYPE_code\":\"" + $scope.txtObservationProductType_code_Model + "\",\"PRODUCT_CATEGORY_CODE\":\"" + $scope.txtObservationProductCategory_code_Model + "\",\"CREATED_BY\":\"" + $scope.txtObservationCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtObservationCreatedDate_Model + "\",\"ACTIVE\":\"" + $scope.txtObservationActive_Model + "\"}";
                    DIMSFactory.UpdateMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#ObservationModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }

            }
        });
    }
    $scope.SaveCompensationModeData = function () {
        DIMSFactory.getXmlData(MasterName).success(function (response) {
            if ($scope.txtCompensationModeCode_Model == "" || $scope.txtCompensationModeCode_Model == null) {
                if (response.indexOf("COMPENSATION_MODE_CODE") >= 0) {
                    alert("Please Enter Compensation Mode Code");
                }
            } else if ($scope.txtCompensationModeName_Model == "" || $scope.txtCompensationModeName_Model == null) {
                if (response.indexOf("COMPENSATION_MODE_NAME") >= 0) {
                    alert("Please Enter Compensation Mode Name");
                }
            }
            else if ($scope.txtCompensationModeProductType_Model == "" || $scope.txtCompensationModeProductType_Model == null) {
                if (response.indexOf("PRODUCT_TYPE_NAME") >= 0) {
                    alert("Please Enter Product Type Name");
                }
            }
            else {
                if ($("#CompensationMode_Save").text() == "Save") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"COMPENSATION_MODE_CODE\":\"" + $scope.txtCompensationModeCode_Model + "\",\"COMPENSATION_MODE_NAME\":\"" + $scope.txtCompensationModeName_Model + "\",\"COMPENSATION_MODE_DESCRIPTION\":\"" + $scope.txtCompensationModeDescription_Model + "\",\"PRODUCT_TYPE_CODE\":\"" + $scope.txtCompensationModeProductType_code_Model + "\",\"PRODUCT_TYPE_NAME\":\"" + $scope.txtCompensationModeProductType_Model + "\",\"CREATED_BY\":\"" + $scope.txtCompensationModeCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtCompensationModeCreatedDate_Model + "\",\"ACTIVE\":\"" + $scope.txtCompensationModeActive_Model + "\"}";
                    DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#CompensationModeModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
                else if ($("#CompensationMode_Save").text() == "Update") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"ID\":\"" + $scope.CompensationMode_id_Model + "\",\"COMPENSATION_MODE_CODE\":\"" + $scope.txtCompensationModeCode_Model + "\",\"COMPENSATION_MODE_NAME\":\"" + $scope.txtCompensationModeName_Model + "\",\"COMPENSATION_MODE_DESCRIPTION\":\"" + $scope.txtCompensationModeDescription_Model + "\",\"PRODUCT_TYPE_CODE\":\"" + $scope.txtCompensationModeProductType_code_Model + "\",\"PRODUCT_TYPE_NAME\":\"" + $scope.txtCompensationModeProductType_Model + "\",\"CREATED_BY\":\"" + $scope.txtCompensationModeCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtCompensationModeCreatedDate_Model + "\",\"ACTIVE\":\"" + $scope.txtCompensationModeActive_Model + "\"}";
                    DIMSFactory.UpdateMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#CompensationModeModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
            }
        });
    }
    //rajanna
    $scope.SaveCountryData = function () {
        //Getting xml values from Controller for Country
        DIMSFactory.getXmlData(MasterName).success(function (response) {
            if ($scope.txtCountryCode_Model == "") {
                if (response.indexOf("COUNTRY_CODE") >= 0) {
                    alert("Please Enter Country Code");
                }
            } else if ($scope.txtCountryName_Model == "") {
                if (response.indexOf("COUNTRY_NAME") >= 0) {
                    alert("Please Enter Country Name");
                }
            } else {
                if ($("#Country_Save").text() == "Save") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"COUNTRY_CODE\":\"" + $scope.txtCountryCode_Model + "\",\"COUNTRY_NAME\":\"" + $scope.txtCountryName_Model + "\"}";
                    DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#CountryModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
                else if ($("#Country_Save").text() == "Update") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"ID\":\"" + $scope.Country_id_Model + "\",\"COUNTRY_CODE\":\"" + $scope.txtCountryCode_Model + "\",\"COUNTRY_NAME\":\"" + $scope.txtCountryName_Model + "\"}";
                    DIMSFactory.UpdateMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#CountryModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }

                //alert("Update");
            }
        });
    }
    $scope.SaveCurrencyData = function () {
        //Getting xml values from Controller for Country
        DIMSFactory.getXmlData(MasterName).success(function (response) {
            if ($scope.txtCurrencyCode_Model == "") {
                if (response.indexOf("CURRENCY_CODE") >= 0) {
                    alert("Please Enter currency Code");
                }
            } else {
                if ($("#Currency_Save").text() == "Save") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"CURRENCY_CODE\":\"" + $scope.txtCurrencyCode_Model + "\",\"CURRENCY_DESC\":\"" + $scope.txtCurrencyDescription_Model + "\",\"BASE_CURRENCY\":\"" + $scope.txtBaseCurrency_Model + "\",\"COUNTRY_CODE\":\"" + $scope.txtCurrencyCountryCode_Model + "\",\"COUNTRY_NAME\":\"" + $scope.txtCurrencyCountryName_Model + "\",\"CREATED_BY\":\"" + $scope.txtCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtCreatedDate_Model + "\"}";
                    DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#CurrencyModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
                else if ($("#Currency_Save").text() == "Update") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"ID\":\"" + $scope.Currency_id_Model + "\",\"CURRENCY_DESC\":\"" + $scope.txtCurrencyDescription_Model + "\",\"BASE_CURRENCY\":\"" + $scope.txtBaseCurrency_Model + "\",\"COUNTRY_ID\":\"" + $scope.txtCurrencyCountryCode_Model + "\",\"COUNTRY_NAME\":\"" + $scope.txtCurrencyCountryName_Model + "\",\"CREATED_BY\":\"" + $scope.txtCreatedBy_Model + "\",\"CREATED_DATE\":\"" + $scope.txtCreatedDate_Model + "\"}";
                    DIMSFactory.UpdateMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#CurrencyModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }

                //alert("Update");
            }
        });
    }

    $scope.SaveAreaData = function () {

        //Getting xml values from Controller for Country
        DIMSFactory.getXmlData(MasterName).success(function (response) {

            if ($scope.txtAreaCode_Model == "") {
                if (response.indexOf("AREA_CODE") >= 0) {
                    alert("Please Enter Area Code");
                }
            } else if ($scope.txtAreaName_Model == "") {
                if (response.indexOf("AREA_NAME") >= 0) {
                    alert("Please Enter Area Name");
                }
            } else {

                if ($("#Area_Save").text() == "Save") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"AREA_CODE\":\"" + $scope.txtAreaCode_Model + "\",\"AREA_NAME\":\"" + $scope.txtAreaName_Model + "\",\"AREA_DESCRIPTION\":\"" + $scope.txtAreaDesc_Model + "\",\"COUNTRY_CODE\":\"" + $scope.AreaCountry_Code + "\",\"COUNTRY_NAME\":\"" + $scope.txtAreaCountryName_Model + "\"}";
                    DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#AreaModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
                else if ($("#Area_Save").text() == "Update") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"ID\":\"" + $scope.Area_id_Model + "\",\"AREA_CODE\":\"" + $scope.txtAreaCode_Model + "\",\"AREA_NAME\":\"" + $scope.txtAreaName_Model + "\",\"AREA_DESCRIPTION\":\"" + $scope.txtAreaDesc_Model + "\",\"COUNTRY_CODE\":\"" + $scope.AreaCountry_Code + "\",\"COUNTRY_NAME\":\"" + $scope.txtAreaCountryName_Model + "\"}";
                    DIMSFactory.UpdateMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#AreaModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
            }
        });
    }

    $scope.SaveStateData = function () {
        //Getting xml values from Controller for Country
        DIMSFactory.getXmlData(MasterName).success(function (response) {
            if ($scope.txtStateCode_Model == "") {
                if (response.indexOf("STATE_CODE") >= 0) {
                    alert("Please Enter State Code");
                }
            } else if ($scope.txtStateName_Model == "") {
                if (response.indexOf("STATE_DESC") >= 0) {
                    alert("Please Enter State Name");
                }
            } else if ($scope.txtStateArea_Model == "") {
                if (response.indexOf("AREA_NAME") >= 0) {
                    alert("Please Select Area Name");
                }
            } else {
                if ($("#State_Save").text() == "Save") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"STATE_CODE\":\"" + $scope.txtStateCode_Model + "\",\"STATE_DESC\":\"" + $scope.txtStateName_Model + "\",\"AREA_CODE\":\"" + MasterScope.StateArea_Code + "\",\"AREA_NAME\":\"" + $scope.txtStateArea_Model + "\",\"COUNTRY_CODE\":\"" + MasterScope.StateAreaCountry_Code + "\",\"COUNTRY_DESC\":\"" + $scope.txtStateCountry_Model + "\"}";
                    DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#StateModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
                else if ($("#State_Save").text() == "Update") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"ID\":\"" + $scope.State_id_Model + "\",\"STATE_CODE\":\"" + $scope.txtStateCode_Model + "\",\"STATE_DESC\":\"" + $scope.txtStateName_Model + "\",\"AREA_CODE\":\"" + MasterScope.StateArea_Code + "\",\"AREA_NAME\":\"" + $scope.txtStateArea_Model + "\",\"COUNTRY_CODE\":\"" + $scope.StateAreaCountry_Code + "\",\"COUNTRY_DESC\":\"" + $scope.txtStateCountry_Model + "\"}";
                    DIMSFactory.UpdateMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#StateModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
            }
        });
    }

    $scope.SaveCityData = function () {
        //Getting xml values from Controller for Country
        DIMSFactory.getXmlData(MasterName).success(function (response) {
            if ($scope.txtCityCode_Model == "") {
                if (response.indexOf("CITY_CODE") >= 0) {
                    alert("Please Enter City Code");
                }
            } else if ($scope.txtCityName_Model == "") {
                if (response.indexOf("CITY_NAME") >= 0) {
                    alert("Please Enter City Name");
                }
            } else if ($scope.txtCityState_Model == "") {
                if (response.indexOf("STATE_DESC") >= 0) {
                    alert("Please Select State");
                }
            } else {
                if ($("#City_Save").text() == "Save") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"STATE_ID\":\"" + MasterScope.CityState_Id + "\",\"CITY_CODE\":\"" + $scope.txtCityCode_Model + "\",\"CITY_NAME\":\"" + $scope.txtCityName_Model + "\",\"STATE_CODE\":\"" + MasterScope.CityState_Code + "\",\"STATE_DESC\":\"" + $scope.txtCityState_Model + "\",\"AREA_CODE\":\"" + $scope.CityArea_Code + "\",\"AREA_NAME\":\"" + $scope.txtCityArea_Model + "\"}";
                    DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#CityModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
                else if ($("#City_Save").text() == "Update") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"ID\":\"" + $scope.City_id_Model + "\",\"STATE_ID\":\"" + MasterScope.CityState_Id + "\",\"CITY_CODE\":\"" + $scope.txtCityCode_Model + "\",\"CITY_NAME\":\"" + $scope.txtCityName_Model + "\",\"STATE_CODE\":\"" + MasterScope.CityState_Code + "\",\"STATE_DESC\":\"" + $scope.txtCityState_Model + "\",\"AREA_CODE\":\"" + $scope.CityArea_Code + "\",\"AREA_NAME\":\"" + $scope.txtCityArea_Model + "\"}";
                    DIMSFactory.UpdateMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#CityModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
            }
        });
    }

    $scope.SaveLocationData = function () {
        //Getting xml values from Controller for Country
        DIMSFactory.getXmlData(MasterName).success(function (response) {
            if ($scope.txtLocationCode_Model == "") {
                if (response.indexOf("LOCATION_CODE") >= 0) {
                    alert("Please Enter Location Code");
                }
            } else if ($scope.txtLocationName_Model == "") {
                if (response.indexOf("LOCATION_NAME") >= 0) {
                    alert("Please Enter Location Name");
                }
            } else if (MasterScope.LocationCity_Code == "") {
                if (response.indexOf("CITY_CODE") >= 0) {
                    alert("Please Select City");
                }
            } else if ($scope.txtLocationCity_Model == "") {
                if (response.indexOf("CITY_NAME") >= 0) {
                    alert("Please Select City");
                }
            }
            else {
                if ($("#Location_Save").text() == "Save") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"LOCATION_CODE\":\"" + $scope.txtLocationCode_Model + "\",\"LOCATION_NAME\":\"" + $scope.txtLocationName_Model + "\",\"LOCATION_DESCRIPTION\":\"" + MasterScope.txtLocationDesc_Model + "\",\"CITY_CODE\":\"" + MasterScope.LocationCity_Code + "\",\"CITY_NAME\":\"" + $scope.txtLocationCity_Model + "\",\"STATE_CODE\":\"" + MasterScope.LocationState_Code + "\",\"STATE_NAME\":\"" + $scope.txtLocationState_Model + "\",\"AREA_CODE\":\"" + MasterScope.LocationArea_Code + "\",\"AREA_NAME\":\"" + MasterScope.txtLocationArea_Model + "\",\"COUNTRY_CODE\":\"" + MasterScope.LocationCountry_Code + "\",\"COUNTRY_NAME\":\"" + $scope.txtLocationCountry_Model + "\"}";
                    DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#LocationModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
                else if ($("#Location_Save").text() == "Update") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"ID\":\"" + $scope.Location_id_Model + "\",\"LOCATION_CODE\":\"" + $scope.txtLocationCode_Model + "\",\"LOCATION_NAME\":\"" + $scope.txtLocationName_Model + "\",\"LOCATION_DESCRIPTION\":\"" + MasterScope.txtLocationDesc_Model + "\",\"CITY_CODE\":\"" + MasterScope.LocationCity_Code + "\",\"CITY_NAME\":\"" + $scope.txtLocationCity_Model + "\",\"STATE_CODE\":\"" + MasterScope.LocationState_Code + "\",\"STATE_NAME\":\"" + $scope.txtLocationState_Model + "\",\"AREA_CODE\":\"" + MasterScope.LocationArea_Code + "\",\"AREA_NAME\":\"" + MasterScope.txtLocationArea_Model + "\",\"COUNTRY_CODE\":\"" + MasterScope.LocationCountry_Code + "\",\"COUNTRY_NAME\":\"" + $scope.txtLocationCountry_Model + "\"}";
                    DIMSFactory.UpdateMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#LocationModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
            }
        });
    }

    $scope.SaveDepoData = function () {

        //Getting xml values from Controller for Country
        DIMSFactory.getXmlData(MasterName).success(function (response) {

            if ($scope.txtDepoCode_Model == "") {
                if (response.indexOf("DEPO_CODE") >= 0) {
                    alert("Please Enter Depo Code");
                }
            } else if ($scope.txtDepoName_Model == "") {
                if (response.indexOf("DEPO_NAME") >= 0) {
                    alert("Please Enter Depo Name");
                }
            } else {
                if ($("#Depo_Save").text() == "Save") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"DEPO_CODE\":\"" + $scope.txtDepoCode_Model + "\",\"DEPO_NAME\":\"" + $scope.txtDepoName_Model + "\",\"DEPO_ADDRESS\":\"" + $scope.txtDepoAddress_Model + "\",\"PLANT_CODE\":\"" + MasterScope.DepoPlant_Code + "\",\"PLANT_NAME\":\"" + $scope.txtDepoPlantName_Model + "\",\"AREA_CODE\":\"" + MasterScope.DepoArea_Code + "\",\"AREA_NAME\":\"" + $scope.txtDepoAreaName_Model + "\",\"CITY_CODE\":\"" + MasterScope.DepoCity_Code + "\",\"CITY_NAME\":\"" + $scope.txtDepoCityName_Model + "\",\"STATE_CODE\":\"" + MasterScope.DepoState_Code + "\",\"STATE_NAME\":\"" + $scope.txtDepoStateName_Model + "\",\"COUNTRY_CODE\":\"" + MasterScope.DepoCountry_Code + "\",\"COUNTRY_NAME\":\"" + $scope.txtDepoCountryName_Model + "\",\"DEPO_DESCRIPTION\":\"" + $scope.txtDepoDesc_Model + "\"}";
                    DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#DepoModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
                else if ($("#Depo_Save").text() == "Update") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"ID\":\"" + $scope.Depo_id_Model + "\",\"DEPO_CODE\":\"" + $scope.txtDepoCode_Model + "\",\"DEPO_NAME\":\"" + $scope.txtDepoName_Model + "\",\"DEPO_ADDRESS\":\"" + $scope.txtDepoAddress_Model + "\",\"PLANT_CODE\":\"" + MasterScope.DepoPlant_Code + "\",\"PLANT_NAME\":\"" + $scope.txtDepoPlantName_Model + "\",\"AREA_CODE\":\"" + MasterScope.DepoArea_Code + "\",\"AREA_NAME\":\"" + $scope.txtDepoAreaName_Model + "\",\"CITY_CODE\":\"" + MasterScope.DepoCity_Code + "\",\"CITY_NAME\":\"" + $scope.txtDepoCityName_Model + "\",\"STATE_CODE\":\"" + MasterScope.DepoState_Code + "\",\"STATE_NAME\":\"" + $scope.txtDepoStateName_Model + "\",\"COUNTRY_CODE\":\"" + MasterScope.DepoCountry_Code + "\",\"COUNTRY_NAME\":\"" + $scope.txtDepoCountryName_Model + "\",\"DEPO_DESCRIPTION\":\"" + $scope.txtDepoDesc_Model + "\"}";
                    DIMSFactory.UpdateMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#DepoModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
            }
        });
    }

    $scope.SaveGroupCompData = function () {
        //Getting xml values from Controller for Country
        DIMSFactory.getXmlData(MasterName).success(function (response) {
            if ($scope.txtGroupCompCode_Model == "") {
                if (response.indexOf("GROUP_COMAPNY_CODE") >= 0) {
                    alert("Please Enter Group Company Code");
                }
            } else if ($scope.txtGroupCompName_Model == "") {
                if (response.indexOf("GROUP_COMANY_NAME") >= 0) {
                    alert("Please Enter Group Company Name");
                }
            } else if (MasterScope.txtGroupCompRoom_Model == "") {
                if (response.indexOf("ROOM_FLOOR") >= 0) {
                    alert("Please Enter Room/Floor");
                }
            } else if ($scope.txtGroupCompBlock_Model == "") {
                if (response.indexOf("BLOCK_BUILDING") >= 0) {
                    alert("Please Enter Block/Building");
                }
            }
            else if ($scope.txtGroupCompStreet_Model == "") {
                if (response.indexOf("STREET_PO_BOX") >= 0) {
                    alert("Please Enter Street/Post Box");
                }
            }
            else if ($scope.txtGroupCompCity_Model == "") {
                if (response.indexOf("CITY") >= 0) {
                    alert("Please Select City");
                }
            } else if ($scope.txtGroupCompZip_Model == "") {
                if (response.indexOf("ZIP_CODE") >= 0) {
                    alert("Please Enter Zip Code");
                }
            } else {
                if ($("#GroupComp_Save").text() == "Save") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"GROUP_COMAPNY_CODE\":\"" + $scope.txtGroupCompCode_Model + "\",\"GROUP_COMANY_NAME\":\"" + $scope.txtGroupCompName_Model + "\",\"ADDRESS\":\"" + $scope.txtGroupAddress_Model + "\",\"ROOM_FLOOR\":\"" + $scope.txtGroupCompRoom_Model + "\",\"BLOCK_BUILDING\":\"" + $scope.txtGroupCompBlock_Model + "\",\"STREET_PO_BOX\":\"" + $scope.txtGroupCompStreet_Model + "\",\"CITY\":\"" + $scope.txtGroupCompCity_Model + "\",\"STATE\":\"" + $scope.txtGroupCompState_Model + "\",\"COUNTRY\":\"" + $scope.txtGroupCompCountry_Model + "\",\"ZIP_CODE\":\"" + $scope.txtGroupCompZip_Model + "\",\"EMAIL\":\"" + $scope.txtGroupCompMail_Model + "\",\"WEBSITE\":\"" + $scope.txtGroupCompWebsite_Model + "\",\"PHONE1\":\"" + $scope.txtGroupCompPhone1_Model + "\",\"PHONE2\":\"" + $scope.txtGroupCompPhone2_Model + "\",\"MOBILE\":\"" + $scope.txtGroupCompMobile_Model + "\",\"FAX\":\"" + $scope.txtGroupCompFax_Model + "\"}";
                    DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#GroupCompModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
                else if ($("#GroupComp_Save").text() == "Update") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"ID\":\"" + $scope.GroupComp_id_Model + "\",\"GROUP_COMAPNY_CODE\":\"" + $scope.txtGroupCompCode_Model + "\",\"GROUP_COMANY_NAME\":\"" + $scope.txtGroupCompName_Model + "\",\"ADDRESS\":\"" + $scope.txtGroupAddress_Model + "\",\"ROOM_FLOOR\":\"" + $scope.txtGroupCompRoom_Model + "\",\"BLOCK_BUILDING\":\"" + $scope.txtGroupCompBlock_Model + "\",\"STREET_PO_BOX\":\"" + $scope.txtGroupCompStreet_Model + "\",\"CITY\":\"" + $scope.txtGroupCompCity_Model + "\",\"STATE\":\"" + $scope.txtGroupCompState_Model + "\",\"COUNTRY\":\"" + $scope.txtGroupCompCountry_Model + "\",\"ZIP_CODE\":\"" + $scope.txtGroupCompZip_Model + "\",\"EMAIL\":\"" + $scope.txtGroupCompMail_Model + "\",\"WEBSITE\":\"" + $scope.txtGroupCompWebsite_Model + "\",\"PHONE1\":\"" + $scope.txtGroupCompPhone1_Model + "\",\"PHONE2\":\"" + $scope.txtGroupCompPhone2_Model + "\",\"MOBILE\":\"" + $scope.txtGroupCompMobile_Model + "\",\"FAX\":\"" + $scope.txtGroupCompFax_Model + "\"}";
                    DIMSFactory.UpdateMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#GroupCompModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
            }
        });
    }

    $scope.SaveCompData = function () {
        //Getting xml values from Controller for Country
        DIMSFactory.getXmlData(MasterName).success(function (response) {
            if ($scope.txtCompCode_Model == "") {
                if (response.indexOf("COMPANY_CODE") >= 0) {
                    alert("Please Enter Company Code");
                }
            } else if ($scope.txtCompName_Model == "") {
                if (response.indexOf("COMPANY_NAME") >= 0) {
                    alert("Please Enter Company Name");
                }
            }
            else if (MasterScope.txtCompRoom_Model == "") {
                if (response.indexOf("ROOM_FLOOR") >= 0) {
                    alert("Please Enter Room/Floor");
                }
            } else if ($scope.txtCompBlock_Model == "") {
                if (response.indexOf("BLOCK_BUILDING") >= 0) {
                    alert("Please Enter Block/Building");
                }
            }
            else if ($scope.txtCompStreet_Model == "") {
                if (response.indexOf("STREET_PO_BOX") >= 0) {
                    alert("Please Enter Street/Post Box");
                }
            }
            else if ($scope.txtCompCity_Model == "") {
                if (response.indexOf("CITY") >= 0) {
                    alert("Please Select City");
                }
            } else if ($scope.txtCompZip_Model == "") {
                if (response.indexOf("ZIP_CODE") >= 0) {
                    alert("Please Enter Zip Code");
                }
            }
            else {
                if ($("#Comp_Save").text() == "Save") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"GROUP_COMPANY_ID\":\"" + MasterScope.CompGroupComp_Id + "\",\"COMAPNY_CODE\":\"" + $scope.txtCompCode_Model + "\",\"COMANY_NAME\":\"" + $scope.txtCompName_Model + "\",\"GROUP_COMAPNY_CODE\":\"" + $scope.txtCompGroupCompCode_Model + "\",\"GROUP_COMANY_NAME\":\"" + $scope.txtCompGroupCompName_Model + "\",\"ADDRESS\":\"" + $scope.txtCompAddress_Model + "\",\"ROOM_FLOOR\":\"" + $scope.txtCompRoom_Model + "\",\"BLOCK_BUILDING\":\"" + $scope.txtCompBlock_Model + "\",\"STREET_PO_BOX\":\"" + $scope.txtCompStreet_Model + "\",\"CITY\":\"" + $scope.txtCompCity_Model + "\",\"STATE\":\"" + $scope.txtCompState_Model + "\",\"COUNTRY\":\"" + $scope.txtCompCountry_Model + "\",\"ZIP_CODE\":\"" + $scope.txtCompZip_Model + "\",\"EMAIL\":\"" + $scope.txtCompMail_Model + "\",\"WEBSITE\":\"" + $scope.txtCompWebsite_Model + "\",\"PHONE1\":\"" + $scope.txtCompPhone1_Model + "\",\"PHONE2\":\"" + $scope.txtCompPhone2_Model + "\",\"MOBILE\":\"" + $scope.txtCompMobile_Model + "\",\"FAX\":\"" + $scope.txtCompFax_Model + "\"}";
                    DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#CompModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
                else if ($("#Comp_Save").text() == "Update") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"ID\":\"" + $scope.Comp_id_Model + "\",\"GROUP_COMPANY_ID\":\"" + MasterScope.CompGroupComp_Id + "\",\"COMAPNY_CODE\":\"" + $scope.txtCompCode_Model + "\",\"COMANY_NAME\":\"" + $scope.txtCompName_Model + "\",\"GROUP_COMAPNY_CODE\":\"" + $scope.txtCompGroupCompCode_Model + "\",\"GROUP_COMANY_NAME\":\"" + $scope.txtCompGroupCompName_Model + "\",\"ADDRESS\":\"" + $scope.txtCompAddress_Model + "\",\"ROOM_FLOOR\":\"" + $scope.txtCompRoom_Model + "\",\"BLOCK_BUILDING\":\"" + $scope.txtCompBlock_Model + "\",\"STREET_PO_BOX\":\"" + $scope.txtCompStreet_Model + "\",\"CITY\":\"" + $scope.txtCompCity_Model + "\",\"STATE\":\"" + $scope.txtCompState_Model + "\",\"COUNTRY\":\"" + $scope.txtCompCountry_Model + "\",\"ZIP_CODE\":\"" + $scope.txtCompZip_Model + "\",\"EMAIL\":\"" + $scope.txtCompMail_Model + "\",\"WEBSITE\":\"" + $scope.txtCompWebsite_Model + "\",\"PHONE1\":\"" + $scope.txtCompPhone1_Model + "\",\"PHONE2\":\"" + $scope.txtCompPhone2_Model + "\",\"MOBILE\":\"" + $scope.txtCompMobile_Model + "\",\"FAX\":\"" + $scope.txtCompFax_Model + "\"}";
                    alert(Master_Data);
                    DIMSFactory.UpdateMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#CompModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
            }
        });
    }

    $scope.SaveZoneData = function () {
        //Getting xml values from Controller for Country
        DIMSFactory.getXmlData(MasterName).success(function (response) {
            if ($scope.txtZoneCode_Model == "") {
                if (response.indexOf("ZONE_CODE") >= 0) {
                    alert("Please Enter Zone Code");
                }
            } else if ($scope.txtZoneName_Model == "") {
                if (response.indexOf("ZONE_NAME") >= 0) {
                    alert("Please Enter Zone Name");
                }
            } else if ($scope.txtZoneCompCode_Model == "") {
                if (response.indexOf("COMPANY_CODE") >= 0) {
                    alert("Please Enter Company Code");
                }
            } else {
                if ($("#Zone_Save").text() == "Save") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"ZONE_CODE\":\"" + $scope.txtZoneCode_Model + "\",\"ZONE_NAME\":\"" + $scope.txtZoneName_Model + "\",\"COMPANY_CODE\":\"" + $scope.txtZoneCompCode_Model + "\",\"COMPANY_NAME\":\"" + $scope.txtZoneCompName_Model + "\",\"COUNTRY_CODE\":\"" + MasterScope.ZoneCountry_Code + "\",\"COUNTRY_NAME\":\"" + $scope.txtZoneCountry_Model + "\"}";
                    DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#ZoneModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
                else if ($("#Zone_Save").text() == "Update") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"ID\":\"" + $scope.Zone_id_Model + "\",\"ZONE_CODE\":\"" + $scope.txtZoneCode_Model + "\",\"ZONE_NAME\":\"" + $scope.txtZoneName_Model + "\",\"COMPANY_CODE\":\"" + $scope.txtZoneCompCode_Model + "\",\"COMPANY_NAME\":\"" + $scope.txtZoneCompName_Model + "\",\"COUNTRY_CODE\":\"" + MasterScope.ZoneCountry_Code + "\",\"COUNTRY_NAME\":\"" + $scope.txtZoneCountry_Model + "\"}";
                    DIMSFactory.UpdateMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#ZoneModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
            }
        });
    }

    $scope.SaveBranchData = function () {
        //Getting xml values from Controller for Country
        DIMSFactory.getXmlData(MasterName).success(function (response) {
            if ($scope.txtBranchCode_Model == "") {
                if (response.indexOf("BRANCH_CODE") >= 0) {
                    alert("Please Enter Branch Code");
                }
            } else if ($scope.txtBranchName_Model == "") {
                if (response.indexOf("BRANCH_NAME") >= 0) {
                    alert("Please Enter Branch Name");
                }
            } else if ($scope.txtBranchCompName_Model == "") {
                if (response.indexOf("COMPANY_NAME") >= 0) {
                    alert("Please Select Company");
                }
            } else {
                if ($("#Branch_Save").text() == "Save") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"BRANCH_CODE\":\"" + $scope.txtBranchCode_Model + "\",\"BRANCH_NAME\":\"" + $scope.txtBranchName_Model + "\",\"COMPANY_CODE\":\"" + MasterScope.BranchComp_Code + "\",\"COMPANY_NAME\":\"" + $scope.txtBranchCompName_Model + "\"}";
                    DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#BranchModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
                else if ($("#Branch_Save").text() == "Update") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"ID\":\"" + $scope.Branch_id_Model + "\",\"BRANCH_CODE\":\"" + $scope.txtBranchCode_Model + "\",\"BRANCH_NAME\":\"" + $scope.txtBranchName_Model + "\",\"COMPANY_CODE\":\"" + MasterScope.BranchComp_Code + "\",\"COMPANY_NAME\":\"" + $scope.txtBranchCompName_Model + "\"}";
                    DIMSFactory.UpdateMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#BranchModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
            }
        });
    }

    $scope.SaveDeptData = function () {
        //Getting xml values from Controller for Country
        DIMSFactory.getXmlData(MasterName).success(function (response) {
            if ($scope.txtDeptCode_Model == "") {
                if (response.indexOf("DEPARTMENT_CODE") >= 0) {
                    alert("Please Enter Department Code");
                }
            } else if ($scope.txtDeptName_Model == "") {
                if (response.indexOf("DEPARTMENT_NAME") >= 0) {
                    alert("Please Enter Department Name");
                }
            } else {
                if ($("#Dept_Save").text() == "Save") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"DEPARTMENT_CODE\":\"" + $scope.txtDeptCode_Model + "\",\"DEPARTMENT_NAME\":\"" + $scope.txtDeptName_Model + "\",\"COMPANYDETAIL_CODE\":\"" + $scope.txtDeptCompCode_Model + "\",\"COMPANYDETAIL_NAME\":\"" + $scope.txtDeptCompName_Model + "\"}";
                    DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#DeptModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
                else if ($("#Dept_Save").text() == "Update") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"ID\":\"" + $scope.Dept_id_Model + "\",\"DEPARTMENT_CODE\":\"" + $scope.txtDeptCode_Model + "\",\"DEPARTMENT_NAME\":\"" + $scope.txtDeptName_Model + "\",\"COMPANYDETAIL_CODE\":\"" + $scope.txtDeptCompCode_Model + "\",\"COMPANYDETAIL_NAME\":\"" + $scope.txtDeptCompName_Model + "\"}";
                    DIMSFactory.UpdateMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#DeptModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
            }
        });
    }

    $scope.SaveCmplModeData = function () {
        //Getting xml values from Controller for Country
        DIMSFactory.getXmlData(MasterName).success(function (response) {
            if ($scope.txtCmplModeCode_Model == "") {
                if (response.indexOf("COMPLAINT_MODE_CODE") >= 0) {
                    alert("Please Enter Complaint Mode Code");
                }
            } else if ($scope.txtCmplModeName_Model == "") {
                if (response.indexOf("COMPLAINT_MODE_NAME") >= 0) {
                    alert("Please Enter Complaint Mode Name");
                }
            } else {
                if ($("#CmplMode_Save").text() == "Save") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"COMPLAINT_MODE_CODE\":\"" + $scope.txtCmplModeCode_Model + "\",\"COMPLAINT_MODE_NAME\":\"" + $scope.txtCmplModeName_Model + "\",\"COMPLAINT_MODE_DESCRIPTION\":\"" + $scope.txtCmplModeDesc_Model + "\"}";
                    DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#CmplModeModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
                else if ($("#CmplMode_Save").text() == "Update") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"ID\":\"" + $scope.CmplMode_id_Model + "\",\"COMPLAINT_MODE_CODE\":\"" + $scope.txtCmplModeCode_Model + "\",\"COMPLAINT_MODE_NAME\":\"" + $scope.txtCmplModeName_Model + "\",\"COMPLAINT_MODE_DESCRIPTION\":\"" + $scope.txtCmplModeDesc_Model + "\"}";
                    DIMSFactory.UpdateMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#CmplModeModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
            }
        });
    }

    $scope.SaveCmplTypeData = function () {
        //Getting xml values from Controller for Country
        DIMSFactory.getXmlData(MasterName).success(function (response) {
            if ($scope.txtCmplTypeCode_Model == "") {
                if (response.indexOf("COMPLAINT_TYPE_CODE") >= 0) {
                    alert("Please Enter complaint type Code");
                }
            } else if ($scope.txtCmplTypeName_Model == "") {
                if (response.indexOf("COMPLAINT_TYPE_NAME") >= 0) {
                    alert("Please Enter complaint type Name");
                }
            } else {
                if ($("#CmplType_Save").text() == "Save") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"COMPLAINT_TYPE_CODE\":\"" + $scope.txtCmplTypeCode_Model + "\",\"COMPLAINT_TYPE_NAME\":\"" + $scope.txtCmplTypeName_Model + "\",\"COMPLAINT_TYPE_DESCRIPTION\":\"" + $scope.txtCmplTypeDesc_Model + "\"}";
                    DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#CmplTypeModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
                else if ($("#CmplMode_Save").text() == "Update") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"COMPLAINT_TYPE_CODE\":\"" + $scope.CmplType_id_Model + "\",\"COMPLAINT_TYPE_CODE\":\"" + $scope.txtCmplTypeCode_Model + "\",\"COMPLAINT_TYPE_NAME\":\"" + $scope.txtCmplTypeName_Model + "\",\"COMPLAINT_TYPE_DESCRIPTION\":\"" + $scope.txtCmplTypeDesc_Model + "\"}";
                    DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#CmplTypeModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
            }
        });
    }

    $scope.SaveCmplCategoryData = function () {
        //Getting xml values from Controller for Country
        DIMSFactory.getXmlData(MasterName).success(function (response) {
            if ($scope.txtCmplCategoryCode_Model == "") {
                if (response.indexOf("COMPLAINT_CATEGORY_CODE") >= 0) {
                    alert("Please Enter Department Code");
                }
            } else if ($scope.txtCmplCategoryName_Model == "") {
                if (response.indexOf("COMPLAINT_CATEGORY_NAME") >= 0) {
                    alert("Please Enter Department Name");
                }
            } else {
                if ($("#CmplCategory_Save").text() == "Save") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"COMPLAINT_CATEGORY_CODE\":\"" + $scope.txtCmplCategoryCode_Model + "\",\"COMPLAINT_CATEGORY_NAME\":\"" + $scope.txtCmplCategoryName_Model + "\",\"COMPLAINT_CATEGORY_DESC\":\"" + $scope.txtCmplCategoryDesc_Model + "\"}";
                    DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#CmplCategoryModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
                else if ($("#CmplCategory_Save").text() == "Update") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"ID\":\"" + $scope.CmplCategory_id_Model + "\",\"COMPLAINT_CATEGORY_CODE\":\"" + $scope.txtCmplCategoryCode_Model + "\",\"COMPLAINT_CATEGORY_NAME\":\"" + $scope.txtCmplCategoryName_Model + "\",\"COMPLAINT_CATEGORY_DESC\":\"" + $scope.txtCmplCategoryDesc_Model + "\"}";
                    DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#CmplCategoryModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
            }
        });
    }

    $scope.SaveCmplNatureData = function () {
        //Getting xml values from Controller for Country
        DIMSFactory.getXmlData(MasterName).success(function (response) {
            if ($scope.txtCmplNatureCode_Model == "") {
                if (response.indexOf("NATUREOFCOMPLAINT_CODE") >= 0) {
                    alert("Please Enter Department Code");
                }
            } else if ($scope.txtCmplNatureName_Model == "") {
                if (response.indexOf("NATUREOFCOMPLAINT_NAME") >= 0) {
                    alert("Please Enter Department Name");
                }
            } else {
                if ($("#CmplNature_Save").text() == "Save") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"NATUREOFCOMPLAINT_CODE\":\"" + $scope.txtCmplNatureCode_Model + "\",\"NATUREOFCOMPLAINT_NAME\":\"" + $scope.txtCmplNatureName_Model + "\",\"NATUREOFCOMPLAINT_DESCRIPTION\":\"" + $scope.txtCmplNatureDesc_Model + "\",\"COMPLAINT_CATEGORY_CODE\":\"" + MasterScope.CmplNatureCmplCategory_Code + "\",\"COMPLAINT_CATEGORY_NAME\":\"" + $scope.txtCmplNatureCmplCategory_Model + "\",\"COMPLAINT_TYPE_CODE\":\"" + $scope.CmplNatureCmplType_Code + "\",\"COMPLAINT_TYPE_NAME\":\"" + $scope.txtCmplNatureCmplType_Model + "\"}";
                    DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#CmplNatureModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
                else if ($("#CmplNature_Save").text() == "Update") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"ID\":\"" + $scope.CmplNature_id_Model + "\",\"NATUREOFCOMPLAINT_CODE\":\"" + $scope.txtCmplNatureCode_Model + "\",\"NATUREOFCOMPLAINT_NAME\":\"" + $scope.txtCmplNatureName_Model + "\",\"NATUREOFCOMPLAINT_DESCRIPTION\":\"" + $scope.txtCmplNatureDesc_Model + "\",\"COMPLAINT_CATEGORY_CODE\":\"" + MasterScope.CmplNatureCmplCategory_Code + "\",\"COMPLAINT_CATEGORY_NAME\":\"" + $scope.txtCmplNatureCmplCategory_Model + "\",\"COMPLAINT_TYPE_CODE\":\"" + $scope.CmplNatureCmplType_Code + "\",\"COMPLAINT_TYPE_NAME\":\"" + $scope.txtCmplNatureCmplType_Model + "\"}";
                    DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#CmplNatureModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
            }
        });
    }

    $scope.SaveCmplPriorityData = function () {
        //Getting xml values from Controller for Country
        DIMSFactory.getXmlData(MasterName).success(function (response) {
            if ($scope.txtCmplPriorityCode_Model == "") {
                if (response.indexOf("COMPLAINT_PRIORITY_CODE") >= 0) {
                    alert("Please Enter complaint priority Code");
                }
            } else if ($scope.txtCmplPriorityName_Model == "") {
                if (response.indexOf("COMPLAINT_PRIORITY_NAME") >= 0) {
                    alert("Please Enter complaint priority Name");
                }
            } else {
                if ($("#CmplPriority_Save").text() == "Save") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"COMPLAINT_PRIORITY_CODE\":\"" + $scope.txtCmplPriorityCode_Model + "\",\"COMPLAINT_PRIORITY_NAME\":\"" + $scope.txtCmplPriorityName_Model + "\",\"COMPLAINT_PRIORITY_DESCRIPTION\":\"" + $scope.txtCmplPriorityDesc_Model + "\"}";
                    DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#CmplPriorityModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
                else if ($("#CmplPriority_Save").text() == "Update") {
                    var Master_Data = "{\"MasterType\":\"" + MasterName + "\",\"ID\":\"" + $scope.CmplPriority_id_Model + "\",\"COMPLAINT_PRIORITY_CODE\":\"" + $scope.txtCmplPriorityCode_Model + "\",\"COMPLAINT_PRIORITY_NAME\":\"" + $scope.txtCmplPriorityName_Model + "\",\"COMPLAINT_PRIORITY_DESCRIPTION\":\"" + $scope.txtCmplPriorityDesc_Model + "\"}";
                    DIMSFactory.SaveMasterData(Master_Data).success(function (response) {
                        var element = angular.element('#CmplPriorityModal');
                        element.modal('hide');
                        GetMasterResponse(MasterName);
                    });
                }
            }
        });
    }

});
function GetAreaCountryLookupData(obj) {
    MasterScope.$apply(function () {
        MasterScope.AreaCountry_Code = $(obj).children().eq(1).html();
        MasterScope.txtAreaCountryName_Model = $(obj).children().eq(2).html();
    });
    var element = angular.element('#LookUpModal');
    element.modal('hide');
}

function GetStateAreaLookupData(obj) {
    MasterScope.$apply(function () {
        MasterScope.StateArea_Code = $(obj).children().eq(1).html();
        MasterScope.txtStateArea_Model = $(obj).children().eq(2).html();
        MasterScope.StateAreaCountry_Code = $(obj).children().eq(3).html();
        MasterScope.txtStateCountry_Model = $(obj).children().eq(4).html();
    });
    var element = angular.element('#LookUpModal');
    element.modal('hide');
}

function GetCityStateLookupData(obj) {
    MasterScope.$apply(function () {
        MasterScope.CityState_Code = $(obj).children().eq(1).html();
        MasterScope.txtCityState_Model = $(obj).children().eq(2).html();
        MasterScope.CityArea_Code = $(obj).children().eq(3).html();
        MasterScope.txtCityArea_Model = $(obj).children().eq(4).html();
    });
    var element = angular.element('#LookUpModal');
    element.modal('hide');
}
function GetLocationCityLookupData(obj) {
    MasterScope.$apply(function () {
        MasterScope.LocationCity_Code = $(obj).children().eq(1).html();
        MasterScope.txtLocationCity_Model = $(obj).children().eq(2).html();
        MasterScope.LocationState_Code = $(obj).children().eq(3).html();
        MasterScope.txtLocationState_Model = $(obj).children().eq(4).html();
        MasterScope.LocationArea_Code = $(obj).children().eq(5).html();
        MasterScope.txtLocationArea_Model = $(obj).children().eq(6).html();
        MasterScope.LocationCountry_Code = $(obj).children().eq(7).html();
        MasterScope.txtLocationCountry_Model = $(obj).children().eq(8).html();
    });
    var element = angular.element('#LookUpModal');
    element.modal('hide');
}
function GetDepoPlantLookupData(obj) {
    MasterScope.$apply(function () {
        MasterScope.DepoPlant_Code = $(obj).children().eq(1).html();
        MasterScope.txtDepoPlantName_Model = $(obj).children().eq(2).html();
        MasterScope.DepoArea_Code = $(obj).children().eq(3).html();

        MasterScope.txtDepoAreaName_Model = $(obj).children().eq(4).html();
        MasterScope.DepoCity_Code = $(obj).children().eq(5).html();
        MasterScope.txtDepoCityName_Model = $(obj).children().eq(6).html();
        MasterScope.DepoState_Code = $(obj).children().eq(7).html();
        MasterScope.txtDepoStateName_Model = $(obj).children().eq(8).html();
        MasterScope.DepoCountry_Code = $(obj).children().eq(9).html();
        MasterScope.txtDepoCountryName_Model = $(obj).children().eq(10).html();

        MasterScope.txtDepoActive_Model = $(obj).children().eq(11).html();
    });
    var element = angular.element('#LookUpModal');
    element.modal('hide');


}


function CurrencyMasterLookupData(obj) {
    MasterScope.$apply(function () {
        MasterScope.txtCurrencyCountryCode_Model = $(obj).children().eq(1).html();
        MasterScope.txtCurrencyCountryName_Model = $(obj).children().eq(2).html();

    });
    var element = angular.element('#LookUpModal');
    element.modal('hide');
}

function GetGroupCompCityLookupData(obj) {
    MasterScope.$apply(function () {
        MasterScope.GroupCompCity_Code = $(obj).children().eq(1).html();
        MasterScope.txtGroupCompCity_Model = $(obj).children().eq(2).html();
        MasterScope.GroupCompState_Code = $(obj).children().eq(3).html();
        MasterScope.txtGroupCompState_Model = $(obj).children().eq(4).html();
        MasterScope.GroupCompCountry_Code = $(obj).children().eq(5).html();
        MasterScope.txtGroupCompCountry_Model = $(obj).children().eq(6).html();
        MasterScope.GroupCompArea_Code = $(obj).children().eq(7).html();
        MasterScope.GroupCompArea_Name = $(obj).children().eq(8).html();
    });
    var element = angular.element('#LookUpModal');
    element.modal('hide');
}
function GetCompGroupCompCodeLookupData(obj) {
    MasterScope.$apply(function () {
        MasterScope.txtCompGroupCompCode_Model = $(obj).children().eq(1).html();
        MasterScope.txtCompGroupCompName_Model = $(obj).children().eq(2).html();
    });
    var element = angular.element('#LookUpModal');
    element.modal('hide');
}
function GetGroupCompCityLookupData(obj) {
    MasterScope.$apply(function () {
        MasterScope.GroupCompCity_Code = $(obj).children().eq(1).html();
        MasterScope.txtGroupCompCity_Model = $(obj).children().eq(2).html();
        MasterScope.GroupCompState_Code = $(obj).children().eq(3).html();
        MasterScope.txtGroupCompState_Model = $(obj).children().eq(4).html();
        MasterScope.GroupCompCountry_Code = $(obj).children().eq(5).html();
        MasterScope.txtGroupCompCountry_Model = $(obj).children().eq(6).html();
        MasterScope.GroupCompArea_Code = $(obj).children().eq(7).html();
        MasterScope.GroupCompArea_Name = $(obj).children().eq(8).html();
    });
    var element = angular.element('#LookUpModal');
    element.modal('hide');
}

function GetCompGroupCompCodeLookupData(obj) {
    MasterScope.$apply(function () {
        MasterScope.txtCompGroupCompCode_Model = $(obj).children().eq(1).html();
        MasterScope.txtCompGroupCompName_Model = $(obj).children().eq(2).html();
    });
    var element = angular.element('#LookUpModal');
    element.modal('hide');
}

function GetCompCityLookupData(obj) {
    MasterScope.$apply(function () {
        MasterScope.CompCity_Code = $(obj).children().eq(1).html();
        MasterScope.txtCompCity_Model = $(obj).children().eq(2).html();
        MasterScope.CompState_Code = $(obj).children().eq(3).html();
        MasterScope.txtCompState_Model = $(obj).children().eq(4).html();
        MasterScope.CompCountry_Code = $(obj).children().eq(5).html();
        MasterScope.txtCompCountry_Model = $(obj).children().eq(6).html();
        MasterScope.CompArea_Code = $(obj).children().eq(7).html();
        MasterScope.CompArea_Name = $(obj).children().eq(8).html();
    });
    var element = angular.element('#LookUpModal');
    element.modal('hide');
}

function GetZoneCompCodeLookupData(obj) {
    MasterScope.$apply(function () {
        MasterScope.txtZoneCompCode_Model = $(obj).children().eq(1).html();
        MasterScope.txtZoneCompName_Model = $(obj).children().eq(2).html();
    });
    var element = angular.element('#LookUpModal');
    element.modal('hide');
}

function GetZoneCountryLookupData(obj) {
    MasterScope.$apply(function () {
        MasterScope.ZoneCountry_Code = $(obj).children().eq(1).html();
        MasterScope.txtZoneCountry_Model = $(obj).children().eq(2).html();
    });
    var element = angular.element('#LookUpModal');
    element.modal('hide');
}

function GetBranchCompLookupData(obj) {
    MasterScope.$apply(function () {
        MasterScope.BranchComp_Code = $(obj).children().eq(1).html();
        MasterScope.txtBranchCompName_Model = $(obj).children().eq(2).html();
    });
    var element = angular.element('#LookUpModal');
    element.modal('hide');
}

function GetDeptCompCodeLookupData(obj) {
    MasterScope.$apply(function () {
        MasterScope.txtDeptCompCode_Model = $(obj).children().eq(1).html();
        MasterScope.txtDeptCompName_Model = $(obj).children().eq(2).html();
    });
    var element = angular.element('#LookUpModal');
    element.modal('hide');
}

function GetCmplCategoryLookupData(obj) {
    MasterScope.$apply(function () {
        MasterScope.txtCmplNatureCmplCategory_Model = $(obj).children().eq(1).html();
        MasterScope.txtCmplNatureCmplCategory_Model = $(obj).children().eq(2).html();
        MasterScope.txtCmplNatureCmplCategory_Model = $(obj).children().eq(3).html();
        MasterScope.txtCmplNatureCmplType_Model = $(obj).children().eq(4).html();
    });
    var element = angular.element('#LookUpModal');
    element.modal('hide');
}


function ProductTypeLookupData(obj) {


    alert("ProductTypeLookupData");

    MasterScope.$apply(function () {

        MasterScope.txtProductType_code_Model = $(obj).children().eq(1).html();
        MasterScope.txtProductType_Model = $(obj).children().eq(2).html();
    });
    var element = angular.element('#LookUpModal');
    element.modal('hide');

}
function ProductMasterLookupData(obj) {

    MasterScope.$apply(function () {
        MasterScope.txtProductMasterProductType_code_Model = $(obj).children().eq(1).html();
        MasterScope.txtProductMasterProductType_Model = $(obj).children().eq(2).html();
    });
    var element = angular.element('#LookUpModal');
    element.modal('hide');
}
function ProductCategoryLookupData(obj) {
    MasterScope.$apply(function () {
        MasterScope.txtProductMasterProductCategory_code_Model = $(obj).children().eq(1).html();
        MasterScope.txtProductMasterProductCategory_Model = $(obj).children().eq(2).html();
    });
    var element = angular.element('#LookUpModal');
    element.modal('hide');
}

function CustomerTypeLookupData(obj) {

    MasterScope.$apply(function () {
        MasterScope.txtCustomerType_code_Model = $(obj).children().eq(1).html();

        MasterScope.txtCustomerType_Model = $(obj).children().eq(2).html();
    });
    var element = angular.element('#LookUpModal');
    element.modal('hide');
}
function ProblemTypeLookupData(obj) {
    MasterScope.$apply(function () {
        MasterScope.txtProblemType_code_Model = $(obj).children().eq(1).html();

        MasterScope.txtProblemType_Model = $(obj).children().eq(2).html();
    });
    var element = angular.element('#LookUpModal');
    element.modal('hide');
}
function DefectProductTypeLookupData(obj) {
    MasterScope.$apply(function () {

        MasterScope.txtDefectProductType_code_Model = $(obj).children().eq(1).html();
        MasterScope.txtDefectProductType_Model = $(obj).children().eq(2).html();
    });
    var element = angular.element('#LookUpModal');
    element.modal('hide');
}
function DefectProductCategoryLookupData(obj) {
    MasterScope.$apply(function () {

        MasterScope.txtDefectProductCategory_code_Model = $(obj).children().eq(1).html();
        MasterScope.txtDefectProductCategory_Model = $(obj).children().eq(2).html();
    });
    var element = angular.element('#LookUpModal');
    element.modal('hide');
}
function ObservationProductTypeLookupData(obj) {
    MasterScope.$apply(function () {
        MasterScope.txtObservationProductType_Model = $(obj).children().eq(2).html();
        MasterScope.txtObservationProductType_code_Model = $(obj).children().eq(1).html();

    });
    var element = angular.element('#LookUpModal');
    element.modal('hide');
}
function ObservationProductCategoryLookupData(obj) {
    MasterScope.$apply(function () {
        MasterScope.txtObservationProductCategory_code_Model = $(obj).children().eq(1).html();

        MasterScope.txtObservationProductCategory_Model = $(obj).children().eq(2).html();
    });
    var element = angular.element('#LookUpModal');
    element.modal('hide');
}
function CompensationModeProductTypeLookupData(obj) {
    MasterScope.$apply(function () {

        MasterScope.txtCompensationModeProductType_code_Model = $(obj).children().eq(1).html();

        MasterScope.txtCompensationModeProductType_Model = $(obj).children().eq(2).html();
    });
    var element = angular.element('#LookUpModal');
    element.modal('hide');

}


function SurveyCriteriaProductTypeLookupData(obj) {
    MasterScope.$apply(function () {
        MasterScope.txtSurveyCriteriaProductType_code_Model = $(obj).children().eq(1).html();
        MasterScope.txtSurveyCriteriaProductType_Model = $(obj).children().eq(2).html();
    });
    var element = angular.element('#LookUpModal');
    element.modal('hide');
}
function SurveyCriteriaProductCategoryLookupData(obj) {
    MasterScope.$apply(function () {
        MasterScope.txtSurveyCriteriaProductCategory_code_Model = $(obj).children().eq(1).html();

        MasterScope.txtSurveyCriteriaProductCategory_Model = $(obj).children().eq(2).html();
    });
    var element = angular.element('#LookUpModal');
    element.modal('hide');
}
function SurveyCriteriaBreakageCategoryLookupData(obj) {
    MasterScope.$apply(function () {
        MasterScope.txtSurveyCriteriaBreakageCategory_code_Model = $(obj).children().eq(1).html();

        MasterScope.txtSurveyCriteriaBreakageCategoryName_Model = $(obj).children().eq(2).html();
    });
    var element = angular.element('#LookUpModal');
    element.modal('hide');
}


// COMPLAINT APPROVAL CONTROLLER
DIMS.controller('ComplaintPendingApprovalCtrl', function ($scope, $location, $compile, DIMSFactory, $http) {
    $scope.templatesettings = { HeaderTitle: "Complaint Status Report" };

    angular.element(document).ready(function () {


        HideLoader();

        try {

            ShowLoader();

            $.ajax({
                type: 'POST',
                url: '../../ComplaintRegistration/FillCMSStateFilter',
                async: true,
                success: function (response) {
                    $("#StateFilter").empty();

                    if (response == "") {
                    }
                    else {
                        response = JSON.parse(response);

                        var UserType = $("#SessionUserTypeID").val();

                        var option = "";


                        if (UserType == "CSM" || UserType == "QH" || UserType == "CSM_BU2" || UserType == "CSM_BU3") {
                            option = $('<option></option>').attr("value", "ALL").text("ALL");
                            $("#StateFilter").append(option);
                        }


                        for (var i = 0; i < response.length; i++) {
                            option = $('<option></option>').attr("value", response[i]["STATE_CODE"]).text(response[i]["STATE_DESC"]);
                            $("#StateFilter").append(option);
                        }

                        var CMSState = $("#CMSState").val();

                        if (CMSState == "") {
                            $("#StateFilter").val(response[0]["STATE_CODE"]);
                            $("#CMSState").val(response[0]["STATE_CODE"]);
                        }
                        else {
                            $("#StateFilter").val(CMSState);
                        }


                        var CMSState = $("#StateFilter").val();
                        AssnState = CMSState;
                        HideLoader();
                        DIMSFactory.getMasterClickData("listComplaintpendingApprovals$" + AssnState).success(function (response) {

                            var obj = JSON.parse(response.tabledata);
                            tcount = obj.length;
                            var TableRow = "";
                            $("#pendingApprovalsList").dataTable().fnDestroy();
                            $("#pendingApprovalsList tbody").empty();

                            var SessionUserCode = $("#SessionUserCode").val();

                            for (var i = 0; i < tcount; i++) {

                                TableRow = TableRow + "<tr style='cursor:pointer;' id='PendingAppr_" + i + "' ng-click='GotoApprovalApplication(obj,$event)'>";
                                TableRow = TableRow + "<td>" + obj[i]["Doc Code"] + "</td>";
                                TableRow = TableRow + "<td>" + obj[i]["Doc No"] + "</td>";
                                //TableRow = TableRow + "<td>" + obj[i]["Complaint Id"] + "</td>";
                                TableRow = TableRow + "<td>" + obj[i]["Complaint No"] + "</td>";
                                TableRow = TableRow + "<td>" + obj[i]["STATE_DESC"] + "</td>";
                                //TableRow = TableRow + "<td>" + obj[i]["Doc Series Code"] + "</td>";
                                TableRow = TableRow + "<td>" + obj[i]["Originated On"] + "</td>";
                                TableRow = TableRow + "<td>" + obj[i]["Originator"] + "</td>";

                                // TableRow = TableRow + "<td>" + obj[i]["Doc Status"] + "</td>";
                                //TableRow = TableRow + "<td>" + obj[i]["Complaint Management Id"] + "</td>";
                                TableRow = TableRow + "</tr>";

                                //TableRow = TableRow + "<tr style='cursor:pointer;' id='PendingAppr_" + i + "' ng-click='GotoApprovalApplication(obj,$event)'>";
                                //TableRow = TableRow + "<td>" + obj[i]["Doc Code"] + "</td>";
                                //TableRow = TableRow + "<td>" + obj[i]["Doc No"] + "</td>";
                                //TableRow = TableRow + "<td>" + obj[i]["Complaint Id"] + "</td>";
                                //TableRow = TableRow + "<td>" + obj[i]["Complaint No"] + "</td>";
                                //TableRow = TableRow + "<td>" + obj[i]["Doc Series Code"] + "</td>";
                                //TableRow = TableRow + "<td>" + obj[i]["Originator"] + "</td>";
                                //TableRow = TableRow + "<td>" + obj[i]["Originated On"] + "</td>";
                                //TableRow = TableRow + "<td>" + obj[i]["Doc Status"] + "</td>";
                                //TableRow = TableRow + "<td>" + obj[i]["Complaint Management Id"] + "</td>";
                                //TableRow = TableRow + "</tr>";




                                ////SessionUserCode   HardCoded Permission Given By Mr.Akbar (50001049)
                                //if (SessionUserCode == "50000985") {

                                //    if (obj[i]["Doc Code"] == "Compensation") {
                                //        TableRow = TableRow + "<tr style='cursor:pointer;' id='PendingAppr_" + i + "' ng-click='GotoApprovalApplication(obj,$event)'>";
                                //        TableRow = TableRow + "<td>" + obj[i]["Doc Code"] + "</td>";
                                //        TableRow = TableRow + "<td>" + obj[i]["Doc No"] + "</td>";
                                //        TableRow = TableRow + "<td>" + obj[i]["Complaint Id"] + "</td>";
                                //        TableRow = TableRow + "<td>" + obj[i]["Complaint No"] + "</td>";
                                //        TableRow = TableRow + "<td>" + obj[i]["Doc Series Code"] + "</td>";
                                //        TableRow = TableRow + "<td>" + obj[i]["Originator"] + "</td>";
                                //        TableRow = TableRow + "<td>" + obj[i]["Originated On"] + "</td>";
                                //        TableRow = TableRow + "<td>" + obj[i]["Doc Status"] + "</td>";
                                //        TableRow = TableRow + "<td>" + obj[i]["Complaint Management Id"] + "</td>";
                                //        TableRow = TableRow + "</tr>";
                                //    }
                                //}

                                //    //SessionUserCode   HardCoded Permission Given By Mr.Akbar (50001049)
                                //else if (SessionUserCode == "50002213") {
                                //    if (obj[i]["Originator"] == "KAM" || obj[i]["Originator"] == "50002304") {
                                //        if (obj[i]["Doc Code"] == "Compensation") {

                                //        }
                                //        else {
                                //            TableRow = TableRow + "<tr style='cursor:pointer;' id='PendingAppr_" + i + "' ng-click='GotoApprovalApplication(obj,$event)'>";
                                //            TableRow = TableRow + "<td>" + obj[i]["Doc Code"] + "</td>";
                                //            TableRow = TableRow + "<td>" + obj[i]["Doc No"] + "</td>";
                                //            TableRow = TableRow + "<td>" + obj[i]["Complaint Id"] + "</td>";
                                //            TableRow = TableRow + "<td>" + obj[i]["Complaint No"] + "</td>";
                                //            TableRow = TableRow + "<td>" + obj[i]["Doc Series Code"] + "</td>";
                                //            TableRow = TableRow + "<td>" + obj[i]["Originator"] + "</td>";
                                //            TableRow = TableRow + "<td>" + obj[i]["Originated On"] + "</td>";
                                //            TableRow = TableRow + "<td>" + obj[i]["Doc Status"] + "</td>";
                                //            TableRow = TableRow + "<td>" + obj[i]["Complaint Management Id"] + "</td>";
                                //            TableRow = TableRow + "</tr>";
                                //        }
                                //    }
                                //    else {
                                //    }
                                //}

                                //    //SessionUserCode   HardCoded Permission Given By Mr.Akbar (50001049)
                                //else if (SessionUserCode == "50001049" || SessionUserCode == "50001048") {
                                //    if (obj[i]["Originator"] == "KAM") {
                                //    }
                                //    else {
                                //        if (obj[i]["Doc Code"] == "Compensation") {

                                //        }
                                //        else {
                                //            TableRow = TableRow + "<tr style='cursor:pointer;' id='PendingAppr_" + i + "' ng-click='GotoApprovalApplication(obj,$event)'>";
                                //            TableRow = TableRow + "<td>" + obj[i]["Doc Code"] + "</td>";
                                //            TableRow = TableRow + "<td>" + obj[i]["Doc No"] + "</td>";
                                //            TableRow = TableRow + "<td>" + obj[i]["Complaint Id"] + "</td>";
                                //            TableRow = TableRow + "<td>" + obj[i]["Complaint No"] + "</td>";
                                //            TableRow = TableRow + "<td>" + obj[i]["Doc Series Code"] + "</td>";
                                //            TableRow = TableRow + "<td>" + obj[i]["Originator"] + "</td>";
                                //            TableRow = TableRow + "<td>" + obj[i]["Originated On"] + "</td>";
                                //            TableRow = TableRow + "<td>" + obj[i]["Doc Status"] + "</td>";
                                //            TableRow = TableRow + "<td>" + obj[i]["Complaint Management Id"] + "</td>";
                                //            TableRow = TableRow + "</tr>";
                                //        }
                                //    }
                                //}


                            }

                            var html = $compile(TableRow)($scope);
                            var el = angular.element($("#pendingApprovalsList tbody"));
                            el.append(html);
                            $compile(html)($scope);

                            //$('#pendingApprovalsList tbody').append(TableRow);
                            var table = $("#pendingApprovalsList").dataTable({
                                "bDestroy": true,
                                //scrollY: "200px",
                                //scrollX: true,
                                scrollCollapse: true,
                                paging: true
                                //fixedColumns: {
                                //    leftColumns: 0
                                //},
                            });

                            $(".dataTables_scrollHeadInner").css({ "width": "100%" });
                            $(".table ").css({ "width": "100%" });

                            HideLoader();

                        });



                    }

                    HideLoader();

                },
                error: function (xhr, ajaxOptions, thrownError) {
                    alert(xhr + "\n" + ajaxOptions + "\n" + thrownError);

                    alert(json.stringify(xhr) + "\n" + json.stringify(ajaxOptions) + "\n" + json.stringify(thrownError));
                    HideLoader();

                }
            });
            HideLoader();

        }
        catch (e) {
            alert("ComplaintPendingApprovalCtrl + " + e);
            HideLoader();

        }

        HideLoader();
    });

    $scope.StateChange = function () {
        AssnState = $("#StateFilter").val();
        DIMSFactory.getMasterClickData("listComplaintpendingApprovals$" + AssnState).success(function (response) {

            var obj = JSON.parse(response.tabledata);
            tcount = obj.length;
            var TableRow = "";

            if (AssnState == "ALL") { }
            else {
                $("#CMSState").val(AssnState);
            }

            $("#pendingApprovalsList").DataTable().clear().draw();
            $("#pendingApprovalsList").DataTable().destroy();
            // $("#pendingApprovalsList").dataTable().fnDestroy();


            var SessionUserCode = $("#SessionUserCode").val();

            for (var i = 0; i < tcount; i++) {
                TableRow = TableRow + "<tr style='cursor:pointer;' id='PendingAppr_" + i + "' ng-click='GotoApprovalApplication(obj,$event)'>";
                TableRow = TableRow + "<td>" + obj[i]["Doc Code"] + "</td>";
                TableRow = TableRow + "<td>" + obj[i]["Doc No"] + "</td>";
                //TableRow = TableRow + "<td>" + obj[i]["Complaint Id"] + "</td>";
                TableRow = TableRow + "<td>" + obj[i]["Complaint No"] + "</td>";
                TableRow = TableRow + "<td>" + obj[i]["STATE_DESC"] + "</td>";
                //TableRow = TableRow + "<td>" + obj[i]["Doc Series Code"] + "</td>";
                TableRow = TableRow + "<td>" + obj[i]["Originated On"] + "</td>";
                TableRow = TableRow + "<td>" + obj[i]["Originator"] + "</td>";

                // TableRow = TableRow + "<td>" + obj[i]["Doc Status"] + "</td>";
                //TableRow = TableRow + "<td>" + obj[i]["Complaint Management Id"] + "</td>";
                TableRow = TableRow + "</tr>";
            }
            $("#pendingApprovalsList tbody").empty();
            var html = $compile(TableRow)($scope);
            var el = angular.element($("#pendingApprovalsList tbody"));
            el.append(html);
            $compile(html)($scope);

            //$('#pendingApprovalsList tbody').append(TableRow);
            var table = $("#pendingApprovalsList").dataTable({
                "bDestroy": true,
                //scrollY: "200px",
                //scrollX: true,
                scrollCollapse: true,
                paging: true
                //fixedColumns: {
                //    leftColumns: 0
                //},
            });
        });
    }

    $scope.go = function (path) {
        CheckUserSession();
        $location.path(path);

    };


    $scope.GotoApprovalApplication = function (obj, $event) {
        var id = $($event.target).parent().attr("id");
        var Appl = $("#pendingApprovalsList tbody #" + id + " td")[0].innerHTML;
        var Cmpl_Mngmt_Id = $("#pendingApprovalsList tbody #" + id + " td")[1].innerHTML;
        $("#HiddenForCMS").val("FromPendingAppr");
        if (Appl == "Complaint Registration") {
            $scope.go("Registration/" + Cmpl_Mngmt_Id);
        }
        else if (Appl == "Corrective Measures") { PendingApprCmplType = "Corrective Measures"; $scope.go("CorrectiveMeasure/" + Cmpl_Mngmt_Id); }
        else if (Appl == "Compensation") { PendingApprCmplType = "Compensation"; $scope.go("Compensation/" + Cmpl_Mngmt_Id); }
        else if (Appl == "Investigation") { PendingApprCmplType = "Investigation"; $scope.go("Investigation/" + Cmpl_Mngmt_Id); }
    }

});

DIMS.controller('ComplaintsAssigningCtrl', function ($scope, $location, $compile, $http, DIMSFactory) {
    var AssnState = "";
    //$scope.GetComplaintAssignData();
    $scope.templatesettings = { HeaderTitle: "Complaint Status Report" };
    MasterScope = $scope;
    $scope.go = function (path) {
        CheckUserSession();
        $location.path(path);
    };

    angular.element(document).ready(function () {
        $("#CompRegSave").css("visibility", "visible");
        $("#CompRegList").css('visibility', 'visible');
        $("#CompRegAssign").css('visibility', 'hidden');
        $.ajax({
            type: 'POST',
            url: '../../ComplaintRegistration/FillCMSStateFilter',
            async: true,
            success: function (response) {
                $("#StateFilter").empty();
                if (response == "") {

                }
                else {
                    response = JSON.parse(response);

                    var option = "";
                    var UserType = $("#SessionUserTypeID").val();
                    //svprasadk 17-06-2020 SBU 1 requirement to bulk assign complaints start
                    var USER_PRODUCT_TYPE_CODE = $("#USER_PRODUCT_TYPE_CODE").val();
                    //svprasadk 17-06-2020 SBU 1 requirement to bulk assign complaints end

                    if (UserType == "CSM" || UserType == "QH" || UserType == "CSM_BU2" || UserType == "CSM_BU3") {
                        option = $('<option></option>').attr("value", "ALL").text("ALL");
                        $("#StateFilter").append(option);
                    }


                    for (var i = 0; i < response.length; i++) {
                        option = $('<option></option>').attr("value", response[i]["STATE_CODE"]).text(response[i]["STATE_DESC"]);
                        $("#StateFilter").append(option);
                    }

                    var CMSState = $("#CMSState").val();

                    if (CMSState == "") {
                        $("#StateFilter").val(response[0]["STATE_CODE"]);
                        $("#CMSState").val(response[0]["STATE_CODE"]);
                    }
                    else {
                        $("#StateFilter").val(CMSState);
                    }
                    var CMSState = $("#StateFilter").val();
                    AssnState = CMSState;
                    DIMSFactory.getMasterClickData("ComplaintAssignCreate$" + AssnState).success(function (response) {

                        var data = JSON.parse(response.tabledata);
                        MasterName = "ComplaintAssignCreate";
                        $("#MasterTable").dataTable().fnDestroy();
                        $('#MasterTable').empty();

                        //svprasadk 18-06-2020 SBU 1 requirement to bulk assign complaints start
                        var columns = addAllColumnHeadersForAsgnCmpl(data, "MasterTable", USER_PRODUCT_TYPE_CODE);
                        //svprasadk 18-06-2020 SBU 1 requirement to bulk assign complaints end

                        //var columns = addAllColumnHeadersForAsgnCmpl(data, "MasterTable");

                        //alert(JSON.stringify(data));
                        var SessionUserCode = $("#SessionUserCode").val();

                        for (var i = 0; i < data.length; i++) {
                            var Assgn_row$ = $('<tr />');
                            //Assgn_row$.append($('<td onclick="EditMasterData(this)" />').html('<a style="background-color: #9760b3; border-color: #9760b3; padding: 6px 6px;" class="btn btn-info"><i class="fa fa-fw fa-pencil-square-o"></i>Edit</a>'));
                            //svprasadk 18-06-2020 SBU 1 requirement to bulk assign complaints start
                            if (USER_PRODUCT_TYPE_CODE == "SBU1") {
                                Assgn_row$.append($('<td />').html('<input type="checkbox" class="roles" name="chkAssn" id="chkAsgnUser' + i + '" /><input type="text" style="display:none;" id="BU_' + i + '" value=' + data[i]["Product Type"] + ' />'));
                            } else {
                                Assgn_row$.append($('<td />').html('<input type="checkbox" name="chkAssn" id="chkAsgnUser' + i + '" onclick="EditAssignUser(this,' + i + ')" /><input type="text" style="display:none;" id="BU_' + i + '" value=' + data[i]["Product Type"] + ' />'));
                            }
                            //svprasadk 18-06-2020 SBU 1 requirement to bulk assign complaints end
                            //Assgn_row$.append($('<td />').html('<input type="checkbox" name="chkAssn" id="chkAsgnUser' + i + '" onclick="EditAssignUser(this,' + i + ')" /><input type="text" style="display:none;" id="BU_' + i + '" value=' + data[i]["Product Type"] + ' />'));
                            for (var colIndex = 0; colIndex < columns.length; colIndex++) {
                                var cellValue = data[i][columns[colIndex]];
                                if (cellValue == null) { cellValue = ""; }
                                Assgn_row$.append($('<td/>').html(cellValue));
                            }
                            //svprasadk 18-06-2020 SBU 1 requirement to bulk assign complaints start
                            if (USER_PRODUCT_TYPE_CODE != "SBU1") {
                                Assgn_row$.append($('<td />').html('<input type="text" id="txtAssgnUserRole' + i + '" style="visibility:hidden" readonly onclick="EditAssnUserRole(this,\'' + "GetAssnUserRoleData" + '\',\'' + "AssnUserRoleMaster" + '\',\'' + "User Role List" + '\',' + i + ')" />'));
                                Assgn_row$.append($('<td />').html('<input type="text" id="txtAssgnUserName' + i + '" style="visibility:hidden" readonly onclick="EditAssnUserRole(this,\'' + "GetAssnUserData" + '\',\'' + "AssnUserMaster" + '\',\'' + "User List" + '\',' + i + ')" />'));
                            }
                            //svprasadk 18-06-2020 SBU 1 requirement to bulk assign complaints end
                            //Assgn_row$.append($('<td />').html('<input type="text" id="txtAssgnUserRole' + i + '" style="visibility:hidden" readonly onclick="EditAssnUserRole(this,\'' + "GetAssnUserRoleData" + '\',\'' + "AssnUserRoleMaster" + '\',\'' + "User Role List" + '\',' + i + ')" />'));
                            //Assgn_row$.append($('<td />').html('<input type="text" id="txtAssgnUserName' + i + '" style="visibility:hidden" readonly onclick="EditAssnUserRole(this,\'' + "GetAssnUserData" + '\',\'' + "AssnUserMaster" + '\',\'' + "User List" + '\',' + i + ')" />'));
                            $("#MasterTable").append(Assgn_row$);
                        }



                        $("#MasterTable tr td:nth-child(2)").hide();
                        $("#MasterTable tr th:nth-child(2)").hide();

                        var table = $("#MasterTable").dataTable({
                            "bDestroy": true,
                            'bPaginate': false,
                            'bFilter': false,
                            //scrollY: "200px",
                            //scrollX: true,
                            scrollCollapse: true,
                            paging: true
                            //fixedColumns: {
                            //    leftColumns: 0
                            //},
                        });

                        //$(".dataTables_scrollHeadInner").css({ "width": "100%" });
                        //$(".table ").css({ "width": "100%" });

                        $('#MasterTable tbody').on('click', 'tr', function () {
                            if ($(this).hasClass('selected')) {
                                $(this).removeClass('selected');
                            }
                            else {
                                table.$('tr.selected').removeClass('selected');
                                $(this).addClass('selected');
                            }
                        });
                    });

                }
            },
            error: function (xhr, ajaxOptions, thrownError) {
            }
        });

    });

    $scope.StateChange = function () {

        AssnState = $("#StateFilter").val();
        DIMSFactory.getMasterClickData("" + MasterName + "$" + AssnState).success(function (response) {

            var data = JSON.parse(response.tabledata);

            if (MasterName == "ComplaintAssign") {
                if (data == "" || data == "[]") {
                    alert("No Data Available");


                    $("#MasterTable").DataTable().clear().draw();
                    return;
                }

                $("#CompRegSave").css("visibility", "hidden");
                $("#CompRegList").css('visibility', 'hidden');
                $("#CompRegAssign").css('visibility', 'visible');
                $("#Add").prop('disabled', true);


                $("#MasterTable").dataTable().fnDestroy();
                $('#MasterTable thead').remove();
                $('#MasterTable tbody').empty();


                var columns = addAllColumnHeaders(data, "MasterTable");


                for (var i = 0 ; i < data.length ; i++) {
                    var row$ = $('<tr onclick="EditMasterData(this)" style="cursor:pointer;" />');
                    for (var colIndex = 0 ; colIndex < columns.length ; colIndex++) {
                        var cellValue = data[i][columns[colIndex]];

                        if (cellValue == null) { cellValue = ""; }
                        row$.append($('<td/>').html(cellValue));
                    }
                    $("#MasterTable").append(row$);
                }

            } else {
                //  MasterName = "ComplaintAssignCreate";
                $("#MasterTable").dataTable().fnDestroy();
                $('#MasterTable').empty();

                //svprasadk 19-06-2020 SBU 1 requirement to bulk assign complaints start
                var USER_PRODUCT_TYPE_CODE = $("#USER_PRODUCT_TYPE_CODE").val();
                //svprasadk 19-06-2020 SBU 1 requirement to bulk assign complaints end

                //svprasadk 19-06-2020 SBU 1 requirement to bulk assign complaints start
                var columns = addAllColumnHeadersForAsgnCmpl(data, "MasterTable", USER_PRODUCT_TYPE_CODE);
                //svprasadk 19-06-2020 SBU 1 requirement to bulk assign complaints end

                //var columns = addAllColumnHeadersForAsgnCmpl(data, "MasterTable");
                var SessionUserCode = $("#SessionUserCode").val();

                for (var i = 0; i < data.length; i++) {
                    var Assgn_row$ = $('<tr />');
                    //Assgn_row$.append($('<td onclick="EditMasterData(this)" />').html('<a style="background-color: #9760b3; border-color: #9760b3; padding: 6px 6px;" class="btn btn-info"><i class="fa fa-fw fa-pencil-square-o"></i>Edit</a>'));
                    //svprasadk 19-06-2020 SBU 1 requirement to bulk assign complaints start
                    if (USER_PRODUCT_TYPE_CODE == "SBU1") {
                        Assgn_row$.append($('<td />').html('<input type="checkbox" class="roles" name="chkAssn" id="chkAsgnUser' + i + '" /><input type="text" style="display:none;" id="BU_' + i + '" value=' + data[i]["Product Type"] + ' />'));
                    } else {
                        Assgn_row$.append($('<td />').html('<input type="checkbox" name="chkAssn" id="chkAsgnUser' + i + '" onclick="EditAssignUser(this,' + i + ')" /><input type="text" style="display:none;" id="BU_' + i + '" value=' + data[i]["Product Type"] + ' />'));
                    }
                    //svprasadk 19-06-2020 SBU 1 requirement to bulk assign complaints end
                    //Assgn_row$.append($('<td />').html('<input type="checkbox" name="chkAssn" id="chkAsgnUser' + i + '" onclick="EditAssignUser(this,' + i + ')" /><input type="text" style="display:none;" id="BU_' + i + '" value=' + data[i]["Product Type"] + ' />'));
                    for (var colIndex = 0; colIndex < columns.length; colIndex++) {
                        var cellValue = data[i][columns[colIndex]];

                        if (cellValue == null) { cellValue = ""; }
                        Assgn_row$.append($('<td/>').html(cellValue));
                    }
                    //svprasadk 19-06-2020 SBU 1 requirement to bulk assign complaints start
                    if (USER_PRODUCT_TYPE_CODE != "SBU1") {
                        Assgn_row$.append($('<td />').html('<input type="text" id="txtAssgnUserRole' + i + '" style="visibility:hidden" readonly onclick="EditAssnUserRole(this,\'' + "GetAssnUserRoleData" + '\',\'' + "AssnUserRoleMaster" + '\',\'' + "User Role List" + '\',' + i + ')" />'));
                        Assgn_row$.append($('<td />').html('<input type="text" id="txtAssgnUserName' + i + '" style="visibility:hidden" readonly onclick="EditAssnUserRole(this,\'' + "GetAssnUserData" + '\',\'' + "AssnUserMaster" + '\',\'' + "User List" + '\',' + i + ')" />'));
                    }
                    //svprasadk 19-06-2020 SBU 1 requirement to bulk assign complaints end
                    //Assgn_row$.append($('<td />').html('<input type="text" id="txtAssgnUserRole' + i + '" style="visibility:hidden" readonly onclick="EditAssnUserRole(this,\'' + "GetAssnUserRoleData" + '\',\'' + "AssnUserRoleMaster" + '\',\'' + "User Role List" + '\',' + i + ')" />'));
                    //Assgn_row$.append($('<td />').html('<input type="text" id="txtAssgnUserName' + i + '" style="visibility:hidden" readonly onclick="EditAssnUserRole(this,\'' + "GetAssnUserData" + '\',\'' + "AssnUserMaster" + '\',\'' + "User List" + '\',' + i + ')" />'));
                    $("#MasterTable").append(Assgn_row$);
                }

                $("#MasterTable tr td:nth-child(2)").hide();
                $("#MasterTable tr th:nth-child(2)").hide();
            }
            var table = $("#MasterTable").dataTable({
                "bDestroy": true,
                'bPaginate': false,
                'bFilter': false,
                //scrollY: "200px",
                //scrollX: true,
                scrollCollapse: true,
                paging: true
                //fixedColumns: {
                //    leftColumns: 0
                //},
            });

            $('#MasterTable tbody').on('click', 'tr', function () {
                if ($(this).hasClass('selected')) {
                    $(this).removeClass('selected');
                }
                else {
                    table.$('tr.selected').removeClass('selected');
                    $(this).addClass('selected');
                }
            });
        });
    }

    $("#Add").prop('disabled', false);
    //DIMSFactory.getMasterClickData("ComplaintAssignCreate$" + AssnState + "").success(function (response) {



    $scope.GetFieldData = function (Methodname, MasterType, Heading) {
        if (Methodname == "GetAssnUserLookupData") {
            if ($scope.txtAssToUserRole_Model != "") {
                DIMSFactory.getComplAssnUserData(MasterType, $scope.txtAssToUserRole_Model).success(function (response) {
                    getFieldLookUpData(response, Methodname, Heading);
                });
            } else {
                alert("Please Select User Role");
            }
        }
        else {
            DIMSFactory.getMasterClickData(MasterType).success(function (response) {
                getFieldLookUpData(response, Methodname, Heading);
            });
        }
    };

    $scope.AssnComplList = function () {

        DIMSFactory.getMasterClickData("ComplaintAssign$" + AssnState).success(function (response) {
            var data = JSON.parse(response.tabledata);
            MasterName = "ComplaintAssign";


            if (data == "" || data == "[]") {
                alert("No Data Available");
                return;
            }

            $("#CompRegSave").css("visibility", "hidden");
            $("#CompRegList").css('visibility', 'hidden');
            $("#CompRegAssign").css('visibility', 'visible');
            $("#Add").prop('disabled', true);


            $("#MasterTable").dataTable().fnDestroy();
            $('#MasterTable thead').remove();
            $('#MasterTable tbody').empty();


            var columns = addAllColumnHeaders(data, "MasterTable");


            for (var i = 0 ; i < data.length ; i++) {
                var row$ = $('<tr onclick="EditMasterData(this)" style="cursor:pointer;" />');
                for (var colIndex = 0 ; colIndex < columns.length ; colIndex++) {
                    var cellValue = data[i][columns[colIndex]];

                    if (cellValue == null) { cellValue = ""; }
                    row$.append($('<td/>').html(cellValue));
                }
                $("#MasterTable").append(row$);
            }


            //$("#MasterTable tr td:nth-child(1)").hide();
            //$("#MasterTable tr th:nth-child(1)").hide();

            var table = $("#MasterTable").dataTable({
                "bDestroy": true,
                'scroll': true,
                //scrollY: "200px",
                //scrollX: true,
                scrollCollapse: true,
                paging: true
                //fixedColumns: {
                //    leftColumns: 0
                //},
            });

            $('#MasterTable tbody').on('click', 'tr', function () {
                if ($(this).hasClass('selected')) {
                    $(this).removeClass('selected');
                }
                else {
                    table.$('tr.selected').removeClass('selected');
                    $(this).addClass('selected');
                }
            });
        });
    }


    $scope.CreateAssnCompl = function () {

        DIMSFactory.getMasterClickData("ComplaintAssignCreate$" + AssnState).success(function (response) {
            var data = JSON.parse(response.tabledata);
            MasterName = "ComplaintAssignCreate";


            if (data == "" || data == "[]") {
                //alert("No Data Available");
                //return;
            }

            $("#CompRegSave").css("visibility", "visible");
            $("#CompRegList").css('visibility', 'visible');
            $("#CompRegAssign").css('visibility', 'hidden');
            $("#Add").prop('disabled', false);

            $("#MasterTable").dataTable().fnDestroy();
            $('#MasterTable thead').remove();
            $('#MasterTable tbody').empty();

            var SessionUserCode = $("#SessionUserCode").val();
            //svprasadk 19-06-2020 SBU 1 requirement to bulk assign complaints start
            var USER_PRODUCT_TYPE_CODE = $("#USER_PRODUCT_TYPE_CODE").val();
            //svprasadk 19-06-2020 SBU 1 requirement to bulk assign complaints end
            $("#actotal").val(data.length);
            //svprasadk 19-06-2020 SBU 1 requirement to bulk assign complaints start
            var columns = addAllColumnHeadersForAsgnCmpl(data, "MasterTable", USER_PRODUCT_TYPE_CODE);
            //svprasadk 19-06-2020 SBU 1 requirement to bulk assign complaints end
            //var columns = addAllColumnHeadersForAsgnCmpl(data, "MasterTable");

            for (var i = 0; i < data.length; i++) {

                var Assgn_row$ = $('<tr />');
                //Assgn_row$.append($('<td onclick="EditMasterData(this)" />').html('<a style="background-color: #9760b3; border-color: #9760b3; padding: 6px 6px;" class="btn btn-info"><i class="fa fa-fw fa-pencil-square-o"></i>Edit</a>'));
                //svprasadk 19-06-2020 SBU 1 requirement to bulk assign complaints start
                if (USER_PRODUCT_TYPE_CODE == "SBU1") {
                    Assgn_row$.append($('<td />').html('<input type="checkbox" class="roles" name="chkAssn" id="chkAsgnUser' + i + '" /><input type="text" style="display:none;" id="BU_' + i + '" value=' + data[i]["Product Type"] + ' />'));
                } else {
                    Assgn_row$.append($('<td />').html('<input type="checkbox" name="chkAssn" id="chkAsgnUser' + i + '" onclick="EditAssignUser(this,' + i + ')" /><input type="text" style="display:none;" id="BU_' + i + '" value=' + data[i]["Product Type"] + ' />'));
                }
                //svprasadk 19-06-2020 SBU 1 requirement to bulk assign complaints end
                //Assgn_row$.append($('<td />').html('<input type="checkbox" name="chkAssn" id="chkAsgnUser' + i + '" onclick="EditAssignUser(this,' + i + ')" /><input type="text" style="display:none;" id="BU_' + i + '" value=' + data[i]["Product Type"] + ' />'));
                for (var colIndex = 0; colIndex < columns.length; colIndex++) {
                    var cellValue = data[i][columns[colIndex]];

                    if (cellValue == null) { cellValue = ""; }
                    Assgn_row$.append($('<td/>').html(cellValue));
                }
                //svprasadk 19-06-2020 SBU 1 requirement to bulk assign complaints start
                if (USER_PRODUCT_TYPE_CODE != "SBU1") {
                    Assgn_row$.append($('<td />').html('<input type="text" id="txtAssgnUserRole' + i + '" style="visibility:hidden" readonly onclick="EditAssnUserRole(this,\'' + "GetAssnUserRoleData" + '\',\'' + "AssnUserRoleMaster" + '\',\'' + "User Role List" + '\',' + i + ')" />'));
                    Assgn_row$.append($('<td />').html('<input type="text" id="txtAssgnUserName' + i + '" style="visibility:hidden" readonly onclick="EditAssnUserRole(this,\'' + "GetAssnUserData" + '\',\'' + "AssnUserMaster" + '\',\'' + "User List" + '\',' + i + ')" />'));
                }
                //svprasadk 19-06-2020 SBU 1 requirement to bulk assign complaints end
                //Assgn_row$.append($('<td />').html('<input type="text" id="txtAssgnUserRole' + i + '" style="visibility:hidden" readonly onclick="EditAssnUserRole(this,\'' + "GetAssnUserRoleData" + '\',\'' + "AssnUserRoleMaster" + '\',\'' + "User Role List" + '\',' + i + ')" />'));
                //Assgn_row$.append($('<td />').html('<input type="text" id="txtAssgnUserName' + i + '" style="visibility:hidden" readonly onclick="EditAssnUserRole(this,\'' + "GetAssnUserData" + '\',\'' + "AssnUserMaster" + '\',\'' + "User List" + '\',' + i + ')" />'));
                $("#MasterTable").append(Assgn_row$);

            }

            $("#MasterTable tr td:nth-child(2)").hide();
            $("#MasterTable tr th:nth-child(2)").hide();

            var table = $("#MasterTable").dataTable({
                "bDestroy": true,
                'scroll': true,
                'bPaginate': false,
                'bFilter': false,
                //scrollY: "200px",
                //scrollX: true,
                scrollCollapse: true,
                paging: true
                //fixedColumns: {
                //    leftColumns: 0
                //},
            });

            $('#MasterTable tbody').on('click', 'tr', function () {
                if ($(this).hasClass('selected')) {
                    $(this).removeClass('selected');
                }
                else {
                    table.$('tr.selected').removeClass('selected');
                    $(this).addClass('selected');
                }
            });
        });
    }

    var Data = "";
    $scope.SaveAssnCompl = function () {
        //alert($("[name='chkAssn']:checked").length);
        //svprasadk 19-06-2020 SBU 1 requirement to bulk assign complaints start
        var USER_PRODUCT_TYPE_CODE = $("#USER_PRODUCT_TYPE_CODE").val();
        //svprasadk 19-06-2020 SBU 1 requirement to bulk assign complaints end
        //debugger;
        if (USER_PRODUCT_TYPE_CODE == "SBU1" && ($("#userRoleMasterCode").val() == "" || typeof $("#userRoleMasterCode").val() == undefined)) {
            alert("Please select User Role");
            return false;
        } else if (USER_PRODUCT_TYPE_CODE == "SBU1" && ($("#usersBasedonRoleCode").val() == "" || typeof $("#usersBasedonRoleCode").val() == undefined)) {
            alert("Please select User Name");
            return false;
        } else {
            Data = $("input:checkbox[name=chkAssn]:checked").map(function () {
                var str = $(this).attr("id");
                var rowcnt = str.slice(11);
                var table = document.getElementById('MasterTable');
                // jQuery to get the content of row n, column 1
                //var rowcountAssn = (parseInt(rowcnt) % 10) + 1;
                var rowcountAssn = (parseInt(rowcnt) % $('select[name="MasterTable_length"]').val()) + 1;
                var ss = $(table.rows[rowcountAssn].cells[1]).text();
                if (USER_PRODUCT_TYPE_CODE == "SBU1") {
                    return ss + "$" + $("#userRoleMaster").val() + "$" + $("#usersBasedonRole").val() + "$" + $("#userRoleMasterCode").val() + "$" + $("#usersBasedonRoleCode").val();
                } else {
                    return ss + "$" + $("#txtAssgnUserRole" + rowcnt + "").val() + "$" + $("#txtAssgnUserName" + rowcnt + "").val();
                }
                //return ss + "$" + $("#txtAssgnUserRole" + rowcnt + "").val() + "$" + $("#txtAssgnUserName" + rowcnt + "").val();
            }).get().join(",");

            if (Data != "") {

                if (confirm("Do you want to Assign Complaints?")) {
                }
                else {
                    return;
                }

                //var MasterType = "{\"MasterType\":\"" + "Assign Complaint" + "\",\"ComplAssnValues\":\"" + Data + "\",\"UserCode\":\"" + $("#SessionUserCode").val() + "\"}";
                var MasterType = "{\"MasterType\":\"" + "Assign Complaint" + "\",\"ComplAssnValues\":\"" + Data + "\",\"UserCode\":\"" + $("#SessionUserCode").val() + "\",\"USER_PRODUCT_TYPE_CODE\":\"" + $("#USER_PRODUCT_TYPE_CODE").val() + "\"}";
                DIMSFactory.SaveMasterData(MasterType).success(function (response) {
                    alert("Complaint has been successfully assigned");
                    $("#userRoleMasterCode").val('');
                    $("#usersBasedonRoleCode").val('')
                    $scope.CreateAssnCompl();
                });
            }
            else {
                alert("Please select atleast one record");
            }
        }
        
        //var table = document.getElementById('MasterTable');

        //var rowLength = table.rows.length;

        //alert(rowLength);

        //for (var i = 1; i < rowLength; i += 1) {
        //    var row = table.rows[i];

        //    //your code goes here, looping over every row.
        //    //cells are accessed as easy

        //    var cellLength = row.cells.length;

        //    alert(cellLength);

        //    for (var y = 0; y < 2; y += 1) {
        //        var cell = row.cells[y].innerHTML;
        //        //var ss = cell.attr('id').text(); alert(ss);

        //        alert(cell);

        //        //do something with every cell here
        //    }
        //}
    }

    $scope.SaveCmplAssignData = function () {
        var MasterType = "{\"MasterType\":\"" + "Assign Complaint List Update" + "\",\"Compl_Id\":\"" + $scope.CmplAssn_id_Model + "\",\"Compl_No\":\"" + $scope.txtCmplNo_Model + "\",\"Compl_Date\":\"" + $scope.txtCmplDate_Model + "\",\"AssnToUserRole\":\"" + $scope.txtAssToUserRole_Model + "\",\"AssnToUser\":\"" + $scope.txtAssToUser_Model + "\",\"AssnBy\":\"" + $scope.txtAssBy_Model + "\",\"AssnOn\":\"" + $scope.txtAssOn_Model + "\"}";
        DIMSFactory.SaveMasterData(MasterType).success(function (response) {
            alert("Record has been successfully updated");
            $scope.AssnComplList();
        });
        var element = angular.element('#CmplAssnModal');
        element.modal('hide');
    }


});

DIMS.controller('PendingApprovalCommercialCtrl', function ($scope, $location, $compile, DIMSFactory, $http) {
    $scope.templatesettings = { HeaderTitle: "Complaint Status Report" };

    angular.element(document).ready(function () {
        HideLoader();
        try {
            ShowLoader();
            $.ajax({
                type: 'POST',
                url: '../../ComplaintRegistration/FillCMSStateFilter',
                async: true,
                success: function (response) {
                    $("#StateFilter").empty();
                    if (response == "") {
                    }
                    else {
                        response = JSON.parse(response);
                        var UserType = $("#SessionUserTypeID").val();
                        var option = "";
                        if (UserType == "CSM" || UserType == "QH" || UserType == "CSM_BU2" || UserType == "CSM_BU3" || UserType == "COM_OF_BU2") {
                            option = $('<option></option>').attr("value", "ALL").text("ALL");
                            $("#StateFilter").append(option);
                        }


                        for (var i = 0; i < response.length; i++) {
                            option = $('<option></option>').attr("value", response[i]["STATE_CODE"]).text(response[i]["STATE_DESC"]);
                            $("#StateFilter").append(option);
                        }

                        var CMSState = $("#CMSState").val();

                        if (CMSState == "") {
                            $("#StateFilter").val(response[0]["STATE_CODE"]);
                            $("#CMSState").val(response[0]["STATE_CODE"]);
                        }
                        else {
                            $("#StateFilter").val(CMSState);
                        }


                        var CMSState = $("#StateFilter").val();
                        AssnState = CMSState;
                        HideLoader();
                        DIMSFactory.getMasterClickData("listpendingApprovalcommercial$" + AssnState).success(function (response) {

                            var obj = JSON.parse(response.tabledata);
                            tcount = obj.length;
                            var TableRow = "";
                            $("#pendingApprovalsList").dataTable().fnDestroy();
                            $("#pendingApprovalsList tbody").empty();

                            var SessionUserCode = $("#SessionUserCode").val();

                            for (var i = 0; i < tcount; i++) {

                                TableRow = TableRow + "<tr style='cursor:pointer;' id='PendingAppr_" + i + "' ng-click='GotoApprovalApplication(obj,$event)'>";
                                TableRow = TableRow + "<td>" + obj[i]["Doc Code"] + "</td>";
                                TableRow = TableRow + "<td>" + obj[i]["Doc No"] + "</td>";
                                TableRow = TableRow + "<td>" + obj[i]["Complaint No"] + "</td>";
                                TableRow = TableRow + "<td>" + obj[i]["STATE_DESC"] + "</td>";
                                TableRow = TableRow + "<td>" + obj[i]["Originated On"] + "</td>";
                                TableRow = TableRow + "<td>" + obj[i]["Originator"] + "</td>";
                                TableRow = TableRow + "</tr>";
                            }

                            var html = $compile(TableRow)($scope);
                            var el = angular.element($("#pendingApprovalsList tbody"));
                            el.append(html);
                            $compile(html)($scope);

                            var table = $("#pendingApprovalsList").dataTable({
                                "bDestroy": true,
                                scrollCollapse: true,
                                paging: true
                            });

                            $(".dataTables_scrollHeadInner").css({ "width": "100%" });
                            $(".table ").css({ "width": "100%" });
                            HideLoader();
                        });
                    }
                    HideLoader();
                },
                error: function (xhr, ajaxOptions, thrownError) {
                    alert(xhr + "\n" + ajaxOptions + "\n" + thrownError);
                    alert(json.stringify(xhr) + "\n" + json.stringify(ajaxOptions) + "\n" + json.stringify(thrownError));
                    HideLoader();
                }
            });
            HideLoader();
        }
        catch (e) {
            alert("ComplaintPendingApprovalCtrl + " + e);
            HideLoader();
        }
        HideLoader();
    });

    $scope.StateChange = function () {
        AssnState = $("#StateFilter").val();
        DIMSFactory.getMasterClickData("listpendingApprovalcommercial$" + AssnState).success(function (response) {

            var obj = JSON.parse(response.tabledata);
            tcount = obj.length;
            var TableRow = "";

            if (AssnState == "ALL") { }
            else {
                $("#CMSState").val(AssnState);
            }

            $("#pendingApprovalsList").DataTable().clear().draw();
            $("#pendingApprovalsList").DataTable().destroy();

            var SessionUserCode = $("#SessionUserCode").val();
            for (var i = 0; i < tcount; i++) {
                TableRow = TableRow + "<tr style='cursor:pointer;' id='PendingAppr_" + i + "' ng-click='GotoApprovalApplication(obj,$event)'>";
                TableRow = TableRow + "<td>" + obj[i]["Doc Code"] + "</td>";
                TableRow = TableRow + "<td>" + obj[i]["Doc No"] + "</td>";
                TableRow = TableRow + "<td>" + obj[i]["Complaint No"] + "</td>";
                TableRow = TableRow + "<td>" + obj[i]["STATE_DESC"] + "</td>";
                TableRow = TableRow + "<td>" + obj[i]["Originated On"] + "</td>";
                TableRow = TableRow + "<td>" + obj[i]["Originator"] + "</td>";
                TableRow = TableRow + "</tr>";
            }
            $("#pendingApprovalsList tbody").empty();
            var html = $compile(TableRow)($scope);
            var el = angular.element($("#pendingApprovalsList tbody"));
            el.append(html);
            $compile(html)($scope);

            var table = $("#pendingApprovalsList").dataTable({
                "bDestroy": true,
                scrollCollapse: true,
                paging: true
            });
        });
    }

    $scope.go = function (path) {
        CheckUserSession();
        $location.path(path);

    };


    $scope.GotoApprovalApplication = function (obj, $event) {
        var id = $($event.target).parent().attr("id");
        var Appl = $("#pendingApprovalsList tbody #" + id + " td")[0].innerHTML;
        var Cmpl_Mngmt_Id = $("#pendingApprovalsList tbody #" + id + " td")[1].innerHTML;
        $("#HiddenForCMS").val("FromPendingAppr");
        if (Appl == "Complaint Registration") {
            $scope.go("Registration/" + Cmpl_Mngmt_Id);
        }
        else if (Appl == "Corrective Measures") { PendingApprCmplType = "Corrective Measures"; $scope.go("CorrectiveMeasure/" + Cmpl_Mngmt_Id); }
        else if (Appl == "Compensation") { PendingApprCmplType = "Compensation"; $scope.go("Compensation/" + Cmpl_Mngmt_Id); }
        else if (Appl == "Investigation") { PendingApprCmplType = "Investigation"; $scope.go("Investigation/" + Cmpl_Mngmt_Id); }
    }

});


function EditAssnUserRole(obj, Methodname, Master, Heading, TextCount, DIMSFactory) {
    txtUserRoleCnt = "txtAssgnUserRole" + TextCount;
    txtUserNameCnt = "txtAssgnUserName" + TextCount;
    var scope = angular.element(document.getElementById("MainWrap")).scope();
    if (Master == "AssnUserRoleMaster") {
        angular.injector(['ng', 'DIMSApp']).get("DIMSFactory").getMasterClickData(Master).success(function (response) {
            getFieldLookUpData(response, Methodname, Heading);
        });
    }
    else if (Master == "AssnUserMaster") {
        if ($("#" + txtUserRoleCnt).val() != "") {
            angular.injector(['ng', 'DIMSApp']).get("DIMSFactory").getComplAssnUserData(Master, $("#" + txtUserRoleCnt).val()).success(function (response) {
                getFieldLookUpData(response, Methodname, Heading);
            });
        }
        else {
            alert("Please Select User Role");
        }
    }
}


function EditAssignUser(obj, cnt, DIMSFactory) {

    if ($("#chkAsgnUser" + cnt + "").prop('checked') == true) {
        $("#txtAssgnUserRole" + cnt + "").css("visibility", "visible");
        $("#txtAssgnUserName" + cnt + "").css("visibility", "visible");

        var BusinessUnit = $("#BU_" + cnt).val();


        if (BusinessUnit == "SBU1") {
            $("#txtAssgnUserRole" + cnt + "").val("Customer Service Officer");
        }
        else if (BusinessUnit == "SBU2") {
            $("#txtAssgnUserRole" + cnt + "").val("Customer Service Manager-BU2");
        }
        else if (BusinessUnit == "SBU3" || BusinessUnit == "UPVC" || BusinessUnit == "CPVC" || BusinessUnit == "COLUMN" || BusinessUnit == "Traded material" || BusinessUnit == "Traded") {
            //$("#txtAssgnUserRole" + cnt + "").val("Quality Audit Manager Plant");
            $("#txtAssgnUserRole" + cnt + "").val("Quality Assurance Manager Plant");
        }
        else {
            $("#txtAssgnUserRole" + cnt + "").val("");
        }
    }
    else {
        $("#txtAssgnUserRole" + cnt + "").css("visibility", "hidden");
        $("#txtAssgnUserName" + cnt + "").css("visibility", "hidden");
        $("#txtAssgnUserRole" + cnt + "").val("");
    }

}

function GetAssnUserRoleLookupData(obj) {
    MasterScope.$apply(function () {
        //MasterScope.txtDeptCompCode_Model = $(obj).children().eq(1).html();
        MasterScope.txtAssToUserRole_Model = $(obj).children().eq(2).html();
        MasterScope.txtAssToUser_Model = "";

    });
    var element = angular.element('#LookUpModal');
    element.modal('hide');
}

function GetAssnUserLookupData(obj) {
    MasterScope.$apply(function () {
        MasterScope.txtAssToUser_Model = $(obj).children().eq(2).html();
        //alert($(obj).children().eq(2).html());
    });
    var element = angular.element('#LookUpModal');
    element.modal('hide');
}

function GetAssnUserRoleData(obj) {
    //svprasadk 19-06-2020 SBU 1 requirement to bulk assign complaints start
    var USER_PRODUCT_TYPE_CODE = $("#USER_PRODUCT_TYPE_CODE").val();
    if (USER_PRODUCT_TYPE_CODE == "SBU1") {
        $("#userRoleMaster").val($(obj).children().eq(2).html());
        $("#userRoleMasterCode").val($(obj).children().eq(1).html());
    } else {
        $("#" + txtUserRoleCnt).val($(obj).children().eq(2).html());
    }
    //svprasadk 19-06-2020 SBU 1 requirement to bulk assign complaints end
    //$("#" + txtUserRoleCnt).val($(obj).children().eq(2).html());
    var element = angular.element('#LookUpModal');
    element.modal('hide');
}

function GetAssnUserData(obj) {
    //svprasadk 19-06-2020 SBU 1 requirement to bulk assign complaints start
    var USER_PRODUCT_TYPE_CODE = $("#USER_PRODUCT_TYPE_CODE").val();
    if (USER_PRODUCT_TYPE_CODE == "SBU1") {
        $("#usersBasedonRole").val($(obj).children().eq(2).html());
        $("#usersBasedonRoleCode").val($(obj).children().eq(1).html());
    } else {
        $("#" + txtUserNameCnt).val($(obj).children().eq(2).html());
    }
    //svprasadk 19-06-2020 SBU 1 requirement to bulk assign complaints end
    //$("#" + txtUserNameCnt).val($(obj).children().eq(2).html());
    var element = angular.element('#LookUpModal');
    element.modal('hide');
}

//svprasadk 18-06-2020 SBU 1 requirement to bulk assign complaints start
function getUserRoleMaster(Methodname, Master, Heading) {
    if ($('.roles:checkbox:checked').length == 0) {
        alert("Please select atleast one record");
    } else {
        angular.injector(['ng', 'DIMSApp']).get("DIMSFactory").getMasterClickData(Master).success(function (response) {
            getFieldLookUpData(response, Methodname, Heading);
        });
    }
}

function getUsersBasedonRole(Methodname, Master, Heading) {
    //svprasadk 19-06-2020 SBU 1 requirement to bulk assign complaints start
    if ($('.roles:checkbox:checked').length == 0) {
        alert("Please select atleast one record");
    }
    //svprasadk 19-06-2020 SBU 1 requirement to bulk assign complaints end
    else if ($("#userRoleMaster").val() != "") {
        angular.injector(['ng', 'DIMSApp']).get("DIMSFactory").getComplAssnUserData(Master, $("#userRoleMaster").val()).success(function (response) {
            getFieldLookUpData(response, Methodname, Heading);
        });
    }
    else {
        alert("Please Select User Role");
    }
}
//svprasadk 18-06-2020 SBU 1 requirement to bulk assign complaints end

DIMS.controller('ComplaintsApprovalReportCtrl', function ($scope, $location, DIMSFactory, $http) {
    $scope.templatesettings = { HeaderTitle: "Complaint Status Report" };

    angular.element(document).ready(function () {
        $.ajax({
            type: 'POST',
            url: '../../ComplaintRegistration/FillCMSStateFilter',
            async: true,
            success: function (response) {
                $("#StateFilter").empty();
                if (response == "") {

                }
                else {
                    response = JSON.parse(response);
                    for (var i = 0; i < response.length; i++) {
                        var option = $('<option></option>').attr("value", response[i]["STATE_CODE"]).text(response[i]["STATE_DESC"]);
                        $("#StateFilter").append(option);
                    }
                    var CMSState = $("#CMSState").val();

                    if (CMSState == "") {
                        $("#StateFilter").val(response[0]["STATE_CODE"]);
                        $("#CMSState").val(response[0]["STATE_CODE"]);
                    }
                    else {
                        $("#StateFilter").val(CMSState);
                    }
                    var CMSState = $("#StateFilter").val();
                    AssnState = CMSState;

                    DIMSFactory.getMasterClickData("listComplaintApprovals$" + AssnState).success(function (response) {

                        var obj = JSON.parse(response.tabledata);
                        tcount = obj.length;
                        var TableRow = "";
                        $("#ApprovalsList").dataTable().fnDestroy();
                        $("#ApprovalsList tbody").empty();

                        for (var i = 0; i < tcount; i++) {
                            TableRow = TableRow + "<tr class='MousePointer'>";
                            TableRow = TableRow + "<td>" + obj[i]["Doc Code"] + "</td>";
                            TableRow = TableRow + "<td>" + obj[i]["Doc No"] + "</td>";
                            TableRow = TableRow + "<td>" + obj[i]["Complaint Id"] + "</td>";
                            TableRow = TableRow + "<td>" + obj[i]["Complaint No"] + "</td>";
                            TableRow = TableRow + "<td>" + obj[i]["Doc series code"] + "</td>";
                            TableRow = TableRow + "<td>" + obj[i]["Originator"] + "</td>";
                            TableRow = TableRow + "<td>" + obj[i]["Originated On"] + "</td>";
                            TableRow = TableRow + "<td>" + obj[i]["Doc Status"] + "</td>";
                            //TableRow = TableRow + "<td>" + obj[i].STAGE + "</td>";
                            TableRow = TableRow + "</tr>";

                        }

                        $('#ApprovalsList tbody').append(TableRow);
                        var table = $("#ApprovalsList").dataTable({
                            "bDestroy": true,
                            scrollCollapse: true,
                            paging: true
                        });
                    });

                }
            },
            error: function (xhr, ajaxOptions, thrownError) {
            }
        });
    });

    $scope.StateChange = function () {
        AssnState = $("#StateFilter").val();
        DIMSFactory.getMasterClickData("listComplaintApprovals$" + AssnState).success(function (response) {

            var obj = JSON.parse(response.tabledata);
            tcount = obj.length;
            var TableRow = "";
            $("#ApprovalsList").dataTable().fnDestroy();
            $("#ApprovalsList tbody").empty();

            for (var i = 0; i < tcount; i++) {
                TableRow = TableRow + "<tr class='MousePointer'>";
                TableRow = TableRow + "<td>" + obj[i]["Doc Code"] + "</td>";
                TableRow = TableRow + "<td>" + obj[i]["Doc No"] + "</td>";
                TableRow = TableRow + "<td>" + obj[i]["Complaint Id"] + "</td>";
                TableRow = TableRow + "<td>" + obj[i]["Complaint No"] + "</td>";
                TableRow = TableRow + "<td>" + obj[i]["Doc series code"] + "</td>";
                TableRow = TableRow + "<td>" + obj[i]["Originator"] + "</td>";
                TableRow = TableRow + "<td>" + obj[i]["Originated On"] + "</td>";
                TableRow = TableRow + "<td>" + obj[i]["Doc Status"] + "</td>";
                //TableRow = TableRow + "<td>" + obj[i].STAGE + "</td>";
                TableRow = TableRow + "</tr>";

            }

            $('#ApprovalsList tbody').append(TableRow);
            var table = $("#ApprovalsList").dataTable({
                "bDestroy": true,
                scrollCollapse: true,
                paging: true
            });
        });
    }

    $scope.go = function (path) {
        CheckUserSession();
        $location.path(path);

    };

});



//Account Statement
var Posting_From_Date = ""; var Posting_To_Date = "";
DIMS.controller('AccountStatementCtrl', function ($scope, $location, DIMSFactory, $http, $compile) {
    $scope.templatesettings = { HeaderTitle: "Account Statement" };
    AccountStatementScope = $scope;
    MasterScope = $scope;



    $("#AccountStatementDiv").hide();

    $scope.go = function (path) {
        CheckUserSession();
        $location.path(path);
    };

    var width = $(window).width(), height = $(window).height();//---------

    var totalheight = height - 191;
    // var totalheight = height - 148;//--------    
    if (height <= 800) {
        totalheight = height - 148;
    }

    $('.content').css({ "max-height": totalheight, "overflow-y": "auto" });//-----------
    $('.content-header > h2').css({ "font-size": "18px", "font-weight": "500" });//----------
    $('.content').css({ "max-height": totalheight, "min-height": totalheight, "overflow-y": "auto" });//-----------

    try {
        //var encrypted = CryptoJS.AES.encrypt("Rajanna", "Secret Passphrase");
        ////U2FsdGVkX18ZUVvShFSES21qHsQEqZXMxQ9zgHy+bu0=

        //var decrypted = CryptoJS.AES.decrypt(encrypted, "Secret Passphrase");
        ////4d657373616765

        //alert(encrypted); alert(decrypted); alert(decrypted.toString(CryptoJS.enc.Utf8));
        ShowLoader();
        var CustomerArray = new Array(); var data_value = "";
        //var data_value = "{\"Role\":\"" + SessionValue + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        if ((SessionValue == "STOCKIST") || (SessionValue == "C&F")) { data_value = "{\"Role\":\"" + "STOCKIST" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}"; } else {
            data_value = "{\"Role\":\"" + "ACTSTMT" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        }
        //Get all the Customers here.
        $http({ url: '../../Home/GetCustomers_AccStmt', method: 'POST', data: { Data: data_value } }).success(function (res) {
            if (res != "") {
                var CustomerList = JSON.parse(res);
                if ((SessionValue == "STOCKIST") || (SessionValue == "C&F")) {
                    //Set his customer code as default and disable.
                    $("#StockistID").attr("disabled", true);
                    CustomerArray.push(CustomerList[0]["STOCKIST_ID"].toString() + ":" + CustomerList[0]["STOCKIST_NAME"])
                    $("#StockistID").val(CustomerList[0]["STOCKIST_ID"].toString() + ":" + CustomerList[0]["STOCKIST_NAME"]);
                } else {
                    $("#StockistID").disabled = false;
                    for (var i = 0; i < CustomerList.length; i++) {
                        CustomerArray.push(CustomerList[i]["STOCKIST_ID"].toString() + ":" + CustomerList[i]["STOCKIST_NAME"])
                    }
                    $("#StockistID").typeahead({
                        source: CustomerArray
                    });
                }
            }
        });

        //we are not using the below method 'GetCust_Name'
        $scope.GetCust_Name = function () {
            if ($("#StockistID").val() != "Select_Customer_Code") {
                var Data = "{\"Role\":\"" + "ADMIN" + "\",\"Cust_Code\":\"" + $("#StockistID").val() + "\"}";
                $http({ url: '../../SAP/GetCustomer_Name', method: 'POST', data: { Data: Data } }).success(function (resp) {
                    var data = JSON.parse(resp.tabledata);
                    //$("#StockistName").val("abc");
                    $("#StockistName").text(data[0]["STOCKIST_NAME"]);
                }).error(function (err) { alert("Error : " + err); });
            }

        }
        HideLoader();
    } catch (ex) { }

    //In the below function, we are validating the customers with logged in user. Wheather the customer belongs to his zone/state/fso or not.
    $scope.GetData = function () {
        var isValidCustCode = isValidCode_Cust($("#StockistID").val(), CustomerArray);
        if (($("#OrderFromDate").val() != "")) {
            if (($("#OrderToDate").val() != "")) {
                if (($("#StockistID").val() != "") && (isValidCustCode == true)) {
                    var DateRange = DateSplitter('OrderFromDate', 'OrderToDate');
                    try {
                        ShowLoader();
                        //var WhereClause = " where ao.CUSTOMER_CODE=CM.STOCKIST_ID and CAST(ao.CUSTOMER_CODE AS INT)='" + $("#StockistID").val() + "' AND ao.CUSTOMER_CODE=csm.STOCKIST_ID and csm.SALES_ORGANISATION='1000' and (ao.POSTING_DATE between " + DateRange + ") group by ao.CUSTOMER_CODE ,CM.STOCKIST_NAME,ao.POSTING_DATE,CM.STATE order by ao.POSTING_DATE DESC";
                        var Customer_Code = $("#StockistID").val().split(':');
                        var data_value = "{\"Role\":\"" + SessionValue + "\",\"UserCode\":\"" + $("#UserCode").val() + "\",\"CustCode\":\"" + Customer_Code[0] + "\"}";
                        $http({ url: '../../Home/ValidateCustomer_AccStmt', method: 'POST', data: { Data: data_value } }).success(function (resp) {
                            if (resp == "true") {
                                var data = JSON.parse(resp);
                                var WhereClause = " where ao.STATE=sm.STATE_CODE and cast(ao.STOCKIST_ID as int)  = cast(CSV.cust_code as int) and cast(ao.STOCKIST_ID as int) ='" + Customer_Code[0] + "'";
                                var Data = JSON.stringify({
                                    MasterType: "AccountStatement",
                                    ID: "561",
                                    UserCode: $("#UserCode").val(),
                                    "Type": "Get",
                                    ReportName: "AccountStatement",
                                    WhereClause: WhereClause
                                });

                                DIMSFactory.getReportListColumnNamesData(Data).success(function (response) {
                                    var Result = JSON.parse(response.tabledata);

                                    if (Result != "") {
                                        $scope.UserDefaultListColumnNames = Result["UserDefaultListColumnNames"];
                                        if (Result.hasOwnProperty('UserListColumnNames')) {
                                            var data1 = JSON.parse(Result["UserListColumnNames"]);

                                            var selectedcolumnname = data1["ColumnNames"];

                                            CustomColumnID = Result["UserListID"];
                                            $('#undo_redo_to').empty();
                                            var ColArray = new Array();
                                            for (var i = 0; i < selectedcolumnname.length; i++) {


                                                ColArray.push({
                                                    "data": selectedcolumnname[i],
                                                    "name": selectedcolumnname[i], "bSortable": true
                                                });
                                                $("#undo_redo_to").append($("<option></option>").val(selectedcolumnname[i]).html(selectedcolumnname[i]));
                                            }
                                            //$scope.UserSelectedColumnName = ColArray;
                                            UserSelectedColumnName = ColArray;
                                        } else {

                                            var data1 = JSON.parse(Result["UserDefaultListColumnNames"]);

                                            var selectedcolumnname = data1["ColumnNames"];

                                            CustomColumnID = "0";

                                            $('#undo_redo_to').empty();
                                            var ColArray = new Array();
                                            for (var i = 0; i < selectedcolumnname.length; i++) {
                                                ColArray.push({
                                                    "data": selectedcolumnname[i],
                                                    "name": selectedcolumnname[i],
                                                    "bSortable": "true"
                                                });
                                                $("#undo_redo_to").append($("<option></option>").val(selectedcolumnname[i]).html(selectedcolumnname[i]));
                                            }
                                            //$scope.UserSelectedColumnName = ColArray;
                                            UserSelectedColumnName = ColArray;
                                        }



                                    }
                                    DIMSFactory.getReportData(Data).success(function (response) {

                                        getLookUpData_Reports_ServerSideBinding("", "EnrollmentNodataLabel", "", "Acc_Stmt", UserSelectedColumnName);
                                        $("#AccountStatementDiv").show();
                                        $('#Acc_Stmt tbody').on('click', 'tr', function () {
                                            ShowLoader();
                                            var ID = $(this).find('td:eq(0)').text().split(':');
                                            var Cust_Code = ID[0];
                                            if (ID != "") {
                                                //Here we are splitting the date with '/' and getting the values and redirecting to summary page with date fields and customer code also.
                                                var From_Dt = $("#OrderFromDate").val().split('/'); var To_Dt = $("#OrderToDate").val().split('/');
                                                var From_Dte = "" + From_Dt[2] + '-' + From_Dt[1] + '-' + From_Dt[0] + "";
                                                var To_Dte = "" + To_Dt[2] + '-' + To_Dt[1] + '-' + To_Dt[0] + "";
                                                var scope = angular.element($("#AccountStatementDiv")).scope();
                                                scope.$apply(function () {
                                                    var Dates12 = Cust_Code + '$' + From_Dte + '$' + To_Dte;
                                                    var data_value = "{\"FromDate\":\"" + From_Dte + "\",\"ToDate\":\"" + To_Dte + "\",\"CustCode\":\"" + Cust_Code + "\"}";
                                                    $http({ url: '../../SAP/Account_Statement_Summary', method: 'POST', data: { val: data_value } }).success(function (res) {
                                                        var result = JSON.parse(res);

                                                        if (result != "") {
                                                            HideLoader();
                                                            scope.go("AccountStatementSummary/" + Dates12);
                                                        }
                                                        else {
                                                            HideLoader();
                                                            alert("No Data available for this Customer");
                                                        }
                                                    });
                                                })
                                                //$scope.go("AccountStatementSummary/" + ID);
                                            }

                                            if ($(this).hasClass('selected')) {
                                                $(this).removeClass('selected');
                                            }
                                            else {
                                                $('tr.selected').removeClass('selected');
                                                $(this).addClass('selected');
                                            }
                                        });


                                    });

                                });
                            } else { alert(resp); $("#AccountStatementDiv").hide(); }
                        }).error(function (err) { alert("Error : " + err); });

                    } catch (Exception) { }
                } else { alert("Please Select Proper Customer Code"); }
            } else { alert("Please Select To Date"); }
        } else { alert("Please Select From Date"); }
    }

    //The below method is used for download the pdf.
    $scope.DownloadFile = function (filetype) {
        var isValidCustCode = isValidCode_Cust($("#StockistID").val(), CustomerArray);
        var SearchValue = $('input[type=search]').val();
        var FileName = "AccountStatement";
        var Customer_Code = $("#StockistID").val().split(':');
        var WhereClause = "where ao.STATE=sm.STATE_CODE and cast(ao.STOCKIST_ID as int)  = cast(CSV.cust_code as int) and cast(ao.STOCKIST_ID as int) ='" + Customer_Code[0] + "'";


        var TableCount = $('#Acc_Stmt').DataTable().data().count();
        if (TableCount == 0) {
            alert("There is no data");
        }
        else {
            if (($("#StockistID").val() != "") && (isValidCustCode == true)) {
                var data_value = "{\"Role\":\"" + SessionValue + "\",\"Form_Code\":\"" + "AST" + "\",\"Action\":\"" + "Is_Export" + "\"}";
                $http({ url: '../../Home/Form_Access', method: 'POST', data: { Data: data_value } }).success(function (res) {
                    if (res == "True") {
                        CommonFunctionForExcelExport_SearchFilter("561", UserCode, SearchValue, FileName, FileName, WhereClause, filetype);
                    }
                    else {
                        alert("You are not allowed to export Account Statement List");
                    }
                });
            }
            else {
                alert("Please Select Proper Customer Code");
            }

        }



        //var Data = JSON.stringify({
        //    ID: "561",
        //    UserCode: "561",
        //    ReportName: FileName,
        //    WhereClause: WhereClause,
        //    "SearchValue": SearchValue
        //});

        //$.ajax({
        //    url: '../../Home/SetInputData',
        //    type: "POST",
        //    datatype: "JSON",
        //    data: { InputData: Data, ReportType: filetype, FileName: FileName },
        //    async: false,
        //    cache: false,
        //    success: function (response) {
        //        window.location.href = '../../Home/GenerateReport_SAP';
        //    },
        //    error: function () {
        //        alert("Technical error has been occured.Please try again later");

        //    }
        //});

    }



    // Open popup for columns selection
    $scope.OpenColumnEditing = function () {

        $('#undo_redo').empty();
        var ColumnNames = JSON.parse($scope.UserDefaultListColumnNames);

        for (var i = 0; i < ColumnNames["ColumnNames"].length; i++) {
            $("#undo_redo").append($("<option></option>").val(ColumnNames["ColumnNames"][i]).html(ColumnNames["ColumnNames"][i]));
        }



        //   $('#undo_redo').refresh();

        $('#undo_redo').multiselect();
        if (ControllerName != "AccountStatementCtrl") {
            ControllerName = "AccountStatementCtrl";
            var elem = angular.element('#ColumnEditingModal');
            elem.removeAttr('ng-controller');
            elem.attr('ng-controller', "AccountStatementCtrl");

            $compile(elem.contents())(AccountStatementScope);
        }

        $("#ColumnEditingModal").modal('show');




    }
    // View Column selected it is like preview.We will send reportname,usercode and where condition to function
    $scope.ViewColumnEditing = function () {
        DIMSFactory.ViewColumnEditing("AccountStatement", $("#UserCode").val(), " NOT EXISTS (SELECT * FROM sap_account_closed_items ac WHERE ao.COMPANY_CODE = ac.COMPANY_CODE and ao.CUSTOMER = ac.CUSTOMER and ao.FISCAL_YEAR = ac.FISCAL_YEAR and ao.DOC_NO = ac.DOC_NO and ao.ITEM_NO = ac.ITEM_NO and ao.POSTING_DATE = ac.POSTING_DATE and ao.DOC_DATE = ac.DOC_DATE and ao.AMOUNT = ac.AMOUNT) and ao.CUSTOMER=CM.STOCKIST_ID"); // 1-Report Name ,2-UserCode(561),3-WhereClause

    }
    // Save Column selected it is like preview.We will send reportname,usercode and where condition to function
    $scope.SaveColumnEditingData = function () {
        var WhereClause = " WHERE NOT EXISTS (SELECT * FROM sap_account_closed_items ac WHERE ao.COMPANY_CODE = ac.COMPANY_CODE and ao.CUSTOMER = ac.CUSTOMER and ao.FISCAL_YEAR = ac.FISCAL_YEAR and ao.DOC_NO = ac.DOC_NO and ao.ITEM_NO = ac.ITEM_NO and ao.POSTING_DATE = ac.POSTING_DATE and ao.DOC_DATE = ac.DOC_DATE and ao.AMOUNT = ac.AMOUNT) and ao.CUSTOMER=CM.STOCKIST_ID";
        var Data = JSON.stringify({
            MasterType: "AccountStatement",
            ID: "561",
            UserCode: $("#UserCode").val(),
            "Type": "Get",
            ReportName: "AccountStatement",
            WhereClause: WhereClause
        });
        //DIMSFactory.SaveColumnEditingData("Compensation", $scope.UserCode, " ORDER BY ID DESC");
        DIMSFactory.SaveColumnEditingData_InputParameter("AccountStatement", $("#UserCode").val(), WhereClause, Data, "Acc_Stmt");
        // 1-Report Name ,2-UserCode(561),3-WhereClause,4-JsonData,5-Frontend datatable id


    }


})

function DateValidation(FromDate, ToDate) {
    if ($("#" + FromDate).val() != "") {
        $("#" + ToDate).datepicker('setStartDate', $("#" + FromDate).val());
        //$("#" + ToDate).datepicker('option', 'minDate', $("#" + MyDate).val());
        //$("#"+ToDate).val("");
    }
}

function DateSplitter(FromDate, ToDate) {
    var From_Dt = $("#" + FromDate).val().split('/'); var To_Dt = $("#" + ToDate).val().split('/');
    var Dates = "'" + From_Dt[2] + '/' + From_Dt[1] + '/' + From_Dt[0] + "'" + ' and ' + "'" + To_Dt[2] + '/' + To_Dt[1] + '/' + To_Dt[0] + "'";
    return Dates;
}


//Account Summary
DIMS.controller('AccountStatementSummaryCtrl', function ($scope, $location, DIMSFactory, $http, $compile, $routeParams) {

    $scope.templatesettings = { HeaderTitle: "Account Summary" };
    MasterScope = $scope;



    $scope.go = function (path) {
        CheckUserSession();
        $location.path(path);
    };

    //Here we are taking the values from route parameters and passing these values to service.
    try {
        var params = $routeParams.ID.split('$');
        var EditId = params[0]; var outstandsum = 0; var outstanddiff = 0; var outstanddiffTotal = 0; var DateNow = new Date(); var CurMonth = parseInt(DateNow.getMonth()) + 1;
        if (EditId == undefined || EditId == "") {
            EditId = 0;
        } else {
            ShowLoader();
            var Dates1 = params[1].split('-'); var Dates2 = params[2].split('-');
            var DatesWithId = "{\"FromDate\":\"" + Dates1[0] + '/' + Dates1[1] + '/' + Dates1[2] + "\",\"ToDate\":\"" + Dates2[0] + '/' + Dates2[1] + '/' + Dates2[2] + "\",\"CustCode\":\"" + params[0] + "\"}";
            $http({
                method: 'POST',
                url: '../../SAP/Account_Statement_Summary',
                data: { val: DatesWithId }
            }).success(function (response) {
                var data = response;
                data = JSON.parse(data);
                $("#tbl_AccSummary").dataTable().fnDestroy();
                $('#tbl_AccSummary tbody').empty();

                //For PDF
                $("#tbl_AccSummary_html").dataTable().fnDestroy();
                $('#tbl_AccSummary_html tbody').empty();

                TRCode = "";
                $("#PartyCode").text(data[0]["Stockist Id"]);
                $("#Name").text(data[0]["Stockist Name"]);
                $("#Address").text(data[0]["Stockist Address"]);

                //For PDF Generation
                $("#PartyCode_html").text(data[0]["Stockist Id"]);
                $("#Name_html").text(data[0]["Stockist Name"]);
                $("#Address_html").text(data[0]["Stockist Address"]);

                //If the security deposit value is greater than zero then we are concatenating the text as 'Debit'.
                //Otherwise Credit.
                var Sec_Deposit = "";
                if (parseInt(data[0]["Security Deposit"]) > 0) {
                    Sec_Deposit = "and for Security Deposit is Rs. " + Number(data[0]["Security Deposit"]).toFixed(2) + " Debit";
                } else {
                    Sec_Deposit = "and for Security Deposit is Rs. " + Number(data[0]["Security Deposit"]).toFixed(2) + " Credit";
                }

                //If the Outstanding amount value is greater than zero then we are concatenating the text as 'Debit'.
                //Otherwise Credit.
                if (parseInt(data[0]["Outstanding"]) > 0) {
                    $("#lblOpenBal").html(Number(data[0]["Outstanding"]).toFixed(2) + ' Debit ' + Sec_Deposit);
                    //For PDF
                    $("#lblOpenBal_html").html(Number(data[0]["Outstanding"]).toFixed(2) + ' Debit ' + Sec_Deposit);
                } else {
                    $("#lblOpenBal").html(Number(data[0]["Outstanding"]).toFixed(2) + ' Credit ' + Sec_Deposit);
                    //For PDF
                    $("#lblOpenBal_html").html(Number(data[0]["Outstanding"]).toFixed(2) + ' Credit ' + Sec_Deposit);
                }
                var Credit = ""; var Debit = "";
                var Cumulative = ""; if (data[0]["Outstanding"] == null) { Cumulative = "0.00"; } else { Cumulative = Number(data[0]["Outstanding"]).toFixed(2); }
                if (parseInt(Cumulative) < 0) { Credit = Number(data[0]["Outstanding"]).toFixed(2) * -1; Debit = ""; } else { Debit = Number(data[0]["Outstanding"]).toFixed(2); Credit = ""; }
                // svprasadk 13-07-2020 hiding opening balance start
                TRCode = TRCode + "<tr style='page-break-inside:avoid; page-break-after:auto'><td> </td><td>Op. Balance</td> <td></td> <td align='right'>" + Debit + "</td> <td align='right'>" + Credit + "</td> <td align='right'>" + Cumulative + "</td> <td></td> <td></td> <td></td></tr>";
                // svprasadk 13-07-2020 hiding opening balance end
                for (var i = 0 ; i < data.length ; i++) {

                    if (data[i]["Debit Amount(Rs)"] == "0") { data[i]["Debit Amount(Rs)"] = ""; }
                    if (data[i]["Credit Amount(Rs)"] == "0") { data[i]["Credit Amount(Rs)"] = ""; }
                    TRCode = TRCode + "<tr class='MousePointer' id='Acc_Stmt_" + (i + 1) + "'  ng-click='EditAcc_Stmt(obj,$event);' style='page-break-inside:avoid; page-break-after:auto'>";
                    TRCode = TRCode + "<td>" + data[i]["Type"] + "</td>";
                    TRCode = TRCode + "<td align='left'>" + data[i]["Document Number"] + "</td>";
                    TRCode = TRCode + "<td>" + data[i]["Posting Date"] + "</td>";
                    //TRCode = TRCode + "<td>" + data[i]["Document Date"] + "</td>";
                    if (data[i]["Debit Amount(Rs)"] == "") {
                        TRCode = TRCode + "<td></td>";
                    } else {
                        TRCode = TRCode + "<td align='right'>" + Number(data[i]["Debit Amount(Rs)"]).toFixed(2) + "</td>";
                    }
                    if (data[i]["Credit Amount(Rs)"] == "") {
                        TRCode = TRCode + "<td></td>";
                    } else {
                        TRCode = TRCode + "<td align='right'>" + Number(data[i]["Credit Amount(Rs)"]).toFixed(2) + "</td>";
                    }
                    if (i == data.length - 1) {
                        $("#lblClosedDate").html(Dates2[2] + '/' + Dates2[1] + '/' + Dates2[0]);
                        //$("#lblClosedDate").html(data[i]["Posting Date"]);
                        //For PDF
                        $("#lblClosedDate_html").html(Dates2[2] + '/' + Dates2[1] + '/' + Dates2[0]);
                    }
                    if (i == 0) {
                        $("#lblOpenDate").html(Dates1[2] + '/' + Dates1[1] + '/' + Dates1[0]);
                        //$("#lblOpenDate").html(data[i]["Posting Date"]);
                        //For PDF
                        $("#lblOpenDate_html").html(Dates1[2] + '/' + Dates1[1] + '/' + Dates1[0]);
                        //$("#lblOpenDate_html").html(data[i]["Posting Date"]);
                        $("#StatementPeriod").html(Dates1[2] + '/' + Dates1[1] + '/' + Dates1[0] + " to " + Dates2[2] + '/' + Dates2[1] + '/' + Dates2[0]);
                        //$("#StatementPeriod").html(data[i]["Posting Date"] + " to " + data[data.length - 1]["Posting Date"]);
                        //For PDF
                        $("#StatementPeriod_html").html(Dates1[2] + '/' + Dates1[1] + '/' + Dates1[0] + " to " + Dates2[2] + '/' + Dates2[1] + '/' + Dates2[0]);
                        //$("#StatementPeriod_html").html(data[i]["Posting Date"] + " to " + data[data.length - 1]["Posting Date"]);

                        if (data[i]["Debit Amount(Rs)"] == "0") { data[i]["Debit Amount(Rs)"] = 0; }
                        if (data[i]["Credit Amount(Rs)"] == "0") { data[i]["Credit Amount(Rs)"] = 0; }
                        if (data[i]["Debit Amount(Rs)"] == 0) { outstanddiff = parseFloat(Number(Cumulative).toFixed(2)) - parseFloat(Number(data[i]["Credit Amount(Rs)"]).toFixed(2)); }
                        else {
                            outstanddiff = parseFloat(Number(Cumulative).toFixed(2)) + parseFloat(Number(data[i]["Debit Amount(Rs)"]).toFixed(2));
                        }

                        TRCode = TRCode + "<td align='right'>" + Number(outstanddiff).toFixed(2) + "</td>";
                    } else {
                        if (data[i]["Debit Amount(Rs)"] == "0") { data[i]["Debit Amount(Rs)"] = 0; }
                        if (data[i]["Credit Amount(Rs)"] == "0") { data[i]["Credit Amount(Rs)"] = 0; }
                        if (data[i]["Debit Amount(Rs)"] == 0) { outstanddiffTotal = parseFloat(Number(outstanddiff).toFixed(2)) - parseFloat(Number(data[i]["Credit Amount(Rs)"]).toFixed(2)); }
                        else {
                            outstanddiffTotal = parseFloat(Number(outstanddiff).toFixed(2)) + parseFloat(Number(data[i]["Debit Amount(Rs)"]).toFixed(2));
                        }

                        outstanddiff = outstanddiffTotal;
                        TRCode = TRCode + "<td align='right'>" + Number(outstanddiffTotal).toFixed(2) + "</td>";
                    }
                    //TRCode = TRCode + "<td align='right'>" + data[i]["Outstanding"] + "</td>";
                    TRCode = TRCode + "<td>" + data[i]["Narration"] + "</td>";

                    if (data[i]["Type"] == "RV") {
                        TRCode = TRCode + "<td align='left'>" + data[i]["Billing Doc."] + "</td>";
                    } else { TRCode = TRCode + "<td></td>"; }
                    TRCode = TRCode + "<td align='left'>" + data[i]["Billing Doc."] + "</td>";
                    TRCode = TRCode + "</tr>";
                }
                var Html = $compile(TRCode)($scope);
                var el = angular.element($("#tbl_AccSummary tbody"));
                el.append(Html);
                $compile(Html)($scope);
                $("#tbl_AccSummary").dataTable({
                    "aaSorting": [],
                    //dom: 'Bfrtip',
                    //buttons: [
                    //    {
                    //        extend: 'pdfHtml5',
                    //        orientation: 'landscape',
                    //        pageSize: 'A3'
                    //    },
                    //    //'excel'
                    //],
                    "bDestroy": true,
                    //scrollY: "200px",
                    //scrollX: true,
                    //scrollCollapse: true,
                    //paging: true,
                    fixedColumns: {
                        leftColumns: 0
                    },
                    'bPaginate': false,
                    'bFilter': false,
                    'bSort': false,
                    "footerCallback": function (row, data, start, end, display) {
                        var api = this.api(), data;

                        // Remove the formatting to get integer data for summation
                        var intVal = function (i) {
                            return typeof i === 'string' ?
                                i.replace(/[\$,]/g, '') * 1 :
                                typeof i === 'number' ?
                                i : 0;
                        };

                        // Total over this page
                        DebitpageTotal = api
                            .column(3, { page: 'current' })
                            .data()
                            .reduce(function (a, b) {
                                return Number(intVal(a) + intVal(b)).toFixed(2);
                            }, 0);

                        CreditpageTotal = api
                           .column(4, { page: 'current' })
                           .data()
                           .reduce(function (a, b) {
                               return Number(intVal(a) + intVal(b)).toFixed(2);
                           }, 0);

                        OutStandpageTotal = api
                           .column(5, { page: 'current' })
                           .data()
                           .reduce(function (a, b) {
                               //var sd = intVal(a) + intVal(b);
                               //alert(intVal(intVal(sd) - intVal(params[1])));
                               //return intVal((intVal(a) + intVal(b)) - params[1]);
                               return Number(intVal(a) + intVal(b)).toFixed(2);
                           }, 0);



                        $(api.column(3).footer()).html(DebitpageTotal);
                        $(api.column(4).footer()).html(CreditpageTotal);
                        $(api.column(5).footer()).html(OutStandpageTotal);
                        outstandsum = OutStandpageTotal;
                    }
                });
                $("#OutstandingTotal").html(Number(outstanddiffTotal).toFixed(2));


                if (parseInt(data[0]["Security"]) > 0) {
                    Sec_Deposit = "and for Security Deposit is Rs. " + Number(data[0]["Security"]).toFixed(2) + " Debit";
                } else {
                    Sec_Deposit = "and for Security Deposit is Rs. " + Number(data[0]["Security"]).toFixed(2) + " Credit";
                }



                if (parseInt(outstanddiffTotal) > 0) {

                    $("#lblClosedBal").html(Number(outstanddiffTotal).toFixed(2) + ' Debit ' + Sec_Deposit);
                    //For PDF
                    $("#lblClosedBal_html").html(Number(outstanddiffTotal).toFixed(2) + ' Debit ' + Sec_Deposit);
                } else {
                    $("#lblClosedBal").html(Number(outstanddiffTotal).toFixed(2) + ' Credit ' + Sec_Deposit);
                    //For PDF
                    $("#lblClosedBal_html").html(Number(outstanddiffTotal).toFixed(2) + ' Credit ' + Sec_Deposit);
                }

                //For PDF Generation=======
                var Pdf_Html = $compile(TRCode)($scope);
                var Pdf_el = angular.element($("#tbl_AccSummary_html tbody"));
                Pdf_el.append(Pdf_Html);
                $compile(Pdf_Html)($scope);
                $("#tbl_AccSummary_html").dataTable({
                    "aaSorting": [],
                    //dom: 'Bfrtip',
                    //buttons: [
                    //    {
                    //        extend: 'pdfHtml5',
                    //        orientation: 'landscape',
                    //        pageSize: 'A3'
                    //    },
                    //    //'excel'
                    //],
                    "bDestroy": true,
                    //scrollY: "200px",
                    //scrollX: true,
                    //scrollCollapse: true,
                    //paging: true,
                    fixedColumns: {
                        leftColumns: 0
                    },
                    'bPaginate': false,
                    'bFilter': false,
                    'bSort': false,
                    "footerCallback": function (row, data, start, end, display) {
                        var api = this.api(), data;

                        // Remove the formatting to get integer data for summation
                        var intVal = function (i) {
                            return typeof i === 'string' ?
                                i.replace(/[\$,]/g, '') * 1 :
                                typeof i === 'number' ?
                                i : 0;
                        };

                        // Total over this page
                        DebitpageTotal = api
                            .column(3, { page: 'current' })
                            .data()
                            .reduce(function (a, b) {
                                return Number(intVal(a) + intVal(b)).toFixed(2);
                            }, 0);

                        CreditpageTotal = api
                           .column(4, { page: 'current' })
                           .data()
                           .reduce(function (a, b) {
                               return Number(intVal(a) + intVal(b)).toFixed(2);
                           }, 0);

                        OutStandpageTotal = api
                           .column(5, { page: 'current' })
                           .data()
                           .reduce(function (a, b) {
                               //var sd = intVal(a) + intVal(b);
                               //alert(intVal(intVal(sd) - intVal(params[1])));
                               //return intVal((intVal(a) + intVal(b)) - params[1]);
                               return Number(intVal(a) + intVal(b)).toFixed(2);
                           }, 0);



                        $(api.column(3).footer()).html(DebitpageTotal);
                        $(api.column(4).footer()).html(CreditpageTotal);
                        $(api.column(5).footer()).html(OutStandpageTotal);
                        outstandsum = OutStandpageTotal;
                    }
                });
                $("#OutstandingTotal_html").html(Number(outstanddiffTotal).toFixed(2));
                HideLoader();

            }).error(function (err) { alert("Error : " + err); });
        }
    } catch (Exception) { }

    //function columnsum(columnnum) {
    //    alert("inside");
    //    var totalSUM = 0;
    //    $("#tbl_AccSummary tbody tr").each(function () {
    //        alert("inside tr");
    //        var getValue = $(this).find("td:eq(" + columnnum + ")").find('.sum').html().replace("$", "");
    //        var filteresValue = getValue.replace(/\,/g, '');
    //        totalSUM += Number(filteresValue)
    //    });
    //    return totalSUM;
    //}


});



//Credit Notes
DIMS.controller('CreditNotesCtrl', function ($scope, $location, DIMSFactory, $http, $compile, $routeParams, DIMSSAPFactory) {
    $scope.templatesettings = { HeaderTitle: "Credit Notes" };
    CreditNoteScope = $scope;
    MasterScope = $scope;


    $("#CredtiNoteDetailId").hide();
    $scope.go = function (path) {
        CheckUserSession();
        $location.path(path);
    };

    var width = $(window).width(), height = $(window).height();//---------

    var totalheight = height - 191;
    // var totalheight = height - 148;//--------    
    if (height <= 800) {
        totalheight = height - 148;
    }

    $('.content').css({ "max-height": totalheight, "overflow-y": "auto" });//-----------
    $('.content-header > h2').css({ "font-size": "18px", "font-weight": "500" });//----------
    $('.content').css({ "max-height": totalheight, "min-height": totalheight, "overflow-y": "auto" });//-----------

    //$('#StockistID').SumoSelect({ placeholder: 'Customer Code' });
    $('#SalesEmapName').SumoSelect({ placeholder: 'Sales Employee' });
    $('#PlantSumo').SumoSelect({ placeholder: 'Plant' });
    $('#Zone').SumoSelect({ placeholder: 'Zone' });
    $('#State').SumoSelect({ placeholder: 'State' });
    $('#TerriotryArea').SumoSelect({ placeholder: 'Terriotry/Area' });
    $('#Location').SumoSelect({ placeholder: 'Location' });
    var data_value = ""; var all_zones = ""; var all_states = ""; var all_territories = ""; var all_customers = ""; var CustomerArray = new Array();
    ShowLoader();
    if ((SessionValue == "ZH") || (SessionValue == "RCC") || (SessionValue == "ZSC")) {
        $("#Zone").attr("disabled", false); $("#State").attr("disabled", false); $("#TerriotryArea").attr("disabled", false); $('#CustomerCode').attr("disabled", false);// $("#StockistID").attr("disabled", false);
        //data_value = "{\"Role\":\"" + "ZH" + "\",\"UserCode\":\"" + "50001762" + "\"}";
        data_value = "{\"Role\":\"" + "ZH" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
            var FilterList = JSON.parse(res);
            all_zones = "";
            for (var i = 0; i < FilterList.dtZone.length; i++) {
                $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
                if (FilterList.dtZone.length == 0) {
                    all_zones = "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                } else if (i == FilterList.dtZone.length - 1) {
                    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                } else {
                    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'" + ',';
                }
            }
            $('select#Zone')[0].sumo.selectItem(0);
            $('#Zone').trigger("change");
            //all_states = "";
            //for (var i = 0; i < FilterList.dtState.length; i++) {
            //    if (FilterList.dtState.length == 0) {
            //        all_states = "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
            //    } else if (i == FilterList.dtState.length - 1) {
            //        all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
            //    } else {
            //        all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'" + ',';
            //    }
            //}
            //all_territories = "";
            //for (var i = 0; i < FilterList.dtTerritory.length; i++) {
            //    if (FilterList.dtTerritory.length == 0) {
            //        all_territories = "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
            //    } else if (i == FilterList.dtTerritory.length - 1) {
            //        all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
            //    } else {
            //        all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'" + ',';
            //    }
            //}
            //all_customers = "";
            //for (var i = 0; i < FilterList.dtCustomer.length; i++) {
            //$('#StockistID')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //$('#StockistName')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //if (FilterList.dtCustomer.length == 0) {
            //    all_customers = "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else if (i == FilterList.dtCustomer.length - 1) {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'" + ',';
            //}
            //}
        });
    } else if (SessionValue == "SH") {
        $("#Zone").attr("disabled", true); $("#State").attr("disabled", false); $("#TerriotryArea").attr("disabled", false); $('#CustomerCode').attr("disabled", false);// $("#StockistID").attr("disabled", false);
        //data_value = "{\"Role\":\"" + "SH" + "\",\"UserCode\":\"" + "50002430" + "\"}";
        data_value = "{\"Role\":\"" + "SH" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
            var FilterList = JSON.parse(res);
            //all_zones = "";
            for (var i = 0; i < FilterList.dtZone.length; i++) {
                $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
                //if (FilterList.dtZone.length == 0) {
                //    all_zones = "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else if (i == FilterList.dtZone.length - 1) {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'" + ',';
                //}
            }
            $('select#Zone')[0].sumo.selectItem(0);
            //all_states = "";
            for (var i = 0; i < FilterList.dtState.length; i++) {
                $('#State')[0].sumo.add(FilterList.dtState[i]["STATE_CODE"], FilterList.dtState[i]["STATE_NAME"]);
                //if (FilterList.dtState.length == 0) {
                //    all_states = "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else if (i == FilterList.dtState.length - 1) {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'" + ',';
                //}
            }
            $('select#State')[0].sumo.selectItem(0);
            $('#State').trigger("change");
            //all_territories = "";
            //for (var i = 0; i < FilterList.dtTerritory.length; i++) {
            //    if (FilterList.dtTerritory.length == 0) {
            //        all_territories = "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
            //    } else if (i == FilterList.dtTerritory.length - 1) {
            //        all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
            //    } else {
            //        all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'" + ',';
            //    }
            //}
            //all_customers = "";
            //for (var i = 0; i < FilterList.dtCustomer.length; i++) {
            // $('#StockistID')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //$('#StockistName')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //if (FilterList.dtCustomer.length == 0) {
            //    all_customers = "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else if (i == FilterList.dtCustomer.length - 1) {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'" + ',';
            //}
            // }
        });
    }

    else if (SessionValue == "TM") {
        $("#Zone").attr("disabled", true); $("#State").attr("disabled", true); $("#TerriotryArea").attr("disabled", false); $('#CustomerCode').attr("disabled", false);// $("#StockistID").attr("disabled", false);
        //data_value = "{\"Role\":\"" + "TM" + "\",\"UserCode\":\"" + "50001144" + "\"}";
        data_value = "{\"Role\":\"" + "TM" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
            var FilterList = JSON.parse(res);
            //all_zones = "";
            for (var i = 0; i < FilterList.dtZone.length; i++) {
                $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
                //if (FilterList.dtZone.length == 0) {
                //    all_zones = "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else if (i == FilterList.dtZone.length - 1) {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'" + ',';
                //}
            }
            $('select#Zone')[0].sumo.selectItem(0);
            //all_states = "";
            for (var i = 0; i < FilterList.dtState.length; i++) {
                $('#State')[0].sumo.add(FilterList.dtState[i]["STATE_CODE"], FilterList.dtState[i]["STATE_NAME"]);
                //if (FilterList.dtState.length == 0) {
                //    all_states = "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else if (i == FilterList.dtState.length - 1) {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'" + ',';
                //}
            }
            $('select#State')[0].sumo.selectItem(0);
            //all_territories = "";
            for (var i = 0; i < FilterList.dtTerritory.length; i++) {
                $('#TerriotryArea')[0].sumo.add(FilterList.dtTerritory[i]["TERRITORY_CODE"], FilterList.dtTerritory[i]["TERRITORY_NAME"]);
                //if (FilterList.dtTerritory.length == 0) {
                //    all_territories = "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                //} else if (i == FilterList.dtTerritory.length - 1) {
                //    all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                //} else {
                //    all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'" + ',';
                //}
            }
            //all_customers = "";
            // for (var i = 0; i < FilterList.dtCustomer.length; i++) {
            // $('#StockistID')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //$('#StockistName')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //if (FilterList.dtCustomer.length == 0) {
            //    all_customers = "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else if (i == FilterList.dtCustomer.length - 1) {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'" + ',';
            //}
            //}
        });
    }

    else if (SessionValue == "FSO" || SessionValue == "FSO_BU2") {
        $("#Zone").attr("disabled", true); $("#State").attr("disabled", true); $("#TerriotryArea").attr("disabled", false); $('#CustomerCode').attr("disabled", false);// $("#StockistID").attr("disabled", false);
        //data_value = "{\"Role\":\"" + "FSO" + "\",\"UserCode\":\"" + "50001906" + "\"}";
        if (SessionValue == "FSO") {
            data_value = "{\"Role\":\"" + "FSO" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        } else {
            data_value = "{\"Role\":\"" + "FSO_BU2" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        }
        $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
            var FilterList = JSON.parse(res);
            //all_zones = "";
            for (var i = 0; i < FilterList.dtZone.length; i++) {
                $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
                //if (FilterList.dtZone.length == 0) {
                //    all_zones = "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else if (i == FilterList.dtZone.length - 1) {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'" + ',';
                //}
            }
            $('select#Zone')[0].sumo.selectItem(0);
            //all_states = "";
            for (var i = 0; i < FilterList.dtState.length; i++) {
                $('#State')[0].sumo.add(FilterList.dtState[i]["STATE_CODE"], FilterList.dtState[i]["STATE_NAME"]);
                //if (FilterList.dtState.length == 0) {
                //    all_states = "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else if (i == FilterList.dtState.length - 1) {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'" + ',';
                //}
            }
            $('select#State')[0].sumo.selectItem(0);
            //all_territories = "";
            for (var i = 0; i < FilterList.dtTerritory.length; i++) {
                $('#TerriotryArea')[0].sumo.add(FilterList.dtTerritory[i]["TERRITORY_CODE"], FilterList.dtTerritory[i]["TERRITORY_NAME"]);
                //if (FilterList.dtTerritory.length == 0) {
                //    all_territories = "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                //} else if (i == FilterList.dtTerritory.length - 1) {
                //    all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                //} else {
                //    all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'" + ',';
                //}
            }
            $('select#TerriotryArea')[0].sumo.selectItem(0);
            $('#TerriotryArea').trigger("change");
            //all_customers = "";
            //for (var i = 0; i < FilterList.dtCustomer.length; i++) {
            // $('#StockistID')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //$('#StockistName')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //if (FilterList.dtCustomer.length == 0) {
            //    all_customers = "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else if (i == FilterList.dtCustomer.length - 1) {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'" + ',';
            //}
            // }
        });
    }

    else if ((SessionValue == "STOCKIST") || (SessionValue == "C&F")) {
        $("#Zone").attr("disabled", true); $("#State").attr("disabled", true); $("#TerriotryArea").attr("disabled", true); $('#CustomerCode').attr("disabled", true); $('#CustomerCode').css({ "class": "gray" });// $("#StockistID").attr("disabled", true);
        //data_value = "{\"Role\":\"" + "STOCKIST" + "\",\"UserCode\":\"" + "1100002" + "\"}";
        data_value = "{\"Role\":\"" + "STOCKIST" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
            var FilterList = JSON.parse(res);
            //all_zones = "";
            for (var i = 0; i < FilterList.dtZone.length; i++) {
                $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
                //if (FilterList.dtZone.length == 0) {
                //    all_zones = "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else if (i == FilterList.dtZone.length - 1) {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'" + ',';
                //}
            }
            $('select#Zone')[0].sumo.selectItem(0);
            //all_states = "";
            for (var i = 0; i < FilterList.dtState.length; i++) {
                $('#State')[0].sumo.add(FilterList.dtState[i]["STATE_CODE"], FilterList.dtState[i]["STATE_NAME"]);
                //if (FilterList.dtState.length == 0) {
                //    all_states = "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else if (i == FilterList.dtState.length - 1) {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'" + ',';
                //}
            }
            $('select#State')[0].sumo.selectItem(0);
            //all_territories = "";
            for (var i = 0; i < FilterList.dtTerritory.length; i++) {
                $('#TerriotryArea')[0].sumo.add(FilterList.dtTerritory[i]["TERRITORY_CODE"], FilterList.dtTerritory[i]["TERRITORY_NAME"]);
                //if (FilterList.dtTerritory.length == 0) {
                //    all_territories = "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                //} else if (i == FilterList.dtTerritory.length - 1) {
                //    all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                //} else {
                //    all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'" + ',';
                //}
            }
            $('select#TerriotryArea')[0].sumo.selectItem(0);
            //all_customers = "";
            for (var i = 0; i < FilterList.dtCustomer.length; i++) {
                // $('#StockistID')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
                CustomerArray.push(FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
                $('#CustomerCode').val(FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
                //$('#StockistName')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
                //if (FilterList.dtCustomer.length == 0) {
                //    all_customers = "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
                //} else if (i == FilterList.dtCustomer.length - 1) {
                //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
                //} else {
                //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'" + ',';
                //}
            }
            $("#CustomerCode").typeahead({
                source: CustomerArray
            });
            // $('select#StockistID')[0].sumo.selectItem(0);
        });
    } else {
        $("#Zone").attr("disabled", false); $("#State").attr("disabled", false); $("#TerriotryArea").attr("disabled", false); $('#CustomerCode').attr("disabled", false);// $("#StockistID").attr("disabled", false);
        //data_value = "{\"Role\":\"" + "ADMIN" + "\",\"UserCode\":\"" + "50001657" + "\"}";
        data_value = "{\"Role\":\"" + SessionValue + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
            var FilterList = JSON.parse(res);
            all_zones = "";
            for (var i = 0; i < FilterList.dtZone.length; i++) {
                $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
                if (FilterList.dtZone.length == 0) {
                    all_zones = "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                } else if (i == FilterList.dtZone.length - 1) {
                    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                } else {
                    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'" + ',';
                }
            }
            CustomerArray.length = 0;
            $("#CustomerCode").val("");
            if (FilterList.dtCustomer.length > 0) {
                for (var i = 0; i < FilterList.dtCustomer.length; i++) {
                    CustomerArray.push(FilterList.dtCustomer[i]["STOCKIST_ID"].toString() + ":" + FilterList.dtCustomer[i]["STOCKIST_NAME"].toString());
                }
            }
            //all_states = "";
            //for (var i = 0; i < FilterList.dtState.length; i++) {
            //    if (FilterList.dtState.length == 0) {
            //        all_states = "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
            //    } else if (i == FilterList.dtState.length - 1) {
            //        all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
            //    } else {
            //        all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'" + ',';
            //    }
            //}
            //all_territories = "";
            //for (var i = 0; i < FilterList.dtTerritory.length; i++) {
            //    if (FilterList.dtTerritory.length == 0) {
            //        all_territories = "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
            //    } else if (i == FilterList.dtTerritory.length - 1) {
            //        all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
            //    } else {
            //        all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'" + ',';
            //    }
            //}
            //all_customers = "";
            //for (var i = 0; i < FilterList.dtCustomer.length; i++) {
            //$('#StockistID')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //$('#StockistName')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //if (FilterList.dtCustomer.length == 0) {
            //    all_customers = "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else if (i == FilterList.dtCustomer.length - 1) {
            //   all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'" + ',';
            //}
            //}
        });

    }
    HideLoader();
    $('#Zone').on('keyup change', function () {
        ShowLoader();
        var Clear_State = $('#State option').length;
        for (var i = 0; i < Clear_State; i++) {
            $('#State')[0].sumo.remove(0);
        }

        //   var Clear_Cust = $('#StockistID option').length;
        //  for (var i = 0; i < Clear_Cust; i++) {
        //      $('#StockistID')[0].sumo.remove(0);
        // }
        CustomerArray.length = 0;//---------------------------9
        $('#CustomerCode').val("");

        var Clear_Terrytory = $('#TerriotryArea option').length;
        for (var i = 0; i < Clear_Terrytory; i++) {
            $('#TerriotryArea')[0].sumo.remove(0);
        }

        var data_value = "{\"Zone_Code\":\"" + $("#Zone").val() + "\"}";
        $http({ url: '../../Home/GetStatesforZone', method: 'POST', data: { Data: data_value } }).success(function (res) {
            if (res != "") {
                var dtState = JSON.parse(res);
                for (var i = 0; i < dtState.length; i++) {
                    $('#State')[0].sumo.add(dtState[i]["STATE_CODE"], dtState[i]["STATE_NAME"]);
                }
                HideLoader();
            } else { HideLoader(); }

            $http({ url: '../../Home/GetCustomersforZone', method: 'POST', data: { Data: data_value } }).success(function (Cust_res) {
                if (Cust_res != "") {
                    var dtCust = JSON.parse(Cust_res);
                    for (var i = 0; i < dtCust.length; i++) {
                        CustomerArray.push(dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());//---------------------1
                        //   $('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"].toString(), dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                        //  $('#StockistName')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"].toString(), dtCust[i]["CUSTOMER_NAME"].toString());
                    }
                }
            });
        });

    });

    var SelectedState = ""; var Actual_SelectedState = ""; var Actual_SelectedTerritory = "";
    $('#State').on('keyup change', function () {
        ShowLoader();
        Actual_SelectedState = "";
        var Clear_Territory = $('#TerriotryArea option').length;
        for (var i = 0; i < Clear_Territory; i++) {
            $('#TerriotryArea')[0].sumo.remove(0);
        }
        // var Clear_Cust = $('#StockistID option').length;
        //  for (var i = 0; i < Clear_Cust; i++) {
        //     $('#StockistID')[0].sumo.remove(0);
        //  }

        CustomerArray.length = 0;//------------------------------------2
        $('#CustomerCode').val("");

        if ($('#State').val() != null) {
            var seleState = $('#State').val();

            for (var k = 0; k < seleState.length; k++) {
                SelectedState += "'" + seleState[k] + "',";
                Actual_SelectedState += "'" + seleState[k] + "',";
            }
            SelectedState = SelectedState.substring(',', SelectedState.length - 1);//Selected States with ' '. 
            Actual_SelectedState = Actual_SelectedState.substring(',', Actual_SelectedState.length - 1);//Selected States with ' '. 
        }

        var data_value = "{\"State_Code\":\"" + SelectedState + "\"}";
        $http({ url: '../../Home/GetTerritoriesforState', method: 'POST', data: { Data: data_value } }).success(function (res) {
            if (res != "") {

                var dtTerritory = JSON.parse(res);
                for (var i = 0; i < dtTerritory.length; i++) {
                    $('#TerriotryArea')[0].sumo.add(dtTerritory[i]["TERRITORY_CODE"], dtTerritory[i]["TERRITORY_NAME"]);
                }
                //  ShowLoader();
                $http({ url: '../../Home/GetCustomersforState', method: 'POST', data: { Data: data_value } }).success(function (res) {
                    if (res != "") {
                        // ShowLoader();

                        var dtCust = JSON.parse(res);

                        for (var i = 0; i < dtCust.length; i++) {
                            // $('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"].toString(), dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());

                            CustomerArray.push(dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());//---------------------3
                        }
                        HideLoader();
                    } else {
                        HideLoader();
                    }
                });
            }
            HideLoader();
        });

        if ($("#State").val() == null) {
            var data_value = "{\"Zone_Code\":\"" + $("#Zone").val() + "\"}";
            if ((SessionValue != "SH") && (SessionValue != "TM") && (SessionValue != "FSO") && (SessionValue != "FSO_BU2") && (SessionValue != "STOCKIST") && (SessionValue != "C&F")) {
                $http({ url: '../../Home/GetCustomersforZone', method: 'POST', data: { Data: data_value } }).success(function (Cust_res) {
                    if (Cust_res != "") {
                        var dtCust = JSON.parse(Cust_res);
                        for (var i = 0; i < dtCust.length; i++) {
                            //  $('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"].toString(), dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                            CustomerArray.push(dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                        }
                        HideLoader();
                    } else {
                        HideLoader();
                    }
                });
            }
            HideLoader();
        }
        SelectedState = "";
        // HideLoader();
    });

    var SelectedTerritory = "";
    $('#TerriotryArea').on('keyup change', function () {
        ShowLoader();
        Actual_SelectedTerritory = ""; Actual_SelectedState = "";
        if ((SessionValue == "TM") || (SessionValue == "FSO") || (SessionValue == "FSO_BU2")) {
            if ($("#TerriotryArea").val() == null) {
                //  var Clear_Cust = $('#StockistID option').length;
                //  for (var i = 0; i < Clear_Cust; i++) {
                //      $('#StockistID')[0].sumo.remove(0);
                //  }
                CustomerArray.length = 0;//-------------------------------------4
                $('#CustomerCode').val("");

                HideLoader();
            } else if ($("#TerriotryArea").val() != null) {
                var seleTerritory = $('#TerriotryArea').val();
                for (var k = 0; k < seleTerritory.length; k++) {
                    SelectedTerritory += "'" + seleTerritory[k] + "',";
                    Actual_SelectedTerritory += "'" + seleTerritory[k] + "',";
                }
                SelectedTerritory = SelectedTerritory.substring(',', SelectedTerritory.length - 1);//Selected Territories with ' '. 
                Actual_SelectedTerritory = Actual_SelectedTerritory.substring(',', Actual_SelectedTerritory.length - 1);//Selected Territories with ' '. 

                var data_value = "{\"Territory_Code\":\"" + SelectedTerritory + "\"}";
                $http({ url: '../../Home/GetCustomersforTerritory', method: 'POST', data: { Data: data_value } }).success(function (res) {
                    if (res != "") {
                        var dtCust = JSON.parse(res);
                        for (var i = 0; i < dtCust.length; i++) {
                            //  $('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"], dtCust[i]["CUSTOMER_CODE"] + ":" + dtCust[i]["CUSTOMER_NAME"]);
                            CustomerArray.push(dtCust[i]["CUSTOMER_CODE"] + ":" + dtCust[i]["CUSTOMER_NAME"]);//--------------------5
                        }
                        HideLoader();
                    } else { HideLoader(); }
                });
            }
        } else {
            //  var Clear_Cust = $('#StockistID option').length;
            //  for (var i = 0; i < Clear_Cust; i++) {
            //   $('#StockistID')[0].sumo.remove(0);
            //   }
            CustomerArray.length = 0;//-------------------------------------6
            $('#CustomerCode').val("");

            if ($('#TerriotryArea').val() != null) {
                var seleTerritory = $('#TerriotryArea').val();
                for (var k = 0; k < seleTerritory.length; k++) {
                    SelectedTerritory += "'" + seleTerritory[k] + "',";
                    Actual_SelectedTerritory += "'" + seleTerritory[k] + "',";
                }
                SelectedTerritory = SelectedTerritory.substring(',', SelectedTerritory.length - 1);//Selected Territories with ' '. 
                Actual_SelectedTerritory = Actual_SelectedTerritory.substring(',', Actual_SelectedTerritory.length - 1);//Selected Territories with ' '. 
            }
            if ($("#TerriotryArea").val() == null) {
                var seleState = $('#State').val();

                for (var k = 0; k < seleState.length; k++) {
                    SelectedState += "'" + seleState[k] + "',";
                    Actual_SelectedState += "'" + seleState[k] + "',";
                }
                SelectedState = SelectedState.substring(',', SelectedState.length - 1);//Selected States with ' '. 
                Actual_SelectedState = Actual_SelectedState.substring(',', Actual_SelectedState.length - 1);//Selected States with ' '. 

                var data_value = "{\"State_Code\":\"" + SelectedState + "\"}";
                $http({ url: '../../Home/GetCustomersforState', method: 'POST', data: { Data: data_value } }).success(function (res) {
                    if (res != "") {
                        var dtCust = JSON.parse(res);
                        for (var i = 0; i < dtCust.length; i++) {
                            //  $('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"].toString(), dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                            CustomerArray.push(dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());//--------------7
                        }
                        HideLoader();
                    } else { HideLoader(); }
                });
            } else {
                var data_value = "{\"Territory_Code\":\"" + SelectedTerritory + "\"}";
                $http({ url: '../../Home/GetCustomersforTerritory', method: 'POST', data: { Data: data_value } }).success(function (res) {
                    if (res != "") {
                        var dtCust = JSON.parse(res);
                        for (var i = 0; i < dtCust.length; i++) {
                            // $('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"], dtCust[i]["CUSTOMER_CODE"] + ":" + dtCust[i]["CUSTOMER_NAME"]);
                            CustomerArray.push(dtCust[i]["CUSTOMER_CODE"] + ":" + dtCust[i]["CUSTOMER_NAME"]);//-------------8
                        }
                        HideLoader();
                    } else { HideLoader(); }
                });
            }
        }
        SelectedTerritory = "";
        SelectedState = "";
    });

    $('#CustomerCode').typeahead({
        source: CustomerArray
    });


    $scope.GetCreditNote = function () {
        try {

            var FromDate = $('#OrderFromDate').val();
            var ToDate = $('#OrderToDate').val();
            var ZoneValue = $('#Zone').val();
            var StateValue = $('#State').val();
            var TerritoryValue = $('#TerriotryArea').val();
            var isValidCustCode = isValidCode_Cust($("#CustomerCode").val(), CustomerArray);
            if (FromDate == "" || FromDate == null) {
                alert("Please select from date");
            } else if (ToDate == "" || ToDate == null) {
                alert("Please select to date");
            } else if (SessionValue == "ZH" && ZoneValue == null) {
                alert("please select zone");
            }
            else if (SessionValue == "SH" && StateValue == null) {
                alert("please select state");
            } else if (SessionValue == "TM" && TerritoryValue == null) {
                alert("please select Territory");
            }
            else if (SessionValue == "FSO" && TerritoryValue == null) {
                alert("please select Territory");
            }
            else if (SessionValue == "FSO_BU2" && TerritoryValue == null) {
                alert("please select Territory");
            }
            else if (($("#CustomerCode").val() != "") && (isValidCustCode == false)) {
                alert("Please select proper customer code");
            }
            else {
                ShowLoader();
                var DateRange = DateSplitter('OrderFromDate', 'OrderToDate');

                var WhereClause = "WHERE INDICATOR='H' AND DOC_TYPE IN('DG','ZD') AND POSTING_DATE BETWEEN " + DateRange + "";
                if ($("#CustomerCode").val() != "") {
                    if (($("#CustomerCode").val() != "") && (isValidCustCode == false)) {
                    } else {
                        WhereClause += " and CAST(CUSTOMER_CODE AS BIGINT) IN (" + $("#CustomerCode").val().split(':')[0] + ")";
                    }
                } else if ($("#TerriotryArea").val() != null) {
                    WhereClause += " and CAST(CUSTOMER_CODE AS BIGINT) IN (select DISTINCT ecc.CUSTOMER_CODE from cms_employee_customer_configuration ecc inner join CUSTOMER_SALES_VIEW csv on CAST(ecc.CUSTOMER_CODE AS BIGINT)=CAST(csv.cust_code AS BIGINT) where ecc.ORG_LEVEL_ID IN(" + Actual_SelectedTerritory + "))";
                } else if ($("#State").val() != null) {
                    WhereClause += " and STATE IN(" + Actual_SelectedState + ")";
                }
                else if ($("#Zone").val() != null) {
                    WhereClause += " AND ZONE IN(" + $("#Zone").val() + ")";
                }
                if (($("#Zone").val() == null) && ($("#State").val() == null) && ($("#TerriotryArea").val() == null) && ($("#CustomerCode").val() == "")) {
                    WhereClause += " ";
                }





                //   ShowLoader();
                // var DateSpliter = DateSplitter('OrderFromDate', 'OrderToDate');
                //var WhereClause = "JOIN sap_customer_sales_master AS SM ON CAST(SM.STOCKIST_ID AS INT)=CAST(CM.STOCKIST_ID AS INT) WHERE CAST(CD.CUSTOMER_CODE AS INT)=CAST(CM.STOCKIST_ID AS INT) AND CD.INDICATOR='H' AND CD.DOC_TYPE='DG' AND CD.DOC_DATE BETWEEN " + DateSpliter + " AND SM.SALES_ORGANISATION='1000'";

                var sheet = $("#Sheets").val();

                //Edited By Manikanta

                if (sheet != "select") {
                    WhereClause += " and CAST(CUSTOMER_CODE AS BIGINT) IN (select STOCKIST_ID from sap_customer_sales_master where DIVISION='" + sheet + "')";
                }



                var Data = JSON.stringify({
                    MasterType: "CreditNotes",
                    ID: "561",
                    UserCode: $("#UserCode").val(),
                    "Type": "Get",
                    ReportName: "CreditNotes",
                    WhereClause: WhereClause
                });

                DIMSFactory.getReportListColumnNamesData(Data).success(function (response) {
                    var Result = JSON.parse(response.tabledata);

                    if (Result != "") {
                        $scope.UserDefaultListColumnNames = Result["UserDefaultListColumnNames"];
                        if (Result.hasOwnProperty('UserListColumnNames')) {
                            var data1 = JSON.parse(Result["UserListColumnNames"]);

                            var selectedcolumnname = data1["ColumnNames"];

                            CustomColumnID = Result["UserListID"];
                            $('#undo_redo_to').empty();
                            var ColArray = new Array();
                            for (var i = 0; i < selectedcolumnname.length; i++) {

                                if (i == 0) {
                                    ColArray.push({
                                        "data": selectedcolumnname[i],
                                        "name": selectedcolumnname[i], "bSortable": false
                                    });
                                } else {
                                    ColArray.push({
                                        "data": selectedcolumnname[i],
                                        "name": selectedcolumnname[i], "bSortable": true
                                    });
                                }
                                $("#undo_redo_to").append($("<option></option>").val(selectedcolumnname[i]).html(selectedcolumnname[i]));
                            }
                            //$scope.UserSelectedColumnName = ColArray;
                            UserSelectedColumnName = ColArray;
                        } else {

                            var data1 = JSON.parse(Result["UserDefaultListColumnNames"]);

                            var selectedcolumnname = data1["ColumnNames"];

                            CustomColumnID = "0";

                            $('#undo_redo_to').empty();
                            var ColArray = new Array();
                            for (var i = 0; i < selectedcolumnname.length; i++) {
                                if (i == 0) {
                                    ColArray.push({
                                        "data": selectedcolumnname[i],
                                        "name": selectedcolumnname[i],
                                        "bSortable": false
                                    });
                                } else {
                                    ColArray.push({
                                        "data": selectedcolumnname[i],
                                        "name": selectedcolumnname[i],
                                        "bSortable": true
                                    });
                                }
                                $("#undo_redo_to").append($("<option></option>").val(selectedcolumnname[i]).html(selectedcolumnname[i]));
                            }
                            //$scope.UserSelectedColumnName = ColArray;
                            UserSelectedColumnName = ColArray;
                        }



                    }
                    ShowLoader();
                    DIMSFactory.getReportData(Data).success(function (response) {
                        ShowLoader();
                        getLookUpData_Reports_ServerSideBinding_CreditDebitNotes("", "EnrollmentNodataLabel", "", "tbl_CreditNotes", UserSelectedColumnName);

                        ShowLoader();
                        $("#CredtiNoteDetailId").show();
                        ShowLoader();
                        var table = $('#tbl_CreditNotes').DataTable();
                        var IsCheckBoxChecked = false;
                        $('#tbl_CreditNotes tbody').on('click', 'td', function () {
                            var columns = table.settings().init().columns;
                            //get the index of the clickec cell
                            var colIndex = table.cell(this).index().column;
                            //alert('you clicked on the column with the name ' + columns[colIndex].name);
                            if (columns[colIndex].name == "Customer Code") {
                                IsCheckBoxChecked = true;
                            }
                            else {
                                IsCheckBoxChecked = false;
                            }
                        });
                        $('#tbl_CreditNotes tbody').on('click', 'tr', function () {
                            if (!IsCheckBoxChecked) {
                                ShowLoader();
                                var DocDate = $(this).find('td:eq(7)').text();
                                var DocNum = $(this).find('td:eq(8)').text();

                                DocDate_CreditNote = DocDate;
                                var DOCDATE1 = "";
                                if (DocDate.indexOf('/') > 0) {
                                    DocDate = DocDate.split('/');
                                    DOCDATE1 = DocDate[2] + "-" + DocDate[1] + "-" + DocDate[0];
                                }
                                if ($(this).hasClass('selected')) {
                                    $(this).removeClass('selected');
                                }
                                else {
                                    $('tr.selected').removeClass('selected');
                                    $(this).addClass('selected');
                                }

                                if (DOCDATE1 != "" && DocNum != "") {

                                    // $scope.go('CreditNotesDetails');

                                    // DocDate = DocDate.replaceAll('/', '-');
                                    var ID = DOCDATE1 + "$" + DocNum;
                                    var scope = angular.element($("#CredtiNoteDetailId")).scope();
                                    scope.$apply(function () {
                                        $scope.go("CreditNotesDetails/" + ID);
                                        HideLoader();
                                    })


                                    // $scope.EditID = ID;             
                                    //$scope.go("AddOrder/" + ID);
                                    //var scope = angular.element($("#InvestigationlistDiv")).scope();
                                    //scope.$apply(function () {
                                    //    scope.go("Investigation/" + ID);
                                    //})
                                }
                            }
                        });
                    });
                    ShowLoader();
                    DIMSSAPFactory.GetTotalSumCreditDebit(Data).success(function (res) {
                        $('#TotalCreditAmnt').val(parseFloat(res).toFixed(2));
                        HideLoader();
                    });
                    HideLoader();
                });


            }
        } catch (Exception) { }



    }


    $scope.DownloadFile = function (filetype) {
        var SearchValue = $('input[type=search]').val();
        var FileName = "CreditNotes";
        var UserRole = $('#SessionRoleCode').val();
        var userCode = $('#SessionUserCode').val();
        var isValidCustCode = isValidCode_Cust($("#CustomerCode").val(), CustomerArray);
        //var DateSpliter = DateSplitter('OrderFromDate', 'OrderToDate');
        //  var WhereClause = "JOIN sap_customer_sales_master AS SM ON CAST(SM.STOCKIST_ID AS INT)=CAST(CM.STOCKIST_ID AS INT) WHERE CAST(CD.CUSTOMER_CODE AS INT)=CAST(CM.STOCKIST_ID AS INT) AND CD.INDICATOR='H' AND CD.DOC_TYPE='DG' AND CD.DOC_DATE BETWEEN " + DateSpliter + " AND SM.SALES_ORGANISATION='1000'";
        // var WhereClause = "WHERE INDICATOR='H' AND DOC_TYPE='DG' AND POSTING_DATE BETWEEN " + DateSpliter + "";



        var DateRange = DateSplitter('OrderFromDate', 'OrderToDate');

        var WhereClause = "WHERE INDICATOR='H' AND DOC_TYPE IN('DG','ZD') AND POSTING_DATE BETWEEN " + DateRange + "";
        if ($("#CustomerCode").val() != "") {
            if (($("#CustomerCode").val() != "") && (isValidCustCode == false)) {
            } else {
                WhereClause += " and CAST(CUSTOMER_CODE AS BIGINT) IN (" + $("#CustomerCode").val().split(':')[0] + ")";
            }
        } else if ($("#TerriotryArea").val() != null) {
            WhereClause += " and CAST(CUSTOMER_CODE AS BIGINT) IN (select DISTINCT ecc.CUSTOMER_CODE from cms_employee_customer_configuration ecc inner join CUSTOMER_SALES_VIEW csv on CAST(ecc.CUSTOMER_CODE AS BIGINT)=CAST(csv.cust_code AS BIGINT) where ecc.ORG_LEVEL_ID IN(" + Actual_SelectedTerritory + "))";
        } else if ($("#State").val() != null) {
            WhereClause += " and STATE IN(" + Actual_SelectedState + ")";
        }
        else if ($("#Zone").val() != null) {
            WhereClause += " AND ZONE IN(" + $("#Zone").val() + ")";
        }
        if (($("#Zone").val() == null) && ($("#State").val() == null) && ($("#TerriotryArea").val() == null) && ($("#CustomerCode").val() == "")) {
            WhereClause += " ";
        }

        var sheet = $("#Sheets").val();

        //Edited By Manikanta

        if (sheet != "select") {
            WhereClause += " and CAST(CUSTOMER_CODE AS BIGINT) IN (select STOCKIST_ID from sap_customer_sales_master where DIVISION='" + sheet + "')";
        }

        var TableCount = $('#tbl_CreditNotes').DataTable().data().count();
        if (TableCount == 0) {
            alert("There is no data");
        } else {
            if (($("#CustomerCode").val() != "") && (isValidCustCode == false)) { alert("please select proper customer code"); } else {
                var data_value = "{\"Role\":\"" + SessionValue + "\",\"Form_Code\":\"" + "CN" + "\",\"Action\":\"" + "Is_Export" + "\"}";
                ShowLoader();
                $http({ url: '../../Home/Form_Access', method: 'POST', data: { Data: data_value } }).success(function (res) {
                    if (res == "True") {
                        ShowLoader();
                        CommonFunctionForExcelExport_SearchFilter("561", userCode, SearchValue, FileName, FileName, WhereClause, filetype);
                        HideLoader();
                    }
                    else {
                        alert("You are not allowed to export Credit Notes List");
                    }
                });
            }
        }



        //var Data = JSON.stringify({
        //    ID: "561",
        //    UserCode: "561",
        //    ReportName: FileName,
        //    WhereClause: WhereClause,
        //    "SearchValue": SearchValue
        //});

        //$.ajax({
        //    url: '../../Home/SetInputData',
        //    type: "POST",
        //    datatype: "JSON",
        //    data: { InputData: Data, ReportType: filetype, FileName: FileName },
        //    async: false,
        //    cache: false,
        //    success: function (response) {
        //        window.location.href = '../../Home/GenerateReport_SAP';
        //    },
        //    error: function () {
        //        alert("Technical error has been occured.Please try again later");

        //    }
        //});

    }





    // Open popup for columns selection
    $scope.OpenColumnEditing = function () {

        $('#undo_redo').empty();
        var ColumnNames = JSON.parse($scope.UserDefaultListColumnNames);

        for (var i = 0; i < ColumnNames["ColumnNames"].length; i++) {
            $("#undo_redo").append($("<option></option>").val(ColumnNames["ColumnNames"][i]).html(ColumnNames["ColumnNames"][i]));
        }



        //   $('#undo_redo').refresh();

        $('#undo_redo').multiselect();
        if (ControllerName != "CreditNotesCtrl") {
            ControllerName = "CreditNotesCtrl";
            var elem = angular.element('#ColumnEditingModal');
            elem.removeAttr('ng-controller');
            elem.attr('ng-controller', "CreditNotesCtrl");

            $compile(elem.contents())(CreditNoteScope);
        }

        $("#ColumnEditingModal").modal('show');




    }
    // View Column selected it is like preview.We will send reportname,usercode and where condition to function
    $scope.ViewColumnEditing = function () {
        DIMSFactory.ViewColumnEditing("CreditNotes", $("#UserCode").val(), " CD.CUSTOMER_CODE=CM.STOCKIST_ID AND CD.DOC_TYPE='DG'"); // 1-Report Name ,2-UserCode(561),3-WhereClause

    }
    // Save Column selected it is like preview.We will send reportname,usercode and where condition to function
    $scope.SaveColumnEditingData = function () {
        var WhereClause = " WHERE CD.CUSTOMER_CODE=CM.STOCKIST_ID AND CD.DOC_TYPE='DG'";
        var Data = JSON.stringify({
            MasterType: "CreditNotes",
            ID: "561",
            UserCode: $("#UserCode").val(),
            "Type": "Get",
            ReportName: "CreditNotes",
            WhereClause: WhereClause
        });
        //DIMSFactory.SaveColumnEditingData("Compensation", $scope.UserCode, " ORDER BY ID DESC");
        DIMSFactory.SaveColumnEditingData_InputParameter("CreditNotes", $("#UserCode").val(), WhereClause, Data, "tbl_CreditNotes");
        // 1-Report Name ,2-UserCode(561),3-WhereClause,4-JsonData,5-Frontend datatable id


    }

});

function isValidCode_Cust(code, ArrayValue) {
    return ($.inArray(code, ArrayValue) > -1);
}

//Credit Details
DIMS.controller('CreditNotesDetailsCtrl', function ($scope, $location, DIMSSAPFactory, $http, $compile, $routeParams) {
    $scope.templatesettings = { HeaderTitle: "Credit Notes Details" };
    CreditNoteScope = $scope;
    MasterScope = $scope;


    $scope.go = function (path) {
        CheckUserSession();
        $location.path(path);
    };
    var EditId = $routeParams.ID;
    if (EditId != undefined || EditId != null) {
        EditId = EditId.split('$');
        var DocDate = EditId[0];
        var DocNum = EditId[1];
        if ((DocDate != "" || DocDate != undefined) && (DocNum != "" || DocNum != undefined)) {

            var Data = JSON.stringify({
                "DocDate": DocDate,
                "DataFrom": "H",
                "DocNum": DocNum
            });
            DIMSSAPFactory.GetCreditNoteDetails(Data).success(function (res) {
                if (res != "False") {
                    var Response = JSON.parse(res);
                    $('#BusinessAreaCode').text(Response[0]["BUSINESS_AREA"]);
                    $('#DocNo').text(Response[0]["DOC_NO"]);
                    $('#DepoName').text(Response[0]["PLANT_DESCRIPTION"]);
                    $('#DocDate').text(Response[0]["POSTING_DATE"]);
                    $('#CustCode').text(Response[0]["CUSTOMER_CODE"]);
                    // var NameAddress = Response[0]["STOCKIST_NAME"] + " ; " + Response[0]["CustomerAddress"] + " ;";

                    $('#CustName').text(Response[0]["STOCKIST_NAME"]);

                    $('#CustAddress').text(Response[0]["CustomerAddress"]);
                    $('#Towards').text("Towards  " + Response[0]["TEXT"]);

                    var GrssAmt = Response[0]["AMOUNT"];

                    $('#GrossAmt').text(GrssAmt.toFixed(2));

                    $('#TDSAmt').text("0.00");

                    $('#NetAmt').text(GrssAmt.toFixed(2));

                    $('#InWords').text("A SUM OF " + toWordsINVOICE(GrssAmt.toFixed(2)));


                    $('#BusinessAreaCode_html').text(Response[0]["BUSINESS_AREA"]);
                    $('#DocNo_html').text(Response[0]["DOC_NO"]);
                    $('#DepoName_html').text(Response[0]["PLANT_DESCRIPTION"]);
                    $('#DocDate_html').text(Response[0]["POSTING_DATE"]);
                    $('#CustCode_html').text(Response[0]["CUSTOMER_CODE"]);
                    // var NameAddress = Response[0]["STOCKIST_NAME"] + " ; " + Response[0]["CustomerAddress"] + " ;";

                    $('#CustName_html').text(Response[0]["STOCKIST_NAME"]);

                    $('#CustAddress_html').text(Response[0]["CustomerAddress"]);
                    $('#Towards_html').text("Towards  " + Response[0]["TEXT"]);

                    var GrssAmt = Response[0]["AMOUNT"];

                    $('#GrossAmt_html').text(GrssAmt.toFixed(2));

                    $('#TDSAmt_html').text("0.00");

                    $('#NetAmt_html').text(GrssAmt.toFixed(2));

                    $('#InWords_html').text("A SUM OF " + toWordsINVOICE(GrssAmt.toFixed(2)));

                    //For GST Related Code
                    $('#GSTPlantDesc').text(Response[0]["PLANT_DESCRIPTION"]);
                    $('#GSTPlantName').text(Response[0]["PlantName"]);
                    $('#GSTPlantAddress').text(Response[0]["PlantAddress"]);
                    $('#GSTPlantPhone').text(Response[0]["PLANT_PHONE"]);
                    $('#GSTPlantGSTNo').text(Response[0]["PLANT_GST_NO"]);
                    $('#GSTPlantTINNo').text(Response[0]["PLANT_TIN_NO"]);
                    $('#GSTPlantEMail').text(Response[0]["EMAIL"]);

                    $('#GSTPlantDesc_html').text(Response[0]["PLANT_DESCRIPTION"]);
                    $('#GSTPlantName_html').text(Response[0]["PlantName"]);
                    $('#GSTPlantAddress_html').text(Response[0]["PlantAddress"]);
                    $('#GSTPlantPhone_html').text(Response[0]["PLANT_PHONE"]);
                    $('#GSTPlantGSTNo_html').text(Response[0]["PLANT_GST_NO"]);
                    $('#GSTPlantTINNo_html').text(Response[0]["PLANT_TIN_NO"]);
                    $('#GSTPlantEMail_html').text(Response[0]["EMAIL"]);

                    $('#GSTDocNo').text(Response[0]["DOC_NO"]);
                    $('#GSTDocDate').text(Response[0]["POSTING_DATE"]);
                    $('#GSTDocType').text(Response[0]["DOC_TYPE"]);
                    $('#GSTRefDocNumber').text(Response[0]["REF_DOC"]);
                    $('#GSTRefDocDate').text(Response[0]["REF_DATE"]);
                    $('#GSTInvoice').text(Response[0]["INVOICE"]);

                    $('#GSTDocNo_html').text(Response[0]["DOC_NO"]);
                    $('#GSTDocDate_html').text(Response[0]["POSTING_DATE"]);
                    $('#GSTDocType_html').text(Response[0]["DOC_TYPE"]);
                    $('#GSTRefDocNumber_html').text(Response[0]["REF_DOC"]);
                    $('#GSTRefDocDate_html').text(Response[0]["REF_DATE"]);
                    $('#GSTInvoice_html').text(Response[0]["INVOICE"]);

                    $('#GSTCustTINNo').text(Response[0]["CUST_TIN"]);
                    $('#GSTCustGSTNo').text(Response[0]["CUST_GST_NO"]);
                    $('#GSTCustPANNo').text(Response[0]["CUST_PAN_NO"]);
                    $('#GSTCustPhoneNo').text(Response[0]["CUST_PHONE"]);

                    $('#GSTCustTINNo_html').text(Response[0]["CUST_TIN"]);
                    $('#GSTCustGSTNo_html').text(Response[0]["CUST_GST_NO"]);
                    $('#GSTCustPANNo_html').text(Response[0]["CUST_PAN_NO"]);
                    $('#GSTCustPhoneNo_html').text(Response[0]["CUST_PHONE"]);


                    $('#GSTMAT_CODE').text(Response[0]["MAT_CODE"]);
                    $('#GSTMAT_TXT').text(Response[0]["MAT_TXT"]);
                    $('#GSTHSN_CODE').text(Response[0]["HSN_CODE"]);
                    $('#GSTQty').text(Response[0]["QNTY"]);

                    $('#GSTMAT_CODE_html').text(Response[0]["MAT_CODE"]);
                    $('#GSTMAT_TXT_html').text(Response[0]["MAT_TXT"]);
                    $('#GSTHSN_CODE_html').text(Response[0]["HSN_CODE"]);
                    $('#GSTQty_html').text(Response[0]["QNTY"]);

                    $('#GSTUnit').text(Response[0]["UNIT"]);
                    $('#GSTUNIT_RATE').text(Response[0]["UNIT_RATE"]);
                    $('#GSTBASE_AMOUNT').text(Response[0]["BASE_AMOUNT"]);
                    $('#GSTREMARKS').text(Response[0]["REMARKS"]);

                    $('#GSTUnit_html').text(Response[0]["UNIT"]);
                    $('#GSTUNIT_RATE_html').text(Response[0]["UNIT_RATE"]);
                    $('#GSTBASE_AMOUNT_html').text(Response[0]["BASE_AMOUNT"]);
                    $('#GSTREMARKS_html').text(Response[0]["REMARKS"]);

                    var GrssAmt = Response[0]["BASE_AMOUNT"];
                    var Amount = Response[0]["AMOUNT"];
                    var TDS = Response[0]["TAX_AMOUNT"];
                    var TotalAmount = (Amount == "" ? 0.00 : parseFloat(Amount).toFixed(2));
                    var CGST = Response[0]["CGST"];
                    var CGSTP = Response[0]["CGST_P"];
                    var SGST = Response[0]["SGST"];
                    var SGSTP = Response[0]["SGST_P"];
                    var IGST = Response[0]["IGST"];
                    var IGSTP = Response[0]["IGST_P"];
                    
                    var TotalGST = parseFloat((CGST == "" || CGST === undefined) ? 0.00 : CGST) + parseFloat((SGST == "" || SGST === undefined) ? 0 : SGST) + parseFloat((IGST == "" || IGST === undefined) ? 0 : IGST);
                    $('#GSTGrossAmount').text((GrssAmt == "" || GrssAmt === undefined) ? 0.00 : GrssAmt.toFixed(2));
                    $('#GSTTDS').text((TDS == "" || TDS === undefined) ? 0.00 : TDS.toFixed(2));
                    $('#GSTCGST').text((CGST == "" || CGST === undefined)  ? 0.00 : parseFloat(CGST).toFixed(2));
                    $('#GSTCGSTP').text((CGSTP == "" || CGSTP === undefined) ? 0.00 : parseFloat(CGSTP).toFixed(2));
                    $('#GSTSGST').text((SGST == "" || SGST === undefined) ? 0.00 : parseFloat(SGST).toFixed(2));
                    $('#GSTSGSTP').text((SGSTP == "" || SGSTP === undefined) ? 0.00 : parseFloat(SGSTP).toFixed(2));
                    $('#GSTIGST').text((IGST == "" || IGST === undefined) ? 0.00 : parseFloat(IGST).toFixed(2));
                    $('#GSTIGSTP').text((IGSTP == "" || IGSTP === undefined) ? 0.00 : parseFloat(IGSTP).toFixed(2));

                    $('#GSTGrossAmount_html').text((GrssAmt == "" || GrssAmt === undefined) ? 0.00 : GrssAmt.toFixed(2));
                    $('#GSTTDS_html').text((TDS == "" || TDS === undefined) ? 0.00 : TDS.toFixed(2));
                    $('#GSTCGST_html').text((CGST == "" || CGST === undefined) ? 0.00 : parseFloat(CGST).toFixed(2));
                    $('#GSTCGSTP_html').text((CGSTP == "" || CGSTP === undefined) ? 0.00 : parseFloat(CGSTP).toFixed(2));
                    $('#GSTSGST_html').text((SGST == "" || SGST === undefined) ? 0.00 : parseFloat(SGST).toFixed(2));
                    $('#GSTSGSTP_html').text((SGSTP == "" || SGSTP === undefined) ? 0.00 : parseFloat(SGSTP).toFixed(2));
                    $('#GSTIGST_html').text((IGST == "" || IGST === undefined) ? 0.00 : parseFloat(IGST).toFixed(2));
                    $('#GSTIGSTP_html').text((IGSTP == "" || IGSTP === undefined) ? 0.00 : parseFloat(IGSTP).toFixed(2));

                    $('#GSTCUSTOMERDETAILS').text(Response[0]["STOCKIST_ID"] + "-" + Response[0]["STOCKIST_NAME"]);
                    $('#GSTCUSTOMERADDRESSDETAILS').text(Response[0]["CustomerAddress"]);

                    $('#GSTCUSTOMERDETAILS_html').text(Response[0]["STOCKIST_ID"] + "-" + Response[0]["STOCKIST_NAME"]);
                    $('#GSTCUSTOMERADDRESSDETAILS_html').text(Response[0]["CustomerAddress"]);

                    $('#GSTTotalAmount').text(TotalAmount);
                    $('#GSTTaxInWords').text("Tax Amount in Words (SGST/CGST/IGST) : " + toWordsINVOICE(TotalGST.toFixed(2)));
                    $('#GSTTotalInWords').text("Total Amount in Words : " + toWordsINVOICE(TotalAmount));

                    $('#GSTTotalAmount_html').text(TotalAmount);
                    $('#GSTTaxInWords_html').text("Tax Amount in Words (SGST/CGST/IGST) : " + toWordsINVOICE(TotalGST.toFixed(2)));
                    $('#GSTTotalInWords_html').text("Total Amount in Words : " + toWordsINVOICE(TotalAmount));
                }
            });

        }



    }

});

//debit Notes
DIMS.controller('DebitNotesCtrl', function ($scope, $location, DIMSFactory, $http, $compile, DIMSSAPFactory) {
    $scope.templatesettings = { HeaderTitle: "Debit Notes" };
    DebitNoteScope = $scope;
    MasterScope = $scope;


    $("#DebitNoteDetailDiv").hide();
    $scope.go = function (path) {
        CheckUserSession();
        $location.path(path);
    };

    var width = $(window).width(), height = $(window).height();//---------

    var totalheight = height - 191;
    // var totalheight = height - 148;//--------    
    if (height <= 800) {
        totalheight = height - 148;
    }

    $('.content').css({ "max-height": totalheight, "overflow-y": "auto" });//-----------
    $('.content-header > h2').css({ "font-size": "18px", "font-weight": "500" });//----------
    $('.content').css({ "max-height": totalheight, "min-height": totalheight, "overflow-y": "auto" });//-----------

    //$('#StockistID').SumoSelect({ placeholder: 'Customer Code' });
    $('#SalesEmapName').SumoSelect({ placeholder: 'Sales Employee' });
    $('#PlantSumo').SumoSelect({ placeholder: 'Plant' });
    $('#Zone').SumoSelect({ placeholder: 'Zone' });
    $('#State').SumoSelect({ placeholder: 'State' });
    $('#TerriotryArea').SumoSelect({ placeholder: 'Terriotry/Area' });
    $('#Location').SumoSelect({ placeholder: 'Location' });
    var data_value = ""; var all_zones = ""; var all_states = ""; var all_territories = ""; var all_customers = ""; var CustomerArray = new Array();
    ShowLoader();
    if ((SessionValue == "ZH") || (SessionValue == "RCC") || (SessionValue == "ZSC")) {
        $("#Zone").attr("disabled", false); $("#State").attr("disabled", false); $("#TerriotryArea").attr("disabled", false); $("#CustomerCode").attr("disabled", false);
        //data_value = "{\"Role\":\"" + "ZH" + "\",\"UserCode\":\"" + "50001762" + "\"}";
        data_value = "{\"Role\":\"" + "ZH" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
            var FilterList = JSON.parse(res);
            all_zones = "";
            for (var i = 0; i < FilterList.dtZone.length; i++) {
                $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
                if (FilterList.dtZone.length == 0) {
                    all_zones = "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                } else if (i == FilterList.dtZone.length - 1) {
                    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                } else {
                    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'" + ',';
                }
            }
            $('select#Zone')[0].sumo.selectItem(0);
            $('#Zone').trigger("change");
            //all_states = "";
            //for (var i = 0; i < FilterList.dtState.length; i++) {
            //    if (FilterList.dtState.length == 0) {
            //        all_states = "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
            //    } else if (i == FilterList.dtState.length - 1) {
            //        all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
            //    } else {
            //        all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'" + ',';
            //    }
            //}
            //all_territories = "";
            //for (var i = 0; i < FilterList.dtTerritory.length; i++) {
            //    if (FilterList.dtTerritory.length == 0) {
            //        all_territories = "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
            //    } else if (i == FilterList.dtTerritory.length - 1) {
            //        all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
            //    } else {
            //        all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'" + ',';
            //    }
            //}
            //all_customers = "";
            //for (var i = 0; i < FilterList.dtCustomer.length; i++) {
            //$('#StockistID')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //$('#StockistName')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //if (FilterList.dtCustomer.length == 0) {
            //    all_customers = "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else if (i == FilterList.dtCustomer.length - 1) {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'" + ',';
            //}
            //}
        });
    } else if (SessionValue == "SH") {
        $("#Zone").attr("disabled", true); $("#State").attr("disabled", false); $("#TerriotryArea").attr("disabled", false); $("#CustomerCode").attr("disabled", false);
        //data_value = "{\"Role\":\"" + "SH" + "\",\"UserCode\":\"" + "50002430" + "\"}";
        data_value = "{\"Role\":\"" + "SH" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
            var FilterList = JSON.parse(res);
            //all_zones = "";
            for (var i = 0; i < FilterList.dtZone.length; i++) {
                $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
                //if (FilterList.dtZone.length == 0) {
                //    all_zones = "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else if (i == FilterList.dtZone.length - 1) {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'" + ',';
                //}
            }
            $('select#Zone')[0].sumo.selectItem(0);
            //all_states = "";
            for (var i = 0; i < FilterList.dtState.length; i++) {
                $('#State')[0].sumo.add(FilterList.dtState[i]["STATE_CODE"], FilterList.dtState[i]["STATE_NAME"]);
                //if (FilterList.dtState.length == 0) {
                //    all_states = "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else if (i == FilterList.dtState.length - 1) {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'" + ',';
                //}
            }
            $('select#State')[0].sumo.selectItem(0);
            $('#State').trigger("change");
            //all_territories = "";
            //for (var i = 0; i < FilterList.dtTerritory.length; i++) {
            //    if (FilterList.dtTerritory.length == 0) {
            //        all_territories = "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
            //    } else if (i == FilterList.dtTerritory.length - 1) {
            //        all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
            //    } else {
            //        all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'" + ',';
            //    }
            //}
            //all_customers = "";
            //for (var i = 0; i < FilterList.dtCustomer.length; i++) {
            // $('#StockistID')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //$('#StockistName')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //if (FilterList.dtCustomer.length == 0) {
            //    all_customers = "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else if (i == FilterList.dtCustomer.length - 1) {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'" + ',';
            //}
            // }
        });
    }

    else if (SessionValue == "TM") {
        $("#Zone").attr("disabled", true); $("#State").attr("disabled", true); $("#TerriotryArea").attr("disabled", false); $("#CustomerCode").attr("disabled", false);
        //data_value = "{\"Role\":\"" + "TM" + "\",\"UserCode\":\"" + "50001144" + "\"}";
        data_value = "{\"Role\":\"" + "TM" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
            var FilterList = JSON.parse(res);
            //all_zones = "";
            for (var i = 0; i < FilterList.dtZone.length; i++) {
                $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
                //if (FilterList.dtZone.length == 0) {
                //    all_zones = "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else if (i == FilterList.dtZone.length - 1) {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'" + ',';
                //}
            }
            $('select#Zone')[0].sumo.selectItem(0);
            //all_states = "";
            for (var i = 0; i < FilterList.dtState.length; i++) {
                $('#State')[0].sumo.add(FilterList.dtState[i]["STATE_CODE"], FilterList.dtState[i]["STATE_NAME"]);
                //if (FilterList.dtState.length == 0) {
                //    all_states = "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else if (i == FilterList.dtState.length - 1) {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'" + ',';
                //}
            }
            $('select#State')[0].sumo.selectItem(0);
            //all_territories = "";
            for (var i = 0; i < FilterList.dtTerritory.length; i++) {
                $('#TerriotryArea')[0].sumo.add(FilterList.dtTerritory[i]["TERRITORY_CODE"], FilterList.dtTerritory[i]["TERRITORY_NAME"]);
                //if (FilterList.dtTerritory.length == 0) {
                //    all_territories = "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                //} else if (i == FilterList.dtTerritory.length - 1) {
                //    all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                //} else {
                //    all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'" + ',';
                //}
            }
            //all_customers = "";
            // for (var i = 0; i < FilterList.dtCustomer.length; i++) {
            // $('#StockistID')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //$('#StockistName')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //if (FilterList.dtCustomer.length == 0) {
            //    all_customers = "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else if (i == FilterList.dtCustomer.length - 1) {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'" + ',';
            //}
            //}
        });
    }

    else if (SessionValue == "FSO" || SessionValue == "FSO_BU2") {
        $("#Zone").attr("disabled", true); $("#State").attr("disabled", true); $("#TerriotryArea").attr("disabled", false); $("#CustomerCode").attr("disabled", false);
        //data_value = "{\"Role\":\"" + "FSO" + "\",\"UserCode\":\"" + "50001906" + "\"}";
        if (SessionValue == "FSO") {
            data_value = "{\"Role\":\"" + "FSO" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        } else {
            data_value = "{\"Role\":\"" + "FSO_BU2" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        }
        $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
            var FilterList = JSON.parse(res);
            //all_zones = "";
            for (var i = 0; i < FilterList.dtZone.length; i++) {
                $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
                //if (FilterList.dtZone.length == 0) {
                //    all_zones = "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else if (i == FilterList.dtZone.length - 1) {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'" + ',';
                //}
            }
            $('select#Zone')[0].sumo.selectItem(0);
            //all_states = "";
            for (var i = 0; i < FilterList.dtState.length; i++) {
                $('#State')[0].sumo.add(FilterList.dtState[i]["STATE_CODE"], FilterList.dtState[i]["STATE_NAME"]);
                //if (FilterList.dtState.length == 0) {
                //    all_states = "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else if (i == FilterList.dtState.length - 1) {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'" + ',';
                //}
            }
            $('select#State')[0].sumo.selectItem(0);
            //all_territories = "";
            for (var i = 0; i < FilterList.dtTerritory.length; i++) {
                $('#TerriotryArea')[0].sumo.add(FilterList.dtTerritory[i]["TERRITORY_CODE"], FilterList.dtTerritory[i]["TERRITORY_NAME"]);
                //if (FilterList.dtTerritory.length == 0) {
                //    all_territories = "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                //} else if (i == FilterList.dtTerritory.length - 1) {
                //    all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                //} else {
                //    all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'" + ',';
                //}
            }
            $('select#TerriotryArea')[0].sumo.selectItem(0);
            $('#TerriotryArea').trigger("change");
            //all_customers = "";
            //for (var i = 0; i < FilterList.dtCustomer.length; i++) {
            // $('#StockistID')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //$('#StockistName')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //if (FilterList.dtCustomer.length == 0) {
            //    all_customers = "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else if (i == FilterList.dtCustomer.length - 1) {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'" + ',';
            //}
            // }
        });
    }

    else if ((SessionValue == "STOCKIST") || (SessionValue == "C&F")) {
        $("#Zone").attr("disabled", true); $("#State").attr("disabled", true); $("#TerriotryArea").attr("disabled", true); $("#CustomerCode").attr("disabled", true);
        //data_value = "{\"Role\":\"" + "STOCKIST" + "\",\"UserCode\":\"" + "1100002" + "\"}";
        data_value = "{\"Role\":\"" + "STOCKIST" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
            var FilterList = JSON.parse(res);
            //all_zones = "";
            for (var i = 0; i < FilterList.dtZone.length; i++) {
                $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
                //if (FilterList.dtZone.length == 0) {
                //    all_zones = "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else if (i == FilterList.dtZone.length - 1) {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'" + ',';
                //}
            }
            $('select#Zone')[0].sumo.selectItem(0);
            //all_states = "";
            for (var i = 0; i < FilterList.dtState.length; i++) {
                $('#State')[0].sumo.add(FilterList.dtState[i]["STATE_CODE"], FilterList.dtState[i]["STATE_NAME"]);
                //if (FilterList.dtState.length == 0) {
                //    all_states = "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else if (i == FilterList.dtState.length - 1) {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'" + ',';
                //}
            }
            $('select#State')[0].sumo.selectItem(0);
            //all_territories = "";
            for (var i = 0; i < FilterList.dtTerritory.length; i++) {
                $('#TerriotryArea')[0].sumo.add(FilterList.dtTerritory[i]["TERRITORY_CODE"], FilterList.dtTerritory[i]["TERRITORY_NAME"]);
                //if (FilterList.dtTerritory.length == 0) {
                //    all_territories = "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                //} else if (i == FilterList.dtTerritory.length - 1) {
                //    all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                //} else {
                //    all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'" + ',';
                //}
            }
            $('select#TerriotryArea')[0].sumo.selectItem(0);
            //all_customers = "";
            CustomerArray.length = 0;
            for (var i = 0; i < FilterList.dtCustomer.length; i++) {
                //  $('#StockistID')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
                CustomerArray.push(FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
                $("#CustomerCode").val(FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);

                //$('#StockistID').val(FilterList.dtCustomer[i]["CUSTOMER_CODE"] + " : " + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
                //$('#StockistName')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
                //if (FilterList.dtCustomer.length == 0) {
                //    all_customers = "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
                //} else if (i == FilterList.dtCustomer.length - 1) {
                //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
                //} else {
                //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'" + ',';
                //}
            }
            //$("#StockistID").typeahead({
            //    source: CustomerArray
            //});
            // $('select#StockistID')[0].sumo.selectItem(0);
        });
    } else {
        $("#Zone").attr("disabled", false); $("#State").attr("disabled", false); $("#TerriotryArea").attr("disabled", false); $("#CustomerCode").attr("disabled", false);
        //data_value = "{\"Role\":\"" + "ADMIN" + "\",\"UserCode\":\"" + "50001657" + "\"}";
        data_value = "{\"Role\":\"" + SessionValue + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
            var FilterList = JSON.parse(res);
            all_zones = "";
            for (var i = 0; i < FilterList.dtZone.length; i++) {
                $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
                if (FilterList.dtZone.length == 0) {
                    all_zones = "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                } else if (i == FilterList.dtZone.length - 1) {
                    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                } else {
                    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'" + ',';
                }
            }
            CustomerArray.length = 0;
            $("#CustomerCode").val("");
            if (FilterList.dtCustomer.length > 0) {
                for (var i = 0; i < FilterList.dtCustomer.length; i++) {
                    CustomerArray.push(FilterList.dtCustomer[i]["STOCKIST_ID"].toString() + ":" + FilterList.dtCustomer[i]["STOCKIST_NAME"].toString());
                }
            }
            //all_states = "";
            //for (var i = 0; i < FilterList.dtState.length; i++) {
            //    if (FilterList.dtState.length == 0) {
            //        all_states = "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
            //    } else if (i == FilterList.dtState.length - 1) {
            //        all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
            //    } else {
            //        all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'" + ',';
            //    }
            //}
            //all_territories = "";
            //for (var i = 0; i < FilterList.dtTerritory.length; i++) {
            //    if (FilterList.dtTerritory.length == 0) {
            //        all_territories = "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
            //    } else if (i == FilterList.dtTerritory.length - 1) {
            //        all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
            //    } else {
            //        all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'" + ',';
            //    }
            //}
            //all_customers = "";
            //for (var i = 0; i < FilterList.dtCustomer.length; i++) {
            //$('#StockistID')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //$('#StockistName')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //if (FilterList.dtCustomer.length == 0) {
            //    all_customers = "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else if (i == FilterList.dtCustomer.length - 1) {
            //   all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'" + ',';
            //}
            //}
        });
    }
    HideLoader();
    $('#Zone').on('keyup change', function () {
        ShowLoader();
        var Clear_State = $('#State option').length;
        for (var i = 0; i < Clear_State; i++) {
            $('#State')[0].sumo.remove(0);
        }

        //var Clear_Cust = $('#StockistID option').length;
        //for (var i = 0; i < Clear_Cust; i++) {
        //    $('#StockistID')[0].sumo.remove(0);
        //}
        CustomerArray.length = 0;
        $('#CustomerCode').val("");

        var Clear_Terrytory = $('#TerriotryArea option').length;
        for (var i = 0; i < Clear_Terrytory; i++) {
            $('#TerriotryArea')[0].sumo.remove(0);
        }

        var data_value = "{\"Zone_Code\":\"" + $("#Zone").val() + "\"}";
        $http({ url: '../../Home/GetStatesforZone', method: 'POST', data: { Data: data_value } }).success(function (res) {
            //   ShowLoader();
            if (res != "") {
                var dtState = JSON.parse(res);
                for (var i = 0; i < dtState.length; i++) {
                    $('#State')[0].sumo.add(dtState[i]["STATE_CODE"], dtState[i]["STATE_NAME"]);
                }
                // HideLoader();
            } else {
                // HideLoader();
            }

            $http({ url: '../../Home/GetCustomersforZone', method: 'POST', data: { Data: data_value } }).success(function (Cust_res) {
                if (Cust_res != "") {
                    var dtCust = JSON.parse(Cust_res);
                    for (var i = 0; i < dtCust.length; i++) {
                        //   $('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"].toString(), dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                        CustomerArray.push(dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                    }
                }
            });
        });
        HideLoader();
    });

    var SelectedState = ""; var Actual_SelectedState = ""; var Actual_SelectedTerritory = "";
    $('#State').on('keyup change', function () {
        ShowLoader();
        Actual_SelectedState = "";
        var Clear_Territory = $('#TerriotryArea option').length;
        for (var i = 0; i < Clear_Territory; i++) {
            $('#TerriotryArea')[0].sumo.remove(0);
        }
        //var Clear_Cust = $('#StockistID option').length;
        //for (var i = 0; i < Clear_Cust; i++) {
        //    $('#StockistID')[0].sumo.remove(0);
        //}
        CustomerArray.length = 0;
        $('#CustomerCode').val("");

        if ($('#State').val() != null) {
            var seleState = $('#State').val();

            for (var k = 0; k < seleState.length; k++) {
                SelectedState += "'" + seleState[k] + "',";
                Actual_SelectedState += "'" + seleState[k] + "',";
            }
            SelectedState = SelectedState.substring(',', SelectedState.length - 1);//Selected States with ' '. 
            Actual_SelectedState = Actual_SelectedState.substring(',', Actual_SelectedState.length - 1);//Selected States with ' '. 
        }

        var data_value = "{\"State_Code\":\"" + SelectedState + "\"}";
        $http({ url: '../../Home/GetTerritoriesforState', method: 'POST', data: { Data: data_value } }).success(function (res) {
            //  ShowLoader();
            if (res != "") {
                // ShowLoader();
                var dtTerritory = JSON.parse(res);
                for (var i = 0; i < dtTerritory.length; i++) {
                    $('#TerriotryArea')[0].sumo.add(dtTerritory[i]["TERRITORY_CODE"], dtTerritory[i]["TERRITORY_NAME"]);
                }
                $http({ url: '../../Home/GetCustomersforState', method: 'POST', data: { Data: data_value } }).success(function (res) {
                    if (res != "") {
                        var dtCust = JSON.parse(res);
                        for (var i = 0; i < dtCust.length; i++) {
                            //$('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"].toString(), dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                            CustomerArray.push(dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                        }
                    }
                });
            } else {
                HideLoader();
            }
            HideLoader();
        });

        if ($("#State").val() == null) {
            var data_value = "{\"Zone_Code\":\"" + $("#Zone").val() + "\"}";
            if ((SessionValue != "SH") && (SessionValue != "TM") && (SessionValue != "FSO") && (SessionValue != "FSO_BU2") && (SessionValue != "STOCKIST") && (SessionValue != "C&F")) {
                $http({ url: '../../Home/GetCustomersforZone', method: 'POST', data: { Data: data_value } }).success(function (Cust_res) {
                    if (Cust_res != "") {
                        var dtCust = JSON.parse(Cust_res);
                        for (var i = 0; i < dtCust.length; i++) {
                            //  $('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"].toString(), dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                            CustomerArray.push(dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                        }
                        HideLoader();
                    } else {
                        HideLoader();
                    }
                });
            }
            HideLoader();
        }
        SelectedState = "";
        HideLoader();
    });

    var SelectedTerritory = "";
    $('#TerriotryArea').on('keyup change', function () {
        ShowLoader();
        Actual_SelectedTerritory = ""; Actual_SelectedState = "";
        if ((SessionValue == "TM") || (SessionValue == "FSO") || (SessionValue == "FSO_BU2")) {
            if ($("#TerriotryArea").val() == null) {
                //var Clear_Cust = $('#StockistID option').length;
                //for (var i = 0; i < Clear_Cust; i++) {
                //    $('#StockistID')[0].sumo.remove(0);
                //}
                CustomerArray.length = 0;
                $('#CustomerCode').val("");
                HideLoader();
            } else if ($("#TerriotryArea").val() != null) {
                var seleTerritory = $('#TerriotryArea').val();
                for (var k = 0; k < seleTerritory.length; k++) {
                    SelectedTerritory += "'" + seleTerritory[k] + "',";
                    Actual_SelectedTerritory += "'" + seleTerritory[k] + "',";
                }
                SelectedTerritory = SelectedTerritory.substring(',', SelectedTerritory.length - 1);//Selected Territories with ' '. 
                Actual_SelectedTerritory = Actual_SelectedTerritory.substring(',', Actual_SelectedTerritory.length - 1);//Selected Territories with ' '. 

                var data_value = "{\"Territory_Code\":\"" + SelectedTerritory + "\"}";
                // ShowLoader();
                $http({ url: '../../Home/GetCustomersforTerritory', method: 'POST', data: { Data: data_value } }).success(function (res) {
                    if (res != "") {
                        var dtCust = JSON.parse(res);
                        for (var i = 0; i < dtCust.length; i++) {
                            //$('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"], dtCust[i]["CUSTOMER_CODE"] + ":" + dtCust[i]["CUSTOMER_NAME"]);
                            CustomerArray.push(dtCust[i]["CUSTOMER_CODE"] + ":" + dtCust[i]["CUSTOMER_NAME"]);
                        }
                        HideLoader();
                    } else {
                        HideLoader();
                    }
                });
            }
        } else {
            //  ShowLoader();
            //var Clear_Cust = $('#StockistID option').length;
            //for (var i = 0; i < Clear_Cust; i++) {
            //    $('#StockistID')[0].sumo.remove(0);
            //}
            CustomerArray.length = 0;
            $('#CustomerCode').val('');


            if ($('#TerriotryArea').val() != null) {
                var seleTerritory = $('#TerriotryArea').val();
                for (var k = 0; k < seleTerritory.length; k++) {
                    SelectedTerritory += "'" + seleTerritory[k] + "',";
                    Actual_SelectedTerritory += "'" + seleTerritory[k] + "',";
                }
                SelectedTerritory = SelectedTerritory.substring(',', SelectedTerritory.length - 1);//Selected Territories with ' '. 
                Actual_SelectedTerritory = Actual_SelectedTerritory.substring(',', Actual_SelectedTerritory.length - 1);//Selected Territories with ' '. 
            }
            if ($("#TerriotryArea").val() == null) {
                var seleState = $('#State').val();

                for (var k = 0; k < seleState.length; k++) {
                    SelectedState += "'" + seleState[k] + "',";
                    Actual_SelectedState += "'" + seleState[k] + "',";
                }
                SelectedState = SelectedState.substring(',', SelectedState.length - 1);//Selected States with ' '. 
                Actual_SelectedState = Actual_SelectedState.substring(',', Actual_SelectedState.length - 1);//Selected States with ' '. 
                // ShowLoader();
                var data_value = "{\"State_Code\":\"" + SelectedState + "\"}";
                $http({ url: '../../Home/GetCustomersforState', method: 'POST', data: { Data: data_value } }).success(function (res) {
                    if (res != "") {
                        // ShowLoader();
                        var dtCust = JSON.parse(res);
                        for (var i = 0; i < dtCust.length; i++) {
                            // $('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"].toString(), dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                            CustomerArray.push(dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                        }
                        HideLoader();
                    } else {
                        HideLoader();
                    }
                });
            } else {
                // ShowLoader();
                var data_value = "{\"Territory_Code\":\"" + SelectedTerritory + "\"}";
                $http({ url: '../../Home/GetCustomersforTerritory', method: 'POST', data: { Data: data_value } }).success(function (res) {
                    if (res != "") {
                        ShowLoader();
                        var dtCust = JSON.parse(res);
                        for (var i = 0; i < dtCust.length; i++) {
                            //$('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"], dtCust[i]["CUSTOMER_CODE"] + ":" + dtCust[i]["CUSTOMER_NAME"]);
                            CustomerArray.push(dtCust[i]["CUSTOMER_CODE"] + ":" + dtCust[i]["CUSTOMER_NAME"]);
                        }
                        HideLoader();
                    } else {
                        HideLoader();
                    }
                });
            }
        }
        SelectedTerritory = "";
        SelectedState = "";
    });

    $("#CustomerCode").typeahead({
        source: CustomerArray
    });
    $scope.GetDebitNote = function () {
        var FromDate = $('#OrderFromDate').val();
        var ToDate = $('#OrderToDate').val();
        var ZoneValue = $('#Zone').val();
        var StateValue = $('#State').val();
        var TerritoryValue = $('#TerriotryArea').val();
        var isValidCustCode = isValidCode_Cust($("#CustomerCode").val(), CustomerArray);
        if (FromDate == "" || FromDate == null) {
            alert("Please select from date");
        } else if (ToDate == "" || ToDate == null) {
            alert("Please select to date");
        } else if (SessionValue == "ZH" && ZoneValue == null) {
            alert("please select zone");
        }
        else if (SessionValue == "SH" && StateValue == null) {
            alert("please select state");
        } else if (SessionValue == "TM" && TerritoryValue == null) {
            alert("please select Territory");
        }
        else if (SessionValue == "FSO" && TerritoryValue == null) {
            alert("please select Territory");
        }
        else if (SessionValue == "FSO_BU2" && TerritoryValue == null) {
            alert("please select Territory");
        }
        else if (($("#CustomerCode").val() != "") && (isValidCustCode == false)) {
            alert("Please select proper customer code");
        }
        else {
            try {
                //ShowLoader();


                var DateRange = DateSplitter('OrderFromDate', 'OrderToDate');

                var WhereClause = "WHERE INDICATOR='S' AND DOC_TYPE='DR' AND POSTING_DATE BETWEEN " + DateRange + "";
                if ($("#CustomerCode").val() != "") {
                    WhereClause += " and CAST(CUSTOMER_CODE AS BIGINT) IN (" + $("#CustomerCode").val().split(':')[0] + ")";
                } else if ($("#TerriotryArea").val() != null) {
                    WhereClause += " and CAST(CUSTOMER_CODE AS BIGINT) IN (select DISTINCT ecc.CUSTOMER_CODE from cms_employee_customer_configuration ecc inner join CUSTOMER_SALES_VIEW csv on CAST(ecc.CUSTOMER_CODE AS BIGINT)=CAST(csv.cust_code AS BIGINT) where ecc.ORG_LEVEL_ID IN(" + Actual_SelectedTerritory + "))";
                } else if ($("#State").val() != null) {
                    WhereClause += " and STATE IN(" + Actual_SelectedState + ")";
                }
                else if ($("#Zone").val() != null) {
                    WhereClause += " AND ZONE IN(" + $("#Zone").val() + ")";
                }
                if (($("#Zone").val() == null) && ($("#State").val() == null) && ($("#TerriotryArea").val() == null) && ($("#CustomerCode").val() == "")) {
                    WhereClause += "";
                }

                //  ShowLoader();

                //    var DateSpliter = DateSplitter('OrderFromDate', 'OrderToDate');
                // var WhereClause = "JOIN sap_customer_sales_master AS SM ON CAST(SM.STOCKIST_ID AS INT)=CAST(CM.STOCKIST_ID AS INT) WHERE CAST(CD.CUSTOMER_CODE AS INT)=CAST(CM.STOCKIST_ID AS INT) AND CD.INDICATOR='S' AND CD.DOC_TYPE='DR' AND CD.DOC_DATE BETWEEN " + DateSpliter + " AND SM.SALES_ORGANISATION='1000'";
                //  var WhereClause = "WHERE INDICATOR='S' AND DOC_TYPE='DR' AND POSTING_DATE BETWEEN " + DateSpliter + "";

                var sheet = $("#Sheets").val();

                //Edited By Manikanta

                if (sheet != "select") {
                    WhereClause += " and CAST(CUSTOMER_CODE AS BIGINT) IN (select STOCKIST_ID from sap_customer_sales_master where DIVISION='" + sheet + "')";
                }



                var Data = JSON.stringify({
                    MasterType: "DebitNotes",
                    ID: "561",
                    UserCode: $("#UserCode").val(),
                    "Type": "Get",
                    ReportName: "DebitNotes",
                    WhereClause: WhereClause
                });

                DIMSFactory.getReportListColumnNamesData(Data).success(function (response) {
                    var Result = JSON.parse(response.tabledata);

                    if (Result != "") {
                        $scope.UserDefaultListColumnNames = Result["UserDefaultListColumnNames"];
                        if (Result.hasOwnProperty('UserListColumnNames')) {
                            var data1 = JSON.parse(Result["UserListColumnNames"]);

                            var selectedcolumnname = data1["ColumnNames"];

                            CustomColumnID = Result["UserListID"];
                            $('#undo_redo_to').empty();
                            var ColArray = new Array();
                            for (var i = 0; i < selectedcolumnname.length; i++) {
                                if (i == 0) {
                                    ColArray.push({
                                        "data": selectedcolumnname[i],
                                        "name": selectedcolumnname[i], "bSortable": false
                                    });
                                } else {
                                    ColArray.push({
                                        "data": selectedcolumnname[i],
                                        "name": selectedcolumnname[i], "bSortable": true
                                    });
                                }
                                $("#undo_redo_to").append($("<option></option>").val(selectedcolumnname[i]).html(selectedcolumnname[i]));
                            }
                            //$scope.UserSelectedColumnName = ColArray;
                            UserSelectedColumnName = ColArray;
                        } else {

                            var data1 = JSON.parse(Result["UserDefaultListColumnNames"]);

                            var selectedcolumnname = data1["ColumnNames"];

                            CustomColumnID = "0";

                            $('#undo_redo_to').empty();
                            var ColArray = new Array();
                            for (var i = 0; i < selectedcolumnname.length; i++) {
                                if (i == 0) {
                                    ColArray.push({
                                        "data": selectedcolumnname[i],
                                        "name": selectedcolumnname[i],
                                        "bSortable": false
                                    });
                                } else {
                                    ColArray.push({
                                        "data": selectedcolumnname[i],
                                        "name": selectedcolumnname[i],
                                        "bSortable": true
                                    });
                                }
                                $("#undo_redo_to").append($("<option></option>").val(selectedcolumnname[i]).html(selectedcolumnname[i]));
                            }
                            //$scope.UserSelectedColumnName = ColArray;
                            UserSelectedColumnName = ColArray;
                        }



                    }
                    DIMSFactory.getReportData(Data).success(function (response) {
                        // ShowLoader();
                        getLookUpData_Reports_ServerSideBinding_CreditDebitNotes("", "EnrollmentNodataLabel", "", "tbl_DebitNotes", UserSelectedColumnName);
                        //  HideLoader();
                        $("#DebitNoteDetailDiv").show();
                        ShowLoader();
                        var table = $('#tbl_DebitNotes').DataTable();
                        var IsCheckBoxChecked = false;
                        $('#tbl_DebitNotes tbody').on('click', 'td', function () {
                            var columns = table.settings().init().columns;
                            //get the index of the clickec cell
                            var colIndex = table.cell(this).index().column;
                            //alert('you clicked on the column with the name ' + columns[colIndex].name);
                            if (columns[colIndex].name == "Customer Code") {
                                IsCheckBoxChecked = true;
                            }
                            else {
                                IsCheckBoxChecked = false;
                            }
                        });
                        $('#tbl_DebitNotes tbody').on('click', 'tr', function () {
                            if (!IsCheckBoxChecked) {
                                var DocDate = $(this).find('td:eq(7)').text();
                                var DocNum = $(this).find('td:eq(8)').text();

                                DocDate_CreditNote = DocDate;
                                var DOCDATE1 = "";
                                if (DocDate.indexOf('/') > 0) {
                                    DocDate = DocDate.split('/');
                                    DOCDATE1 = DocDate[2] + "-" + DocDate[1] + "-" + DocDate[0];
                                }
                                if ($(this).hasClass('selected')) {
                                    $(this).removeClass('selected');
                                }
                                else {
                                    $('tr.selected').removeClass('selected');
                                    $(this).addClass('selected');
                                }

                                if (DOCDATE1 != "" && DocNum != "") {

                                    // $scope.go('CreditNotesDetails');

                                    // DocDate = DocDate.replaceAll('/', '-');
                                    ShowLoader();
                                    var ID = DOCDATE1 + "$" + DocNum;
                                    var scope = angular.element($("#DebitNoteDetailId")).scope();
                                    scope.$apply(function () {
                                        $scope.go("DebitNotesDetails/" + ID);
                                        HideLoader();
                                    })


                                    // $scope.EditID = ID;             
                                    //$scope.go("AddOrder/" + ID);
                                    //var scope = angular.element($("#InvestigationlistDiv")).scope();
                                    //scope.$apply(function () {
                                    //    scope.go("Investigation/" + ID);
                                    //})
                                }
                            }
                        });
                    });

                    DIMSSAPFactory.GetTotalSumCreditDebit(Data).success(function (res) {
                        $('#TotalDebitAmnt').val(parseFloat(res).toFixed(2));
                        HideLoader();
                    });

                });
            } catch (Exception) { }

        }
    }

    $scope.DownloadFile = function (filetype) {
        var SearchValue = $('input[type=search]').val();
        var FileName = "DebitNotes";
        var DateSpliter = DateSplitter('OrderFromDate', 'OrderToDate');
        var UserCode = $("#UserCode").val();
        var WhereClause = "WHERE INDICATOR='S' AND DOC_TYPE='DR' AND POSTING_DATE BETWEEN " + DateSpliter + "";
        var isValidCustCode = isValidCode_Cust($("#CustomerCode").val(), CustomerArray);
        if ($("#CustomerCode").val() != "") {
            if (($("#CustomerCode").val() != "") && (isValidCustCode == false)) {
            } else {
                WhereClause += " and CAST(CUSTOMER_CODE AS BIGINT) IN (" + $("#CustomerCode").val().split(':')[0] + ")";
            }
        } else if ($("#TerriotryArea").val() != null) {
            WhereClause += " and CAST(CUSTOMER_CODE AS BIGINT) IN (select DISTINCT ecc.CUSTOMER_CODE from cms_employee_customer_configuration ecc inner join CUSTOMER_SALES_VIEW csv on CAST(ecc.CUSTOMER_CODE AS BIGINT)=CAST(csv.cust_code AS BIGINT) where ecc.ORG_LEVEL_ID IN(" + Actual_SelectedTerritory + "))";
        } else if ($("#State").val() != null) {
            WhereClause += " and STATE IN(" + Actual_SelectedState + ")";
        }
        else if ($("#Zone").val() != null) {
            WhereClause += " AND ZONE IN(" + $("#Zone").val() + ")";
        }
        if (($("#Zone").val() == null) && ($("#State").val() == null) && ($("#TerriotryArea").val() == null) && ($("#CustomerCode").val() == "")) {
            WhereClause += "";
        }


        var sheet = $("#Sheets").val();

        //Edited By Manikanta

        if (sheet != "select") {
            WhereClause += " and CAST(CUSTOMER_CODE AS BIGINT) IN (select STOCKIST_ID from sap_customer_sales_master where DIVISION='" + sheet + "')";
        }

        var Table_DebitCount = $('#tbl_DebitNotes').DataTable().data().count();
        if (Table_DebitCount == 0) {
            alert("There is no data");
        } else {
            if (($("#CustomerCode").val() != "") && (isValidCustCode == false)) { alert("please select proper customer code"); } else {
                var data_value = "{\"Role\":\"" + SessionValue + "\",\"Form_Code\":\"" + "DN" + "\",\"Action\":\"" + "Is_Export" + "\"}";
                $http({ url: '../../Home/Form_Access', method: 'POST', data: { Data: data_value } }).success(function (res) {
                    if (res == "True") {
                        CommonFunctionForExcelExport_SearchFilter("561", UserCode, SearchValue, FileName, FileName, WhereClause, filetype);
                    }
                    else {
                        alert("You are not allowed to export Debit Notes List");
                    }
                });
            }
        }
    }

    // Open popup for columns selection
    $scope.OpenColumnEditing = function () {

        $('#undo_redo').empty();
        var ColumnNames = JSON.parse($scope.UserDefaultListColumnNames);

        for (var i = 0; i < ColumnNames["ColumnNames"].length; i++) {
            $("#undo_redo").append($("<option></option>").val(ColumnNames["ColumnNames"][i]).html(ColumnNames["ColumnNames"][i]));
        }



        //   $('#undo_redo').refresh();

        $('#undo_redo').multiselect();
        if (ControllerName != "DebitNotesCtrl") {
            ControllerName = "DebitNotesCtrl";
            var elem = angular.element('#ColumnEditingModal');
            elem.removeAttr('ng-controller');
            elem.attr('ng-controller', "DebitNotesCtrl");

            $compile(elem.contents())(DebitNoteScope);
        }

        $("#ColumnEditingModal").modal('show');




    }
    // View Column selected it is like preview.We will send reportname,usercode and where condition to function
    $scope.ViewColumnEditing = function () {
        DIMSFactory.ViewColumnEditing("DebitNotes", $("#UserCode").val(), " CD.CUSTOMER_CODE=CM.STOCKIST_ID AND CD.DOC_TYPE='DA'"); // 1-Report Name ,2-UserCode(561),3-WhereClause

    }
    // Save Column selected it is like preview.We will send reportname,usercode and where condition to function
    $scope.SaveColumnEditingData = function () {
        var WhereClause = " WHERE CD.CUSTOMER_CODE=CM.STOCKIST_ID AND CD.DOC_TYPE='DA'";
        var Data = JSON.stringify({
            MasterType: "DebitNotes",
            ID: "561",
            UserCode: $("#UserCode").val(),
            "Type": "Get",
            ReportName: "DebitNotes",
            WhereClause: WhereClause
        });
        //DIMSFactory.SaveColumnEditingData("Compensation", $scope.UserCode, " ORDER BY ID DESC");
        DIMSFactory.SaveColumnEditingData_InputParameter("DebitNotes", $("#UserCode").val(), WhereClause, Data, "tbl_DebitNotes");
        // 1-Report Name ,2-UserCode(561),3-WhereClause,4-JsonData,5-Frontend datatable id


    }
});

DIMS.controller('DebitNotesDetailsCtrl', function ($scope, $location, DIMSSAPFactory, $http, $compile, $routeParams) {
    $scope.templatesettings = { HeaderTitle: "Credit Notes Details" };
    CreditNoteScope = $scope;
    MasterScope = $scope;


    $scope.go = function (path) {
        CheckUserSession();
        $location.path(path);
    };
    var EditId = $routeParams.ID;
    if (EditId != undefined || EditId != null) {
        EditId = EditId.split('$');
        var DocDate = EditId[0];
        var DocNum = EditId[1];
        if ((DocDate != "" || DocDate != undefined) && (DocNum != "" || DocNum != undefined)) {

            var Data = JSON.stringify({
                "DocDate": DocDate,
                "DataFrom": "S",
                "DocNum": DocNum
            })
            DIMSSAPFactory.GetCreditNoteDetails(Data).success(function (res) {
                if (res != "False") {
                    var Response = JSON.parse(res);
                    $('#BusinessAreaCode').text(Response[0]["BUSINESS_AREA"]);
                    $('#DocNo').text(Response[0]["DOC_NO"]);
                    $('#DepoName').text(Response[0]["PLANT_DESCRIPTION"]);
                    $('#DocDate').text(Response[0]["POSTING_DATE"]);
                    $('#CustCode').text(Response[0]["CUSTOMER_CODE"]);
                    //  var NameAddress = Response[0]["STOCKIST_NAME"] + ' ; ' + Response[0]["CustomerAddress"] + " ;";

                    $('#CustName').text(Response[0]["STOCKIST_NAME"]);

                    $('#CustAddress').text(Response[0]["CustomerAddress"]);

                    $('#Towards').text("Towards " + Response[0]["TEXT"]);

                    var GrssAmt = Response[0]["AMOUNT"];

                    $('#GrossAmt').text(GrssAmt.toFixed(2));

                    $('#TDSAmt').text("0.00");

                    $('#NetAmt').text(GrssAmt.toFixed(2));

                    $('#InWords').text("A SUM OF " + toWordsINVOICE(GrssAmt.toFixed(2)));


                    $('#BusinessAreaCode_html').text(Response[0]["BUSINESS_AREA"]);
                    $('#DocNo_html').text(Response[0]["DOC_NO"]);
                    $('#DepoName_html').text(Response[0]["PLANT_DESCRIPTION"]);
                    $('#DocDate_html').text(Response[0]["POSTING_DATE"]);
                    $('#CustCode_html').text(Response[0]["CUSTOMER_CODE"]);
                    // var NameAddress = Response[0]["STOCKIST_NAME"] + " ; " + Response[0]["CustomerAddress"] + " ;";

                    $('#CustName_html').text(Response[0]["STOCKIST_NAME"]);

                    $('#CustAddress_html').text(Response[0]["CustomerAddress"]);
                    $('#Towards_html').text("Towards  " + Response[0]["TEXT"]);

                    var GrssAmt = Response[0]["AMOUNT"];

                    $('#GrossAmt_html').text(GrssAmt.toFixed(2));

                    $('#TDSAmt_html').text("0.00");

                    $('#NetAmt_html').text(GrssAmt.toFixed(2));

                    $('#InWords_html').text("A SUM OF " + toWordsINVOICE(GrssAmt.toFixed(2)));

                    //For GST Related Code
                    $('#GSTPlantDesc').text(Response[0]["PLANT_DESCRIPTION"]);
                    $('#GSTPlantName').text(Response[0]["PlantName"]);
                    $('#GSTPlantAddress').text(Response[0]["PlantAddress"]);
                    $('#GSTPlantPhone').text(Response[0]["PLANT_PHONE"]);
                    $('#GSTPlantGSTNo').text(Response[0]["PLANT_GST_NO"]);
                    $('#GSTPlantTINNo').text(Response[0]["PLANT_TIN_NO"]);
                    $('#GSTPlantEMail').text(Response[0]["EMAIL"]);

                    $('#GSTPlantDesc_html').text(Response[0]["PLANT_DESCRIPTION"]);
                    $('#GSTPlantName_html').text(Response[0]["PlantName"]);
                    $('#GSTPlantAddress_html').text(Response[0]["PlantAddress"]);
                    $('#GSTPlantPhone_html').text(Response[0]["PLANT_PHONE"]);
                    $('#GSTPlantGSTNo_html').text(Response[0]["PLANT_GST_NO"]);
                    $('#GSTPlantTINNo_html').text(Response[0]["PLANT_TIN_NO"]);
                    $('#GSTPlantEMail_html').text(Response[0]["EMAIL"]);

                    $('#GSTDocNo').text(Response[0]["DOC_NO"]);
                    $('#GSTDocDate').text(Response[0]["POSTING_DATE"]);
                    $('#GSTDocType').text(Response[0]["DOC_TYPE"]);
                    $('#GSTRefDocNumber').text(Response[0]["REF_DOC"]);
                    $('#GSTRefDocDate').text(Response[0]["REF_DATE"]);
                    $('#GSTInvoice').text(Response[0]["INVOICE"]);

                    $('#GSTDocNo_html').text(Response[0]["DOC_NO"]);
                    $('#GSTDocDate_html').text(Response[0]["POSTING_DATE"]);
                    $('#GSTDocType_html').text(Response[0]["DOC_TYPE"]);
                    $('#GSTRefDocNumber_html').text(Response[0]["REF_DOC"]);
                    $('#GSTRefDocDate_html').text(Response[0]["REF_DATE"]);
                    $('#GSTInvoice_html').text(Response[0]["INVOICE"]);

                    $('#GSTCustTINNo').text(Response[0]["CUST_TIN"]);
                    $('#GSTCustGSTNo').text(Response[0]["CUST_GST_NO"]);
                    $('#GSTCustPANNo').text(Response[0]["CUST_PAN_NO"]);
                    $('#GSTCustPhoneNo').text(Response[0]["CUST_PHONE"]);

                    $('#GSTCustTINNo_html').text(Response[0]["CUST_TIN"]);
                    $('#GSTCustGSTNo_html').text(Response[0]["CUST_GST_NO"]);
                    $('#GSTCustPANNo_html').text(Response[0]["CUST_PAN_NO"]);
                    $('#GSTCustPhoneNo_html').text(Response[0]["CUST_PHONE"]);


                    $('#GSTMAT_CODE').text(Response[0]["MAT_CODE"]);
                    $('#GSTMAT_TXT').text(Response[0]["MAT_TXT"]);
                    $('#GSTHSN_CODE').text(Response[0]["HSN_CODE"]);
                    $('#GSTQty').text(Response[0]["QNTY"]);

                    $('#GSTMAT_CODE_html').text(Response[0]["MAT_CODE"]);
                    $('#GSTMAT_TXT_html').text(Response[0]["MAT_TXT"]);
                    $('#GSTHSN_CODE_html').text(Response[0]["HSN_CODE"]);
                    $('#GSTQty_html').text(Response[0]["QNTY"]);

                    $('#GSTUnit').text(Response[0]["UNIT"]);
                    $('#GSTUNIT_RATE').text(Response[0]["UNIT_RATE"]);
                    $('#GSTBASE_AMOUNT').text(Response[0]["BASE_AMOUNT"]);
                    $('#GSTREMARKS').text(Response[0]["REMARKS"]);

                    $('#GSTUnit_html').text(Response[0]["UNIT"]);
                    $('#GSTUNIT_RATE_html').text(Response[0]["UNIT_RATE"]);
                    $('#GSTBASE_AMOUNT_html').text(Response[0]["BASE_AMOUNT"]);
                    $('#GSTREMARKS_html').text(Response[0]["REMARKS"]);

                    var GrssAmt = Response[0]["BASE_AMOUNT"];
                    var Amount = Response[0]["AMOUNT"];
                    var TDS = Response[0]["TAX_AMOUNT"];
                    var TotalAmount = (Amount == "" ? 0.00 : parseFloat(Amount).toFixed(2));
                    var CGST = Response[0]["CGST"];
                    var CGSTP = Response[0]["CGST_P"];
                    var SGST = Response[0]["SGST"];
                    var SGSTP = Response[0]["SGST_P"];
                    var IGST = Response[0]["IGST"];
                    var IGSTP = Response[0]["IGST_P"];

                    var TotalGST = parseFloat((CGST == "" || CGST === undefined) ? 0.00 : CGST) + parseFloat((SGST == "" || SGST === undefined) ? 0 : SGST) + parseFloat((IGST == "" || IGST === undefined) ? 0 : IGST);
                    $('#GSTGrossAmount').text((GrssAmt == "" || GrssAmt === undefined) ? 0.00 : GrssAmt.toFixed(2));
                    $('#GSTTDS').text((TDS == "" || TDS === undefined) ? 0.00 : TDS.toFixed(2));
                    $('#GSTCGST').text((CGST == "" || CGST === undefined) ? 0.00 : parseFloat(CGST).toFixed(2));
                    $('#GSTCGSTP').text((CGSTP == "" || CGSTP === undefined) ? 0.00 : parseFloat(CGSTP).toFixed(2));
                    $('#GSTSGST').text((SGST == "" || SGST === undefined) ? 0.00 : parseFloat(SGST).toFixed(2));
                    $('#GSTSGSTP').text((SGSTP == "" || SGSTP === undefined) ? 0.00 : parseFloat(SGSTP).toFixed(2));
                    $('#GSTIGST').text((IGST == "" || IGST === undefined) ? 0.00 : parseFloat(IGST).toFixed(2));
                    $('#GSTIGSTP').text((IGSTP == "" || IGSTP === undefined) ? 0.00 : parseFloat(IGSTP).toFixed(2));

                    $('#GSTGrossAmount_html').text((GrssAmt == "" || GrssAmt === undefined) ? 0.00 : GrssAmt.toFixed(2));
                    $('#GSTTDS_html').text((TDS == "" || TDS === undefined) ? 0.00 : TDS.toFixed(2));
                    $('#GSTCGST_html').text((CGST == "" || CGST === undefined) ? 0.00 : parseFloat(CGST).toFixed(2));
                    $('#GSTCGSTP_html').text((CGSTP == "" || CGSTP === undefined) ? 0.00 : parseFloat(CGSTP).toFixed(2));
                    $('#GSTSGST_html').text((SGST == "" || SGST === undefined) ? 0.00 : parseFloat(SGST).toFixed(2));
                    $('#GSTSGSTP_html').text((SGSTP == "" || SGSTP === undefined) ? 0.00 : parseFloat(SGSTP).toFixed(2));
                    $('#GSTIGST_html').text((IGST == "" || IGST === undefined) ? 0.00 : parseFloat(IGST).toFixed(2));
                    $('#GSTIGSTP_html').text((IGSTP == "" || IGSTP === undefined) ? 0.00 : parseFloat(IGSTP).toFixed(2));

                    $('#GSTCUSTOMERDETAILS').text(Response[0]["STOCKIST_ID"] + "-" + Response[0]["STOCKIST_NAME"]);
                    $('#GSTCUSTOMERADDRESSDETAILS').text(Response[0]["CustomerAddress"]);

                    $('#GSTCUSTOMERDETAILS_html').text(Response[0]["STOCKIST_ID"] + "-" + Response[0]["STOCKIST_NAME"]);
                    $('#GSTCUSTOMERADDRESSDETAILS_html').text(Response[0]["CustomerAddress"]);

                    $('#GSTTotalAmount').text(TotalAmount);
                    $('#GSTTaxInWords').text("Tax Amount in Words (SGST/CGST/IGST) : " + toWordsINVOICE(TotalGST.toFixed(2)));
                    $('#GSTTotalInWords').text("Total Amount in Words : " + toWordsINVOICE(TotalAmount));

                    $('#GSTTotalAmount_html').text(TotalAmount);
                    $('#GSTTaxInWords_html').text("Tax Amount in Words (SGST/CGST/IGST) : " + toWordsINVOICE(TotalGST.toFixed(2)));
                    $('#GSTTotalInWords_html').text("Total Amount in Words : " + toWordsINVOICE(TotalAmount));
                }
            });

        }



    }

});


//Invoice List
DIMS.controller('InvoiceListViewCtrl', function ($scope, $location, DIMSSAPFactory, DIMSFactory, $http, $compile) {

    $scope.templatesettings = { HeaderTitle: "Debit Notes" };
    MasterScope = $scope;
    $("#Invoice_List").show();
    $("#Invoice_Details").hide();

    $("#InvoiceListDiv").hide();
    $scope.go = function (path) {
        CheckUserSession();
        $location.path(path);
    };

    var width = $(window).width(), height = $(window).height();//---------

    var totalheight = height - 191;
    // var totalheight = height - 148;//--------    
    if (height <= 800) {
        totalheight = height - 148;
    }

    $('.content').css({ "max-height": totalheight, "overflow-y": "auto" });//-----------
    $('.content-header > h2').css({ "font-size": "18px", "font-weight": "500" });//----------
    $('.content').css({ "max-height": totalheight, "min-height": totalheight, "overflow-y": "auto" });//-----------

    //try {
    //    var CustomerArray = new Array(); var data_value = "";
    //    SessionValue = "STOCKIST";
    //    //var data_value = "{\"Role\":\"" + SessionValue + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
    //    if (SessionValue == "STOCKIST") { data_value = "{\"Role\":\"" + "STOCKIST" + "\",\"UserCode\":\"" + "1100225" + "\"}"; } else {
    //        data_value = "{\"Role\":\"" + "ACTSTMT" + "\",\"UserCode\":\"" + "50002033" + "\"}";
    //    }
    //    $http({ url: '../../SAP/GetCustomers', method: 'POST', data: { Data: data_value } }).success(function (res) {
    //        if (res != "") {
    //            var CustomerList = JSON.parse(res.tabledata);
    //            if (SessionValue == "STOCKIST") {
    //                $("#StockistID").attr("disabled", true); $("#StockistID").val(CustomerList[0]["STOCKIST_ID"] + " : " + CustomerList[0]["STOCKIST_NAME"]);
    //            } else {
    //                $("#StockistID").disabled = false;
    //                for (var i = 0; i < CustomerList.length; i++) {
    //                    CustomerArray.push(CustomerList[i]["STOCKIST_ID"] + " : " + CustomerList[i]["STOCKIST_NAME"])
    //                }
    //                $("#StockistID").typeahead({
    //                    source: CustomerArray
    //                });
    //            }
    //        }
    //    });

    //    $scope.GetCust_Name = function () {
    //        if ($("#StockistID").val() != "Select_Customer_Code") {
    //            var Data = "{\"Role\":\"" + "ADMIN" + "\",\"Cust_Code\":\"" + $("#StockistID").val() + "\"}";
    //            $http({ url: '../../SAP/GetCustomer_Name', method: 'POST', data: { Data: Data } }).success(function (resp) {
    //                var data = JSON.parse(resp.tabledata);
    //                //$("#StockistName").val("abc");
    //                $("#StockistName").text(data[0]["STOCKIST_NAME"]);
    //            }).error(function (err) { alert("Error : " + err); });
    //        }

    //    }
    //} catch (ex) { }


    try {
        //$('#StockistName').SumoSelect({ placeholder: 'Customer Name' });
        //   $('#StockistID').SumoSelect({ placeholder: 'Customer Code' });
        $('#SalesEmapName').SumoSelect({ placeholder: 'Sales Employee' });
        $('#PlantSumo').SumoSelect({ placeholder: 'Plant' });
        $('#Zone').SumoSelect({ placeholder: 'Zone' });
        $('#State').SumoSelect({ placeholder: 'State' });
        $('#TerriotryArea').SumoSelect({ placeholder: 'Territory/Area' });
        $('#Location').SumoSelect({ placeholder: 'Location' });
        var Data = JSON.stringify({
            ID: "",
            UserCode: "",
            UserRoleType: "",
            ReportName: "InvoiceList"
        });
        DIMSFactory.getReportListColumnNamesData(Data).success(function (response) {
            var Result = JSON.parse(response.tabledata);

            if (Result != "") {
                $scope.UserDefaultListColumnNames = Result["UserDefaultListColumnNames"];
                if (Result.hasOwnProperty('UserListColumnNames')) {
                    var data1 = JSON.parse(Result["UserListColumnNames"]);

                    var selectedcolumnname = data1["ColumnNames"];

                    CustomColumnID = Result["UserListID"];
                    $('#undo_redo_to').empty();
                    var ColArray = new Array();
                    for (var i = 0; i < selectedcolumnname.length; i++) {
                        ColArray.push({
                            "data": selectedcolumnname[i],
                            "name": selectedcolumnname[i], "bSortable": true
                        });
                        $("#undo_redo_to").append($("<option></option>").val(selectedcolumnname[i]).html(selectedcolumnname[i]));
                    }
                    //$scope.UserSelectedColumnName = ColArray;
                    UserSelectedColumnName = ColArray;
                } else {

                    var data1 = JSON.parse(Result["UserDefaultListColumnNames"]);

                    var selectedcolumnname = data1["ColumnNames"];

                    CustomColumnID = "0";

                    $('#undo_redo_to').empty();
                    var ColArray = new Array();
                    for (var i = 0; i < selectedcolumnname.length; i++) {
                        ColArray.push({
                            "data": selectedcolumnname[i],
                            "name": selectedcolumnname[i],
                            "bSortable": "true"
                        });
                        $("#undo_redo_to").append($("<option></option>").val(selectedcolumnname[i]).html(selectedcolumnname[i]));
                    }
                    //$scope.UserSelectedColumnName = ColArray;
                    UserSelectedColumnName = ColArray;
                }



            }

        });


        var data_value = ""; var all_zones = ""; var all_states = ""; var all_territories = ""; var all_customers = ""; var CustomerArray = new Array();
        ShowLoader();
        if ((SessionValue == "ZH") || (SessionValue == "RCC") || (SessionValue == "ZSC")) {
            $("#Zone").attr("disabled", false); $("#State").attr("disabled", false); $("#TerriotryArea").attr("disabled", false); $('#CustomerCode').attr("disabled", false);// $("#StockistID").attr("disabled", false);
            //data_value = "{\"Role\":\"" + "ZH" + "\",\"UserCode\":\"" + "50001762" + "\"}";
            data_value = "{\"Role\":\"" + "ZH" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
            $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
                var FilterList = JSON.parse(res);
                all_zones = "";
                for (var i = 0; i < FilterList.dtZone.length; i++) {
                    $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
                    if (FilterList.dtZone.length == 0) {
                        all_zones = "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                    } else if (i == FilterList.dtZone.length - 1) {
                        all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                    } else {
                        all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'" + ',';
                    }
                }

                $('select#Zone')[0].sumo.selectItem(0);
                $('#Zone').trigger("change");

                //all_states = "";
                //for (var i = 0; i < FilterList.dtState.length; i++) {
                //    if (FilterList.dtState.length == 0) {
                //        all_states = "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //    } else if (i == FilterList.dtState.length - 1) {
                //        all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //    } else {
                //        all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'" + ',';
                //    }
                //}
                //all_territories = "";
                //for (var i = 0; i < FilterList.dtTerritory.length; i++) {
                //    if (FilterList.dtTerritory.length == 0) {
                //        all_territories = "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                //    } else if (i == FilterList.dtTerritory.length - 1) {
                //        all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                //    } else {
                //        all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'" + ',';
                //    }
                //}
                //all_customers = "";
                //for (var i = 0; i < FilterList.dtCustomer.length; i++) {
                //$('#StockistID')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
                //$('#StockistName')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
                //if (FilterList.dtCustomer.length == 0) {
                //    all_customers = "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
                //} else if (i == FilterList.dtCustomer.length - 1) {
                //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
                //} else {
                //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'" + ',';
                //}
                //}
            });
        } else if (SessionValue == "SH") {
            $("#Zone").attr("disabled", true); $("#State").attr("disabled", false); $("#TerriotryArea").attr("disabled", false); $('#CustomerCode').attr("disabled", false);// $("#StockistID").attr("disabled", false);
            //data_value = "{\"Role\":\"" + "SH" + "\",\"UserCode\":\"" + "50002430" + "\"}";
            data_value = "{\"Role\":\"" + "SH" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
            $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
                var FilterList = JSON.parse(res);
                //all_zones = "";
                for (var i = 0; i < FilterList.dtZone.length; i++) {
                    $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
                    //if (FilterList.dtZone.length == 0) {
                    //    all_zones = "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                    //} else if (i == FilterList.dtZone.length - 1) {
                    //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                    //} else {
                    //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'" + ',';
                    //}
                }
                $('select#Zone')[0].sumo.selectItem(0);
                //all_states = "";
                for (var i = 0; i < FilterList.dtState.length; i++) {
                    $('#State')[0].sumo.add(FilterList.dtState[i]["STATE_CODE"], FilterList.dtState[i]["STATE_NAME"]);
                    //if (FilterList.dtState.length == 0) {
                    //    all_states = "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                    //} else if (i == FilterList.dtState.length - 1) {
                    //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                    //} else {
                    //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'" + ',';
                    //}
                }

                $('select#State')[0].sumo.selectItem(0);
                $('#State').trigger("change");
                //all_territories = "";
                //for (var i = 0; i < FilterList.dtTerritory.length; i++) {
                //    if (FilterList.dtTerritory.length == 0) {
                //        all_territories = "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                //    } else if (i == FilterList.dtTerritory.length - 1) {
                //        all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                //    } else {
                //        all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'" + ',';
                //    }
                //}
                //all_customers = "";
                //for (var i = 0; i < FilterList.dtCustomer.length; i++) {
                // $('#StockistID')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
                //$('#StockistName')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
                //if (FilterList.dtCustomer.length == 0) {
                //    all_customers = "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
                //} else if (i == FilterList.dtCustomer.length - 1) {
                //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
                //} else {
                //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'" + ',';
                //}
                // }
            });
        }

        else if (SessionValue == "TM") {
            $("#Zone").attr("disabled", true); $("#State").attr("disabled", true); $("#TerriotryArea").attr("disabled", false); $('#CustomerCode').attr("disabled", false); //$("#StockistID").attr("disabled", false);
            //data_value = "{\"Role\":\"" + "TM" + "\",\"UserCode\":\"" + "50001144" + "\"}";
            data_value = "{\"Role\":\"" + "TM" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
            $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
                var FilterList = JSON.parse(res);
                //all_zones = "";
                for (var i = 0; i < FilterList.dtZone.length; i++) {
                    $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
                    //if (FilterList.dtZone.length == 0) {
                    //    all_zones = "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                    //} else if (i == FilterList.dtZone.length - 1) {
                    //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                    //} else {
                    //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'" + ',';
                    //}
                }
                $('select#Zone')[0].sumo.selectItem(0);
                //all_states = "";
                for (var i = 0; i < FilterList.dtState.length; i++) {
                    $('#State')[0].sumo.add(FilterList.dtState[i]["STATE_CODE"], FilterList.dtState[i]["STATE_NAME"]);
                    //if (FilterList.dtState.length == 0) {
                    //    all_states = "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                    //} else if (i == FilterList.dtState.length - 1) {
                    //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                    //} else {
                    //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'" + ',';
                    //}
                }
                $('select#State')[0].sumo.selectItem(0);
                //all_territories = "";
                for (var i = 0; i < FilterList.dtTerritory.length; i++) {
                    $('#TerriotryArea')[0].sumo.add(FilterList.dtTerritory[i]["TERRITORY_CODE"], FilterList.dtTerritory[i]["TERRITORY_NAME"]);
                    //if (FilterList.dtTerritory.length == 0) {
                    //    all_territories = "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                    //} else if (i == FilterList.dtTerritory.length - 1) {
                    //    all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                    //} else {
                    //    all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'" + ',';
                    //}
                }
                //all_customers = "";
                // for (var i = 0; i < FilterList.dtCustomer.length; i++) {
                // $('#StockistID')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
                //$('#StockistName')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
                //if (FilterList.dtCustomer.length == 0) {
                //    all_customers = "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
                //} else if (i == FilterList.dtCustomer.length - 1) {
                //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
                //} else {
                //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'" + ',';
                //}
                //}
            });
        }

        else if (SessionValue == "FSO" || SessionValue == "FSO_BU2") {
            $("#Zone").attr("disabled", true); $("#State").attr("disabled", true); $("#TerriotryArea").attr("disabled", false); $('#CustomerCode').attr("disabled", false);// $("#StockistID").attr("disabled", false);
            //data_value = "{\"Role\":\"" + "FSO" + "\",\"UserCode\":\"" + "50001906" + "\"}";
            if (SessionValue == "FSO") {
                data_value = "{\"Role\":\"" + "FSO" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
            } else {
                data_value = "{\"Role\":\"" + "FSO_BU2" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
            }
            $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
                var FilterList = JSON.parse(res);
                //all_zones = "";
                for (var i = 0; i < FilterList.dtZone.length; i++) {
                    $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
                    //if (FilterList.dtZone.length == 0) {
                    //    all_zones = "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                    //} else if (i == FilterList.dtZone.length - 1) {
                    //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                    //} else {
                    //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'" + ',';
                    //}
                }
                $('select#Zone')[0].sumo.selectItem(0);
                //all_states = "";
                for (var i = 0; i < FilterList.dtState.length; i++) {
                    $('#State')[0].sumo.add(FilterList.dtState[i]["STATE_CODE"], FilterList.dtState[i]["STATE_NAME"]);
                    //if (FilterList.dtState.length == 0) {
                    //    all_states = "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                    //} else if (i == FilterList.dtState.length - 1) {
                    //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                    //} else {
                    //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'" + ',';
                    //}
                }
                $('select#State')[0].sumo.selectItem(0);
                //all_territories = "";
                for (var i = 0; i < FilterList.dtTerritory.length; i++) {
                    $('#TerriotryArea')[0].sumo.add(FilterList.dtTerritory[i]["TERRITORY_CODE"], FilterList.dtTerritory[i]["TERRITORY_NAME"]);
                    //if (FilterList.dtTerritory.length == 0) {
                    //    all_territories = "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                    //} else if (i == FilterList.dtTerritory.length - 1) {
                    //    all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                    //} else {
                    //    all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'" + ',';
                    //}
                }
                $('select#TerriotryArea')[0].sumo.selectItem(0);
                $('#TerriotryArea').trigger("change");
                //all_customers = "";
                //for (var i = 0; i < FilterList.dtCustomer.length; i++) {
                // $('#StockistID')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
                //$('#StockistName')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
                //if (FilterList.dtCustomer.length == 0) {
                //    all_customers = "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
                //} else if (i == FilterList.dtCustomer.length - 1) {
                //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
                //} else {
                //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'" + ',';
                //}
                // }
            });
        }

        else if ((SessionValue == "STOCKIST") || (SessionValue == "C&F")) {
            $("#Zone").attr("disabled", true); $("#State").attr("disabled", true); $("#TerriotryArea").attr("disabled", true); $('#CustomerCode').attr("disabled", true); $('#CustomerCode').css({ "class": "gray" }); //$("#StockistID").attr("disabled", true);
            //data_value = "{\"Role\":\"" + "STOCKIST" + "\",\"UserCode\":\"" + "1100002" + "\"}";
            data_value = "{\"Role\":\"" + "STOCKIST" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
            $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
                var FilterList = JSON.parse(res);
                //all_zones = "";
                for (var i = 0; i < FilterList.dtZone.length; i++) {
                    $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
                    //if (FilterList.dtZone.length == 0) {
                    //    all_zones = "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                    //} else if (i == FilterList.dtZone.length - 1) {
                    //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                    //} else {
                    //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'" + ',';
                    //}
                }
                if (FilterList.dtZone.length > 0)
                    $('select#Zone')[0].sumo.selectItem(0);
                //all_states = "";
                for (var i = 0; i < FilterList.dtState.length; i++) {
                    $('#State')[0].sumo.add(FilterList.dtState[i]["STATE_CODE"], FilterList.dtState[i]["STATE_NAME"]);
                    //if (FilterList.dtState.length == 0) {
                    //    all_states = "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                    //} else if (i == FilterList.dtState.length - 1) {
                    //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                    //} else {
                    //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'" + ',';
                    //}
                }
                if (FilterList.dtState.length > 0)
                    $('select#State')[0].sumo.selectItem(0);
                //all_territories = "";
                for (var i = 0; i < FilterList.dtTerritory.length; i++) {
                    $('#TerriotryArea')[0].sumo.add(FilterList.dtTerritory[i]["TERRITORY_CODE"], FilterList.dtTerritory[i]["TERRITORY_NAME"]);
                    //if (FilterList.dtTerritory.length == 0) {
                    //    all_territories = "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                    //} else if (i == FilterList.dtTerritory.length - 1) {
                    //    all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                    //} else {
                    //    all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'" + ',';
                    //}
                }
                if (FilterList.dtTerritory.length > 0)
                    $('select#TerriotryArea')[0].sumo.selectItem(0);
                //all_customers = "";
                for (var i = 0; i < FilterList.dtCustomer.length; i++) {
                    // $('#StockistID')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
                    CustomerArray.push(FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
                    $('#CustomerCode').val(FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
                    //$('#StockistName')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
                    //if (FilterList.dtCustomer.length == 0) {
                    //    all_customers = "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
                    //} else if (i == FilterList.dtCustomer.length - 1) {
                    //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
                    //} else {
                    //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'" + ',';
                    //}
                }
                //  $('select#StockistID')[0].sumo.selectItem(0);
            });
        } else {
            $("#Zone").attr("disabled", false); $("#State").attr("disabled", false); $("#TerriotryArea").attr("disabled", false); $('#CustomerCode').attr("disabled", false); //$("#StockistID").attr("disabled", false);
            //data_value = "{\"Role\":\"" + "ADMIN" + "\",\"UserCode\":\"" + "50001657" + "\"}";
            data_value = "{\"Role\":\"" + SessionValue + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
            $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
                var FilterList = JSON.parse(res);
                all_zones = "";
                for (var i = 0; i < FilterList.dtZone.length; i++) {
                    $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
                    if (FilterList.dtZone.length == 0) {
                        all_zones = "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                    } else if (i == FilterList.dtZone.length - 1) {
                        all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                    } else {
                        all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'" + ',';
                    }
                }
                CustomerArray.length = 0;
                $("#CustomerCode").val("");
                if (FilterList.dtCustomer.length > 0) {
                    for (var i = 0; i < FilterList.dtCustomer.length; i++) {
                        CustomerArray.push(FilterList.dtCustomer[i]["STOCKIST_ID"].toString() + ":" + FilterList.dtCustomer[i]["STOCKIST_NAME"].toString());
                    }
                }
                //all_states = "";
                //for (var i = 0; i < FilterList.dtState.length; i++) {
                //    if (FilterList.dtState.length == 0) {
                //        all_states = "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //    } else if (i == FilterList.dtState.length - 1) {
                //        all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //    } else {
                //        all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'" + ',';
                //    }
                //}
                //all_territories = "";
                //for (var i = 0; i < FilterList.dtTerritory.length; i++) {
                //    if (FilterList.dtTerritory.length == 0) {
                //        all_territories = "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                //    } else if (i == FilterList.dtTerritory.length - 1) {
                //        all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                //    } else {
                //        all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'" + ',';
                //    }
                //}
                //all_customers = "";
                //for (var i = 0; i < FilterList.dtCustomer.length; i++) {
                //$('#StockistID')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
                //$('#StockistName')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
                //if (FilterList.dtCustomer.length == 0) {
                //    all_customers = "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
                //} else if (i == FilterList.dtCustomer.length - 1) {
                //   all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
                //} else {
                //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'" + ',';
                //}
                //}
            });
        }
        HideLoader();
        $('#Zone').on('keyup change', function () {
            ShowLoader();
            var Clear_State = $('#State option').length;
            for (var i = 0; i < Clear_State; i++) {
                $('#State')[0].sumo.remove(0);
            }

            // var Clear_Cust = $('#StockistID option').length;
            // for (var i = 0; i < Clear_Cust; i++) {
            //     $('#StockistID')[0].sumo.remove(0);
            //  }
            CustomerArray.length = 0;
            $("#CustomerCode").val("");
            var Clear_Terrytory = $('#TerriotryArea option').length;
            for (var i = 0; i < Clear_Terrytory; i++) {
                $('#TerriotryArea')[0].sumo.remove(0);
            }

            var data_value = "{\"Zone_Code\":\"" + $("#Zone").val() + "\"}";
            $http({ url: '../../Home/GetStatesforZone', method: 'POST', data: { Data: data_value } }).success(function (res) {
                if (res != "") {
                    var dtState = JSON.parse(res);
                    for (var i = 0; i < dtState.length; i++) {
                        $('#State')[0].sumo.add(dtState[i]["STATE_CODE"], dtState[i]["STATE_NAME"]);
                    }
                    // HideLoader();
                } else {
                    // HideLoader();
                }

                $http({ url: '../../Home/GetCustomersforZone', method: 'POST', data: { Data: data_value } }).success(function (Cust_res) {
                    if (Cust_res != "") {
                        var dtCust = JSON.parse(Cust_res);
                        for (var i = 0; i < dtCust.length; i++) {
                            //  $('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"].toString(), dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                            CustomerArray.push(dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                        }
                    }
                });
            });
            HideLoader();
        });

        var SelectedState = ""; var Actual_SelectedState = ""; var Actual_SelectedTerritory = "";
        $('#State').on('keyup change', function () {
            ShowLoader();
            Actual_SelectedState = "";
            var Clear_Territory = $('#TerriotryArea option').length;
            for (var i = 0; i < Clear_Territory; i++) {
                $('#TerriotryArea')[0].sumo.remove(0);
            }
            // var Clear_Cust = $('#StockistID option').length;
            //   for (var i = 0; i < Clear_Cust; i++) {
            //      $('#StockistID')[0].sumo.remove(0);
            //  }
            CustomerArray.length = 0;
            $("#CustomerCode").val("");
            if ($('#State').val() != null) {
                var seleState = $('#State').val();

                for (var k = 0; k < seleState.length; k++) {
                    SelectedState += "'" + seleState[k] + "',";
                    Actual_SelectedState += "'" + seleState[k] + "',";
                }
                SelectedState = SelectedState.substring(',', SelectedState.length - 1);//Selected States with ' '. 
                Actual_SelectedState = Actual_SelectedState.substring(',', Actual_SelectedState.length - 1);//Selected States with ' '. 
            }

            var data_value = "{\"State_Code\":\"" + SelectedState + "\"}";
            $http({ url: '../../Home/GetTerritoriesforState', method: 'POST', data: { Data: data_value } }).success(function (res) {
                if (res != "") {
                    var dtTerritory = JSON.parse(res);
                    for (var i = 0; i < dtTerritory.length; i++) {
                        $('#TerriotryArea')[0].sumo.add(dtTerritory[i]["TERRITORY_CODE"], dtTerritory[i]["TERRITORY_NAME"]);
                    }
                }
                $http({ url: '../../Home/GetCustomersforState', method: 'POST', data: { Data: data_value } }).success(function (res) {
                    if (res != "") {
                        var dtCust = JSON.parse(res);
                        for (var i = 0; i < dtCust.length; i++) {
                            //  $('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"].toString(), dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                            //$('#StockistName')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"].toString(), dtCust[i]["CUSTOMER_NAME"].toString());
                            CustomerArray.push(dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                        }
                        HideLoader();
                    } else {
                        HideLoader();
                    }
                });
            });

            if ($("#State").val() == null) {
                var data_value = "{\"Zone_Code\":\"" + $("#Zone").val() + "\"}";
                if ((SessionValue != "SH") && (SessionValue != "TM") && (SessionValue != "FSO") && (SessionValue != "FSO_BU2") && (SessionValue != "STOCKIST") && (SessionValue != "C&F")) {
                    $http({ url: '../../Home/GetCustomersforZone', method: 'POST', data: { Data: data_value } }).success(function (Cust_res) {
                        if (Cust_res != "") {
                            var dtCust = JSON.parse(Cust_res);
                            for (var i = 0; i < dtCust.length; i++) {
                                //  $('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"].toString(), dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                                CustomerArray.push(dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                            }
                            HideLoader();
                        } else {
                            HideLoader();
                        }
                    });
                }
                HideLoader();
            }
            SelectedState = "";
            //HideLoader();
        });

        var SelectedTerritory = "";
        $('#TerriotryArea').on('keyup change', function () {
            ShowLoader();
            Actual_SelectedTerritory = ""; Actual_SelectedState = "";
            if ((SessionValue == "TM") || (SessionValue == "FSO") || (SessionValue == "FSO_BU2")) {
                if ($("#TerriotryArea").val() == null) {
                    //  var Clear_Cust = $('#StockistID option').length;
                    CustomerArray.length = 0;
                    $("#CustomerCode").val("");
                    //for (var i = 0; i < Clear_Cust; i++) {
                    //     $('#StockistID')[0].sumo.remove(0);
                    //   }
                    HideLoader();
                } else if ($("#TerriotryArea").val() != null) {
                    var seleTerritory = $('#TerriotryArea').val();
                    for (var k = 0; k < seleTerritory.length; k++) {
                        SelectedTerritory += "'" + seleTerritory[k] + "',";
                        Actual_SelectedTerritory += "'" + seleTerritory[k] + "',";
                    }
                    SelectedTerritory = SelectedTerritory.substring(',', SelectedTerritory.length - 1);//Selected Territories with ' '. 
                    Actual_SelectedTerritory = Actual_SelectedTerritory.substring(',', Actual_SelectedTerritory.length - 1);//Selected Territories with ' '. 

                    var data_value = "{\"Territory_Code\":\"" + SelectedTerritory + "\"}";
                    $http({ url: '../../Home/GetCustomersforTerritory', method: 'POST', data: { Data: data_value } }).success(function (res) {
                        if (res != "") {
                            var dtCust = JSON.parse(res);
                            for (var i = 0; i < dtCust.length; i++) {
                                //  $('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"], dtCust[i]["CUSTOMER_CODE"] + ":" + dtCust[i]["CUSTOMER_NAME"]);
                                CustomerArray.push(dtCust[i]["CUSTOMER_CODE"] + ":" + dtCust[i]["CUSTOMER_NAME"]);
                            }
                            HideLoader();
                        } else { HideLoader(); }
                    });

                }
            } else {
                CustomerArray.length = 0;
                $("#CustomerCode").val("");
                // var Clear_Cust = $('#StockistID option').length;
                //  for (var i = 0; i < Clear_Cust; i++) {
                //      $('#StockistID')[0].sumo.remove(0);
                //  }


                if ($('#TerriotryArea').val() != null) {
                    var seleTerritory = $('#TerriotryArea').val();
                    for (var k = 0; k < seleTerritory.length; k++) {
                        SelectedTerritory += "'" + seleTerritory[k] + "',";
                        Actual_SelectedTerritory += "'" + seleTerritory[k] + "',";
                    }
                    SelectedTerritory = SelectedTerritory.substring(',', SelectedTerritory.length - 1);//Selected Territories with ' '. 
                    Actual_SelectedTerritory = Actual_SelectedTerritory.substring(',', Actual_SelectedTerritory.length - 1);//Selected Territories with ' '. 
                }
                if ($("#TerriotryArea").val() == null) {
                    var seleState = $('#State').val();

                    for (var k = 0; k < seleState.length; k++) {
                        SelectedState += "'" + seleState[k] + "',";
                        Actual_SelectedState += "'" + seleState[k] + "',";
                    }
                    SelectedState = SelectedState.substring(',', SelectedState.length - 1);//Selected States with ' '. 
                    Actual_SelectedState = Actual_SelectedState.substring(',', Actual_SelectedState.length - 1);//Selected States with ' '. 

                    var data_value = "{\"State_Code\":\"" + SelectedState + "\"}";
                    $http({ url: '../../Home/GetCustomersforState', method: 'POST', data: { Data: data_value } }).success(function (res) {
                        if (res != "") {
                            var dtCust = JSON.parse(res);
                            for (var i = 0; i < dtCust.length; i++) {
                                //  $('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"].toString(), dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                                CustomerArray.push(dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                            }
                            HideLoader();
                        } else {
                            HideLoader();
                        }
                    });

                } else {
                    var data_value = "{\"Territory_Code\":\"" + SelectedTerritory + "\"}";
                    $http({ url: '../../Home/GetCustomersforTerritory', method: 'POST', data: { Data: data_value } }).success(function (res) {
                        if (res != "") {
                            var dtCust = JSON.parse(res);
                            for (var i = 0; i < dtCust.length; i++) {
                                // $('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"], dtCust[i]["CUSTOMER_CODE"] + ":" + dtCust[i]["CUSTOMER_NAME"]);
                                CustomerArray.push(dtCust[i]["CUSTOMER_CODE"] + ":" + dtCust[i]["CUSTOMER_NAME"]);
                            }
                            HideLoader();
                        } else { HideLoader(); }
                    });

                }
            }
            SelectedTerritory = "";
            SelectedState = "";
        });
        $("#CustomerCode").typeahead({
            source: CustomerArray
        });
        $scope.GetData = function () {
            var isValidCustCode = isValidCode_Cust($("#CustomerCode").val(), CustomerArray);
            if (($("#OrderFromDate").val() != "") && ($("#OrderToDate").val() != "")) {
                if ((SessionValue == "ZH")) {
                    if ($("#Zone").val() == null) { alert("Please Select Your Zone"); }
                    else if ((isValidCustCode == false) && ($("#CustomerCode").val() != "")) {
                        alert("please select proper customer code");
                    } else {
                        GetInvoiceData();
                    }
                } else if (SessionValue == "SH") {
                    if ($("#State").val() == null) { alert("Please Select Your State"); }
                    else if ((isValidCustCode == false) && ($("#CustomerCode").val() != "")) {
                        alert("please select proper customer code");
                    } else {
                        GetInvoiceData();
                    }
                } else if (SessionValue == "TM") {
                    if ($("#TerriotryArea").val() == null) { alert("Please Select Your Sales Group"); }
                    else if ((isValidCustCode == false) && ($("#CustomerCode").val() != "")) {
                        alert("please select proper customer code");
                    } else {
                        GetInvoiceData();
                    }
                }
                else if (SessionValue == "FSO" || SessionValue == "FSO_BU2") {
                    if ($("#TerriotryArea").val() == null) { alert("Please Select Your Sales Group"); }
                    else if ((isValidCustCode == false) && ($("#CustomerCode").val() != "")) {
                        alert("please select proper customer code");
                    } else {
                        GetInvoiceData();
                    }
                }
                else {
                    if ((isValidCustCode == false) && ($("#CustomerCode").val() != "")) {
                        alert("please select proper customer code");
                    } else {
                        if ($("#State").val() != null)
                            Actual_SelectedState = "'" + $("#State").val() + "'";
                        GetInvoiceData();
                    }
                }
            } else { alert("Please Select From Date and To Date"); }
        }

        function GetInvoiceData() {

            ShowLoader();
            var DateRange = DateSplitter('OrderFromDate', 'OrderToDate');
            try {
                var WhereClause = "where (DATE between " + DateRange + ")";
                if ($("#SessionRole").val() == "STOCKIST") {
                    WhereClause += " and SOLD_TO_PARTY_NO = " + $("#UserCode").val();
                }
                else if ($("#CustomerCode").val() != "") {
                    WhereClause += " and SOLD_TO_PARTY_NO IN (" + $("#CustomerCode").val().split(':')[0] + ")";

                    //if (isValidCustCode == false) {
                    //    alert("please select proper customer code");
                    //} else {
                    //    WhereClause += " and SOLD_TO_PARTY_NO IN (" + $("#CustomerCode").val().split(':')[0] + ")";
                    //}
                } else if ($("#TerriotryArea").val() != null) {
                    WhereClause += " and SOLD_TO_PARTY_NO IN (select DISTINCT ecc.CUSTOMER_CODE from cms_employee_customer_configuration ecc inner join CUSTOMER_SALES_VIEW csv on CAST(ecc.CUSTOMER_CODE AS BIGINT)=CAST(csv.cust_code AS BIGINT) where ecc.ORG_LEVEL_ID IN(" + Actual_SelectedTerritory + "))";
                } else if ($("#State").val() != null) {
                    WhereClause += " and State IN(" + Actual_SelectedState + ")";
                }
                else if ($("#Zone").val() != null) {
                    WhereClause += " and ZONE IN(" + $("#Zone").val() + ")";
                }
                if (($("#Zone").val() == null) && ($("#State").val() == null) && ($("#TerriotryArea").val() == null) && ($("#CustomerCode").val() == "")) {
                    WhereClause += "";
                }

                var sheet = $("#Sheets").val();

                //Edited By Manikanta

                if (sheet != "select") {
                    WhereClause += " and SOLD_TO_PARTY_NO IN (select STOCKIST_ID from sap_customer_sales_master where DIVISION='" + sheet + "')";
                }


                WhereClause += " order by DOC_NO,ITEM ASC";




                //HideLoader();
                //else if ($("#Zone").val() == null) {
                //    WhereClause += " and CAST(IH.BILL_TO_PARTY_NO AS BIGINT) IN (SELECT CAST(CUST_CODE AS BIGINT) FROM CUSTOMER_SALES_VIEW WHERE ZONE IN(" + all_zones + "))";
                //}
                //if ($("#State").val() != null) {
                //    WhereClause += " and CAST(IH.BILL_TO_PARTY_NO AS BIGINT) IN (SELECT CAST(CUST_CODE AS BIGINT) FROM CUSTOMER_SALES_VIEW WHERE STATE IN(" + $("#State").val() + "))";
                //} else if ($("#State").val() == null) {
                //    WhereClause += " and CAST(IH.BILL_TO_PARTY_NO AS BIGINT) IN (SELECT CAST(CUST_CODE AS BIGINT) FROM CUSTOMER_SALES_VIEW WHERE STATE IN(" + all_states + "))";
                //}
                //if ($("#TerriotryArea").val() != null) {
                //    WhereClause += " and CAST(IH.BILL_TO_PARTY_NO AS BIGINT) IN (SELECT CAST(CUST_CODE AS BIGINT) FROM CUSTOMER_SALES_VIEW WHERE Tert_Code IN(" + $("#TerriotryArea").val() + "))";
                //} else if ($("#TerriotryArea").val() == null) {
                //    WhereClause += " and CAST(IH.BILL_TO_PARTY_NO AS BIGINT) IN (SELECT CAST(CUST_CODE AS BIGINT) FROM CUSTOMER_SALES_VIEW WHERE Tert_Code IN(" + all_territories + "))";
                //}
                //if ($("#StockistID").val() != null) {
                //    WhereClause += " and CAST(IH.BILL_TO_PARTY_NO AS BIGINT) IN (" + $("#StockistID").val() + ")";
                //} else if ($("#StockistID").val() == null) {
                //    WhereClause += " and CAST(IH.BILL_TO_PARTY_NO AS BIGINT) IN (SELECT CAST(CUST_CODE AS BIGINT) FROM CUSTOMER_SALES_VIEW WHERE CAST(CUST_CODE AS BIGINT) IN(" + all_customers + "))";
                //}
                var Data = JSON.stringify({
                    MasterType: "InvoiceList",
                    ID: "561",
                    UserCode: $("#UserCode").val(),
                    "Type": "Get",
                    ReportName: "InvoiceList",
                    WhereClause: WhereClause
                });
                //ShowLoader();
                DIMSFactory.getReportData(Data).success(function (response) {
                    //HideLoader();
                    getLookUpData_Reports_ServerSideBinding("", "EnrollmentNodataLabel", "", "tbl_InvoiceList", UserSelectedColumnName);
                    $("#InvoiceListDiv").show();

                    $('#tbl_InvoiceList tbody').on('click', 'tr', function () {
                        ShowLoader();
                        var ID = $(this).find('td:eq(0)').text();
                        var Inv_Type = $(this).find('td:eq(1)').text();
                        var Plant_Code = $(this).find('td:eq(8)').text();
                        var Inv_Date = $(this).find('td:eq(2)').text();
                        if (ID != "") {

                            var encryptedID = CryptoJS.AES.encrypt(ID, "Secret Passphrase");
                            var decrypted12 = CryptoJS.AES.decrypt(encryptedID, "Secret Passphrase");
                            var decryptedasd = decrypted12.toString(CryptoJS.enc.Utf8);

                            var scope = angular.element($("#InvoiceListDiv")).scope();
                            scope.$apply(function () {
                                //If the Invoice type is ‘ZINV’ and Plant Code is greater than or equal to 3000 then from the invoice list page, 
                                //it will redirect to ‘ZINV_Depo Invoice view’
                                //else it will redirect to ‘ZINV_Plant Invoice view’



                                var tempdate = Inv_Date.split('/');
                                Inv_Date = tempdate[2] + '-' + tempdate[1] + '-' + tempdate[0];


                                if (Date.parse(Inv_Date) >= Date.parse('2017-07-01')) {
                                    if (Inv_Type == "ZINV") {
                                        HideLoader();
                                        if (parseInt(Plant_Code) >= 3000) {

                                            scope.go("InvoiceDetail_ZINV_Plant_GST/" + ID);


                                        } else {

                                            scope.go("InvoiceDetail_ZINV_Plant_GST/" + ID);


                                        }
                                    }
                                    else if (Inv_Type == "ZFOC") {
                                        HideLoader();
                                        if (parseInt(Plant_Code) >= 3000) {
                                            scope.go("InvoiceDetail_ZFOC_Plant_GST/" + ID);
                                        } else {

                                            scope.go("InvoiceDetail_ZFOC_Plant_GST/" + ID);
                                        }
                                    }
                                }
                                else {
                                    if (Inv_Type == "ZINV") {
                                        HideLoader();
                                        if (parseInt(Plant_Code) >= 3000) {
                                            //alert(encryptedID);
                                            scope.go("InvoiceDetail_ZINV_Depo/" + ID);
                                        } else {

                                            scope.go("InvoiceDetail_ZINV_Plant/" + ID);
                                        }
                                    }
                                        //If the Invoice type is ‘ZFOC’ and Plant Code is greater than or equal to 3000 then from the invoice list page, 
                                        //it will redirect to ‘ZFOC_Depo Invoice view’
                                        //else it will redirect to ‘ZFOC_Plant Invoice view’
                                    else if (Inv_Type == "ZFOC") {
                                        HideLoader();
                                        if (parseInt(Plant_Code) >= 3000) {
                                            scope.go("InvoiceDetail_ZFOC_Depo/" + ID);
                                        } else {

                                            scope.go("InvoiceDetail_ZFOC_Plant/" + ID);
                                        }
                                    }
                                }






                            })
                        }

                        if ($(this).hasClass('selected')) {
                            $(this).removeClass('selected');
                        }
                        else {
                            $('tr.selected').removeClass('selected');
                            $(this).addClass('selected');
                        }
                    });
                });
                var WhereClause1 = "where (DATE between " + DateRange + ")";
                if ($("#CustomerCode").val() != "") {
                    WhereClause1 += " and SOLD_TO_PARTY_NO IN (" + $("#CustomerCode").val().split(':')[0] + ")";

                    //if (isValidCustCode == false) {
                    //    alert("please select proper customer code");
                    //} else {
                    //    WhereClause += " and SOLD_TO_PARTY_NO IN (" + $("#CustomerCode").val().split(':')[0] + ")";
                    //}
                } else if ($("#TerriotryArea").val() != null) {
                    WhereClause1 += " and SOLD_TO_PARTY_NO IN (select DISTINCT ecc.CUSTOMER_CODE from cms_employee_customer_configuration ecc inner join CUSTOMER_SALES_VIEW csv on CAST(ecc.CUSTOMER_CODE AS BIGINT)=CAST(csv.cust_code AS BIGINT) where ecc.ORG_LEVEL_ID IN(" + Actual_SelectedTerritory + "))";
                } else if ($("#State").val() != null) {
                    WhereClause1 += " and State IN(" + Actual_SelectedState + ")";
                }
                else if ($("#Zone").val() != null) {
                    WhereClause1 += " and ZONE IN(" + $("#Zone").val() + ")";
                }
                if (($("#Zone").val() == null) && ($("#State").val() == null) && ($("#TerriotryArea").val() == null) && ($("#CustomerCode").val() == "")) {
                    WhereClause1 += "";
                }

                var sheet = $("#Sheets").val();

                //Edited By Manikanta

                if (sheet != "select") {
                    WhereClause1 += " and SOLD_TO_PARTY_NO IN (select STOCKIST_ID from sap_customer_sales_master where DIVISION='" + sheet + "')";
                }

                var Data1 = JSON.stringify({
                    MasterType: "InvoiceList",
                    ID: "561",
                    UserCode: $("#UserCode").val(),
                    "Type": "Get",
                    ReportName: "InvoiceList",
                    WhereClause: WhereClause1
                });
                DIMSSAPFactory.GetTotalAmtInvoice(Data1).success(function (res) {
                    if (res != "0") {
                        //var Res = JSON.parse(res);
                        if (res[0]["Amount"] != "") {
                            $('#TotalInvoiceAmnt').val(parseFloat(res[0]["Amount"]).toFixed(2));
                        } else {
                            $('#TotalInvoiceAmnt').val("0.00");
                        }
                        if (res[0]["Grss_Wt"] != "") {
                            $('#TotalInvoiceGrossWt').val(parseFloat(res[0]["Grss_Wt"]).toFixed(2));
                        } else {
                            $('#TotalInvoiceGrossWt').val("0.00");
                        }

                    } else {
                        $('#TotalInvoiceAmnt').val("0.00");
                        $('#TotalInvoiceGrossWt').val("0.00");
                    }

                });
            } catch (Exception) { }

        }

        //This method is used for download the Invoice List page.
        $scope.DownloadFile = function (filetype) {
            var isValidCustCode = isValidCode_Cust($("#CustomerCode").val(), CustomerArray);
            var SearchValue = $('input[type=search]').val();
            var FileName = "InvoiceList";
            var DateRange = DateSplitter('OrderFromDate', 'OrderToDate');
            var UserCode = $("#UserCode").val();

            var WhereClause = "where (DATE between " + DateRange + ")";
            if ($("#CustomerCode").val() != "") {
                if ((isValidCustCode == false) && ($("#CustomerCode").val() != "")) {

                } else {
                    WhereClause += " and SOLD_TO_PARTY_NO IN (" + $("#CustomerCode").val().split(':')[0] + ")";
                }

            }
            else if ($("#TerriotryArea").val() != null) {
                WhereClause += " and SOLD_TO_PARTY_NO IN (select DISTINCT ecc.CUSTOMER_CODE from cms_employee_customer_configuration ecc inner join CUSTOMER_SALES_VIEW csv on CAST(ecc.CUSTOMER_CODE AS BIGINT)=CAST(csv.cust_code AS BIGINT) where ecc.ORG_LEVEL_ID IN(" + Actual_SelectedTerritory + "))";
            } else if ($("#State").val() != null) {
                WhereClause += " and State IN(" + Actual_SelectedState + ")";
            }
            else if ($("#Zone").val() != null) {
                WhereClause += " and ZONE IN(" + $("#Zone").val() + ")";
            }
            if (($("#Zone").val() == null) && ($("#State").val() == null) && ($("#TerriotryArea").val() == null) && ($("#CustomerCode").val() == "")) {
                WhereClause += "";
            }


            var sheet = $("#Sheets").val();

            //Edited By Manikanta

            if (sheet != "select") {
                WhereClause += " and SOLD_TO_PARTY_NO IN (select STOCKIST_ID from sap_customer_sales_master where DIVISION='" + sheet + "')";
            }

            WhereClause += " order by DOC_NO,ITEM ASC";



            var Table_DebitCount = $('#tbl_InvoiceList').DataTable().data().count();
            if (Table_DebitCount == 0) {
                alert("There is no data");
            } else {
                if ((isValidCustCode == false) && ($("#CustomerCode").val() != "")) { alert("please select proper customer code"); } else {
                    var data_value = "{\"Role\":\"" + SessionValue + "\",\"Form_Code\":\"" + "INV" + "\",\"Action\":\"" + "Is_Export" + "\"}";
                    $http({ url: '../../Home/Form_Access', method: 'POST', data: { Data: data_value } }).success(function (res) {
                        if (res == "True") {
                            CommonFunctionForExcelExport_SearchFilter("561", UserCode, SearchValue, FileName, FileName, WhereClause, filetype);
                        }
                        else {
                            alert("You are not allowed to export Invoice List");
                        }
                    });
                }

            }


        }
    } catch (Exception) { }

    //
    // Open popup for columns selection
    $scope.OpenColumnEditing = function () {

        $('#undo_redo').empty();

        var ColumnNames = JSON.parse($scope.UserDefaultListColumnNames);

        for (var i = 0; i < ColumnNames["ColumnNames"].length; i++) {
            $("#undo_redo").append($("<option></option>").val(ColumnNames["ColumnNames"][i]).html(ColumnNames["ColumnNames"][i]));
        }


        //  $('#undo_redo').refresh();

        $('#undo_redo').multiselect();
        if (ControllerName != "UnnatiEnrollmentDetailReportCtrl") {
            ControllerName = "UnnatiEnrollmentDetailReportCtrl";
            var elem = angular.element('#ColumnEditingModal');
            elem.removeAttr('ng-controller');
            elem.attr('ng-controller', "UnnatiEnrollmentDetailReportCtrl");

            $compile(elem.contents())(UnnatiEnrollmentDetailReportScope);
        }

        $("#ColumnEditingModal").modal('show');

    }

    $scope.ViewColumnEditing = function () {

        var STDATE = ($scope.EnrollementDetailFromDate).split('/');
        var startDateValue = new Date(STDATE[2], STDATE[1], STDATE[0]);
        var startDateValuecmp = startDateValue.getTime();
        var ENDATE = ($scope.EnrollementDetailToDate).split('/');
        var endDateValue = new Date(ENDATE[2], ENDATE[1], ENDATE[0]);
        var endDateValuecmp = endDateValue.getTime();

        if (startDateValuecmp > endDateValuecmp) {
            alert("To Date cannot be less than From Date");
            return;
        }

        var finalStartDate = STDATE[2] + "-" + STDATE[1] + "-" + STDATE[0];
        var finalEndDate = ENDATE[2] + "-" + ENDATE[1] + "-" + ENDATE[0];
        var WhereCondition = " where CONVERT(DATE,ENROLLEMENT_DATE)>= '" + finalStartDate + "' AND CONVERT(DATE,ENROLLEMENT_DATE)<='" + finalEndDate + "' ";
        if ($scope.EnrollDetailMemberType == "ALL")
        { } else {
            WhereCondition += "  AND  MEMBER_TYPE='" + $scope.EnrollDetailMemberType + "' ";
        }
        if ($scope.EnrollDetailZone == "Select" || $scope.EnrollDetailZone == undefined) {
            alert("Select Zone");
            return;
        } else {
            if ($scope.EnrollDetailZone == "ALL")
            { } else {
                WhereCondition = WhereCondition + " AND ZONE='" + $scope.EnrollDetailZone + "' ";
            }
        }

        if ($scope.EnrollDetailState == "Select" || $scope.EnrollDetailState == undefined) {
            alert("Select State");
            return;
        } else {
            if ($scope.EnrollDetailState == "ALL")
            { } else {
                WhereCondition = WhereCondition + " AND UPPER(STATE)='" + $scope.EnrollDetailState.toUpperCase() + "' ";
            }
        }


        if ($scope.EnrollDetailDistrict == "Select" || $scope.EnrollDetailDistrict == undefined) {
            alert("Select District");
            return;
        } else {
            if ($scope.EnrollDetailDistrict == "ALL")
            { } else {
                WhereCondition = WhereCondition + " AND UPPER(DISTRICT)='" + $scope.EnrollDetailDistrict.toUpperCase() + "' ";
            }
        }

        //if ($scope.EnrollDetailTaluk == "Select" || $scope.EnrollDetailTaluk == undefined) {
        //    alert("Select Taluk");
        //    return;
        //} else {
        //    if ($scope.EnrollDetailTaluk == "ALL")
        //    { } else {
        //        WhereCondition = WhereCondition + " AND TALUK='" + $scope.EnrollDetailTaluk + "' ";
        //    }
        //}


        //if ($scope.EnrollDetailVillage == "Select" || $scope.EnrollDetailVillage == undefined) {
        //    alert("Select Village");
        //    return;
        //} else {
        //    if ($scope.EnrollDetailVillage == "ALL")
        //    { } else {
        //        WhereCondition = WhereCondition + " AND VILLAGE='" + $scope.EnrollDetailVillage + "' ";
        //    }
        //}

        DIMSFactory.ViewColumnEditing("UnnatiEnrollmentDetail", UserCode, WhereCondition);

    }

    // Save Column selected it is like preview.We will send reportname,usercode and where condition to function
    $scope.SaveColumnEditingData = function () {
        var STDATE = ($scope.EnrollementDetailFromDate).split('/');
        var startDateValue = new Date(STDATE[2], STDATE[1], STDATE[0]);
        var startDateValuecmp = startDateValue.getTime();
        var ENDATE = ($scope.EnrollementDetailToDate).split('/');
        var endDateValue = new Date(ENDATE[2], ENDATE[1], ENDATE[0]);
        var endDateValuecmp = endDateValue.getTime();

        if (startDateValuecmp > endDateValuecmp) {
            alert("To Date cannot be less than From Date");
            return;
        }

        var finalStartDate = STDATE[2] + "-" + STDATE[1] + "-" + STDATE[0];
        var finalEndDate = ENDATE[2] + "-" + ENDATE[1] + "-" + ENDATE[0];

        var WhereCondition = " where CONVERT(DATE,ENROLLEMENT_DATE)>= '" + finalStartDate + "' AND CONVERT(DATE,ENROLLEMENT_DATE)<='" + finalEndDate + "' ";
        if ($scope.EnrollDetailMemberType == "ALL")
        { } else {
            WhereCondition += "  AND  MEMBER_TYPE='" + $scope.EnrollDetailMemberType + "' ";
        }

        if ($scope.EnrollDetailZone == "Select" || $scope.EnrollDetailZone == undefined) {
            alert("Select zone");
            return;
        } else {
            if ($scope.EnrollDetailZone == "ALL")
            { } else {
                WhereCondition = WhereCondition + " AND ZONE='" + $scope.EnrollDetailZone + "' ";
            }
        }

        if ($scope.EnrollDetailState == "Select" || $scope.EnrollDetailState == undefined) {
            alert("Select State");
            return;
        } else {
            if ($scope.EnrollDetailState == "ALL")
            { } else {
                WhereCondition = WhereCondition + " AND UPPER(STATE)='" + $scope.EnrollDetailState.toUpperCase() + "' ";
            }
        }


        if ($scope.EnrollDetailDistrict == "Select" || $scope.EnrollDetailDistrict == undefined) {
            alert("Select District");
            return;
        } else {
            if ($scope.EnrollDetailDistrict == "ALL")
            { } else {
                WhereCondition = WhereCondition + " AND UPPER(DISTRICT)='" + $scope.EnrollDetailDistrict.toUpperCase() + "' ";
            }
        }

        //if ($scope.EnrollDetailTaluk == "Select" || $scope.EnrollDetailTaluk == undefined) {
        //    alert("Select Taluk");
        //    return;
        //} else {
        //    if ($scope.EnrollDetailTaluk == "ALL")
        //    { } else {
        //        WhereCondition = WhereCondition + " AND TALUK='" + $scope.EnrollDetailTaluk + "' ";
        //    }
        //}


        //if ($scope.EnrollDetailVillage == "Select" || $scope.EnrollDetailVillage == undefined) {
        //    alert("Select Village");
        //    return;
        //} else {
        //    if ($scope.EnrollDetailVillage == "ALL")
        //    { } else {
        //        WhereCondition = WhereCondition + " AND VILLAGE='" + $scope.EnrollDetailVillage + "' ";
        //    }
        //}

        var Data = JSON.stringify({
            ID: UserCode,
            UserCode: UserCode,
            ReportName: "UnnatiEnrollmentDetail",
            WhereClause: WhereCondition,
            "Type": "Get"

        });
        DIMSFactory.SaveColumnEditingData_InputParameter("UnnatiEnrollmentDetail", UserCode, WhereCondition, Data, "EnrollmentDetailReport_Table");


    }
    //


    $scope.SendEmailData = function () {
        //window.location.href = "../../SAP/Invoice_List_View_Data";

        DIMSSAPFactory.SendEmailInvoice().success(function (Res) {
            alert(Res);
        });
        //var FilterdText = $('#tbl_InvoiceList_info').text();
        //if (FilterdText.indexOf('filtered')) {
        //    var table = $('#tbl_InvoiceList').tableToJSON(); // Convert the table into a javascript object            
        //    alert(JSON.stringify(table));
        //}
        //else {
        //    DIMSSAPFactory.SendEmailInvoice().success(function (Res) {
        //        alert(Res);
        //    });
        //}

    }
});

//Invoice ZINV Plant Details
DIMS.controller('InvoiceDetail_ZINV_PlantCtrl', function ($scope, $location, DIMSFactory, $http, $compile, $routeParams) {
    $scope.templatesettings = { HeaderTitle: "Invoice details" };
    MasterScope = $scope;
    $scope.go = function (path) {
        CheckUserSession();
        $location.path(path);
    };

    var width = $(window).width(), height = $(window).height();//---------

    var totalheight = height - 191;
    // var totalheight = height - 148;//--------    
    if (height <= 800) {
        totalheight = height - 148;
    }

    $('.content').css({ "max-height": totalheight, "overflow-y": "auto" });//-----------
    $('.content-header > h2').css({ "font-size": "18px", "font-weight": "500" });//----------

    angular.element(document).ready(function () {
        var EditId = $routeParams.ID;
        if (EditId == undefined || EditId == "") {
            EditId = 0;
        } else {
            var decryptedID = CryptoJS.AES.decrypt(EditId, "Secret Passphrase");
            var decryptedDocNo = decryptedID.toString(CryptoJS.enc.Utf8);
            ShowLoader();
            $http({
                method: 'POST',
                url: '../../SAP/Invoice_Details_Edit',
                data: { val: EditId }
            }).then(function successCallback(response) {
                var Data = response.data.tabledata;
                Data = JSON.parse(Data);
                var Header = Data["Header"];
                if (Header != "") {
                    var Plant = Data["Plant"];
                    var Biller = Data["Biller"];
                    var Shipper = Data["Shipper"];
                    var ChildTable = Data["ItemsTable"];
                    var PricingDetails = Data["PricingDetails"];

                    var Gross_Wt = 0;

                    //Sales Order

                    // $scope.BillingDoc = Header[0]["Billing Doc No."];
                    $('#BillingDoc').text(Header[0]["Billing Doc No."]);
                    $('#BillingDoc_html').text(Header[0]["Billing Doc No."]);
                    var ExciseInvdate = Header[0]["EXCISE_INV_DATE"].split('/');
                    //  $scope.ExciseInvNo = Header[0]["Excise Inv"] + "/" + ExciseInvdate;
                    $('#ExciseInvNo').text(Header[0]["Excise Inv"] + " / " + ExciseInvdate[0] + '.' + ExciseInvdate[1] + '.' + ExciseInvdate[2]);
                    $('#ExciseInvNo_html').text(Header[0]["Excise Inv"] + " / " + ExciseInvdate[0] + '.' + ExciseInvdate[1] + '.' + ExciseInvdate[2]);
                    // $scope.BillingDate = Header[0]["Billing Date"];
                    var Billing_Date = Header[0]["Billing Date"].split('/');
                    $('#BillingDate').text(Billing_Date[0] + '.' + Billing_Date[1] + '.' + Billing_Date[2]);
                    $('#BillingDate_html').text(Billing_Date[0] + '.' + Billing_Date[1] + '.' + Billing_Date[2]);
                    //$scope.ECCNumber = Header[0]["ECC Number"];
                    $('#ECCNumber').text(Header[0]["ECC Number"]);
                    $('#ECCNumber_html').text(Header[0]["ECC Number"]);
                    //$scope.SalesOrderNo = Header[0]["Sales Order"];
                    var SO_No = Header[0]["Sales Order"].split('/');
                    $('#SalesOrderNo').text(parseInt(SO_No[0]) + ' / ' + SO_No[1] + '.' + SO_No[2] + '.' + SO_No[3]);
                    $('#SalesOrderNo_html').text(parseInt(SO_No[0]) + ' / ' + SO_No[1] + '.' + SO_No[2] + '.' + SO_No[3]);

                    //$scope.CINNo = "L74999TG1955PLC000656";

                    $('#CINNo').text("L74999TG1955PLC000656");
                    $('#CINNo_html').text("L74999TG1955PLC000656");
                    // $scope.SoldTo = Shipper[0]["STOCKIST_ID"] + " ( " + Shipper[0]["STOCKIST_NAME"] + " )";
                    //$scope.SoldTo = Header[0]["Sold To"];
                    var Soldto = Header[0]["Sold To"];
                    $('#SoldTo').text(Soldto);
                    $('#SoldTo_html').text(Soldto);
                    //$scope.OrderRefDate = Header[0]["Order Ref Date"];
                    var OR_Date = Header[0]["Order Ref Date"].split('/');
                    $('#OrderRefDate').text(OR_Date[0] + ' / ' + OR_Date[1] + '.' + OR_Date[2] + '.' + OR_Date[3]);
                    $('#OrderRefDate_html').text(OR_Date[0] + ' / ' + OR_Date[1] + '.' + OR_Date[2] + '.' + OR_Date[3]);
                    //Date of Preperation
                    var DOP = Header[0]["Billing Date"].split('/');
                    var DOT = Header[0]["Time"];
                    var ss = DOT.split(":");
                    var dt = new Date();
                    dt.setHours(ss[0]);
                    dt.setMinutes(ss[1]);
                    dt.setSeconds(ss[2]);
                    var dt2 = new Date(dt.valueOf() + 4000000);
                    var DOT_Time = dt2.toTimeString().split(" ")[0];

                    //$('#DOPrep').text(DOP[0] + '.' + DOP[1] + '.' + DOP[2] + " " + Header[0]["Time"]);
                    //$('#DOPrep_html').text(DOP[0] + '.' + DOP[1] + '.' + DOP[2] + " " + Header[0]["Time"]);
                    //Date of Removal
                    //$('#DORemoval').text(DOP[0] + '.' + DOP[1] + '.' + DOP[2] + " " + DOT_Time);
                    //$('#DORemoval_html').text(DOP[0] + '.' + DOP[1] + '.' + DOP[2] + " " + DOT_Time);

                    $('#Delivery').text("EX Factory");
                    $('#Delivery_html').text("EX Factory");


                    $('#GrossAmnt').text(Header[0]["Gross Amount"]);



                    // $('#NetWeight').text(Header[0]["NET_WT"]);
                    $('#PaymentTerms').text(Header[0]["PAYMENT_TERMS"]);
                    $('#PaymentTerms_html').text(Header[0]["PAYMENT_TERMS"]);
                    $('#LRRNo').text(Header[0]["LR_NO"]);
                    $('#LRRNo_html').text(Header[0]["LR_NO"]);
                    //$('#TransporterName').text(Header[0]["TRANSPORTER"]);
                    $('#TransporterName').text(Header[0]["Transporter Name"]);
                    $('#TransporterName_html').text(Header[0]["Transporter Name"]);
                    $('#LorryNum').text(Header[0]["VEHICLE_NO"]);
                    $('#LorryNum_html').text(Header[0]["VEHICLE_NO"]);
                    $('#OBDNum').text(Header[0]["DELIVERY_NO"]);
                    $('#OBDNum_html').text(Header[0]["DELIVERY_NO"]);


                    //If the Delivery is 'ZFR' or 'FOR' then display the text as Insurance and Transportaion is being arranged on customer's request
                    //else If the Delivery is 'EXT' then display the text as Freight to be paid to Transporter directly
                    if ((Header[0]["Delivery"] == "ZFR") || (Header[0]["Delivery"] == "FOR")) {
                        $("#lblInsuranceText_html").text("Insurance and Transportaion is being arranged on customer's request");
                    } else if (Header[0]["Delivery"] == "EXT") {
                        $("#lblInsuranceText_html").text("Freight to be paid to Transporter directly");
                    }

                    //
                    var BillToDetails = "<b>Consignee / Payer Detail:</b>" + "</br>" + Biller[0]["SOLD_TO_PARTY_NO"] + "</br>";
                    BillToDetails += Biller[0]["STOCKIST_NAME"] + ",<br />" + Biller[0]["Biller Address"].substring(0, 27) + "<br />" + Biller[0]["Biller Address"].substring(27, Biller[0]["Biller Address"].length) + "," + Biller[0]["STATE_NAME"] + "</br>" + "Ph No :" + Biller[0]["PHONE1"] + "</br>" + "TIN No. :" + Biller[0]["TIN_NO"] + "</br>" + "CST No. :" + Biller[0]["CST_NO"] + "</br>" + "&nbsp;";

                    var BillToDetails_html = "<b>Consignee / Payer Detail:</b>" + "</br>" + Biller[0]["SOLD_TO_PARTY_NO"] + "</br>";
                    BillToDetails_html += Biller[0]["STOCKIST_NAME"] + ",<br />" + Biller[0]["Biller Address"] + "," + Biller[0]["STATE_NAME"] + "</br>" + "Ph No :" + Biller[0]["PHONE1"] + "</br>" + "TIN No. :" + Biller[0]["TIN_NO"] + "</br>" + "CST No. :" + Biller[0]["CST_NO"] + "</br>" + "&nbsp;";


                    //  var ShipperDetails = Shipper[0][""]


                    var ShipperDetails = "<b>Delivery Address / Consignee:</b>" + "</br>" + Shipper[0]["SHIP_TO_PARTY_NO"] + "</br>";
                    ShipperDetails += Shipper[0]["STOCKIST_NAME"] + ",<br />" + Shipper[0]["Shipper Address"].substring(0, 27) + "<br />" + Shipper[0]["Shipper Address"].substring(27, Shipper[0]["Shipper Address"].length) + "," + Shipper[0]["STATE_NAME"] + "</br>" + "Ph No :" + Shipper[0]["PHONE1"] + "</br>" + "TIN No. :" + Shipper[0]["TIN_NO"] + "</br>" + "CST No. :" + Shipper[0]["CST_NO"] + "</br>" + "&nbsp;";

                    var ShipperDetails_html = "<b>Delivery Address / Consignee:</b>" + "</br>" + Shipper[0]["SHIP_TO_PARTY_NO"] + "</br>";
                    ShipperDetails_html += Shipper[0]["STOCKIST_NAME"] + ",<br />" + Shipper[0]["Shipper Address"] + "," + Shipper[0]["STATE_NAME"] + "</br>" + "Ph No :" + Shipper[0]["PHONE1"] + "</br>" + "TIN No. :" + Shipper[0]["TIN_NO"] + "</br>" + "CST No. :" + Shipper[0]["CST_NO"] + "</br>" + "&nbsp;";


                    //var PlantDetails = "<b>Consigner Detail- HIL Limited</b>" + "</br>" + Plant[0]["NAME3"] + " " + Plant[0]["STREET2"] + " " + Plant[0]["STREET3"] + "<br />" + Plant[0]["STREET"] + " " + Plant[0]["STREET4"] + " " + Plant[0]["CITY_CODE"] + " " + Plant[0]["DISTRICT"] + " " + Plant[0]["ZIP_CODE"] + " " + Plant[0]["STATE_NAME"] + "</br>" + "Email:" + Plant[0]["EMAIL"] + "</br>" + "Phone:" + Plant[0]["PHONE1"] + "</br>" + "TIN No.:" + Plant[0]["TIN_NO"] + "</br>" + "CST No.:" + Plant[0]["CST_NO"];
                    var PlantDetails = "<b>Consigner Detail- HIL Limited</b>" + "</br>" + Plant[0]["NAME3"] + " " + Plant[0]["STREET2"] + " " + Plant[0]["STREET3"] + "<br />" + Plant[0]["STREET"] + " " + Plant[0]["STREET4"] + " " + Plant[0]["CITY_CODE"] + " ," + Plant[0]["DISTRICT"] + " ," + Plant[0]["ZIP_CODE"] + " ," + Plant[0]["STATE_NAME"] + "</br>" + "Email:" + Plant[0]["EMAIL"] + "</br>" + "Phone :" + Plant[0]["PHONE1"] + "</br>" + "TIN No. :" + Plant[0]["TIN_NO"] + "</br>" + "CST No. :" + Plant[0]["CST_NO"] + "</br>" + "&nbsp;";
                    var PlantDetails_html = "<b>Consigner Detail- HIL Limited</b>" + "</br>" + Plant[0]["NAME3"] + " " + Plant[0]["STREET2"] + " " + Plant[0]["STREET3"] + "<br /> " + Plant[0]["STREET"] + " " + Plant[0]["STREET4"] + " " + Plant[0]["CITY_CODE"] + " ," + Plant[0]["DISTRICT"] + " ," + Plant[0]["ZIP_CODE"] + " ," + Plant[0]["STATE_NAME"] + "</br>" + "Email:" + Plant[0]["EMAIL"] + "</br>" + "Phone :" + Plant[0]["PHONE1"] + "</br>" + "TIN No. :" + Plant[0]["TIN_NO"] + "</br>" + "CST No. :" + Plant[0]["CST_NO"] + "</br>" + "&nbsp;" + "</br>" + "&nbsp;" + "</br>" + "&nbsp;";
                    $("#lblPlantName").html(Plant[0]["NAME3"] + "" + Plant[0]["STREET2"] + " " + Plant[0]["STREET3"] + " " + Plant[0]["STREET"] + " " + Plant[0]["STREET4"] + " " + Plant[0]["CITY_CODE"] + " " + Plant[0]["DISTRICT"] + " " + +Plant[0]["ZIP_CODE"] + " " + Plant[0]["STATE_NAME"]);
                    //For PDF
                    $("#lblPlantName_html").html(Plant[0]["NAME3"] + "" + Plant[0]["STREET2"] + " " + Plant[0]["STREET3"] + " " + Plant[0]["STREET"] + " " + Plant[0]["STREET4"] + " " + Plant[0]["CITY_CODE"] + " " + Plant[0]["DISTRICT"] + " " + +Plant[0]["ZIP_CODE"] + " " + Plant[0]["STATE_NAME"]);
                    $('#ExciseRange').append(Header[0]["EXCISE_RANGE"]);
                    $('#ExciseDivison').append(Header[0]["EXCISE_DIVISION"]);
                    $('#ExciseCommissionerate').append(Header[0]["EXCISE_COMMISIONARATE"]);

                    $('#ExciseRange_html').append(Header[0]["EXCISE_RANGE"]);
                    $('#ExciseDivison_html').append(Header[0]["EXCISE_DIVISION"]);
                    $('#ExciseCommissionerate_html').append(Header[0]["EXCISE_COMMISIONARATE"]);

                    $('#tbl_Inv_Details').dataTable().fnAddData([PlantDetails, BillToDetails, ShipperDetails]);
                    $('#tbl_Inv_Details_html').dataTable().fnAddData([PlantDetails_html, BillToDetails_html, ShipperDetails_html]);


                    TRCode = "";
                    for (var i = 0; i < ChildTable.length; i++) {
                        var TotalBasicAmt = (ChildTable[i]["BILL_QTY"]) * (ChildTable[i]["Unit Rate"]);
                        Gross_Wt += parseFloat(ChildTable[i]["Wt In Mt"]);
                        $('#tbl_Inv_Details1').dataTable().fnAddData([ChildTable[i]["MATERIAL_NO"], ChildTable[i]["PRODUCT_DESC"], ChildTable[i]["BILL_QTY"], ChildTable[i]["UOM"], ChildTable[i]["PROD_GRP"], Number(ChildTable[i]["Wt In Mt"]).toFixed(3), parseFloat(ChildTable[i]["Unit Rate"]).toFixed(2), parseFloat(TotalBasicAmt).toFixed(2)]);
                        //$('#tbl_Inv_Details1_html').dataTable().fnAddData([ChildTable[i]["MATERIAL_NO"], ChildTable[i]["PRODUCT_DESC"], ChildTable[i]["BILL_QTY"], ChildTable[i]["UOM"], ChildTable[i]["PROD_GRP"], Number(ChildTable[i]["Wt In Mt"]).toFixed(3), parseFloat(ChildTable[i]["Unit Rate"]).toFixed(2), parseFloat(TotalBasicAmt).toFixed(2)]);

                        TRCode = TRCode + "<tr>";
                        TRCode = TRCode + "<td align='center'>" + ChildTable[i]["MATERIAL_NO"] + "</td>";
                        TRCode = TRCode + "<td>" + ChildTable[i]["PRODUCT_DESC"] + "</td>";
                        TRCode = TRCode + "<td align='right'>" + ChildTable[i]["BILL_QTY"] + "</td>";
                        TRCode = TRCode + "<td align='center'>" + ChildTable[i]["UOM"] + "</td>";
                        TRCode = TRCode + "<td align='center'>" + ChildTable[i]["PROD_GRP"] + "</td>";
                        TRCode = TRCode + "<td align='right'>" + parseFloat(ChildTable[i]["Wt In Mt"]).toFixed(3) + "</td>";
                        TRCode = TRCode + "<td align='right'>" + parseFloat(ChildTable[i]["Unit Rate"]).toFixed(2) + "</td>";
                        TRCode = TRCode + "<td align='right'>" + parseFloat(TotalBasicAmt).toFixed(2) + "</td>";
                        TRCode = TRCode + "</tr>";

                        $("#lblChapter_Id_html").text(ChildTable[0]["CHAPTER_ID"]);
                        $("#lblChapter_Desc_html").text(ChildTable[0]["CHAPTER_DESC"]);
                    }
                    var Html = $compile(TRCode)($scope);
                    var el = angular.element($("#tbl_Inv_Details1_html tbody"));
                    el.append(Html);
                    $compile(Html)($scope);
                    $("#tbl_Inv_Details1_html").dataTable({
                        "bDestroy": true,
                        "bSort": false,
                        "bScrollCollapse": true,
                        "paging": false,
                        "ordering": false,
                        "info": false,
                        "bFilter": false,
                        "footerCallback": function (tfoot, data, start, end, display) {
                            var api = this.api();
                            $(api.column(7).footer()).html(
                                api.column(7).data().reduce(function (a, b) {
                                    var res = parseFloat(a) + parseFloat(b);
                                    return parseFloat(res).toFixed(2);
                                }, 0)
                            );
                        }
                    });

                    $("#Zinv_Plant_Footer_Header_html").remove();


                    var GrossWeight = Gross_Wt;
                    GrossWeight = parseFloat(GrossWeight).toFixed(3);
                    var GrossWeightinMt = GrossWeight / 1000;


                    $('#GrossWeight').text(GrossWeight + " KG " + "( " + GrossWeightinMt.toFixed(3) + " MT )");
                    $('#GrossWeight_html').text(GrossWeight + " KG " + "( " + GrossWeightinMt.toFixed(3) + " MT )");

                    var NetWeight = Gross_Wt;
                    NetWeight = parseFloat(NetWeight).toFixed(3);
                    var NetWeightinMt = NetWeight / 1000;

                    $('#NetWeight').text(NetWeight + " KG " + "( " + NetWeightinMt.toFixed(3) + " MT )");
                    $('#NetWeight_html').text(NetWeight + " KG " + "( " + NetWeightinMt.toFixed(3) + " MT )");


                    var AssessableValue = 0;
                    var ExiceDuty = 0;
                    var EntryTax = 0;
                    var Turnover = 0;
                    var JCST = 0;
                    var ZSSC = 0;
                    var StateAddTax = 0;
                    var InsuranceTPND = 0;
                    var FreightAmt = 0;
                    var TotalFr = 0;
                    if ((parseFloat(PricingDetails[0]["DISC"]) > 0) || (parseFloat(PricingDetails[0]["DISC"]) < 0)) {
                        $('#Discount').text(Number(PricingDetails[0]["DISC"]).toFixed(2));
                    } else {
                        $("#lblDiscount").hide(); $("#Discount").hide();
                        $("#lblDiscount_html").hide(); $("#Discount_html").hide();
                    }
                    if (parseFloat(PricingDetails[0]["JCST"]) > 0) {
                        if (PricingDetails[0]["STK_PRC_GRP"] == "Z1") {
                            $("#lblAgainstCFORM").html("CST @ " + PricingDetails[0]["JCSTP"] + "% (against CFORM) :"); $("#lblAgainstCFORM_html").html("CST @ " + PricingDetails[0]["JCSTP"] + "% (against CFORM) :");
                        } else {
                            $("#lblAgainstCFORM").html("CST @ " + PricingDetails[0]["JCSTP"] + "% :"); $("#lblAgainstCFORM_html").html("CST @ " + PricingDetails[0]["JCSTP"] + "% :");
                        }
                        $('#AgainstCFORM').text(Number(PricingDetails[0]["JCST"]).toFixed(2));
                        $('#AgainstCFORM_html').text(Number(PricingDetails[0]["JCST"]).toFixed(2));
                    }
                    else {
                        $("#lblAgainstCFORM").html("VAT @ " + PricingDetails[0]["ZVATP"] + "% :");
                        $("#lblAgainstCFORM_html").html("VAT @ " + PricingDetails[0]["ZVATP"] + "% :");
                        $('#AgainstCFORM').text(Number(PricingDetails[0]["ZVAT"]).toFixed(2));
                        $('#AgainstCFORM_html').text(Number(PricingDetails[0]["ZVAT"]).toFixed(2));
                    }



                    if (Number(PricingDetails[0]["ZSSC"].toString()).toFixed(2) == "0.00") {
                        $("#idSteteSess").hide();
                        $("#idSteteSess_html").hide();

                    }
                    else {
                        $('#SteteSec').text(Number(PricingDetails[0]["ZSSC"]).toFixed(2));
                        $('#SteteSec_html').text(Number(PricingDetails[0]["ZSSC"]).toFixed(2));
                        $("#lblSteteSec").html("State Sec Cess @ " + PricingDetails[0]["ZSSCP"] + "% :");
                        $("#lblSteteSec_html").html("State Sec Cess @ " + PricingDetails[0]["ZSSCP"] + "% :");
                    }
                    if (Number(PricingDetails[0]["ZGTA"].toString()).toFixed(2) == "0.00") {
                        $("#idStateAddTax").hide();
                        $("#idStateAddTax_html").hide();
                    } else {
                        $('#StateAddTax').text(Number(PricingDetails[0]["ZGTA"]).toFixed(2));
                        $('#StateAddTax_html').text(Number(PricingDetails[0]["ZGTA"]).toFixed(2));

                        $("#lblSteteSec").html("State Add Tax @ " + PricingDetails[0]["ZGTAP"] + "% :");
                        $("#lblStateAddTax_html").html("State Add Tax @ " + PricingDetails[0]["ZGTAP"] + "% :");
                    }

                    if (parseFloat(PricingDetails[0]["ASS"]) > 0) {
                        $('#AssessableValue').text(Number(PricingDetails[0]["ASS"]).toFixed(2));
                        $('#AssessableValue_html').text(Number(PricingDetails[0]["ASS"]).toFixed(2));
                    } else {
                        $("#lblAssessableValue").hide(); $("#AssessableValue").hide();
                        $("#lblAssessableValue_html").hide(); $("#AssessableValue_html").hide();
                    }

                    if (parseFloat(PricingDetails[0]["JEXP"]) > 0) {
                        $('#ExiceDuty').text(Number(PricingDetails[0]["JEXP"]).toFixed(2));
                        $('#ExiceDuty_html').text(Number(PricingDetails[0]["JEXP"]).toFixed(2));
                    } else {
                        $("#lblExiceDuty").hide(); $("#ExiceDuty").hide();
                        $("#lblExiceDuty_html").hide(); $("#ExiceDuty_html").hide();
                    }
                    if ((Number(PricingDetails[0]["ZETX"].toString()).toFixed(2) == "0.00") && (Number(PricingDetails[0]["ZETO"].toString()).toFixed(2) == "0.00")) {
                        $("#idEntryTax").hide();
                        $("#idEntryTax_html").hide();
                        $("#idOrissaTax").hide();
                        $("#idOrissaTax_html").hide();
                    } else {
                        if (Number(PricingDetails[0]["ZETOP"].toString()).toFixed(2) == "0.00") {
                            $('#EntryTax').text(Number(PricingDetails[0]["ZETX"]).toFixed(2));
                            $('#EntryTax_html').text(Number(PricingDetails[0]["ZETX"]).toFixed(2));
                        } else {
                            //$('#EntryTax').text(Number(PricingDetails[0]["ZETO"]).toFixed(2));
                            //$('#EntryTax_html').text(Number(PricingDetails[0]["ZETO"]).toFixed(2));

                            $('#OrissaTax').text(Number(PricingDetails[0]["ZETO"]).toFixed(2));
                            $('#OrissaTax_html').text(Number(PricingDetails[0]["ZETO"]).toFixed(2));
                        }

                        if (Number(PricingDetails[0]["ZETOP"].toString()).toFixed(2) == "0.00") {
                            $("#lblEntryTax").html("Entry Tax @ " + PricingDetails[0]["ZETXP"] + "% :");
                            $("#lblEntryTax_html").html("Entry Tax @ " + PricingDetails[0]["ZETXP"] + "% :");
                        } else {
                            $("#lblOrissaTax").html("Orissa Entry Tax @ " + PricingDetails[0]["ZETOP"] + "% :");
                            $("#lblOrissaTax_html").html("Orissa Entry Tax @ " + PricingDetails[0]["ZETOP"] + "% :");
                        }

                    }

                    if (parseFloat(PricingDetails[0]["ZINS"]) > 0) {
                        $('#InsuranceTPND').text(Number(PricingDetails[0]["ZINS"]).toFixed(2));
                        $('#InsuranceTPND_html').text(Number(PricingDetails[0]["ZINS"]).toFixed(2));

                        $("#lblInsuranceTPND").html("Insurance (TPND) @ " + PricingDetails[0]["ZINSP"] + "% :");
                        $("#lblInsuranceTPND_html").html("Insurance (TPND) @ " + PricingDetails[0]["ZINSP"] + "% :");
                    } else {
                        $("#lblInsuranceTPND").hide(); $("#InsuranceTPND").hide();
                        $("#lblInsuranceTPND_html").hide(); $("#InsuranceTPND_html").hide();
                    }
                    if (parseFloat(PricingDetails[0]["ZF00"]) > 0) {
                        $('#FreightAmt').text(Number(PricingDetails[0]["ZF00"]).toFixed(2));
                        $('#FreightAmt_html').text(Number(PricingDetails[0]["ZF00"]).toFixed(2));
                    } else {
                        $("#lblFreightAmt").hide(); $("#FreightAmt").hide();
                        $("#lblFreightAmt_html").hide(); $("#FreightAmt_html").hide();
                    }


                    JCST += parseFloat(Number(PricingDetails[0]["ZVAT"]).toFixed(2));
                    Turnover = parseFloat(Number(PricingDetails[0]["ASS"]).toFixed(2)) + parseFloat(Number(PricingDetails[0]["JEXP"]).toFixed(2)) + parseFloat(Number(PricingDetails[0]["ZETX"]).toFixed(2));
                    $('#TaxTornover').text(Number(Turnover).toFixed(2));
                    $('#TaxTornover_html').text(Number(Turnover).toFixed(2));
                    var Total_Wt_Fr = parseFloat(Number(Turnover).toFixed(2)) + parseFloat(Number(PricingDetails[0]["JCST"]).toFixed(2)) + parseFloat(Number(PricingDetails[0]["ZVAT"]).toFixed(2)) + parseFloat(Number(PricingDetails[0]["ZGTA"]).toFixed(2)) + parseFloat(Number(PricingDetails[0]["ZSSC"]).toFixed(2)) + parseFloat(Number(PricingDetails[0]["ZETO"]).toFixed(2));
                    $('#Total').text(parseFloat(Number(Total_Wt_Fr).toFixed(2)));
                    $('#Total_html').text(parseFloat(Number(Total_Wt_Fr).toFixed(2)));
                    TotalFr = parseFloat(Number(Total_Wt_Fr).toFixed(2)) + parseFloat(Number(PricingDetails[0]["ZINS"]).toFixed(2)) + parseFloat(Number(PricingDetails[0]["ZF00"]).toFixed(2));
                    $('#TotalFr').text(Number(TotalFr).toFixed(2));
                    $('#TotalFr_html').text(Number(TotalFr).toFixed(2));
                    $('#TotalAmountRound').text(Math.round(Number(TotalFr).toFixed(2)) + ".00");
                    $('#TotalAmountRound_html').text(Math.round(Number(TotalFr).toFixed(2)) + ".00");
                    //$('#TotalAmountRound').text(Math.round(TotalFr) + '.00')
                    //$('#TotalAmountRound_html').text(Math.round(TotalFr) + '.00')
                    $('#ExciseAmtInWords').text(toWordsINVOICE(Number(PricingDetails[0]["JEXP"]).toFixed(2)));
                    $('#ExciseAmtInWords_html').text(toWordsINVOICE(Number(PricingDetails[0]["JEXP"]).toFixed(2)));
                    $('#TotalAmtInWords').text(toWordsINVOICE(Number(Header[0]["Gross Amount"]).toFixed(2)));
                    $('#TotalAmtInWords_html').text(toWordsINVOICE(Number(Header[0]["Gross Amount"]).toFixed(2)));
                    //$('#TotalAmtInWords').text(toWordsINVOICE(Math.round(TotalFr) + '.00'));
                    //$('#TotalAmtInWords_html').text(toWordsINVOICE(Math.round(TotalFr) + '.00'));
                    HideLoader();
                } else {
                    HideLoader();
                    alert("No Proper Data");
                }

            }, function errorCallback(response) {
                alert("Error : " + response);
            });
        }
    });
});

//Invoice ZINV Depo Details
DIMS.controller('InvoiceDetail_ZINV_DepoCtrl', function ($scope, $location, DIMSFactory, $http, $compile, $routeParams) {
    $scope.templatesettings = { HeaderTitle: "Invoice details" };
    MasterScope = $scope;
    $scope.go = function (path) {
        CheckUserSession();
        $location.path(path);
    };

    var width = $(window).width(), height = $(window).height();//---------

    var totalheight = height - 191;
    // var totalheight = height - 148;//--------    
    if (height <= 800) {
        totalheight = height - 148;
    }

    $('.content').css({ "max-height": totalheight, "overflow-y": "auto" });//-----------
    $('.content-header > h2').css({ "font-size": "18px", "font-weight": "500" });//----------

    angular.element(document).ready(function () {
        var EditId = $routeParams.ID;
        if (EditId == undefined || EditId == "") {
            EditId = 0;
        } else {
            var decryptedID = CryptoJS.AES.decrypt(EditId, "Secret Passphrase");
            var decryptedDocNo = decryptedID.toString(CryptoJS.enc.Utf8);
            ShowLoader();
            $http({
                method: 'POST',
                url: '../../SAP/Invoice_Details_Edit',
                data: { val: EditId }
            }).then(function successCallback(response) {
                var Data = response.data.tabledata;
                Data = JSON.parse(Data);
                var Header = Data["Header"];
                if (Header != "") {
                    var Plant = Data["Plant"];
                    var Biller = Data["Biller"];
                    var Shipper = Data["Shipper"];
                    var ChildTable = Data["ItemsTable"];
                    var PricingDetails = Data["PricingDetails"];

                    var Gross_Wt = 0;

                    //Sales Order

                    // $scope.BillingDoc = Header[0]["Billing Doc No."];
                    $('#BillingDoc').text(Header[0]["Billing Doc No."]);
                    $('#BillingDoc_html').text(Header[0]["Billing Doc No."]);
                    var ExciseInvdate = Header[0]["EXCISE_INV_DATE"].split('/');
                    // $scope.BillingDate = Header[0]["Billing Date"];
                    var Billing_Date = Header[0]["Billing Date"].split('/');
                    $('#BillingDate').text(Billing_Date[0] + '.' + Billing_Date[1] + '.' + Billing_Date[2]);
                    $('#BillingDate_html').text(Billing_Date[0] + '.' + Billing_Date[1] + '.' + Billing_Date[2]);
                    //$scope.SalesOrderNo = Header[0]["Sales Order"];
                    var SO_No = Header[0]["Sales Order"].split('/');
                    $('#SalesOrderNo').text(parseInt(SO_No[0]) + ' / ' + SO_No[1] + '.' + SO_No[2] + '.' + SO_No[3]);
                    $('#SalesOrderNo_html').text(parseInt(SO_No[0]) + ' / ' + SO_No[1] + '.' + SO_No[2] + '.' + SO_No[3]);

                    //$scope.CINNo = "L74999TG1955PLC000656";

                    $('#CINNo').text("L74999TG1955PLC000656");
                    $('#CINNo_html').text("L74999TG1955PLC000656");
                    // $scope.SoldTo = Shipper[0]["STOCKIST_ID"] + " ( " + Shipper[0]["STOCKIST_NAME"] + " )";
                    //$scope.SoldTo = Header[0]["Sold To"];
                    var Soldto = Header[0]["Sold To"];
                    $('#SoldTo').text(Soldto);
                    $('#SoldTo_html').text(Soldto);
                    var OR_Date = Header[0]["Order Ref Date"].split('/');
                    $('#OrderRefDate').text(OR_Date[0] + ' / ' + OR_Date[1] + '.' + OR_Date[2] + '.' + OR_Date[3]);
                    $('#OrderRefDate_html').text(OR_Date[0] + ' / ' + OR_Date[1] + '.' + OR_Date[2] + '.' + OR_Date[3]);
                    //Date of Preperation
                    var DOP = Header[0]["Billing Date"].split('/');

                    var DOT = Header[0]["Time"];
                    var ss = DOT.split(":");
                    var dt = new Date();
                    dt.setHours(ss[0]);
                    dt.setMinutes(ss[1]);
                    dt.setSeconds(ss[2]);
                    var dt2 = new Date(dt.valueOf() + 40000);
                    var DOT_Time = dt2.toTimeString().split(" ")[0];

                    // $('#DOPrep').text(DOP[0] + '.' + DOP[1] + '.' + DOP[2] + " " + Header[0]["Time"]);
                    //$('#DOPrep_html').text(DOP[0] + '.' + DOP[1] + '.' + DOP[2] + " " + Header[0]["Time"]);
                    //Date of Removal
                    //$('#DORemoval').text(DOP[0] + '.' + DOP[1] + '.' + DOP[2] + " " + DOT_Time);
                    //$('#DORemoval_html').text(DOP[0] + '.' + DOP[1] + '.' + DOP[2] + " " + DOT_Time);

                    $('#Delivery').text("EX Depot");
                    $('#Delivery_html').text("EX Depot");


                    $('#GrossAmnt').text(Header[0]["Gross Amount"]);



                    // $('#NetWeight').text(Header[0]["NET_WT"]);
                    $('#PaymentTerms').text(Header[0]["PAYMENT_TERMS"]);
                    $('#PaymentTerms_html').text(Header[0]["PAYMENT_TERMS"]);
                    $('#LRRNo').text(Header[0]["LR_NO"]);
                    $('#LRRNo_html').text(Header[0]["LR_NO"]);
                    $('#TransporterName').text(Header[0]["Transporter Name"]);
                    $('#TransporterName_html').text(Header[0]["Transporter Name"]);
                    $('#LorryNum').text(Header[0]["VEHICLE_NO"]);
                    $('#LorryNum_html').text(Header[0]["VEHICLE_NO"]);
                    $('#OBDNum').text(Header[0]["DELIVERY_NO"]);
                    $('#OBDNum_html').text(Header[0]["DELIVERY_NO"]);

                    if ((Header[0]["Delivery"] == "ZFR") || (Header[0]["Delivery"] == "FOR")) {
                        $("#lblInsuranceText_html").text("Insurance and Transportation is being arranged on customer's request");
                    } else if (Header[0]["Delivery"] == "EXT") {
                        $("#lblInsuranceText_html").text("Freight to be paid to Transporter directly");
                    }


                    var BillToDetails = "<b>Payer Detail:</b>" + "</br>" + Biller[0]["SOLD_TO_PARTY_NO"] + "</br>";
                    BillToDetails += Biller[0]["STOCKIST_NAME"] + ",<br />" + Biller[0]["Biller Address"].substring(0, 27) + "<br />" + Biller[0]["Biller Address"].substring(27, Biller[0]["Biller Address"].length) + "," + Biller[0]["STATE_NAME"] + "</br>" + "Ph No :" + Biller[0]["PHONE1"] + "</br>" + "TIN No. :" + Biller[0]["TIN_NO"] + "</br>" + "CST No. :" + Biller[0]["CST_NO"] + "</br>" + "&nbsp;";

                    var BillToDetails_html = "<b>Payer Detail:</b>" + "</br>" + Biller[0]["SOLD_TO_PARTY_NO"] + "</br>";
                    BillToDetails_html += Biller[0]["STOCKIST_NAME"] + ",<br />" + Biller[0]["Biller Address"] + "," + Biller[0]["STATE_NAME"] + "</br>" + "Ph No :" + Biller[0]["PHONE1"] + "</br>" + "TIN No. :" + Biller[0]["TIN_NO"] + "</br>" + "CST No. :" + Biller[0]["CST_NO"] + "</br>" + "&nbsp;";


                    //  var ShipperDetails = Shipper[0][""]


                    var ShipperDetails = "<b>Delivery / Consignee:</b>" + "</br>" + Shipper[0]["SHIP_TO_PARTY_NO"] + "</br>";
                    ShipperDetails += Shipper[0]["STOCKIST_NAME"] + ",<br />" + Shipper[0]["Shipper Address"].substring(0, 27) + "<br />" + Shipper[0]["Shipper Address"].substring(27, Shipper[0]["Shipper Address"].length) + "," + Shipper[0]["STATE_NAME"] + "</br>" + "Ph No :" + Shipper[0]["PHONE1"] + "</br>" + "TIN No. :" + Shipper[0]["TIN_NO"] + "</br>" + "CST No. :" + Shipper[0]["CST_NO"] + "</br>" + "&nbsp;";

                    var ShipperDetails_html = "<b>Delivery / Consignee:</b>" + "</br>" + Shipper[0]["SHIP_TO_PARTY_NO"] + "</br>";
                    ShipperDetails_html += Shipper[0]["STOCKIST_NAME"] + ",<br />" + Shipper[0]["Shipper Address"] + "," + Shipper[0]["STATE_NAME"] + "</br>" + "Ph No :" + Shipper[0]["PHONE1"] + "</br>" + "TIN No. :" + Shipper[0]["TIN_NO"] + "</br>" + "CST No. :" + Shipper[0]["CST_NO"] + "</br>" + "&nbsp;";


                    var PlantDetails = "<b>Consigner Detail- HIL Limited</b>" + "</br>" + Plant[0]["NAME3"] + " " + Plant[0]["STREET2"] + " " + Plant[0]["STREET3"] + "<br />" + Plant[0]["STREET"] + " " + Plant[0]["STREET4"] + " " + Plant[0]["CITY_CODE"] + " ," + Plant[0]["DISTRICT"] + " ," + Plant[0]["ZIP_CODE"] + " ," + Plant[0]["STATE_NAME"] + "</br>" + "Email:" + Plant[0]["EMAIL"] + "</br>" + "Phone :" + Plant[0]["PHONE1"] + "</br>" + "TIN No. :" + Plant[0]["TIN_NO"] + "</br>" + "CST No. :" + Plant[0]["CST_NO"] + "</br>" + "&nbsp;";
                    var PlantDetails_html = "<b>Consigner Detail- HIL Limited</b>" + "</br>" + Plant[0]["NAME3"] + " " + Plant[0]["STREET2"] + " " + Plant[0]["STREET3"] + "<br />" + Plant[0]["STREET"] + " " + Plant[0]["STREET4"] + " " + Plant[0]["CITY_CODE"] + " ," + Plant[0]["DISTRICT"] + " ," + Plant[0]["ZIP_CODE"] + " ," + Plant[0]["STATE_NAME"] + "</br>" + "Email:" + Plant[0]["EMAIL"] + "</br>" + "Phone :" + Plant[0]["PHONE1"] + "</br>" + "TIN No. :" + Plant[0]["TIN_NO"] + "</br>" + "CST No. :" + Plant[0]["CST_NO"] + "</br>" + "&nbsp;";
                    $("#lblPlantName").html(Plant[0]["NAME3"] + "" + Plant[0]["STREET2"] + " " + Plant[0]["STREET3"] + " " + Plant[0]["STREET"] + " " + Plant[0]["STREET4"] + " " + Plant[0]["CITY_CODE"] + " " + Plant[0]["DISTRICT"] + " " + +Plant[0]["ZIP_CODE"] + " " + Plant[0]["STATE_NAME"]);
                    //For PDF
                    $("#lblPlantName_html").html(Plant[0]["NAME3"] + "" + Plant[0]["STREET2"] + " " + Plant[0]["STREET3"] + " " + Plant[0]["STREET"] + " " + Plant[0]["STREET4"] + " " + Plant[0]["CITY_CODE"] + " " + Plant[0]["DISTRICT"] + " " + +Plant[0]["ZIP_CODE"] + " " + Plant[0]["STATE_NAME"]);
                    $('#ExciseRange').append(Header[0]["EXCISE_RANGE"]);
                    $('#ExciseDivison').append(Header[0]["EXCISE_DIVISION"]);
                    $('#ExciseCommissionerate').append(Header[0]["EXCISE_COMMISIONARATE"]);

                    $('#ExciseRange_html').append(Header[0]["EXCISE_RANGE"]);
                    $('#ExciseDivison_html').append(Header[0]["EXCISE_DIVISION"]);
                    $('#ExciseCommissionerate_html').append(Header[0]["EXCISE_COMMISIONARATE"]);

                    $('#tbl_Inv_Details').dataTable().fnAddData([PlantDetails, BillToDetails, ShipperDetails]);
                    $('#tbl_Inv_Details_html').dataTable().fnAddData([PlantDetails_html, BillToDetails_html, ShipperDetails_html]);


                    TRCode = "";
                    for (var i = 0; i < ChildTable.length; i++) {
                        var TotalBasicAmt = (ChildTable[i]["BILL_QTY"]) * (ChildTable[i]["Unit Rate"]);
                        Gross_Wt += parseFloat(ChildTable[i]["Wt In Mt"]);
                        $('#tbl_Inv_Details1').dataTable().fnAddData([ChildTable[i]["MATERIAL_NO"], ChildTable[i]["PRODUCT_DESC"], ChildTable[i]["BILL_QTY"], ChildTable[i]["UOM"], ChildTable[i]["PROD_GRP"], Number(ChildTable[i]["Wt In Mt"]).toFixed(3), parseFloat(ChildTable[i]["Unit Rate"]).toFixed(2), parseFloat(TotalBasicAmt).toFixed(2)]);
                        //$('#tbl_Inv_Details1_html').dataTable().fnAddData([ChildTable[i]["MATERIAL_NO"], ChildTable[i]["PRODUCT_DESC"], ChildTable[i]["BILL_QTY"], ChildTable[i]["UOM"], ChildTable[i]["PROD_GRP"], Number(ChildTable[i]["Wt In Mt"]).toFixed(3), parseFloat(ChildTable[i]["Unit Rate"]).toFixed(2), parseFloat(TotalBasicAmt).toFixed(2)]);

                        TRCode = TRCode + "<tr>";
                        TRCode = TRCode + "<td align='center'>" + ChildTable[i]["MATERIAL_NO"] + "</td>";
                        TRCode = TRCode + "<td>" + ChildTable[i]["PRODUCT_DESC"] + "</td>";
                        TRCode = TRCode + "<td align='right'>" + ChildTable[i]["BILL_QTY"] + "</td>";
                        TRCode = TRCode + "<td align='center'>" + ChildTable[i]["UOM"] + "</td>";
                        TRCode = TRCode + "<td align='center'>" + ChildTable[i]["PROD_GRP"] + "</td>";
                        TRCode = TRCode + "<td align='right'>" + parseFloat(ChildTable[i]["Wt In Mt"]).toFixed(3) + "</td>";
                        TRCode = TRCode + "<td align='right'>" + parseFloat(ChildTable[i]["Unit Rate"]).toFixed(2) + "</td>";
                        TRCode = TRCode + "<td align='right'>" + parseFloat(TotalBasicAmt).toFixed(2) + "</td>";
                        TRCode = TRCode + "</tr>";
                    }
                    var Html = $compile(TRCode)($scope);
                    var el = angular.element($("#tbl_Inv_Details1_html tbody"));
                    el.append(Html);
                    $compile(Html)($scope);
                    $("#tbl_Inv_Details1_html").dataTable({
                        "bDestroy": true,
                        "bSort": false,
                        "bScrollCollapse": true,
                        "paging": false,
                        "ordering": false,
                        "info": false,
                        "bFilter": false,
                        "footerCallback": function (tfoot, data, start, end, display) {
                            var api = this.api();
                            $(api.column(7).footer()).html(
                                api.column(7).data().reduce(function (a, b) {
                                    var res = parseFloat(a) + parseFloat(b);
                                    return parseFloat(res).toFixed(2);
                                }, 0)
                            );
                        }
                    });
                    $("#Zinv_Depo_header").remove();
                    $("#Zinv_Depo_header_html").remove();
                    $("#Zinv_Depo_Footer_Header_html").remove();


                    var GrossWeight = Gross_Wt;
                    GrossWeight = parseFloat(GrossWeight).toFixed(3);
                    var GrossWeightinMt = GrossWeight / 1000;


                    $('#GrossWeight').text(GrossWeight + " KG " + "( " + GrossWeightinMt.toFixed(3) + " MT )");
                    $('#GrossWeight_html').text(GrossWeight + " KG " + "( " + GrossWeightinMt.toFixed(3) + " MT )");

                    var NetWeight = Gross_Wt;
                    NetWeight = parseFloat(NetWeight).toFixed(3);
                    var NetWeightinMt = NetWeight / 1000;

                    $('#NetWeight').text(NetWeight + " KG " + "( " + NetWeightinMt.toFixed(3) + " MT )");
                    $('#NetWeight_html').text(NetWeight + " KG " + "( " + NetWeightinMt.toFixed(3) + " MT )");


                    var AssessableValue = 0;
                    var ExiceDuty = 0;
                    var EntryTax = 0;
                    var Turnover = 0;
                    var JCST = 0;
                    var ZSSC = 0;
                    var StateAddTax = 0;
                    var InsuranceTPND = 0;
                    var FreightAmt = 0;
                    var TotalFr = 0;
                    if (parseFloat(PricingDetails[0]["DISC"]) > 0) {
                        $('#Discount').text(Number(PricingDetails[0]["DISC"]).toFixed(2));
                    } else {
                        $("#lblDiscount").hide(); $("#Discount").hide();
                        $("#lblDiscount_html").hide(); $("#Discount_html").hide();
                    }
                    if (parseFloat(PricingDetails[0]["JCST"]) > 0) {
                        if (PricingDetails[0]["STK_PRC_GRP"] == "Z1") {
                            $("#lblAgainstCFORM").html("CST @ " + PricingDetails[0]["JCSTP"] + "% (against CFORM) :"); $("#lblAgainstCFORM_html").html("CST @ " + PricingDetails[0]["JCSTP"] + "% (against CFORM) :");
                        } else {
                            $("#lblAgainstCFORM").html("CST @ " + PricingDetails[0]["JCSTP"] + "% :"); $("#lblAgainstCFORM_html").html("CST @ " + PricingDetails[0]["JCSTP"] + "% :");
                        }
                        $('#AgainstCFORM').text(Number(PricingDetails[0]["JCST"]).toFixed(2));
                        $('#AgainstCFORM_html').text(Number(PricingDetails[0]["JCST"]).toFixed(2));
                    }
                    else {
                        if (parseFloat(PricingDetails[0]["ZVAT"]) > 0) {
                            $("#lblAgainstCFORM").html("VAT @ " + PricingDetails[0]["ZVATP"] + "% :");
                            $("#lblAgainstCFORM_html").html("VAT @ " + PricingDetails[0]["ZVATP"] + "% :");
                            $('#AgainstCFORM').text(Number(PricingDetails[0]["ZVAT"]).toFixed(2));
                            $('#AgainstCFORM_html').text(Number(PricingDetails[0]["ZVAT"]).toFixed(2));
                        } else {
                            $("#lblAgainstCFORM").hide(); $("#AgainstCFORM").hide();
                            $("#lblAgainstCFORM_html").hide(); $("#AgainstCFORM_html").hide();
                        }
                    }




                    if (Number(PricingDetails[0]["ZSSC"].toString()).toFixed(2) == "0.00") {
                        $("#idSteteSess").hide();
                        $("#idSteteSess_html").hide();

                    }
                    else {
                        $('#SteteSec').text(Number(PricingDetails[0]["ZSSC"]).toFixed(2));
                        $('#SteteSec_html').text(Number(PricingDetails[0]["ZSSC"]).toFixed(2));
                        $("#lblSteteSec").html("State Sec Cess @ " + PricingDetails[0]["ZSSCP"] + "% :");
                        $("#lblSteteSec_html").html("State Sec Cess @ " + PricingDetails[0]["ZSSCP"] + "% :");
                    }

                    if (Number(PricingDetails[0]["ZGTA"].toString()).toFixed(2) == "0.00") {
                        $("#idStateAddTax").hide();
                        $("#idStateAddTax_html").hide();
                    } else {
                        $('#StateAddTax').text(Number(PricingDetails[0]["ZGTA"]).toFixed(2));
                        $('#StateAddTax_html').text(Number(PricingDetails[0]["ZGTA"]).toFixed(2));
                        $("#lblSteteSec").html("State Add Tax @ " + PricingDetails[0]["ZGTAP"] + "% :");
                        $("#lblStateAddTax_html").html("State Add Tax @ " + PricingDetails[0]["ZGTAP"] + "% :");
                    }
                    if (parseFloat(PricingDetails[0]["ASS"]) > 0) {
                        $('#AssessableValue').text(Number(PricingDetails[0]["ASS"]).toFixed(2));
                        $('#AssessableValue_html').text(Number(PricingDetails[0]["ASS"]).toFixed(2));
                    } else {
                        $("#lblAssessableValue").hide(); $("#AssessableValue").hide();
                        $("#lblAssessableValue_html").hide(); $("#AssessableValue_html").hide();
                    }
                    //$('#ExiceDuty').text(Number(PricingDetails[0]["JEXP"]).toFixed(2));
                    if ((Number(PricingDetails[0]["ZETX"].toString()).toFixed(2) == "0.00") && (Number(PricingDetails[0]["ZETO"].toString()).toFixed(2) == "0.00")) {
                        $("#idEntryTax").hide();
                        $("#idEntryTax_html").hide();
                        $("#idOrissaTax").hide();
                        $("#idOrissaTax_html").hide();
                    } else {
                        if (Number(PricingDetails[0]["ZETOP"].toString()).toFixed(2) == "0.00") {
                            $('#EntryTax').text(Number(PricingDetails[0]["ZETX"]).toFixed(2));
                            $('#EntryTax_html').text(Number(PricingDetails[0]["ZETX"]).toFixed(2));
                        } else {
                            //$('#EntryTax').text(Number(PricingDetails[0]["ZETO"]).toFixed(2));
                            //$('#EntryTax_html').text(Number(PricingDetails[0]["ZETO"]).toFixed(2));
                            $('#OrissaTax').text(Number(PricingDetails[0]["ZETO"]).toFixed(2));
                            $('#OrissaTax_html').text(Number(PricingDetails[0]["ZETO"]).toFixed(2));
                        }

                        if (Number(PricingDetails[0]["ZETOP"].toString()).toFixed(2) == "0.00") {
                            $("#lblEntryTax").html("Entry Tax @ " + PricingDetails[0]["ZETXP"] + "% :");
                            $("#lblEntryTax_html").html("Entry Tax @ " + PricingDetails[0]["ZETXP"] + "% :");
                        } else {
                            $("#lblOrissaTax").html("Orissa Entry Tax @ " + PricingDetails[0]["ZETOP"] + "% :");
                            $("#lblOrissaTax_html").html("Orissa Entry Tax @ " + PricingDetails[0]["ZETOP"] + "% :");
                        }

                    }

                    if (parseFloat(PricingDetails[0]["ZINS"]) > 0) {
                        $('#InsuranceTPND').text(Number(PricingDetails[0]["ZINS"]).toFixed(2));
                        $('#InsuranceTPND_html').text(Number(PricingDetails[0]["ZINS"]).toFixed(2));

                        $("#lblInsuranceTPND").html("Insurance (TPND) @ " + PricingDetails[0]["ZINSP"] + "% :");
                        $("#lblInsuranceTPND_html").html("Insurance (TPND) @ " + PricingDetails[0]["ZINSP"] + "% :");
                    } else {
                        $("#lblInsuranceTPND").hide(); $("#InsuranceTPND").hide();
                        $("#lblInsuranceTPND_html").hide(); $("#InsuranceTPND_html").hide();
                    }
                    if (parseFloat(PricingDetails[0]["ZF00"]) > 0) {
                        $('#FreightAmt').text(Number(PricingDetails[0]["ZF00"]).toFixed(2));
                        $('#FreightAmt_html').text(Number(PricingDetails[0]["ZF00"]).toFixed(2));
                    } else {
                        $("#lblFreightAmt").hide(); $("#FreightAmt").hide();
                        $("#lblFreightAmt_html").hide(); $("#FreightAmt_html").hide();
                    }


                    JCST += parseFloat(Number(PricingDetails[0]["ZVAT"]).toFixed(2));
                    Turnover = parseFloat(Number(PricingDetails[0]["ASS"]).toFixed(2)) + parseFloat(Number(PricingDetails[0]["JEXP"]).toFixed(2)) + parseFloat(Number(PricingDetails[0]["ZETX"]).toFixed(2));
                    $('#TaxTornover').text(Number(Turnover).toFixed(2));
                    $('#TaxTornover_html').text(Number(Turnover).toFixed(2));
                    var Total_Wt_Fr = parseFloat(Number(Turnover).toFixed(2)) + parseFloat(Number(PricingDetails[0]["JCST"]).toFixed(2)) + parseFloat(Number(PricingDetails[0]["ZVAT"]).toFixed(2)) + parseFloat(Number(PricingDetails[0]["ZGTA"]).toFixed(2)) + parseFloat(Number(PricingDetails[0]["ZSSC"]).toFixed(2)) + parseFloat(Number(PricingDetails[0]["ZETO"]).toFixed(2));
                    $('#Total').text(parseFloat(Number(Total_Wt_Fr).toFixed(2)));
                    $('#Total_html').text(parseFloat(Number(Total_Wt_Fr).toFixed(2)));
                    TotalFr = parseFloat(Number(Total_Wt_Fr).toFixed(2)) + parseFloat(Number(PricingDetails[0]["ZINS"]).toFixed(2)) + parseFloat(Number(PricingDetails[0]["ZF00"]).toFixed(2));
                    $('#TotalFr').text(Number(TotalFr).toFixed(2));
                    $('#TotalFr_html').text(Number(TotalFr).toFixed(2));

                    $('#TotalAmountRound').text(Math.round(Number(Total_Wt_Fr).toFixed(2)) + ".00");
                    //$('#TotalAmountRound_html').text(Math.round((Header[0]["Gross Amount"]).toFixed(2)) + ".00");
                    $('#TotalAmountRound_html').text(Math.round(Number(Total_Wt_Fr).toFixed(2)) + ".00");

                    $('#TotalAmtInWords').text(toWordsINVOICE(Number(Header[0]["Gross Amount"]).toFixed(2)));
                    $('#TotalAmtInWords_html').text(toWordsINVOICE(Number(Header[0]["Gross Amount"]).toFixed(2)));
                    HideLoader();
                } else {
                    HideLoader();
                    alert("No Proper Data");
                }

            }, function errorCallback(response) {
                alert("Error : " + response);
            });
        }
    });
});

//Invoice ZFOC Plant Details
DIMS.controller('InvoiceDetail_ZFOC_PlantCtrl', function ($scope, $location, DIMSFactory, $http, $compile, $routeParams) {
    $scope.templatesettings = { HeaderTitle: "Invoice details" };
    MasterScope = $scope;
    $scope.go = function (path) {
        CheckUserSession();
        $location.path(path);
    };

    var width = $(window).width(), height = $(window).height();//---------

    var totalheight = height - 191;
    // var totalheight = height - 148;//--------    
    if (height <= 800) {
        totalheight = height - 148;
    }

    $('.content').css({ "max-height": totalheight, "overflow-y": "auto" });//-----------
    $('.content-header > h2').css({ "font-size": "18px", "font-weight": "500" });//----------

    angular.element(document).ready(function () {
        var EditId = $routeParams.ID;
        if (EditId == undefined || EditId == "") {
            EditId = 0;
        } else {
            var decryptedID = CryptoJS.AES.decrypt(EditId, "Secret Passphrase");
            var decryptedDocNo = decryptedID.toString(CryptoJS.enc.Utf8);
            ShowLoader();
            $http({
                method: 'POST',
                url: '../../SAP/Invoice_Details_Edit',
                data: { val: EditId }
            }).then(function successCallback(response) {
                var Data = response.data.tabledata;
                Data = JSON.parse(Data);
                var Header = Data["Header"];
                if (Header != "") {
                    var Plant = Data["Plant"];
                    var Biller = Data["Biller"];
                    var Shipper = Data["Shipper"];
                    var ChildTable = Data["ItemsTable"];
                    var PricingDetails = Data["PricingDetails"];

                    var Gross_Wt = 0;

                    //Sales Order

                    // $scope.BillingDoc = Header[0]["Billing Doc No."];
                    $('#BillingDoc').text(Header[0]["Billing Doc No."]);
                    $('#BillingDoc_html').text(Header[0]["Billing Doc No."]);
                    var ExciseInvdate = Header[0]["EXCISE_INV_DATE"].split('/');
                    //  $scope.ExciseInvNo = Header[0]["Excise Inv"] + "/" + ExciseInvdate;
                    $('#ExciseInvNo').text(Header[0]["Excise Inv"] + " / " + ExciseInvdate[0] + '.' + ExciseInvdate[1] + '.' + ExciseInvdate[2]);
                    $('#ExciseInvNo_html').text(Header[0]["Excise Inv"] + " / " + ExciseInvdate[0] + '.' + ExciseInvdate[1] + '.' + ExciseInvdate[2]);
                    // $scope.BillingDate = Header[0]["Billing Date"];
                    var Billing_Date = Header[0]["Billing Date"].split('/');
                    $('#BillingDate').text(Billing_Date[0] + '.' + Billing_Date[1] + '.' + Billing_Date[2]);
                    $('#BillingDate_html').text(Billing_Date[0] + '.' + Billing_Date[1] + '.' + Billing_Date[2]);
                    //$scope.ECCNumber = Header[0]["ECC Number"];
                    $('#ECCNumber').text(Header[0]["ECC Number"]);
                    $('#ECCNumber_html').text(Header[0]["ECC Number"]);
                    //$scope.SalesOrderNo = Header[0]["Sales Order"];
                    var SO_No = Header[0]["Sales Order"].split('/');
                    $('#SalesOrderNo').text(parseInt(SO_No[0]) + ' / ' + SO_No[1] + '.' + SO_No[2] + '.' + SO_No[3]);
                    $('#SalesOrderNo_html').text(parseInt(SO_No[0]) + ' / ' + SO_No[1] + '.' + SO_No[2] + '.' + SO_No[3]);

                    //$scope.CINNo = "L74999TG1955PLC000656";

                    $('#CINNo').text("L74999TG1955PLC000656");
                    $('#CINNo_html').text("L74999TG1955PLC000656");
                    // $scope.SoldTo = Shipper[0]["STOCKIST_ID"] + " ( " + Shipper[0]["STOCKIST_NAME"] + " )";
                    //$scope.SoldTo = Header[0]["Sold To"];
                    var Soldto = Header[0]["Sold To"];
                    $('#SoldTo').text(Soldto);
                    $('#SoldTo_html').text(Soldto);
                    //$scope.OrderRefDate = Header[0]["Order Ref Date"];
                    var OR_Date = Header[0]["Order Ref Date"].split('/');
                    $('#OrderRefDate').text(OR_Date[0] + ' / ' + OR_Date[1] + '.' + OR_Date[2] + '.' + OR_Date[3]);
                    $('#OrderRefDate_html').text(OR_Date[0] + ' / ' + OR_Date[1] + '.' + OR_Date[2] + '.' + OR_Date[3]);
                    //Date of Preperation
                    var DOP = Header[0]["Billing Date"].split('/');
                    var DOT = Header[0]["Time"];
                    var ss = DOT.split(":");
                    var dt = new Date();
                    dt.setHours(ss[0]);
                    dt.setMinutes(ss[1]);
                    dt.setSeconds(ss[2]);
                    var dt2 = new Date(dt.valueOf() + 4000000);
                    var DOT_Time = dt2.toTimeString().split(" ")[0];

                    // $('#DOPrep').text(DOP[0] + '.' + DOP[1] + '.' + DOP[2] + " " + Header[0]["Time"]);
                    // $('#DOPrep_html').text(DOP[0] + '.' + DOP[1] + '.' + DOP[2] + " " + Header[0]["Time"]);
                    //Date of Removal
                    // $('#DORemoval').text(DOP[0] + '.' + DOP[1] + '.' + DOP[2] + " " + DOT_Time);
                    //$('#DORemoval_html').text(DOP[0] + '.' + DOP[1] + '.' + DOP[2] + " " + DOT_Time);

                    $('#Delivery').text("EX Factory");
                    $('#Delivery_html').text("EX Factory");


                    $('#GrossAmnt').text(Header[0]["Gross Amount"]);



                    // $('#NetWeight').text(Header[0]["NET_WT"]);
                    $('#PaymentTerms').text(Header[0]["PAYMENT_TERMS"]);
                    $('#PaymentTerms_html').text(Header[0]["PAYMENT_TERMS"]);
                    $('#LRRNo').text(Header[0]["LR_NO"]);
                    $('#LRRNo_html').text(Header[0]["LR_NO"]);
                    //$('#TransporterName').text(Header[0]["TRANSPORTER"]);
                    $('#TransporterName').text(Header[0]["Transporter Name"]);
                    $('#TransporterName_html').text(Header[0]["Transporter Name"]);
                    $('#LorryNum').text(Header[0]["VEHICLE_NO"]);
                    $('#LorryNum_html').text(Header[0]["VEHICLE_NO"]);
                    $('#OBDNum').text(Header[0]["DELIVERY_NO"]);
                    $('#OBDNum_html').text(Header[0]["DELIVERY_NO"]);

                    if ((Header[0]["Delivery"] == "ZFR") || (Header[0]["Delivery"] == "FOR")) {
                        $("#lblInsuranceText_html").text("Insurance and Transportaion is being arranged on customer's request");
                    } else if (Header[0]["Delivery"] == "EXT") {
                        $("#lblInsuranceText_html").text("Freight to be paid to Transporter directly");
                    }

                    var BillToDetails = "<b>Consignee / Payer Detail:</b>" + "</br>" + Biller[0]["SOLD_TO_PARTY_NO"] + "</br>";
                    BillToDetails += Biller[0]["STOCKIST_NAME"] + ",<br />" + Biller[0]["Biller Address"].substring(0, 27) + "<br />" + Biller[0]["Biller Address"].substring(27, Biller[0]["Biller Address"].length) + "," + Biller[0]["STATE_NAME"] + "</br>" + "Ph No :" + Biller[0]["PHONE1"] + "</br>" + "TIN No. :" + Biller[0]["TIN_NO"] + "</br>" + "CST No. :" + Biller[0]["CST_NO"] + "</br>" + "&nbsp;";

                    var BillToDetails_html = "<b>Consignee / Payer Detail:</b>" + "</br>" + Biller[0]["SOLD_TO_PARTY_NO"] + "</br>";
                    BillToDetails_html += Biller[0]["STOCKIST_NAME"] + ",<br />" + Biller[0]["Biller Address"] + "," + Biller[0]["STATE_NAME"] + "</br>" + "Ph No :" + Biller[0]["PHONE1"] + "</br>" + "TIN No. :" + Biller[0]["TIN_NO"] + "</br>" + "CST No. :" + Biller[0]["CST_NO"] + "</br>" + "&nbsp;";


                    //  var ShipperDetails = Shipper[0][""]


                    var ShipperDetails = "<b>Delivery Address / Consignee:</b>" + "</br>" + Shipper[0]["SHIP_TO_PARTY_NO"] + "</br>";
                    ShipperDetails += Shipper[0]["STOCKIST_NAME"] + ",<br />" + Shipper[0]["Shipper Address"].substring(0, 27) + "<br />" + Shipper[0]["Shipper Address"].substring(27, Shipper[0]["Shipper Address"].length) + "," + Shipper[0]["STATE_NAME"] + "</br>" + "Ph No :" + Shipper[0]["PHONE1"] + "</br>" + "TIN No. :" + Shipper[0]["TIN_NO"] + "</br>" + "CST No. :" + Shipper[0]["CST_NO"] + "</br>" + "&nbsp;";

                    var ShipperDetails_html = "<b>Delivery Address / Consignee:</b>" + "</br>" + Shipper[0]["SHIP_TO_PARTY_NO"] + "</br>";
                    ShipperDetails_html += Shipper[0]["STOCKIST_NAME"] + ",<br />" + Shipper[0]["Shipper Address"] + "," + Shipper[0]["STATE_NAME"] + "</br>" + "Ph No :" + Shipper[0]["PHONE1"] + "</br>" + "TIN No. :" + Shipper[0]["TIN_NO"] + "</br>" + "CST No. :" + Shipper[0]["CST_NO"] + "</br>" + "&nbsp;";


                    //var PlantDetails = "<b>Consigner Detail- HIL Limited</b>" + "</br>" + Plant[0]["NAME3"] + " " + Plant[0]["STREET2"] + " " + Plant[0]["STREET3"] + "<br />" + Plant[0]["STREET"] + " " + Plant[0]["STREET4"] + " " + Plant[0]["CITY_CODE"] + " " + Plant[0]["DISTRICT"] + " " + Plant[0]["ZIP_CODE"] + " " + Plant[0]["STATE_NAME"] + "</br>" + "Email:" + Plant[0]["EMAIL"] + "</br>" + "Phone:" + Plant[0]["PHONE1"] + "</br>" + "TIN No.:" + Plant[0]["TIN_NO"] + "</br>" + "CST No.:" + Plant[0]["CST_NO"];
                    var PlantDetails = "<b>Consigner Detail- HIL Limited</b>" + "</br>" + Plant[0]["NAME3"] + " " + Plant[0]["STREET2"] + " " + Plant[0]["STREET3"] + "<br />" + Plant[0]["STREET"] + " " + Plant[0]["STREET4"] + " " + Plant[0]["CITY_CODE"] + " ," + Plant[0]["DISTRICT"] + " ," + Plant[0]["ZIP_CODE"] + " ," + Plant[0]["STATE_NAME"] + "</br>" + "Email:" + Plant[0]["EMAIL"] + "</br>" + "Phone :" + Plant[0]["PHONE1"] + "</br>" + "TIN No. :" + Plant[0]["TIN_NO"] + "</br>" + "CST No. :" + Plant[0]["CST_NO"] + "</br>" + "&nbsp;";
                    var PlantDetails_html = "<b>Consigner Detail- HIL Limited</b>" + "</br>" + Plant[0]["NAME3"] + " " + Plant[0]["STREET2"] + " " + Plant[0]["STREET3"] + "<br /> " + Plant[0]["STREET"] + " " + Plant[0]["STREET4"] + " " + Plant[0]["CITY_CODE"] + " ," + Plant[0]["DISTRICT"] + " ," + Plant[0]["ZIP_CODE"] + " ," + Plant[0]["STATE_NAME"] + "</br>" + "Email:" + Plant[0]["EMAIL"] + "</br>" + "Phone :" + Plant[0]["PHONE1"] + "</br>" + "TIN No. :" + Plant[0]["TIN_NO"] + "</br>" + "CST No. :" + Plant[0]["CST_NO"] + "</br>" + "&nbsp;";
                    $("#lblPlantName").html(Plant[0]["NAME3"] + "" + Plant[0]["STREET2"] + " " + Plant[0]["STREET3"] + " " + Plant[0]["STREET"] + " " + Plant[0]["STREET4"] + " " + Plant[0]["CITY_CODE"] + " " + Plant[0]["DISTRICT"] + " " + +Plant[0]["ZIP_CODE"] + " " + Plant[0]["STATE_NAME"]);
                    //For PDF
                    $("#lblPlantName_html").html(Plant[0]["NAME3"] + "" + Plant[0]["STREET2"] + " " + Plant[0]["STREET3"] + " " + Plant[0]["STREET"] + " " + Plant[0]["STREET4"] + " " + Plant[0]["CITY_CODE"] + " " + Plant[0]["DISTRICT"] + " " + +Plant[0]["ZIP_CODE"] + " " + Plant[0]["STATE_NAME"]);
                    $('#ExciseRange').append(Header[0]["EXCISE_RANGE"]);
                    $('#ExciseDivison').append(Header[0]["EXCISE_DIVISION"]);
                    $('#ExciseCommissionerate').append(Header[0]["EXCISE_COMMISIONARATE"]);

                    $('#ExciseRange_html').append(Header[0]["EXCISE_RANGE"]);
                    $('#ExciseDivison_html').append(Header[0]["EXCISE_DIVISION"]);
                    $('#ExciseCommissionerate_html').append(Header[0]["EXCISE_COMMISIONARATE"]);

                    $('#tbl_Inv_Details').dataTable().fnAddData([PlantDetails, BillToDetails, ShipperDetails]);
                    $('#tbl_Inv_Details_html').dataTable().fnAddData([PlantDetails_html, BillToDetails_html, ShipperDetails_html]);


                    TRCode = "";
                    for (var i = 0; i < ChildTable.length; i++) {
                        var TotalBasicAmt = (ChildTable[i]["BILL_QTY"]) * (ChildTable[i]["Unit Rate"]);
                        Gross_Wt += parseFloat(ChildTable[i]["Wt In Mt"]);
                        $('#tbl_Inv_Details1').dataTable().fnAddData([ChildTable[i]["MATERIAL_NO"], ChildTable[i]["PRODUCT_DESC"], ChildTable[i]["BILL_QTY"], ChildTable[i]["UOM"], ChildTable[i]["PROD_GRP"], Number(ChildTable[i]["Wt In Mt"]).toFixed(3), parseFloat(ChildTable[i]["Unit Rate"]).toFixed(2), parseFloat(TotalBasicAmt).toFixed(2)]);
                        //$('#tbl_Inv_Details1_html').dataTable().fnAddData([ChildTable[i]["MATERIAL_NO"], ChildTable[i]["PRODUCT_DESC"], ChildTable[i]["BILL_QTY"], ChildTable[i]["UOM"], ChildTable[i]["PROD_GRP"], Number(ChildTable[i]["Wt In Mt"]).toFixed(3), parseFloat(ChildTable[i]["Unit Rate"]).toFixed(2), parseFloat(TotalBasicAmt).toFixed(2)]);

                        TRCode = TRCode + "<tr>";
                        TRCode = TRCode + "<td align='center'>" + ChildTable[i]["MATERIAL_NO"] + "</td>";
                        TRCode = TRCode + "<td>" + ChildTable[i]["PRODUCT_DESC"] + "</td>";
                        TRCode = TRCode + "<td align='right'>" + ChildTable[i]["BILL_QTY"] + "</td>";
                        TRCode = TRCode + "<td align='center'>" + ChildTable[i]["UOM"] + "</td>";
                        TRCode = TRCode + "<td align='center'>" + ChildTable[i]["PROD_GRP"] + "</td>";
                        TRCode = TRCode + "<td align='right'>" + parseFloat(ChildTable[i]["Wt In Mt"]).toFixed(3) + "</td>";
                        TRCode = TRCode + "<td align='right'>" + parseFloat(ChildTable[i]["Unit Rate"]).toFixed(2) + "</td>";
                        TRCode = TRCode + "<td align='right'>" + parseFloat(TotalBasicAmt).toFixed(2) + "</td>";
                        TRCode = TRCode + "</tr>";

                        $("#lblChapter_Id_html").text(ChildTable[0]["CHAPTER_ID"]);
                        $("#lblChapter_Desc_html").text(ChildTable[0]["CHAPTER_DESC"]);
                    }
                    var Html = $compile(TRCode)($scope);
                    var el = angular.element($("#tbl_Inv_Details1_html tbody"));
                    el.append(Html);
                    $compile(Html)($scope);
                    $("#tbl_Inv_Details1_html").dataTable({
                        "bDestroy": true,
                        "bSort": false,
                        "bScrollCollapse": true,
                        "paging": false,
                        "ordering": false,
                        "info": false,
                        "bFilter": false,
                        "footerCallback": function (tfoot, data, start, end, display) {
                            var api = this.api();
                            $(api.column(7).footer()).html(
                                api.column(7).data().reduce(function (a, b) {
                                    var res = parseFloat(a) + parseFloat(b);
                                    return parseFloat(res).toFixed(2);
                                }, 0)
                            );
                        }
                    });

                    $("#Zfoc_Plant_Footer_Header_html").remove();


                    var GrossWeight = Gross_Wt;
                    GrossWeight = parseFloat(GrossWeight).toFixed(3);
                    var GrossWeightinMt = GrossWeight / 1000;


                    $('#GrossWeight').text(GrossWeight + " KG " + "( " + GrossWeightinMt.toFixed(3) + " MT )");
                    $('#GrossWeight_html').text(GrossWeight + " KG " + "( " + GrossWeightinMt.toFixed(3) + " MT )");

                    var NetWeight = Gross_Wt;
                    NetWeight = parseFloat(NetWeight).toFixed(3);
                    var NetWeightinMt = NetWeight / 1000;

                    $('#NetWeight').text(NetWeight + " KG " + "( " + NetWeightinMt.toFixed(3) + " MT )");
                    $('#NetWeight_html').text(NetWeight + " KG " + "( " + NetWeightinMt.toFixed(3) + " MT )");


                    var AssessableValue = 0;
                    var ExiceDuty = 0;
                    var EntryTax = 0;
                    var Turnover = 0;
                    var JCST = 0;
                    var ZSSC = 0;
                    var StateAddTax = 0;
                    var InsuranceTPND = 0;
                    var FreightAmt = 0;
                    var TotalFr = 0;
                    //if (parseFloat(PricingDetails[0]["DISC"]) > 0) {
                    //    $('#Discount').text(Number(PricingDetails[0]["DISC"]).toFixed(2));
                    //} else {
                    //    $("#lblDiscount").hide(); $("#Discount").hide();
                    //    $("#lblDiscount_html").hide(); $("#Discount_html").hide();
                    //}
                    //if (parseFloat(PricingDetails[0]["JCST"]) > 0) {
                    //    $("#lblAgainstCFORM").html("CST :");
                    //    $('#AgainstCFORM').text(Number(PricingDetails[0]["JCST"]).toFixed(2));
                    //    $('#AgainstCFORM_html').text(Number(PricingDetails[0]["JCST"]).toFixed(2));
                    //}
                    //else {
                    //    $("#lblAgainstCFORM").html("VAT :");
                    //    $('#AgainstCFORM').text(Number(PricingDetails[0]["ZVAT"]).toFixed(2));
                    //    $('#AgainstCFORM_html').text(Number(PricingDetails[0]["ZVAT"]).toFixed(2));
                    //}



                    //if (Number(PricingDetails[0]["ZSSC"].toString()).toFixed(2) == "0.00") {
                    //    $("#idSteteSess").hide();
                    //    $("#idSteteSess_html").hide();

                    //}
                    //else {
                    //    $('#SteteSec').text(Number(PricingDetails[0]["ZSSC"]).toFixed(2));
                    //    $('#SteteSec_html').text(Number(PricingDetails[0]["ZSSC"]).toFixed(2));
                    //    $("#lblSteteSec").html("State Sec Cess  :");
                    //    $("#lblSteteSec_html").html("State Sec Cess  :");
                    //}
                    //if (Number(PricingDetails[0]["ZGTA"].toString()).toFixed(2) == "0.00") {
                    //    $("#idStateAddTax").hide();
                    //    $("#idStateAddTax_html").hide();
                    //} else {
                    //    $('#StateAddTax').text(Number(PricingDetails[0]["ZGTA"]).toFixed(2));
                    //    $('#StateAddTax_html').text(Number(PricingDetails[0]["ZGTA"]).toFixed(2));

                    //    $("#lblStateAddTax").html("State Add Tax  :");
                    //    $("#lblStateAddTax_html").html("State Add Tax  :");
                    //}

                    if (parseFloat(PricingDetails[0]["ASS"]) > 0) {
                        $('#AssessableValue').text(Number(PricingDetails[0]["ASS"]).toFixed(2));
                        $('#AssessableValue_html').text(Number(PricingDetails[0]["ASS"]).toFixed(2));
                    } else {
                        $("#lblAssessableValue").hide(); $("#AssessableValue").hide();
                        $("#lblAssessableValue_html").hide(); $("#AssessableValue_html").hide();
                    }
                    //if (parseFloat(PricingDetails[0]["ASS"]) > 0) {
                    //    $('#AssessableValue').text(Number(PricingDetails[0]["ASS"]).toFixed(2));
                    //    $('#AssessableValue_html').text(Number(PricingDetails[0]["ASS"]).toFixed(2));
                    //} else {
                    //    $("#lblAssessableValue").hide(); $("#AssessableValue").hide();
                    //    $("#lblAssessableValue_html").hide(); $("#AssessableValue_html").hide();
                    //}



                    if (parseFloat(PricingDetails[0]["JEXP"]) > 0) {
                        $('#ExiceDuty').text(Number(PricingDetails[0]["JEXP"]).toFixed(2));
                        $('#ExiceDuty_html').text(Number(PricingDetails[0]["JEXP"]).toFixed(2));
                    } else {
                        $("#lblExiceDuty").hide(); $("#ExiceDuty").hide();
                        $("#lblExiceDuty_html").hide(); $("#ExiceDuty_html").hide();
                    }
                    //if (Number(PricingDetails[0]["ZETX"].toString()).toFixed(2) == "0.00") {
                    //    $("#idEntryTax").hide();
                    //    $("#idEntryTax_html").hide();
                    //} else {
                    //    $('#EntryTax').text(Number(PricingDetails[0]["ZETX"]).toFixed(2));
                    //    $('#EntryTax_html').text(Number(PricingDetails[0]["ZETX"]).toFixed(2));
                    //}

                    //if (parseFloat(PricingDetails[0]["ZINS"]) > 0) {
                    //    $('#InsuranceTPND').text(Number(PricingDetails[0]["ZINS"]).toFixed(2));
                    //    $('#InsuranceTPND_html').text(Number(PricingDetails[0]["ZINS"]).toFixed(2));
                    //} else { $("#lblInsuranceTPND").hide(); $("#InsuranceTPND").hide(); $("#lblInsuranceTPND_html").hide(); $("#InsuranceTPND_html").hide(); }
                    //if (parseFloat(PricingDetails[0]["ZF00"]) > 0) {
                    //    $('#FreightAmt').text(Number(PricingDetails[0]["ZF00"]).toFixed(2));
                    //    $('#FreightAmt_html').text(Number(PricingDetails[0]["ZF00"]).toFixed(2));
                    //} else {
                    //    $("#lblFreightAmt").hide(); $("#FreightAmt").hide();
                    //    $("#lblFreightAmt_html").hide(); $("#FreightAmt_html").hide();
                    //}


                    JCST += parseFloat(Number(PricingDetails[0]["ZVAT"]).toFixed(2));
                    Turnover = parseFloat(Number(PricingDetails[0]["ASS"]).toFixed(2)) + parseFloat(Number(PricingDetails[0]["JEXP"]).toFixed(2)) + parseFloat(Number(PricingDetails[0]["ZETX"]).toFixed(2));
                    $('#TaxTornover').text(Number(0).toFixed(2));
                    $('#TaxTornover_html').text(Number(0).toFixed(2));
                    var Total_Wt_Fr = parseFloat(Number(Turnover).toFixed(2)) + parseFloat(Number(PricingDetails[0]["JCST"]).toFixed(2)) + parseFloat(Number(PricingDetails[0]["ZVAT"]).toFixed(2)) + parseFloat(Number(PricingDetails[0]["ZGTA"]).toFixed(2)) + parseFloat(Number(PricingDetails[0]["ZSSC"]).toFixed(2)) + parseFloat(Number(PricingDetails[0]["ZETO"]).toFixed(2));
                    $('#Total').text(Number(0).toFixed(2));
                    $('#Total_html').text(Number(0).toFixed(2));
                    TotalFr = parseFloat(Number(Total_Wt_Fr).toFixed(2)) + parseFloat(Number(PricingDetails[0]["ZINS"]).toFixed(2)) + parseFloat(Number(PricingDetails[0]["ZF00"]).toFixed(2));
                    $('#TotalFr').text(Number(0).toFixed(2));
                    $('#TotalFr_html').text(Number(0).toFixed(2));
                    $('#TotalAmountRound').text(Math.round(Number(0).toFixed(2)) + ".00");
                    $('#TotalAmountRound_html').text(Math.round(Number(0).toFixed(2)) + ".00");
                    $('#ExciseAmtInWords').text(toWordsINVOICE(Number(PricingDetails[0]["JEXP"]).toFixed(2)));
                    $('#ExciseAmtInWords_html').text(toWordsINVOICE(Number(PricingDetails[0]["JEXP"]).toFixed(2)));
                    $('#TotalAmtInWords').text(toWordsINVOICE(Number(0).toFixed(2)));
                    $('#TotalAmtInWords_html').text(toWordsINVOICE(Number(0).toFixed(2)));
                    HideLoader();
                } else {
                    HideLoader();
                    alert("No Proper Data");
                }

            }, function errorCallback(response) {
                alert("Error : " + response);
            });
        }
    });
});

//Invoice ZFOC Depo Details
DIMS.controller('InvoiceDetail_ZFOC_DepoCtrl', function ($scope, $location, DIMSFactory, $http, $compile, $routeParams) {
    $scope.templatesettings = { HeaderTitle: "Invoice details" };
    MasterScope = $scope;
    $scope.go = function (path) {
        CheckUserSession();
        $location.path(path);
    };

    var width = $(window).width(), height = $(window).height();//---------

    var totalheight = height - 191;
    // var totalheight = height - 148;//--------    
    if (height <= 800) {
        totalheight = height - 148;
    }

    $('.content').css({ "max-height": totalheight, "overflow-y": "auto" });//-----------
    $('.content-header > h2').css({ "font-size": "18px", "font-weight": "500" });//----------

    angular.element(document).ready(function () {
        var EditId = $routeParams.ID;
        if (EditId == undefined || EditId == "") {
            EditId = 0;
        } else {
            var decryptedID = CryptoJS.AES.decrypt(EditId, "Secret Passphrase");
            var decryptedDocNo = decryptedID.toString(CryptoJS.enc.Utf8);
            ShowLoader();
            $http({
                method: 'POST',
                url: '../../SAP/Invoice_Details_Edit',
                data: { val: EditId }
            }).then(function successCallback(response) {
                var Data = response.data.tabledata;
                Data = JSON.parse(Data);
                var Header = Data["Header"];
                if (Header != "") {
                    var Plant = Data["Plant"];
                    var Biller = Data["Biller"];
                    var Shipper = Data["Shipper"];
                    var ChildTable = Data["ItemsTable"];
                    var PricingDetails = Data["PricingDetails"];

                    var Gross_Wt = 0;

                    //Sales Order

                    // $scope.BillingDoc = Header[0]["Billing Doc No."];
                    $('#BillingDoc').text(Header[0]["Billing Doc No."]);
                    $('#BillingDoc_html').text(Header[0]["Billing Doc No."]);
                    var ExciseInvdate = Header[0]["EXCISE_INV_DATE"].split('/');
                    // $scope.BillingDate = Header[0]["Billing Date"];
                    var Billing_Date = Header[0]["Billing Date"].split('/');
                    $('#BillingDate').text(Billing_Date[0] + '.' + Billing_Date[1] + '.' + Billing_Date[2]);
                    $('#BillingDate_html').text(Billing_Date[0] + '.' + Billing_Date[1] + '.' + Billing_Date[2]);
                    //$scope.SalesOrderNo = Header[0]["Sales Order"];
                    var SO_No = Header[0]["Sales Order"].split('/');
                    $('#SalesOrderNo').text(parseInt(SO_No[0]) + ' / ' + SO_No[1] + '.' + SO_No[2] + '.' + SO_No[3]);
                    $('#SalesOrderNo_html').text(parseInt(SO_No[0]) + ' / ' + SO_No[1] + '.' + SO_No[2] + '.' + SO_No[3]);

                    //$scope.CINNo = "L74999TG1955PLC000656";

                    $('#CINNo').text("L74999TG1955PLC000656");
                    $('#CINNo_html').text("L74999TG1955PLC000656");
                    // $scope.SoldTo = Shipper[0]["STOCKIST_ID"] + " ( " + Shipper[0]["STOCKIST_NAME"] + " )";
                    //$scope.SoldTo = Header[0]["Sold To"];
                    var Soldto = Header[0]["Sold To"];
                    $('#SoldTo').text(Soldto);
                    $('#SoldTo_html').text(Soldto);
                    var OR_Date = Header[0]["Order Ref Date"].split('/');
                    $('#OrderRefDate').text(OR_Date[0] + ' / ' + OR_Date[1] + '.' + OR_Date[2] + '.' + OR_Date[3]);
                    $('#OrderRefDate_html').text(OR_Date[0] + ' / ' + OR_Date[1] + '.' + OR_Date[2] + '.' + OR_Date[3]);
                    //Date of Preperation
                    var DOP = Header[0]["Billing Date"].split('/');
                    var DOT = Header[0]["Time"];
                    var ss = DOT.split(":");
                    var dt = new Date();
                    dt.setHours(ss[0]);
                    dt.setMinutes(ss[1]);
                    dt.setSeconds(ss[2]);
                    var dt2 = new Date(dt.valueOf() + 40000);
                    var DOT_Time = dt2.toTimeString().split(" ")[0];

                    //$('#DOPrep').text(DOP[0] + '.' + DOP[1] + '.' + DOP[2] + " " + Header[0]["Time"]);
                    //$('#DOPrep_html').text(DOP[0] + '.' + DOP[1] + '.' + DOP[2] + " " + Header[0]["Time"]);
                    //Date of Removal
                    //$('#DORemoval').text(DOP[0] + '.' + DOP[1] + '.' + DOP[2] + " " + DOT_Time);
                    //$('#DORemoval_html').text(DOP[0] + '.' + DOP[1] + '.' + DOP[2] + " " + DOT_Time);

                    $('#Delivery').text("EX Depot");
                    $('#Delivery_html').text("EX Depot");


                    $('#GrossAmnt').text(Header[0]["Gross Amount"]);



                    // $('#NetWeight').text(Header[0]["NET_WT"]);
                    $('#PaymentTerms').text(Header[0]["PAYMENT_TERMS"]);
                    $('#PaymentTerms_html').text(Header[0]["PAYMENT_TERMS"]);
                    $('#LRRNo').text(Header[0]["LR_NO"]);
                    $('#LRRNo_html').text(Header[0]["LR_NO"]);
                    $('#TransporterName').text(Header[0]["Transporter Name"]);
                    $('#TransporterName_html').text(Header[0]["Transporter Name"]);
                    $('#LorryNum').text(Header[0]["VEHICLE_NO"]);
                    $('#LorryNum_html').text(Header[0]["VEHICLE_NO"]);
                    $('#OBDNum').text(Header[0]["DELIVERY_NO"]);
                    $('#OBDNum_html').text(Header[0]["DELIVERY_NO"]);

                    if ((Header[0]["Delivery"] == "ZFR") || (Header[0]["Delivery"] == "FOR")) {
                        $("#lblInsuranceText_html").text("Insurance and Transportaion is being arranged on customer's request");
                    } else if (Header[0]["Delivery"] == "EXT") {
                        $("#lblInsuranceText_html").text("Freight to be paid to Transporter directly");
                    }

                    var BillToDetails = "<b>Payer Detail:</b>" + "</br>" + Biller[0]["SOLD_TO_PARTY_NO"] + "</br>";
                    BillToDetails += Biller[0]["STOCKIST_NAME"] + ",<br />" + Biller[0]["Biller Address"].substring(0, 27) + "<br />" + Biller[0]["Biller Address"].substring(27, Biller[0]["Biller Address"].length) + "," + Biller[0]["STATE_NAME"] + "</br>" + "Ph No :" + Biller[0]["PHONE1"] + "</br>" + "TIN No. :" + Biller[0]["TIN_NO"] + "</br>" + "CST No. :" + Biller[0]["CST_NO"] + "</br>" + "&nbsp;";

                    var BillToDetails_html = "<b>Payer Detail:</b>" + "</br>" + Biller[0]["SOLD_TO_PARTY_NO"] + "</br>";
                    BillToDetails_html += Biller[0]["STOCKIST_NAME"] + ",<br />" + Biller[0]["Biller Address"] + "," + Biller[0]["STATE_NAME"] + "</br>" + "Ph No :" + Biller[0]["PHONE1"] + "</br>" + "TIN No. :" + Biller[0]["TIN_NO"] + "</br>" + "CST No. :" + Biller[0]["CST_NO"] + "</br>" + "&nbsp;";


                    //  var ShipperDetails = Shipper[0][""]


                    var ShipperDetails = "<b>Delivery / Consignee:</b>" + "</br>" + Shipper[0]["SHIP_TO_PARTY_NO"] + "</br>";
                    ShipperDetails += Shipper[0]["STOCKIST_NAME"] + ",<br />" + Shipper[0]["Shipper Address"].substring(0, 27) + "<br />" + Shipper[0]["Shipper Address"].substring(27, Shipper[0]["Shipper Address"].length) + "," + Shipper[0]["STATE_NAME"] + "</br>" + "Ph No :" + Shipper[0]["PHONE1"] + "</br>" + "TIN No. :" + Shipper[0]["TIN_NO"] + "</br>" + "CST No. :" + Shipper[0]["CST_NO"] + "</br>" + "&nbsp;";

                    var ShipperDetails_html = "<b>Delivery / Consignee:</b>" + "</br>" + Shipper[0]["SHIP_TO_PARTY_NO"] + "</br>";
                    ShipperDetails_html += Shipper[0]["STOCKIST_NAME"] + ",<br />" + Shipper[0]["Shipper Address"] + "," + Shipper[0]["STATE_NAME"] + "</br>" + "Ph No :" + Shipper[0]["PHONE1"] + "</br>" + "TIN No. :" + Shipper[0]["TIN_NO"] + "</br>" + "CST No. :" + Shipper[0]["CST_NO"] + "</br>" + "&nbsp;";


                    var PlantDetails = "<b>Consigner Detail- HIL Limited</b>" + "</br>" + Plant[0]["NAME3"] + " " + Plant[0]["STREET2"] + " " + Plant[0]["STREET3"] + "<br />" + Plant[0]["STREET"] + " " + Plant[0]["STREET4"] + " " + Plant[0]["CITY_CODE"] + " ," + Plant[0]["DISTRICT"] + " ," + Plant[0]["ZIP_CODE"] + " ," + Plant[0]["STATE_NAME"] + "</br>" + "Email:" + Plant[0]["EMAIL"] + "</br>" + "Phone :" + Plant[0]["PHONE1"] + "</br>" + "TIN No. :" + Plant[0]["TIN_NO"] + "</br>" + "CST No. :" + Plant[0]["CST_NO"] + "</br>" + "&nbsp;";
                    var PlantDetails_html = "<b>Consigner Detail- HIL Limited</b>" + "</br>" + Plant[0]["NAME3"] + " " + Plant[0]["STREET2"] + " " + Plant[0]["STREET3"] + " <br />" + Plant[0]["STREET"] + " " + Plant[0]["STREET4"] + " " + Plant[0]["CITY_CODE"] + " ," + Plant[0]["DISTRICT"] + " ," + Plant[0]["ZIP_CODE"] + " ," + Plant[0]["STATE_NAME"] + "</br>" + "Email:" + Plant[0]["EMAIL"] + "</br>" + "Phone :" + Plant[0]["PHONE1"] + "</br>" + "TIN No. :" + Plant[0]["TIN_NO"] + "</br>" + "CST No. :" + Plant[0]["CST_NO"] + "</br>" + "&nbsp;";
                    $("#lblPlantName").html(Plant[0]["NAME3"] + "" + Plant[0]["STREET2"] + " " + Plant[0]["STREET3"] + " " + Plant[0]["STREET"] + " " + Plant[0]["STREET4"] + " " + Plant[0]["CITY_CODE"] + " " + Plant[0]["DISTRICT"] + " " + +Plant[0]["ZIP_CODE"] + " " + Plant[0]["STATE_NAME"]);
                    //For PDF
                    $("#lblPlantName_html").html(Plant[0]["NAME3"] + "" + Plant[0]["STREET2"] + " " + Plant[0]["STREET3"] + " " + Plant[0]["STREET"] + " " + Plant[0]["STREET4"] + " " + Plant[0]["CITY_CODE"] + " " + Plant[0]["DISTRICT"] + " " + +Plant[0]["ZIP_CODE"] + " " + Plant[0]["STATE_NAME"]);
                    $('#ExciseRange').append(Header[0]["EXCISE_RANGE"]);
                    $('#ExciseDivison').append(Header[0]["EXCISE_DIVISION"]);
                    $('#ExciseCommissionerate').append(Header[0]["EXCISE_COMMISIONARATE"]);

                    $('#ExciseRange_html').append(Header[0]["EXCISE_RANGE"]);
                    $('#ExciseDivison_html').append(Header[0]["EXCISE_DIVISION"]);
                    $('#ExciseCommissionerate_html').append(Header[0]["EXCISE_COMMISIONARATE"]);

                    $('#tbl_Inv_Details').dataTable().fnAddData([PlantDetails, BillToDetails, ShipperDetails]);
                    $('#tbl_Inv_Details_html').dataTable().fnAddData([PlantDetails_html, BillToDetails_html, ShipperDetails_html]);


                    TRCode = "";
                    for (var i = 0; i < ChildTable.length; i++) {
                        var TotalBasicAmt = (ChildTable[i]["BILL_QTY"]) * (ChildTable[i]["Unit Rate"]);
                        Gross_Wt += parseFloat(ChildTable[i]["Wt In Mt"]);
                        $('#tbl_Inv_Details1').dataTable().fnAddData([ChildTable[i]["MATERIAL_NO"], ChildTable[i]["PRODUCT_DESC"], ChildTable[i]["BILL_QTY"], ChildTable[i]["UOM"], ChildTable[i]["PROD_GRP"], Number(ChildTable[i]["Wt In Mt"]).toFixed(3), parseFloat(ChildTable[i]["Unit Rate"]).toFixed(2), parseFloat(TotalBasicAmt).toFixed(2)]);
                        //$('#tbl_Inv_Details1_html').dataTable().fnAddData([ChildTable[i]["MATERIAL_NO"], ChildTable[i]["PRODUCT_DESC"], ChildTable[i]["BILL_QTY"], ChildTable[i]["UOM"], ChildTable[i]["PROD_GRP"], Number(ChildTable[i]["Wt In Mt"]).toFixed(3), parseFloat(ChildTable[i]["Unit Rate"]).toFixed(2), parseFloat(TotalBasicAmt).toFixed(2)]);

                        TRCode = TRCode + "<tr>";
                        TRCode = TRCode + "<td align='center'>" + ChildTable[i]["MATERIAL_NO"] + "</td>";
                        TRCode = TRCode + "<td>" + ChildTable[i]["PRODUCT_DESC"] + "</td>";
                        TRCode = TRCode + "<td align='right'>" + ChildTable[i]["BILL_QTY"] + "</td>";
                        TRCode = TRCode + "<td align='center'>" + ChildTable[i]["UOM"] + "</td>";
                        TRCode = TRCode + "<td align='center'>" + ChildTable[i]["PROD_GRP"] + "</td>";
                        TRCode = TRCode + "<td align='right'>" + parseFloat(ChildTable[i]["Wt In Mt"]).toFixed(3) + "</td>";
                        TRCode = TRCode + "<td align='right'>" + parseFloat(ChildTable[i]["Unit Rate"]).toFixed(2) + "</td>";
                        TRCode = TRCode + "<td align='right'>" + parseFloat(TotalBasicAmt).toFixed(2) + "</td>";
                        TRCode = TRCode + "</tr>";

                        $("#lblChapter_Id_html").text(ChildTable[0]["CHAPTER_ID"]);
                        $("#lblChapter_Desc_html").text(ChildTable[0]["CHAPTER_DESC"]);
                    }
                    var Html = $compile(TRCode)($scope);
                    var el = angular.element($("#tbl_Inv_Details1_html tbody"));
                    el.append(Html);
                    $compile(Html)($scope);
                    $("#tbl_Inv_Details1_html").dataTable({
                        "bDestroy": true,
                        "bSort": false,
                        "bScrollCollapse": true,
                        "paging": false,
                        "ordering": false,
                        "info": false,
                        "bFilter": false,
                        "footerCallback": function (tfoot, data, start, end, display) {
                            var api = this.api();
                            $(api.column(7).footer()).html(
                                api.column(7).data().reduce(function (a, b) {
                                    var res = parseFloat(a) + parseFloat(b);
                                    return parseFloat(0).toFixed(2);
                                }, 0)
                            );
                        }
                    });
                    $("#Zinv_Depo_header").remove();
                    $("#Zinv_Depo_header_html").remove();
                    $("#Zfoc_Depo_Footer_Header_html").remove();


                    var GrossWeight = Gross_Wt;
                    GrossWeight = parseFloat(GrossWeight).toFixed(3);
                    var GrossWeightinMt = GrossWeight / 1000;


                    $('#GrossWeight').text(GrossWeight + " KG " + "( " + GrossWeightinMt.toFixed(3) + " MT )");
                    $('#GrossWeight_html').text(GrossWeight + " KG " + "( " + GrossWeightinMt.toFixed(3) + " MT )");

                    var NetWeight = Gross_Wt;
                    NetWeight = parseFloat(NetWeight).toFixed(3);
                    var NetWeightinMt = NetWeight / 1000;

                    $('#NetWeight').text(NetWeight + " KG " + "( " + NetWeightinMt.toFixed(3) + " MT )");
                    $('#NetWeight_html').text(NetWeight + " KG " + "( " + NetWeightinMt.toFixed(3) + " MT )");


                    var AssessableValue = 0;
                    var ExiceDuty = 0;
                    var EntryTax = 0;
                    var Turnover = 0;
                    var JCST = 0;
                    var ZSSC = 0;
                    var StateAddTax = 0;
                    var InsuranceTPND = 0;
                    var FreightAmt = 0;
                    var TotalFr = 0;
                    if (parseFloat(PricingDetails[0]["DISC"]) > 0) {
                        $('#Discount').text(Number(PricingDetails[0]["DISC"]).toFixed(2));
                    } else {
                        $("#lblDiscount").hide(); $("#Discount").hide();
                        $("#lblDiscount_html").hide(); $("#Discount_html").hide();
                    }
                    if (parseFloat(PricingDetails[0]["JCST"]) > 0) {
                        $("#lblAgainstCFORM").html("CST :");
                        $("#lblAgainstCFORM_html").html("CST :");
                        $('#AgainstCFORM').text(Number(PricingDetails[0]["JCST"]).toFixed(2));
                        $('#AgainstCFORM_html').text(Number(PricingDetails[0]["JCST"]).toFixed(2));
                    }
                    else {
                        if (parseFloat(PricingDetails[0]["ZVAT"]) > 0) {
                            $("#lblAgainstCFORM").html("VAT :");
                            $("#lblAgainstCFORM_html").html("VAT :");
                            $('#AgainstCFORM').text(Number(PricingDetails[0]["ZVAT"]).toFixed(2));
                            $('#AgainstCFORM_html').text(Number(PricingDetails[0]["ZVAT"]).toFixed(2));
                        } else {
                            $("#lblAgainstCFORM").hide(); $("#AgainstCFORM").hide();
                            $("#lblAgainstCFORM_html").hide(); $("#AgainstCFORM_html").hide();
                        }
                    }




                    if (Number(PricingDetails[0]["ZSSC"].toString()).toFixed(2) == "0.00") {
                        $("#idSteteSess").hide();
                        $("#idSteteSess_html").hide();

                    }
                    else {
                        $('#SteteSec').text(Number(PricingDetails[0]["ZSSC"]).toFixed(2));
                        $('#SteteSec_html').text(Number(PricingDetails[0]["ZSSC"]).toFixed(2));
                        $("#lblSteteSec").html("State Sec Cess  :");
                        $("#lblSteteSec_html").html("State Sec Cess  :");
                    }

                    if (Number(PricingDetails[0]["ZGTA"].toString()).toFixed(2) == "0.00") {
                        $("#idStateAddTax").hide();
                        $("#idStateAddTax_html").hide();
                    } else {
                        $('#StateAddTax').text(Number(PricingDetails[0]["ZGTA"]).toFixed(2));
                        $('#StateAddTax_html').text(Number(PricingDetails[0]["ZGTA"]).toFixed(2));

                        $("#lblStateAddTax").html("State Add Tax  :");
                        $("#lblStateAddTax_html").html("State Add Tax  :");
                    }
                    if (parseFloat(PricingDetails[0]["ASS"]) > 0) {
                        $('#AssessableValue').text(Number(PricingDetails[0]["ASS"]).toFixed(2));
                        $('#AssessableValue_html').text(Number(PricingDetails[0]["ASS"]).toFixed(2));
                    } else {
                        $("#lblAssessableValue").hide(); $("#AssessableValue").hide();
                        $("#lblAssessableValue_html").hide(); $("#AssessableValue_html").hide();
                    }
                    //$('#ExiceDuty').text(Number(PricingDetails[0]["JEXP"]).toFixed(2));
                    //if (Number(PricingDetails[0]["ZETX"].toString()).toFixed(2) == "0.00") {
                    //    $("#idEntryTax").hide();
                    //    $("#idEntryTax_html").hide();
                    //} else {
                    //    $('#EntryTax').text(Number(PricingDetails[0]["ZETX"]).toFixed(2));
                    //    $('#EntryTax_html').text(Number(PricingDetails[0]["ZETX"]).toFixed(2));
                    //}

                    if (parseFloat(PricingDetails[0]["ZINS"]) > 0) {
                        $('#InsuranceTPND').text(Number(PricingDetails[0]["ZINS"]).toFixed(2));
                        $('#InsuranceTPND_html').text(Number(PricingDetails[0]["ZINS"]).toFixed(2));
                    } else { $("#lblInsuranceTPND").hide(); $("#InsuranceTPND").hide(); $("#lblInsuranceTPND_html").hide(); $("#InsuranceTPND_html").hide(); }
                    if (parseFloat(PricingDetails[0]["ZF00"]) > 0) {
                        $('#FreightAmt').text(Number(PricingDetails[0]["ZF00"]).toFixed(2));
                        $('#FreightAmt_html').text(Number(PricingDetails[0]["ZF00"]).toFixed(2));
                    } else {
                        $("#lblFreightAmt").hide(); $("#FreightAmt").hide();
                        $("#lblFreightAmt_html").hide(); $("#FreightAmt_html").hide();
                    }


                    JCST += parseFloat(Number(PricingDetails[0]["ZVAT"]).toFixed(2));
                    Turnover = parseFloat(Number(PricingDetails[0]["ASS"]).toFixed(2)) + parseFloat(Number(PricingDetails[0]["JEXP"]).toFixed(2)) + parseFloat(Number(PricingDetails[0]["ZETX"]).toFixed(2));
                    $('#TaxTornover').text(Number(0).toFixed(2));
                    $('#TaxTornover_html').text(Number(0).toFixed(2));
                    var Total_Wt_Fr = parseFloat(Number(Turnover).toFixed(2)) + parseFloat(Number(PricingDetails[0]["JCST"]).toFixed(2)) + parseFloat(Number(PricingDetails[0]["ZVAT"]).toFixed(2)) + parseFloat(Number(PricingDetails[0]["ZGTA"]).toFixed(2)) + parseFloat(Number(PricingDetails[0]["ZSSC"]).toFixed(2)) + parseFloat(Number(PricingDetails[0]["ZETO"]).toFixed(2));
                    $('#Total').text(Number(0).toFixed(2));
                    $('#Total_html').text(Number(0).toFixed(2));
                    TotalFr = parseFloat(Number(Total_Wt_Fr).toFixed(2)) + parseFloat(Number(PricingDetails[0]["ZINS"]).toFixed(2)) + parseFloat(Number(PricingDetails[0]["ZF00"]).toFixed(2));
                    $('#TotalFr').text(Number(0).toFixed(2));
                    $('#TotalFr_html').text(Number(0).toFixed(2));
                    $('#TotalAmountRound').text(Math.round(Number(0).toFixed(2)) + ".00");
                    $('#TotalAmountRound_html').text(Math.round(Number(0).toFixed(2)) + ".00");
                    $('#TotalAmtInWords').text(toWordsINVOICE(Number(0).toFixed(2)));
                    $('#TotalAmtInWords_html').text(toWordsINVOICE(Number(0).toFixed(2)));
                    HideLoader();
                } else {
                    HideLoader();
                    alert("No Proper Data");
                }

            }, function errorCallback(response) {
                alert("Error : " + response);
            });
        }
    });
});



//Invoice ZINV Plant Details
DIMS.controller('InvoiceDetail_ZINV_Plant_GSTCtrl', function ($scope, $location, DIMSFactory, $http, $compile, $routeParams) {
    $scope.templatesettings = { HeaderTitle: "Invoice details" };
    MasterScope = $scope;
    $scope.go = function (path) {
        CheckUserSession();
        $location.path(path);

    };

    var width = $(window).width(), height = $(window).height();//---------

    var totalheight = height - 191;
    // var totalheight = height - 148;//--------    
    if (height <= 800) {
        totalheight = height - 148;
    }

    $('.content').css({ "max-height": totalheight, "overflow-y": "auto" });//-----------
    $('.content-header > h2').css({ "font-size": "18px", "font-weight": "500" });//----------

    angular.element(document).ready(function () {
        var EditId = $routeParams.ID;


        if (EditId == undefined || EditId == "") {
            EditId = 0;
        } else {
            //var decryptedID = CryptoJS.AES.decrypt(EditId, "Secret Passphrase");
            // var decryptedDocNo = decryptedID.toString(CryptoJS.enc.Utf8);
            ShowLoader();
            $http({
                method: 'POST',
                url: '../../SAP/Invoice_Details_Edit',
                data: { val: EditId }
            }).then(function successCallback(response) {

                var Data = response.data.tabledata;
                Data = JSON.parse(Data);
                var Header = Data["Header"];
                if (Header != "") {
                    var Plant = Data["Plant"];
                    var Biller = Data["Biller"];
                    var Shipper = Data["Shipper"];
                    var ChildTable = Data["ItemsTable"];
                    var PricingDetails = Data["PricingDetails"];

                    var Gross_Wt = 0;


                    $('#BillingDoc').text(Header[0]["Billing Doc No."]);
                    $('#BillingDoc_html').text(Header[0]["Billing Doc No."]);


                    var Billing_Date = Header[0]["Billing Date"].split('/');
                    $('#BillingDate').text(Billing_Date[0] + '.' + Billing_Date[1] + '.' + Billing_Date[2]);
                    $('#BillingDate_html').text(Billing_Date[0] + '.' + Billing_Date[1] + '.' + Billing_Date[2]);

                    var SO_No = Header[0]["Sales Order"].split('/');
                    $('#SalesOrderNo').text(parseInt(SO_No[0]) + ' / ' + SO_No[1] + '.' + SO_No[2] + '.' + SO_No[3]);
                    $('#SalesOrderNo_html').text(parseInt(SO_No[0]) + ' / ' + SO_No[1] + '.' + SO_No[2] + '.' + SO_No[3]);

                    $("#lblPhoneNo").text(Plant[0]["PHONE1"]);
                    $("#lblPhoneNo_html").text(Plant[0]["PHONE1"]);

                    $('#CINNo').text("L74999TG1955PLC000656");
                    $('#CINNo_html').text("L74999TG1955PLC000656");
                    // $scope.SoldTo = Shipper[0]["STOCKIST_ID"] + " ( " + Shipper[0]["STOCKIST_NAME"] + " )";
                    $("#lblGSTINNo").text(Plant[0]["GSTIN_NO"]);
                    $("#lblGSTINNo_html").text(Plant[0]["GSTIN_NO"]);
                    $("#lblPANNo").text(Plant[0]["PAN_NO"]);
                    $("#lblPANNo_html").text(Plant[0]["PAN_NO"]);
                    $("#lblplantEmail").text(Plant[0]["EMAIL"]);
                    $("#lblplantEmail_html").text(Plant[0]["EMAIL"]);

                    var OR_Date = Header[0]["Order Ref Date"].split('/');
                    // $('#OrderRefDate').text(OR_Date[0] + ' / ' + OR_Date[1] + '.' + OR_Date[2] + '.' + OR_Date[3]);
                    // $('#OrderRefDate_html').text(OR_Date[0] + ' / ' + OR_Date[1] + '.' + OR_Date[2] + '.' + OR_Date[3]);


                    var BillToDetails = "<b>Bill to Party</b>" + "</br>" + Biller[0]["SOLD_TO_PARTY_NO"] + "-" + Biller[0]["STOCKIST_NAME"] + " </br>";
                    BillToDetails += Biller[0]["Biller Address"].substring(0, 27) + "<br />" + Biller[0]["Biller Address"].substring(27, Biller[0]["Biller Address"].length) + "," + Biller[0]["STATE_NAME"] + "</br>" + "TIN Number &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:" + Biller[0]["TIN_NO"] + "</br>" + "GST Number &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:" + Biller[0]["GST_NO"] + "</br>" + "PAN Number &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:" + Biller[0]["PAN_NO"] + "" + "</br>" + "Phone Number &nbsp;:" + Biller[0]["PHONE1"] + "</br>";

                    var BillToDetails_html = "<b>Bill to Party</b>" + "</br>" + Biller[0]["SOLD_TO_PARTY_NO"] + "-" + Biller[0]["STOCKIST_NAME"] + " </br>";
                    BillToDetails_html += Biller[0]["Biller Address"].substring(0, 27) + "<br />" + Biller[0]["Biller Address"].substring(27, Biller[0]["Biller Address"].length) + "," + Biller[0]["STATE_NAME"] + "</br>" + "TIN Number &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:" + Biller[0]["TIN_NO"] + "</br>" + "GST Number &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:" + Biller[0]["GST_NO"] + "</br>" + "PAN Number &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:" + Biller[0]["PAN_NO"] + "" + "</br>" + "Phone Number &nbsp; &nbsp;:" + Biller[0]["PHONE1"] + "</br>";

                    var ShipperDetails = "<b>Place of Supply</b>" + "</br>" + Shipper[0]["SHIP_TO_PARTY_NO"] + "-" + Shipper[0]["STOCKIST_NAME"] + "</br>";
                    ShipperDetails += Shipper[0]["Shipper Address"].substring(0, 27) + "<br />" + Shipper[0]["Shipper Address"].substring(27, Shipper[0]["Shipper Address"].length) + "," + Shipper[0]["STATE_NAME"] + "</br>" + "TIN Number &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:" + Shipper[0]["TIN_NO"] + "</br>" + "GST Number &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:" + Shipper[0]["GST_NO"] + "</br>" + "PAN Number &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:" + Shipper[0]["PAN_NO"] + "</br>" + "Phone Number &nbsp;:" + Shipper[0]["PHONE1"] + "</br>";

                    var ShipperDetails_html = "<b>Place of Supply</b>" + "</br>" + Shipper[0]["SHIP_TO_PARTY_NO"] + "-" + Shipper[0]["STOCKIST_NAME"] + "</br>";
                    ShipperDetails_html += Shipper[0]["Shipper Address"].substring(0, 27) + "<br />" + Shipper[0]["Shipper Address"].substring(27, Shipper[0]["Shipper Address"].length) + "," + Shipper[0]["STATE_NAME"] + "</br>" + "TIN Number &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:" + Shipper[0]["TIN_NO"] + "</br>" + "GST Number &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:" + Shipper[0]["GST_NO"] + "</br>" + "PAN Number &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:" + Shipper[0]["PAN_NO"] + "</br>" + "Phone Number &nbsp; &nbsp;:" + Shipper[0]["PHONE1"] + "</br>";


                    //var PlantDetails = "<b>Consigner Detail- HIL Limited</b>" + "</br>" + Plant[0]["NAME3"] + " " + Plant[0]["STREET2"] + " " + Plant[0]["STREET3"] + "<br />" + Plant[0]["STREET"] + " " + Plant[0]["STREET4"] + " " + Plant[0]["CITY_CODE"] + " " + Plant[0]["DISTRICT"] + " " + Plant[0]["ZIP_CODE"] + " " + Plant[0]["STATE_NAME"] + "</br>" + "Email:" + Plant[0]["EMAIL"] + "</br>" + "Phone:" + Plant[0]["PHONE1"] + "</br>" + "TIN No.:" + Plant[0]["TIN_NO"] + "</br>" + "CST No.:" + Plant[0]["CST_NO"];
                    var PlantDetails = "Invoice Number  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: " + Plant[0]["DOC_NO"] + "</br>" + "Invoice Date &nbsp; &nbsp;  &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: " + Billing_Date[0] + '.' + Billing_Date[1] + '.' + Billing_Date[2] + "</br>" + "SO Number & Date &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: " + parseInt(SO_No[0]) + ' & ' + SO_No[1] + '.' + SO_No[2] + '.' + SO_No[3] + "</br>" + "Order Ref & Dt.  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: " + OR_Date[0] + " & " + OR_Date[1] + '.' + OR_Date[2] + '.' + OR_Date[3] + "</br>" + "Delivery / OBD Number  &nbsp; &nbsp;: " + Header[0]["DELIVERY_NO"] + "</br>" + "L/C Number  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: " + "</br>" + "Payment Terms  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: " + Header[0]["PAYMENT_TERMS"] + "" + "</br>" + "Delivery (Inco Terms)  &nbsp;  &nbsp; &nbsp; &nbsp;: Ex Works";

                    var PlantDetails_html = "Invoice Number  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: " + Plant[0]["DOC_NO"] + "</br>" + "Invoice Date &nbsp; &nbsp;  &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: " + Billing_Date[0] + '.' + Billing_Date[1] + '.' + Billing_Date[2] + "</br>" + "SO Number & Date &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: " + parseInt(SO_No[0]) + ' & ' + SO_No[1] + '.' + SO_No[2] + '.' + SO_No[3] + "</br>" + "Order Ref & Dt.  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: " + OR_Date[0] + " & " + OR_Date[1] + '.' + OR_Date[2] + '.' + OR_Date[3] + "</br>" + "Delivery / OBD Number  &nbsp; &nbsp;: " + Header[0]["DELIVERY_NO"] + "</br>" + "L/C Number  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: " + "</br>" + "Payment Terms  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: " + Header[0]["PAYMENT_TERMS"] + "" + "</br>" + "Delivery (Inco Terms)  &nbsp;  &nbsp; &nbsp; &nbsp;: Ex Works";



                    var htc = '<tr><td>' + BillToDetails + '</td>';
                    htc += '<td>' + ShipperDetails + '</td></tr>';
                    $('#tbl_Inv_Stockist').append(htc);

                    var htc_html = '<tr><td>' + BillToDetails_html + '</td>';
                    htc_html += '<td>' + ShipperDetails_html + '</td></tr>';
                    $('#tbl_Inv_Stockist_html').append(htc_html);



                    $("#lblPlantName").html(Plant[0]["NAME3"] + "" + Plant[0]["STREET2"] + " " + Plant[0]["STREET3"] + " " + Plant[0]["STREET"] + " " + Plant[0]["STREET4"] + " " + Plant[0]["CITY_CODE"] + " " + Plant[0]["DISTRICT"] + " " + +Plant[0]["ZIP_CODE"] + " " + Plant[0]["STATE_NAME"]);
                    //For PDF
                    $("#lblPlantName_html").html(Plant[0]["NAME3"] + "" + Plant[0]["STREET2"] + " " + Plant[0]["STREET3"] + " " + Plant[0]["STREET"] + " " + Plant[0]["STREET4"] + " " + Plant[0]["CITY_CODE"] + " " + Plant[0]["DISTRICT"] + " " + +Plant[0]["ZIP_CODE"] + " " + Plant[0]["STATE_NAME"]);


                    //$('#tbl_Inv_Details').dataTable().fnAddData([PlantDetails, BillToDetails, ShipperDetails]);
                    //$('#tbl_Inv_Details_html').dataTable().fnAddData([PlantDetails_html, BillToDetails_html, ShipperDetails_html]);



                    $('#ExciseRange').append(Header[0]["EXCISE_RANGE"]);
                    $('#ExciseDivison').append(Header[0]["EXCISE_DIVISION"]);
                    $('#ExciseCommissionerate').append(Header[0]["EXCISE_COMMISIONARATE"]);

                    $('#ExciseRange_html').append(Header[0]["EXCISE_RANGE"]);
                    $('#ExciseDivison_html').append(Header[0]["EXCISE_DIVISION"]);
                    $('#ExciseCommissionerate_html').append(Header[0]["EXCISE_COMMISIONARATE"]);

                    TRCode = "";
                    for (var i = 0; i < ChildTable.length; i++) {
                        var TotalBasicAmt = (ChildTable[i]["BILL_QTY"]) * (ChildTable[i]["Unit Rate"]);
                        Gross_Wt += parseFloat(ChildTable[i]["Wt In Mt"]);

                        $('#tbl_Inv_Details1').dataTable().fnAddData([ChildTable[i]["MATERIAL_NO"], ChildTable[i]["PRODUCT_DESC"] + "<br/> HSN No - " + ChildTable[i]["HSN_NO"], ChildTable[i]["BILL_QTY"], ChildTable[i]["UOM"], ChildTable[i]["PROD_GRP"], Number(ChildTable[i]["Wt In Mt"]).toFixed(3), parseFloat(ChildTable[i]["Unit Rate"]).toFixed(2), parseFloat(TotalBasicAmt).toFixed(2), parseFloat(ChildTable[i]["DISCOUNT"]).toFixed(2), parseFloat(ChildTable[i]["TAX_AMOUNT"]).toFixed(2)]);
                        //$('#tbl_Inv_Details1_html').dataTable().fnAddData([ChildTable[i]["MATERIAL_NO"], ChildTable[i]["PRODUCT_DESC"], ChildTable[i]["BILL_QTY"], ChildTable[i]["UOM"], ChildTable[i]["PROD_GRP"], Number(ChildTable[i]["Wt In Mt"]).toFixed(3), parseFloat(ChildTable[i]["Unit Rate"]).toFixed(2), parseFloat(TotalBasicAmt).toFixed(2)]);

                        TRCode = TRCode + "<tr>";
                        TRCode = TRCode + "<td align='center'>" + ChildTable[i]["MATERIAL_NO"] + "</td>";
                        TRCode = TRCode + "<td>" + ChildTable[i]["PRODUCT_DESC"] + " HSN No - " + ChildTable[i]["HSN_NO"] + "</td>";
                        TRCode = TRCode + "<td align='right'>" + ChildTable[i]["BILL_QTY"] + "</td>";
                        TRCode = TRCode + "<td align='center'>" + ChildTable[i]["UOM"] + "</td>";
                        TRCode = TRCode + "<td align='center'>" + ChildTable[i]["PROD_GRP"] + "</td>";
                        TRCode = TRCode + "<td align='right'>" + parseFloat(ChildTable[i]["Wt In Mt"]).toFixed(3) + "</td>";
                        TRCode = TRCode + "<td align='right'>" + parseFloat(ChildTable[i]["Unit Rate"]).toFixed(2) + "</td>";
                        TRCode = TRCode + "<td align='right'>" + parseFloat(TotalBasicAmt).toFixed(2) + "</td>";
                        TRCode = TRCode + "<td align='right'>" + parseFloat(ChildTable[i]["DISCOUNT"]).toFixed(2) + "</td>";
                        TRCode = TRCode + "<td align='right'>" + parseFloat(ChildTable[i]["TAX_AMOUNT"]).toFixed(2) + "</td>";
                        TRCode = TRCode + "</tr>";

                    }
                    var Html = $compile(TRCode)($scope);
                    var el = angular.element($("#tbl_Inv_Details1_html tbody"));
                    el.append(Html);
                    $compile(Html)($scope);
                    $("#tbl_Inv_Details1_html").dataTable({
                        "bDestroy": true,
                        "bSort": false,
                        "bScrollCollapse": true,
                        "paging": false,
                        "ordering": false,
                        "info": false,
                        "bFilter": false,
                        "footerCallback": function (tfoot, data, start, end, display) {
                            var api = this.api();
                            $(api.column(7).footer()).html(
                                api.column(7).data().reduce(function (a, b) {
                                    var res = parseFloat(a) + parseFloat(b);
                                    return parseFloat(res).toFixed(2);
                                }, 0)
                            );
                            $(api.column(8).footer()).html(
                                api.column(8).data().reduce(function (a, b) {
                                    var res = parseFloat(a) + parseFloat(b);
                                    return parseFloat(res).toFixed(2);
                                }, 0)
                            );
                            $(api.column(9).footer()).html(
                                api.column(9).data().reduce(function (a, b) {
                                    var res = parseFloat(a) + parseFloat(b);
                                    return parseFloat(res).toFixed(2);
                                }, 0)
                            );
                        }
                    });

                    // $("#Zinv_Plant_Footer_Header_html").remove();
                    $("#lblChapter_Id").text(ChildTable[0]["CHAPTER_ID"]);
                    $("#lblChapter_Id_html").text(ChildTable[0]["CHAPTER_ID"]);
                    $("#lblChapter_Desc").text(ChildTable[0]["CHAPTER_DESC"]);
                    $("#lblChapter_Desc_html").text(ChildTable[0]["CHAPTER_DESC"]);

                    var GrossWeight = Gross_Wt;
                    GrossWeight = parseFloat(GrossWeight).toFixed(3);
                    var GrossWeightinMt = GrossWeight / 1000;


                    $('#GrossWeight').text(GrossWeight + " KG " + "( " + GrossWeightinMt.toFixed(3) + " MT )");
                    $('#GrossWeight_html').text(GrossWeight + " KG " + "( " + GrossWeightinMt.toFixed(3) + " MT )");

                    var NetWeight = Gross_Wt;
                    NetWeight = parseFloat(NetWeight).toFixed(3);
                    var NetWeightinMt = NetWeight / 1000;

                    $('#NetWeight').text(NetWeight + " KG " + "( " + NetWeightinMt.toFixed(3) + " MT )");
                    $('#NetWeight_html').text(NetWeight + " KG " + "( " + NetWeightinMt.toFixed(3) + " MT )");


                    var transportDetails = "Date & Time of Preperation : " + Billing_Date[0] + '.' + Billing_Date[1] + '.' + Billing_Date[2] + " & " + Header[0]["Time"] + "</br>" + "Transporter Name &nbsp;&nbsp;&nbsp;&nbsp;: " + Header[0]["Transporter Name"] + "</br>" + "LR/RR No &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: " + Header[0]["LR_NO"] + "</br>" + "Lorry/Wagon No &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:" + Header[0]["VEHICLE_NO"] + "</br>" + "Gross Weight &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:" + GrossWeight + " KG " + "( " + GrossWeightinMt.toFixed(3) + " MT )" + "</br>" + "Net Weight &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:" + NetWeight + " KG " + "( " + NetWeightinMt.toFixed(3) + " MT )" + "</br>" + "E-Way Bill No  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:" + Header[0]["ZZEWAY_BILLNO"] + "";

                    var transportDetails_html = "Date & Time of Preperation : " + Billing_Date[0] + '.' + Billing_Date[1] + '.' + Billing_Date[2] + " & " + Header[0]["Time"] + "</br>" + "Transporter Name : " + Header[0]["Transporter Name"] + "</br>" + "LR/RR No : " + Header[0]["LR_NO"] + "</br>" + "Lorry/Wagon No : " + Header[0]["VEHICLE_NO"] + "</br>" + "Gross Weight : " + GrossWeight + " KG " + "( " + GrossWeightinMt.toFixed(3) + " MT )" + "</br>" + "Net Weight : " + NetWeight + " KG " + "( " + NetWeightinMt.toFixed(3) + " MT )" + "</br>" + "E-Way Bill No : " + Header[0]["ZZEWAY_BILLNO"] + "";


                    var ht = '<tr ><td>' + PlantDetails + '</td>';
                    ht += '<td>' + transportDetails + '</td></tr>';
                    $('#tbl_Inv_Details').append(ht);

                    var ht_html = '<tr><td >' + PlantDetails_html + '</td>';
                    ht_html += '<td>' + transportDetails_html + '</td></tr>';
                    $('#tbl_Inv_Details_html').append(ht_html);



                    var IgsttotAmt = parseFloat(parseFloat($("#testtot").text()) + parseFloat(Header[0]["IGST"])).toFixed(2);
                    var IgsttotAmt_html = parseFloat(parseFloat($("#testtot").text()) + parseFloat(Header[0]["IGST"])).toFixed(2);
                    var totAmt = parseFloat(parseFloat($("#testtot").text()) + parseFloat(Header[0]["CGST"]) + parseFloat(Header[0]["SGST"])).toFixed(2);
                    var totAmt_html = parseFloat(parseFloat($("#testtot").text()) + parseFloat(Header[0]["CGST"]) + parseFloat(Header[0]["SGST"])).toFixed(2);


                    $("#cgstp").text("@ " + Header[0]["CGSTP"] + " %");
                    $("#cgstp_html").text("@ " + Header[0]["CGSTP"] + " %");
                    $("#sgstp").text("@ " + Header[0]["SGSTP"] + " %");
                    $("#sgstp_html").text("@ " + Header[0]["SGSTP"] + " %");
                    $("#cgstamt").text(Header[0]["CGST"]);
                    $("#cgstamt_html").text(Header[0]["CGST"]);
                    $("#sgstamt").text(Header[0]["SGST"]);
                    $("#sgstamt_html").text(Header[0]["SGST"]);
                    $("#totAmt").text(totAmt);
                    $("#totAmt_html").text(totAmt_html);
                    $("#totAmtrnd").text(Math.round(Number(totAmt).toFixed(2)) + ".00");
                    $("#totAmtrnd_html").text(Math.round(Number(totAmt_html).toFixed(2)) + ".00");
                    $("#Igstp").text("@ " + Header[0]["IGSTP"] + " %");
                    $("#Igstp_html").text("@ " + Header[0]["IGSTP"] + " %");
                    $("#Igstamt").text(Header[0]["IGST"]);
                    $("#Igstamt_html").text(Header[0]["IGST"]);
                    $("#IgsttotAmt").text(IgsttotAmt);
                    $("#IgsttotAmt_html").text(IgsttotAmt_html);
                    $("#IgsttotAmtrnd").text(Math.round(Number(IgsttotAmt).toFixed(2)) + ".00");
                    $("#IgsttotAmtrnd_html").text(Math.round(Number(IgsttotAmt_html).toFixed(2)) + ".00");


                    if (parseFloat(Header[0]["IGST"]) == 0 || Header[0]["IGST"] == "" || Header[0]["IGST"] == undefined) {
                        $("#cgstsection").show();
                        $("#cgstsection_html").show();
                        $('#TotalAmtInWords').text(toWordsINVOICE(parseFloat($("#totAmtrnd").text())));
                        $('#TotalAmtInWords_html').text(toWordsINVOICE(parseFloat($("#totAmtrnd_html").text())));
                        var adda = parseFloat(parseFloat(Header[0]["CGST"]) + parseFloat(Header[0]["SGST"])).toFixed(2);
                        var adda_html = parseFloat(parseFloat(Header[0]["CGST"]) + parseFloat(Header[0]["SGST"])).toFixed(2);
                        $("#totaltaxamountinwords").text(toWordsINVOICE(adda));
                        $("#totaltaxamountinwords_html").text(toWordsINVOICE(adda_html));
                    }
                    else {
                        $("#igstsection").show();
                        $("#igstsection_html").show();
                        $('#TotalAmtInWords').text(toWordsINVOICE(parseFloat($("#IgsttotAmtrnd").text())));
                        $('#TotalAmtInWords_html').text(toWordsINVOICE(parseFloat($("#IgsttotAmtrnd_html").text())));
                        $("#totaltaxamountinwords").text(toWordsINVOICE(parseFloat(Header[0]["IGST"])));
                        $("#totaltaxamountinwords_html").text(toWordsINVOICE(parseFloat(Header[0]["IGST"])));
                    }


                    HideLoader();
                } else {
                    HideLoader();
                    alert("No Proper Data");
                }


            }, function errorCallback(response) {
                alert("Error : " + response);
            });
        }
    });
});

//Invoice ZINV Depo Details
DIMS.controller('InvoiceDetail_ZINV_Depo_GSTCtrl', function ($scope, $location, DIMSFactory, $http, $compile, $routeParams) {
    $scope.templatesettings = { HeaderTitle: "Invoice details" };
    MasterScope = $scope;
    $scope.go = function (path) {
        CheckUserSession();
        $location.path(path);
    };

    var width = $(window).width(), height = $(window).height();//---------

    var totalheight = height - 191;
    // var totalheight = height - 148;//--------    
    if (height <= 800) {
        totalheight = height - 148;
    }

    $('.content').css({ "max-height": totalheight, "overflow-y": "auto" });//-----------
    $('.content-header > h2').css({ "font-size": "18px", "font-weight": "500" });//----------

    angular.element(document).ready(function () {
        var EditId = $routeParams.ID;
        if (EditId == undefined || EditId == "") {
            EditId = 0;
        } else {
            var decryptedID = CryptoJS.AES.decrypt(EditId, "Secret Passphrase");
            var decryptedDocNo = decryptedID.toString(CryptoJS.enc.Utf8);
            ShowLoader();
            $http({
                method: 'POST',
                url: '../../SAP/Invoice_Details_Edit',
                data: { val: EditId }
            }).then(function successCallback(response) {
                alert(response);
                var Data = response.data.tabledata;
                Data = JSON.parse(Data);
                var Header = Data["Header"];
                if (Header != "") {
                    var Plant = Data["Plant"];
                    var Biller = Data["Biller"];
                    var Shipper = Data["Shipper"];
                    var ChildTable = Data["ItemsTable"];
                    var PricingDetails = Data["PricingDetails"];

                    var Gross_Wt = 0;

                    //Sales Order

                    alert(Header[0]["EXCISE_DIVISION"]);

                    // $scope.BillingDoc = Header[0]["Billing Doc No."];
                    $('#BillingDoc').text(Header[0]["Billing Doc No."]);
                    $('#BillingDoc_html').text(Header[0]["Billing Doc No."]);
                    var ExciseInvdate = Header[0]["EXCISE_INV_DATE"].split('/');
                    // $scope.BillingDate = Header[0]["Billing Date"];
                    var Billing_Date = Header[0]["Billing Date"].split('/');
                    $('#BillingDate').text(Billing_Date[0] + '.' + Billing_Date[1] + '.' + Billing_Date[2]);
                    $('#BillingDate_html').text(Billing_Date[0] + '.' + Billing_Date[1] + '.' + Billing_Date[2]);
                    //$scope.SalesOrderNo = Header[0]["Sales Order"];
                    var SO_No = Header[0]["Sales Order"].split('/');
                    $('#SalesOrderNo').text(parseInt(SO_No[0]) + ' / ' + SO_No[1] + '.' + SO_No[2] + '.' + SO_No[3]);
                    $('#SalesOrderNo_html').text(parseInt(SO_No[0]) + ' / ' + SO_No[1] + '.' + SO_No[2] + '.' + SO_No[3]);

                    //$scope.CINNo = "L74999TG1955PLC000656";

                    $('#CINNo').text("L74999TG1955PLC000656");
                    $('#CINNo_html').text("L74999TG1955PLC000656");
                    // $scope.SoldTo = Shipper[0]["STOCKIST_ID"] + " ( " + Shipper[0]["STOCKIST_NAME"] + " )";
                    //$scope.SoldTo = Header[0]["Sold To"];
                    var Soldto = Header[0]["Sold To"];
                    $('#SoldTo').text(Soldto);
                    $('#SoldTo_html').text(Soldto);
                    var OR_Date = Header[0]["Order Ref Date"].split('/');
                    $('#OrderRefDate').text(OR_Date[0] + ' / ' + OR_Date[1] + '.' + OR_Date[2] + '.' + OR_Date[3]);
                    $('#OrderRefDate_html').text(OR_Date[0] + ' / ' + OR_Date[1] + '.' + OR_Date[2] + '.' + OR_Date[3]);
                    //Date of Preperation
                    var DOP = Header[0]["Billing Date"].split('/');

                    var DOT = Header[0]["Time"];
                    var ss = DOT.split(":");
                    var dt = new Date();
                    dt.setHours(ss[0]);
                    dt.setMinutes(ss[1]);
                    dt.setSeconds(ss[2]);
                    var dt2 = new Date(dt.valueOf() + 40000);
                    var DOT_Time = dt2.toTimeString().split(" ")[0];

                    // $('#DOPrep').text(DOP[0] + '.' + DOP[1] + '.' + DOP[2] + " " + Header[0]["Time"]);
                    //$('#DOPrep_html').text(DOP[0] + '.' + DOP[1] + '.' + DOP[2] + " " + Header[0]["Time"]);
                    //Date of Removal
                    //$('#DORemoval').text(DOP[0] + '.' + DOP[1] + '.' + DOP[2] + " " + DOT_Time);
                    //$('#DORemoval_html').text(DOP[0] + '.' + DOP[1] + '.' + DOP[2] + " " + DOT_Time);

                    $('#Delivery').text("EX Depot");
                    $('#Delivery_html').text("EX Depot");


                    $('#GrossAmnt').text(Header[0]["Gross Amount"]);



                    // $('#NetWeight').text(Header[0]["NET_WT"]);
                    $('#PaymentTerms').text(Header[0]["PAYMENT_TERMS"]);
                    $('#PaymentTerms_html').text(Header[0]["PAYMENT_TERMS"]);
                    $('#LRRNo').text(Header[0]["LR_NO"]);
                    $('#LRRNo_html').text(Header[0]["LR_NO"]);
                    $('#TransporterName').text(Header[0]["Transporter Name"]);
                    $('#TransporterName_html').text(Header[0]["Transporter Name"]);
                    $('#LorryNum').text(Header[0]["VEHICLE_NO"]);
                    $('#LorryNum_html').text(Header[0]["VEHICLE_NO"]);
                    $('#OBDNum').text(Header[0]["DELIVERY_NO"]);
                    $('#OBDNum_html').text(Header[0]["DELIVERY_NO"]);

                    if ((Header[0]["Delivery"] == "ZFR") || (Header[0]["Delivery"] == "FOR")) {
                        $("#lblInsuranceText_html").text("Insurance and Transportation is being arranged on customer's request");
                    } else if (Header[0]["Delivery"] == "EXT") {
                        $("#lblInsuranceText_html").text("Freight to be paid to Transporter directly");
                    }


                    var BillToDetails = "<b>Payer Detail:</b>" + "</br>" + Biller[0]["SOLD_TO_PARTY_NO"] + "</br>";
                    BillToDetails += Biller[0]["STOCKIST_NAME"] + ",<br />" + Biller[0]["Biller Address"].substring(0, 27) + "<br />" + Biller[0]["Biller Address"].substring(27, Biller[0]["Biller Address"].length) + "," + Biller[0]["STATE_NAME"] + "</br>" + "Ph No :" + Biller[0]["PHONE1"] + "</br>" + "TIN No. :" + Biller[0]["TIN_NO"] + "</br>" + "CST No. :" + Biller[0]["CST_NO"] + "</br>" + "&nbsp;";

                    var BillToDetails_html = "<b>Payer Detail:</b>" + "</br>" + Biller[0]["SOLD_TO_PARTY_NO"] + "</br>";
                    BillToDetails_html += Biller[0]["STOCKIST_NAME"] + ",<br />" + Biller[0]["Biller Address"] + "," + Biller[0]["STATE_NAME"] + "</br>" + "Ph No :" + Biller[0]["PHONE1"] + "</br>" + "TIN No. :" + Biller[0]["TIN_NO"] + "</br>" + "CST No. :" + Biller[0]["CST_NO"] + "</br>" + "&nbsp;";


                    //  var ShipperDetails = Shipper[0][""]


                    var ShipperDetails = "<b>Delivery / Consignee:</b>" + "</br>" + Shipper[0]["SHIP_TO_PARTY_NO"] + "</br>";
                    ShipperDetails += Shipper[0]["STOCKIST_NAME"] + ",<br />" + Shipper[0]["Shipper Address"].substring(0, 27) + "<br />" + Shipper[0]["Shipper Address"].substring(27, Shipper[0]["Shipper Address"].length) + "," + Shipper[0]["STATE_NAME"] + "</br>" + "Ph No :" + Shipper[0]["PHONE1"] + "</br>" + "TIN No. :" + Shipper[0]["TIN_NO"] + "</br>" + "CST No. :" + Shipper[0]["CST_NO"] + "</br>" + "&nbsp;";

                    var ShipperDetails_html = "<b>Delivery / Consignee:</b>" + "</br>" + Shipper[0]["SHIP_TO_PARTY_NO"] + "</br>";
                    ShipperDetails_html += Shipper[0]["STOCKIST_NAME"] + ",<br />" + Shipper[0]["Shipper Address"] + "," + Shipper[0]["STATE_NAME"] + "</br>" + "Ph No :" + Shipper[0]["PHONE1"] + "</br>" + "TIN No. :" + Shipper[0]["TIN_NO"] + "</br>" + "CST No. :" + Shipper[0]["CST_NO"] + "</br>" + "&nbsp;";


                    var PlantDetails = "<b>Consigner Detail- HIL Limited</b>" + "</br>" + Plant[0]["NAME3"] + " " + Plant[0]["STREET2"] + " " + Plant[0]["STREET3"] + "<br />" + Plant[0]["STREET"] + " " + Plant[0]["STREET4"] + " " + Plant[0]["CITY_CODE"] + " ," + Plant[0]["DISTRICT"] + " ," + Plant[0]["ZIP_CODE"] + " ," + Plant[0]["STATE_NAME"] + "</br>" + "Email:" + Plant[0]["EMAIL"] + "</br>" + "Phone :" + Plant[0]["PHONE1"] + "</br>" + "TIN No. :" + Plant[0]["TIN_NO"] + "</br>" + "CST No. :" + Plant[0]["CST_NO"] + "</br>" + "&nbsp;";
                    var PlantDetails_html = "<b>Consigner Detail- HIL Limited</b>" + "</br>" + Plant[0]["NAME3"] + " " + Plant[0]["STREET2"] + " " + Plant[0]["STREET3"] + "<br />" + Plant[0]["STREET"] + " " + Plant[0]["STREET4"] + " " + Plant[0]["CITY_CODE"] + " ," + Plant[0]["DISTRICT"] + " ," + Plant[0]["ZIP_CODE"] + " ," + Plant[0]["STATE_NAME"] + "</br>" + "Email:" + Plant[0]["EMAIL"] + "</br>" + "Phone :" + Plant[0]["PHONE1"] + "</br>" + "TIN No. :" + Plant[0]["TIN_NO"] + "</br>" + "CST No. :" + Plant[0]["CST_NO"] + "</br>" + "&nbsp;";
                    $("#lblPlantName").html(Plant[0]["NAME3"] + "" + Plant[0]["STREET2"] + " " + Plant[0]["STREET3"] + " " + Plant[0]["STREET"] + " " + Plant[0]["STREET4"] + " " + Plant[0]["CITY_CODE"] + " " + Plant[0]["DISTRICT"] + " " + +Plant[0]["ZIP_CODE"] + " " + Plant[0]["STATE_NAME"]);
                    //For PDF
                    $("#lblPlantName_html").html(Plant[0]["NAME3"] + "" + Plant[0]["STREET2"] + " " + Plant[0]["STREET3"] + " " + Plant[0]["STREET"] + " " + Plant[0]["STREET4"] + " " + Plant[0]["CITY_CODE"] + " " + Plant[0]["DISTRICT"] + " " + +Plant[0]["ZIP_CODE"] + " " + Plant[0]["STATE_NAME"]);
                    $('#ExciseRange').append(Header[0]["EXCISE_RANGE"]);
                    $('#ExciseDivison').append(Header[0]["EXCISE_DIVISION"]);
                    $('#ExciseCommissionerate').append(Header[0]["EXCISE_COMMISIONARATE"]);

                    $('#ExciseRange_html').append(Header[0]["EXCISE_RANGE"]);
                    $('#ExciseDivison_html').append(Header[0]["EXCISE_DIVISION"]);
                    $('#ExciseCommissionerate_html').append(Header[0]["EXCISE_COMMISIONARATE"]);



                    $('#tbl_Inv_Details').dataTable().fnAddData([PlantDetails, BillToDetails, ShipperDetails]);
                    $('#tbl_Inv_Details_html').dataTable().fnAddData([PlantDetails_html, BillToDetails_html, ShipperDetails_html]);


                    TRCode = "";
                    for (var i = 0; i < ChildTable.length; i++) {
                        var TotalBasicAmt = (ChildTable[i]["BILL_QTY"]) * (ChildTable[i]["Unit Rate"]);
                        Gross_Wt += parseFloat(ChildTable[i]["Wt In Mt"]);
                        $('#tbl_Inv_Details1').dataTable().fnAddData([ChildTable[i]["MATERIAL_NO"], ChildTable[i]["PRODUCT_DESC"], ChildTable[i]["BILL_QTY"], ChildTable[i]["UOM"], ChildTable[i]["PROD_GRP"], Number(ChildTable[i]["Wt In Mt"]).toFixed(3), parseFloat(ChildTable[i]["Unit Rate"]).toFixed(2), parseFloat(TotalBasicAmt).toFixed(2)]);
                        //$('#tbl_Inv_Details1_html').dataTable().fnAddData([ChildTable[i]["MATERIAL_NO"], ChildTable[i]["PRODUCT_DESC"], ChildTable[i]["BILL_QTY"], ChildTable[i]["UOM"], ChildTable[i]["PROD_GRP"], Number(ChildTable[i]["Wt In Mt"]).toFixed(3), parseFloat(ChildTable[i]["Unit Rate"]).toFixed(2), parseFloat(TotalBasicAmt).toFixed(2)]);

                        TRCode = TRCode + "<tr>";
                        TRCode = TRCode + "<td align='center'>" + ChildTable[i]["MATERIAL_NO"] + "</td>";
                        TRCode = TRCode + "<td>" + ChildTable[i]["PRODUCT_DESC"] + "</td>";
                        TRCode = TRCode + "<td align='right'>" + ChildTable[i]["BILL_QTY"] + "</td>";
                        TRCode = TRCode + "<td align='center'>" + ChildTable[i]["UOM"] + "</td>";
                        TRCode = TRCode + "<td align='center'>" + ChildTable[i]["PROD_GRP"] + "</td>";
                        TRCode = TRCode + "<td align='right'>" + parseFloat(ChildTable[i]["Wt In Mt"]).toFixed(3) + "</td>";
                        TRCode = TRCode + "<td align='right'>" + parseFloat(ChildTable[i]["Unit Rate"]).toFixed(2) + "</td>";
                        TRCode = TRCode + "<td align='right'>" + parseFloat(TotalBasicAmt).toFixed(2) + "</td>";
                        TRCode = TRCode + "</tr>";
                    }
                    var Html = $compile(TRCode)($scope);
                    var el = angular.element($("#tbl_Inv_Details1_html tbody"));
                    el.append(Html);
                    $compile(Html)($scope);
                    $("#tbl_Inv_Details1_html").dataTable({
                        "bDestroy": true,
                        "bSort": false,
                        "bScrollCollapse": true,
                        "paging": false,
                        "ordering": false,
                        "info": false,
                        "bFilter": false,
                        "footerCallback": function (tfoot, data, start, end, display) {
                            var api = this.api();
                            $(api.column(7).footer()).html(
                                api.column(7).data().reduce(function (a, b) {
                                    var res = parseFloat(a) + parseFloat(b);
                                    return parseFloat(res).toFixed(2);
                                }, 0)
                            );
                        }
                    });
                    $("#Zinv_Depo_header").remove();
                    $("#Zinv_Depo_header_html").remove();
                    $("#Zinv_Depo_Footer_Header_html").remove();


                    var GrossWeight = Gross_Wt;
                    GrossWeight = parseFloat(GrossWeight).toFixed(3);
                    var GrossWeightinMt = GrossWeight / 1000;


                    $('#GrossWeight').text(GrossWeight + " KG " + "( " + GrossWeightinMt.toFixed(3) + " MT )");
                    $('#GrossWeight_html').text(GrossWeight + " KG " + "( " + GrossWeightinMt.toFixed(3) + " MT )");

                    var NetWeight = Gross_Wt;
                    NetWeight = parseFloat(NetWeight).toFixed(3);
                    var NetWeightinMt = NetWeight / 1000;

                    $('#NetWeight').text(NetWeight + " KG " + "( " + NetWeightinMt.toFixed(3) + " MT )");
                    $('#NetWeight_html').text(NetWeight + " KG " + "( " + NetWeightinMt.toFixed(3) + " MT )");


                    var AssessableValue = 0;
                    var ExiceDuty = 0;
                    var EntryTax = 0;
                    var Turnover = 0;
                    var JCST = 0;
                    var ZSSC = 0;
                    var StateAddTax = 0;
                    var InsuranceTPND = 0;
                    var FreightAmt = 0;
                    var TotalFr = 0;
                    if (parseFloat(PricingDetails[0]["DISC"]) > 0) {
                        $('#Discount').text(Number(PricingDetails[0]["DISC"]).toFixed(2));
                    } else {
                        $("#lblDiscount").hide(); $("#Discount").hide();
                        $("#lblDiscount_html").hide(); $("#Discount_html").hide();
                    }
                    if (parseFloat(PricingDetails[0]["JCST"]) > 0) {
                        if (PricingDetails[0]["STK_PRC_GRP"] == "Z1") {
                            $("#lblAgainstCFORM").html("CST @ " + PricingDetails[0]["JCSTP"] + "% (against CFORM) :"); $("#lblAgainstCFORM_html").html("CST @ " + PricingDetails[0]["JCSTP"] + "% (against CFORM) :");
                        } else {
                            $("#lblAgainstCFORM").html("CST @ " + PricingDetails[0]["JCSTP"] + "% :"); $("#lblAgainstCFORM_html").html("CST @ " + PricingDetails[0]["JCSTP"] + "% :");
                        }
                        $('#AgainstCFORM').text(Number(PricingDetails[0]["JCST"]).toFixed(2));
                        $('#AgainstCFORM_html').text(Number(PricingDetails[0]["JCST"]).toFixed(2));
                    }
                    else {
                        if (parseFloat(PricingDetails[0]["ZVAT"]) > 0) {
                            $("#lblAgainstCFORM").html("VAT @ " + PricingDetails[0]["ZVATP"] + "% :");
                            $("#lblAgainstCFORM_html").html("VAT @ " + PricingDetails[0]["ZVATP"] + "% :");
                            $('#AgainstCFORM').text(Number(PricingDetails[0]["ZVAT"]).toFixed(2));
                            $('#AgainstCFORM_html').text(Number(PricingDetails[0]["ZVAT"]).toFixed(2));
                        } else {
                            $("#lblAgainstCFORM").hide(); $("#AgainstCFORM").hide();
                            $("#lblAgainstCFORM_html").hide(); $("#AgainstCFORM_html").hide();
                        }
                    }




                    if (Number(PricingDetails[0]["ZSSC"].toString()).toFixed(2) == "0.00") {
                        $("#idSteteSess").hide();
                        $("#idSteteSess_html").hide();

                    }
                    else {
                        $('#SteteSec').text(Number(PricingDetails[0]["ZSSC"]).toFixed(2));
                        $('#SteteSec_html').text(Number(PricingDetails[0]["ZSSC"]).toFixed(2));
                        $("#lblSteteSec").html("State Sec Cess @ " + PricingDetails[0]["ZSSCP"] + "% :");
                        $("#lblSteteSec_html").html("State Sec Cess @ " + PricingDetails[0]["ZSSCP"] + "% :");
                    }

                    if (Number(PricingDetails[0]["ZGTA"].toString()).toFixed(2) == "0.00") {
                        $("#idStateAddTax").hide();
                        $("#idStateAddTax_html").hide();
                    } else {
                        $('#StateAddTax').text(Number(PricingDetails[0]["ZGTA"]).toFixed(2));
                        $('#StateAddTax_html').text(Number(PricingDetails[0]["ZGTA"]).toFixed(2));
                        $("#lblSteteSec").html("State Add Tax @ " + PricingDetails[0]["ZGTAP"] + "% :");
                        $("#lblStateAddTax_html").html("State Add Tax @ " + PricingDetails[0]["ZGTAP"] + "% :");
                    }
                    if (parseFloat(PricingDetails[0]["ASS"]) > 0) {
                        $('#AssessableValue').text(Number(PricingDetails[0]["ASS"]).toFixed(2));
                        $('#AssessableValue_html').text(Number(PricingDetails[0]["ASS"]).toFixed(2));
                    } else {
                        $("#lblAssessableValue").hide(); $("#AssessableValue").hide();
                        $("#lblAssessableValue_html").hide(); $("#AssessableValue_html").hide();
                    }
                    //$('#ExiceDuty').text(Number(PricingDetails[0]["JEXP"]).toFixed(2));
                    if ((Number(PricingDetails[0]["ZETX"].toString()).toFixed(2) == "0.00") && (Number(PricingDetails[0]["ZETO"].toString()).toFixed(2) == "0.00")) {
                        $("#idEntryTax").hide();
                        $("#idEntryTax_html").hide();
                        $("#idOrissaTax").hide();
                        $("#idOrissaTax_html").hide();
                    } else {
                        if (Number(PricingDetails[0]["ZETOP"].toString()).toFixed(2) == "0.00") {
                            $('#EntryTax').text(Number(PricingDetails[0]["ZETX"]).toFixed(2));
                            $('#EntryTax_html').text(Number(PricingDetails[0]["ZETX"]).toFixed(2));
                        } else {
                            //$('#EntryTax').text(Number(PricingDetails[0]["ZETO"]).toFixed(2));
                            //$('#EntryTax_html').text(Number(PricingDetails[0]["ZETO"]).toFixed(2));
                            $('#OrissaTax').text(Number(PricingDetails[0]["ZETO"]).toFixed(2));
                            $('#OrissaTax_html').text(Number(PricingDetails[0]["ZETO"]).toFixed(2));
                        }

                        if (Number(PricingDetails[0]["ZETOP"].toString()).toFixed(2) == "0.00") {
                            $("#lblEntryTax").html("Entry Tax @ " + PricingDetails[0]["ZETXP"] + "% :");
                            $("#lblEntryTax_html").html("Entry Tax @ " + PricingDetails[0]["ZETXP"] + "% :");
                        } else {
                            $("#lblOrissaTax").html("Orissa Entry Tax @ " + PricingDetails[0]["ZETOP"] + "% :");
                            $("#lblOrissaTax_html").html("Orissa Entry Tax @ " + PricingDetails[0]["ZETOP"] + "% :");
                        }

                    }

                    if (parseFloat(PricingDetails[0]["ZINS"]) > 0) {
                        $('#InsuranceTPND').text(Number(PricingDetails[0]["ZINS"]).toFixed(2));
                        $('#InsuranceTPND_html').text(Number(PricingDetails[0]["ZINS"]).toFixed(2));

                        $("#lblInsuranceTPND").html("Insurance (TPND) @ " + PricingDetails[0]["ZINSP"] + "% :");
                        $("#lblInsuranceTPND_html").html("Insurance (TPND) @ " + PricingDetails[0]["ZINSP"] + "% :");
                    } else {
                        $("#lblInsuranceTPND").hide(); $("#InsuranceTPND").hide();
                        $("#lblInsuranceTPND_html").hide(); $("#InsuranceTPND_html").hide();
                    }
                    if (parseFloat(PricingDetails[0]["ZF00"]) > 0) {
                        $('#FreightAmt').text(Number(PricingDetails[0]["ZF00"]).toFixed(2));
                        $('#FreightAmt_html').text(Number(PricingDetails[0]["ZF00"]).toFixed(2));
                    } else {
                        $("#lblFreightAmt").hide(); $("#FreightAmt").hide();
                        $("#lblFreightAmt_html").hide(); $("#FreightAmt_html").hide();
                    }


                    JCST += parseFloat(Number(PricingDetails[0]["ZVAT"]).toFixed(2));
                    Turnover = parseFloat(Number(PricingDetails[0]["ASS"]).toFixed(2)) + parseFloat(Number(PricingDetails[0]["JEXP"]).toFixed(2)) + parseFloat(Number(PricingDetails[0]["ZETX"]).toFixed(2));
                    $('#TaxTornover').text(Number(Turnover).toFixed(2));
                    $('#TaxTornover_html').text(Number(Turnover).toFixed(2));
                    var Total_Wt_Fr = parseFloat(Number(Turnover).toFixed(2)) + parseFloat(Number(PricingDetails[0]["JCST"]).toFixed(2)) + parseFloat(Number(PricingDetails[0]["ZVAT"]).toFixed(2)) + parseFloat(Number(PricingDetails[0]["ZGTA"]).toFixed(2)) + parseFloat(Number(PricingDetails[0]["ZSSC"]).toFixed(2)) + parseFloat(Number(PricingDetails[0]["ZETO"]).toFixed(2));
                    $('#Total').text(parseFloat(Number(Total_Wt_Fr).toFixed(2)));
                    $('#Total_html').text(parseFloat(Number(Total_Wt_Fr).toFixed(2)));
                    TotalFr = parseFloat(Number(Total_Wt_Fr).toFixed(2)) + parseFloat(Number(PricingDetails[0]["ZINS"]).toFixed(2)) + parseFloat(Number(PricingDetails[0]["ZF00"]).toFixed(2));
                    $('#TotalFr').text(Number(TotalFr).toFixed(2));
                    $('#TotalFr_html').text(Number(TotalFr).toFixed(2));

                    $('#TotalAmountRound').text(Math.round(Number(Total_Wt_Fr).toFixed(2)) + ".00");
                    //$('#TotalAmountRound_html').text(Math.round((Header[0]["Gross Amount"]).toFixed(2)) + ".00");
                    $('#TotalAmountRound_html').text(Math.round(Number(Total_Wt_Fr).toFixed(2)) + ".00");

                    $('#TotalAmtInWords').text(toWordsINVOICE(Number(Header[0]["Gross Amount"]).toFixed(2)));
                    $('#TotalAmtInWords_html').text(toWordsINVOICE(Number(Header[0]["Gross Amount"]).toFixed(2)));
                    HideLoader();
                } else {
                    HideLoader();
                    alert("No Proper Data");
                }

            }, function errorCallback(response) {
                alert("Error : " + response);
            });
        }
    });
});

//Invoice ZFOC Plant Details
DIMS.controller('InvoiceDetail_ZFOC_Plant_GSTCtrl', function ($scope, $location, DIMSFactory, $http, $compile, $routeParams) {
    $scope.templatesettings = { HeaderTitle: "Invoice details" };
    MasterScope = $scope;
    $scope.go = function (path) {
        CheckUserSession();
        $location.path(path);
    };

    var width = $(window).width(), height = $(window).height();//---------

    var totalheight = height - 191;
    // var totalheight = height - 148;//--------    
    if (height <= 800) {
        totalheight = height - 148;
    }

    $('.content').css({ "max-height": totalheight, "overflow-y": "auto" });//-----------
    $('.content-header > h2').css({ "font-size": "18px", "font-weight": "500" });//----------

    angular.element(document).ready(function () {
        var EditId = $routeParams.ID;


        if (EditId == undefined || EditId == "") {
            EditId = 0;
        } else {
            //var decryptedID = CryptoJS.AES.decrypt(EditId, "Secret Passphrase");
            // var decryptedDocNo = decryptedID.toString(CryptoJS.enc.Utf8);
            ShowLoader();
            $http({
                method: 'POST',
                url: '../../SAP/Invoice_Details_Edit',
                data: { val: EditId }
            }).then(function successCallback(response) {

                var Data = response.data.tabledata;
                Data = JSON.parse(Data);
                var Header = Data["Header"];
                if (Header != "") {
                    var Plant = Data["Plant"];
                    var Biller = Data["Biller"];
                    var Shipper = Data["Shipper"];
                    var ChildTable = Data["ItemsTable"];
                    var PricingDetails = Data["PricingDetails"];

                    var Gross_Wt = 0;


                    $('#BillingDoc').text(Header[0]["Billing Doc No."]);
                    $('#BillingDoc_html').text(Header[0]["Billing Doc No."]);


                    var Billing_Date = Header[0]["Billing Date"].split('/');
                    $('#BillingDate').text(Billing_Date[0] + '.' + Billing_Date[1] + '.' + Billing_Date[2]);
                    $('#BillingDate_html').text(Billing_Date[0] + '.' + Billing_Date[1] + '.' + Billing_Date[2]);

                    var SO_No = Header[0]["Sales Order"].split('/');
                    $('#SalesOrderNo').text(parseInt(SO_No[0]) + ' / ' + SO_No[1] + '.' + SO_No[2] + '.' + SO_No[3]);
                    $('#SalesOrderNo_html').text(parseInt(SO_No[0]) + ' / ' + SO_No[1] + '.' + SO_No[2] + '.' + SO_No[3]);

                    $("#lblPhoneNo").text(Plant[0]["PHONE1"]);
                    $("#lblPhoneNo_html").text(Plant[0]["PHONE1"]);

                    $('#CINNo').text("L74999TG1955PLC000656");
                    $('#CINNo_html').text("L74999TG1955PLC000656");
                    // $scope.SoldTo = Shipper[0]["STOCKIST_ID"] + " ( " + Shipper[0]["STOCKIST_NAME"] + " )";
                    $("#lblGSTINNo").text(Plant[0]["GSTIN_NO"]);
                    $("#lblGSTINNo_html").text(Plant[0]["GSTIN_NO"]);
                    $("#lblPANNo").text(Plant[0]["PAN_NO"]);
                    $("#lblPANNo_html").text(Plant[0]["PAN_NO"]);
                    $("#lblplantEmail").text(Plant[0]["EMAIL"]);
                    $("#lblplantEmail_html").text(Plant[0]["EMAIL"]);

                    var OR_Date = Header[0]["Order Ref Date"].split('/');
                    // $('#OrderRefDate').text(OR_Date[0] + ' / ' + OR_Date[1] + '.' + OR_Date[2] + '.' + OR_Date[3]);
                    // $('#OrderRefDate_html').text(OR_Date[0] + ' / ' + OR_Date[1] + '.' + OR_Date[2] + '.' + OR_Date[3]);


                    var BillToDetails = "<b>Bill to Party</b>" + "</br>" + Biller[0]["SOLD_TO_PARTY_NO"] + "-" + Biller[0]["STOCKIST_NAME"] + " </br>";
                    BillToDetails += Biller[0]["Biller Address"].substring(0, 27) + "<br />" + Biller[0]["Biller Address"].substring(27, Biller[0]["Biller Address"].length) + "," + Biller[0]["STATE_NAME"] + "</br>" + "TIN Number &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:" + Biller[0]["TIN_NO"] + "</br>" + "GST Number &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:" + Biller[0]["GST_NO"] + "</br>" + "PAN Number &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:" + Biller[0]["PAN_NO"] + "" + "</br>" + "Phone Number &nbsp;:" + Biller[0]["PHONE1"] + "</br>";

                    var BillToDetails_html = "<b>Bill to Party</b>" + "</br>" + Biller[0]["SOLD_TO_PARTY_NO"] + "-" + Biller[0]["STOCKIST_NAME"] + " </br>";
                    BillToDetails_html += Biller[0]["Biller Address"].substring(0, 27) + "<br />" + Biller[0]["Biller Address"].substring(27, Biller[0]["Biller Address"].length) + "," + Biller[0]["STATE_NAME"] + "</br>" + "TIN Number &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:" + Biller[0]["TIN_NO"] + "</br>" + "GST Number &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:" + Biller[0]["GST_NO"] + "</br>" + "PAN Number &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:" + Biller[0]["PAN_NO"] + "" + "</br>" + "Phone Number &nbsp; &nbsp;:" + Biller[0]["PHONE1"] + "</br>";

                    var ShipperDetails = "<b>Place of Supply</b>" + "</br>" + Shipper[0]["SHIP_TO_PARTY_NO"] + "-" + Shipper[0]["STOCKIST_NAME"] + "</br>";
                    ShipperDetails += Shipper[0]["Shipper Address"].substring(0, 27) + "<br />" + Shipper[0]["Shipper Address"].substring(27, Shipper[0]["Shipper Address"].length) + "," + Shipper[0]["STATE_NAME"] + "</br>" + "TIN Number &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:" + Shipper[0]["TIN_NO"] + "</br>" + "GST Number &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:" + Shipper[0]["GST_NO"] + "</br>" + "PAN Number &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:" + Shipper[0]["PAN_NO"] + "</br>" + "Phone Number &nbsp;:" + Shipper[0]["PHONE1"] + "</br>";

                    var ShipperDetails_html = "<b>Place of Supply</b>" + "</br>" + Shipper[0]["SHIP_TO_PARTY_NO"] + "-" + Shipper[0]["STOCKIST_NAME"] + "</br>";
                    ShipperDetails_html += Shipper[0]["Shipper Address"].substring(0, 27) + "<br />" + Shipper[0]["Shipper Address"].substring(27, Shipper[0]["Shipper Address"].length) + "," + Shipper[0]["STATE_NAME"] + "</br>" + "TIN Number &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:" + Shipper[0]["TIN_NO"] + "</br>" + "GST Number &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:" + Shipper[0]["GST_NO"] + "</br>" + "PAN Number &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:" + Shipper[0]["PAN_NO"] + "</br>" + "Phone Number &nbsp; &nbsp;:" + Shipper[0]["PHONE1"] + "</br>";


                    //var PlantDetails = "<b>Consigner Detail- HIL Limited</b>" + "</br>" + Plant[0]["NAME3"] + " " + Plant[0]["STREET2"] + " " + Plant[0]["STREET3"] + "<br />" + Plant[0]["STREET"] + " " + Plant[0]["STREET4"] + " " + Plant[0]["CITY_CODE"] + " " + Plant[0]["DISTRICT"] + " " + Plant[0]["ZIP_CODE"] + " " + Plant[0]["STATE_NAME"] + "</br>" + "Email:" + Plant[0]["EMAIL"] + "</br>" + "Phone:" + Plant[0]["PHONE1"] + "</br>" + "TIN No.:" + Plant[0]["TIN_NO"] + "</br>" + "CST No.:" + Plant[0]["CST_NO"];
                    var PlantDetails = "Invoice Number  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: " + Plant[0]["DOC_NO"] + "</br>" + "Invoice Date &nbsp; &nbsp;  &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: " + Billing_Date[0] + '.' + Billing_Date[1] + '.' + Billing_Date[2] + "</br>" + "SO Number & Date &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: " + parseInt(SO_No[0]) + ' & ' + SO_No[1] + '.' + SO_No[2] + '.' + SO_No[3] + "</br>" + "Order Ref & Dt.  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: " + OR_Date[0] + " & " + OR_Date[1] + '.' + OR_Date[2] + '.' + OR_Date[3] + "</br>" + "Delivery / OBD Number  &nbsp; &nbsp;: " + Header[0]["DELIVERY_NO"] + "</br>" + "L/C Number  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: " + "</br>" + "Payment Terms  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: " + Header[0]["PAYMENT_TERMS"] + "" + "</br>" + "Delivery (Inco Terms)  &nbsp;  &nbsp; &nbsp; &nbsp;: Ex Works";

                    var PlantDetails_html = "Invoice Number  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: " + Plant[0]["DOC_NO"] + "</br>" + "Invoice Date &nbsp; &nbsp;  &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: " + Billing_Date[0] + '.' + Billing_Date[1] + '.' + Billing_Date[2] + "</br>" + "SO Number & Date &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: " + parseInt(SO_No[0]) + ' & ' + SO_No[1] + '.' + SO_No[2] + '.' + SO_No[3] + "</br>" + "Order Ref & Dt.  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: " + OR_Date[0] + " & " + OR_Date[1] + '.' + OR_Date[2] + '.' + OR_Date[3] + "</br>" + "Delivery / OBD Number  &nbsp; &nbsp;: " + Header[0]["DELIVERY_NO"] + "</br>" + "L/C Number  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: " + "</br>" + "Payment Terms  &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: " + Header[0]["PAYMENT_TERMS"] + "" + "</br>" + "Delivery (Inco Terms)  &nbsp;  &nbsp; &nbsp; &nbsp;: Ex Works";



                    var htc = '<tr><td>' + BillToDetails + '</td>';
                    htc += '<td>' + ShipperDetails + '</td></tr>';
                    $('#tbl_Inv_Stockist').append(htc);

                    var htc_html = '<tr><td>' + BillToDetails_html + '</td>';
                    htc_html += '<td>' + ShipperDetails_html + '</td></tr>';
                    $('#tbl_Inv_Stockist_html').append(htc_html);



                    $("#lblPlantName").html(Plant[0]["NAME3"] + "" + Plant[0]["STREET2"] + " " + Plant[0]["STREET3"] + " " + Plant[0]["STREET"] + " " + Plant[0]["STREET4"] + " " + Plant[0]["CITY_CODE"] + " " + Plant[0]["DISTRICT"] + " " + +Plant[0]["ZIP_CODE"] + " " + Plant[0]["STATE_NAME"]);
                    //For PDF
                    $("#lblPlantName_html").html(Plant[0]["NAME3"] + "" + Plant[0]["STREET2"] + " " + Plant[0]["STREET3"] + " " + Plant[0]["STREET"] + " " + Plant[0]["STREET4"] + " " + Plant[0]["CITY_CODE"] + " " + Plant[0]["DISTRICT"] + " " + +Plant[0]["ZIP_CODE"] + " " + Plant[0]["STATE_NAME"]);


                    //$('#tbl_Inv_Details').dataTable().fnAddData([PlantDetails, BillToDetails, ShipperDetails]);
                    //$('#tbl_Inv_Details_html').dataTable().fnAddData([PlantDetails_html, BillToDetails_html, ShipperDetails_html]);



                    $('#ExciseRange').append(Header[0]["EXCISE_RANGE"]);
                    $('#ExciseDivison').append(Header[0]["EXCISE_DIVISION"]);
                    $('#ExciseCommissionerate').append(Header[0]["EXCISE_COMMISIONARATE"]);

                    $('#ExciseRange_html').append(Header[0]["EXCISE_RANGE"]);
                    $('#ExciseDivison_html').append(Header[0]["EXCISE_DIVISION"]);
                    $('#ExciseCommissionerate_html').append(Header[0]["EXCISE_COMMISIONARATE"]);

                    TRCode = "";
                    for (var i = 0; i < ChildTable.length; i++) {
                        var TotalBasicAmt = (ChildTable[i]["BILL_QTY"]) * (ChildTable[i]["Unit Rate"]);
                        Gross_Wt += parseFloat(ChildTable[i]["Wt In Mt"]);

                        $('#tbl_Inv_Details1').dataTable().fnAddData([ChildTable[i]["MATERIAL_NO"], ChildTable[i]["PRODUCT_DESC"] + "<br/> HSN No - " + ChildTable[i]["HSN_NO"], ChildTable[i]["BILL_QTY"], ChildTable[i]["UOM"], ChildTable[i]["PROD_GRP"], Number(ChildTable[i]["Wt In Mt"]).toFixed(3), parseFloat(ChildTable[i]["Unit Rate"]).toFixed(2), parseFloat(TotalBasicAmt).toFixed(2), parseFloat(ChildTable[i]["DISCOUNT"]).toFixed(2), parseFloat(ChildTable[i]["TAX_AMOUNT"]).toFixed(2)]);
                        //$('#tbl_Inv_Details1_html').dataTable().fnAddData([ChildTable[i]["MATERIAL_NO"], ChildTable[i]["PRODUCT_DESC"], ChildTable[i]["BILL_QTY"], ChildTable[i]["UOM"], ChildTable[i]["PROD_GRP"], Number(ChildTable[i]["Wt In Mt"]).toFixed(3), parseFloat(ChildTable[i]["Unit Rate"]).toFixed(2), parseFloat(TotalBasicAmt).toFixed(2)]);

                        TRCode = TRCode + "<tr>";
                        TRCode = TRCode + "<td align='center'>" + ChildTable[i]["MATERIAL_NO"] + "</td>";
                        TRCode = TRCode + "<td>" + ChildTable[i]["PRODUCT_DESC"] + " HSN No - " + ChildTable[i]["HSN_NO"] + "</td>";
                        TRCode = TRCode + "<td align='right'>" + ChildTable[i]["BILL_QTY"] + "</td>";
                        TRCode = TRCode + "<td align='center'>" + ChildTable[i]["UOM"] + "</td>";
                        TRCode = TRCode + "<td align='center'>" + ChildTable[i]["PROD_GRP"] + "</td>";
                        TRCode = TRCode + "<td align='right'>" + parseFloat(ChildTable[i]["Wt In Mt"]).toFixed(3) + "</td>";
                        TRCode = TRCode + "<td align='right'>" + parseFloat(ChildTable[i]["Unit Rate"]).toFixed(2) + "</td>";
                        TRCode = TRCode + "<td align='right'>" + parseFloat(TotalBasicAmt).toFixed(2) + "</td>";
                        TRCode = TRCode + "<td align='right'>" + parseFloat(ChildTable[i]["DISCOUNT"]).toFixed(2) + "</td>";
                        TRCode = TRCode + "<td align='right'>" + parseFloat(ChildTable[i]["TAX_AMOUNT"]).toFixed(2) + "</td>";
                        TRCode = TRCode + "</tr>";

                    }
                    var Html = $compile(TRCode)($scope);
                    var el = angular.element($("#tbl_Inv_Details1_html tbody"));
                    el.append(Html);
                    $compile(Html)($scope);
                    $("#tbl_Inv_Details1_html").dataTable({
                        "bDestroy": true,
                        "bSort": false,
                        "bScrollCollapse": true,
                        "paging": false,
                        "ordering": false,
                        "info": false,
                        "bFilter": false,
                        "footerCallback": function (tfoot, data, start, end, display) {
                            var api = this.api();
                            $(api.column(7).footer()).html(
                                api.column(7).data().reduce(function (a, b) {
                                    var res = parseFloat(a) + parseFloat(b);
                                    return parseFloat(res).toFixed(2);
                                }, 0)
                            );
                            $(api.column(8).footer()).html(
                                api.column(8).data().reduce(function (a, b) {
                                    var res = parseFloat(a) + parseFloat(b);
                                    return parseFloat(res).toFixed(2);
                                }, 0)
                            );
                            $(api.column(9).footer()).html(
                                api.column(9).data().reduce(function (a, b) {
                                    var res = parseFloat(a) + parseFloat(b);
                                    return parseFloat(res).toFixed(2);
                                }, 0)
                            );
                        }
                    });

                    // $("#Zinv_Plant_Footer_Header_html").remove();
                    $("#lblChapter_Id").text(ChildTable[0]["CHAPTER_ID"]);
                    $("#lblChapter_Id_html").text(ChildTable[0]["CHAPTER_ID"]);
                    $("#lblChapter_Desc").text(ChildTable[0]["CHAPTER_DESC"]);
                    $("#lblChapter_Desc_html").text(ChildTable[0]["CHAPTER_DESC"]);

                    var GrossWeight = Gross_Wt;
                    GrossWeight = parseFloat(GrossWeight).toFixed(3);
                    var GrossWeightinMt = GrossWeight / 1000;


                    $('#GrossWeight').text(GrossWeight + " KG " + "( " + GrossWeightinMt.toFixed(3) + " MT )");
                    $('#GrossWeight_html').text(GrossWeight + " KG " + "( " + GrossWeightinMt.toFixed(3) + " MT )");

                    var NetWeight = Gross_Wt;
                    NetWeight = parseFloat(NetWeight).toFixed(3);
                    var NetWeightinMt = NetWeight / 1000;

                    $('#NetWeight').text(NetWeight + " KG " + "( " + NetWeightinMt.toFixed(3) + " MT )");
                    $('#NetWeight_html').text(NetWeight + " KG " + "( " + NetWeightinMt.toFixed(3) + " MT )");


                    var transportDetails = "Date & Time of Preperation : " + Billing_Date[0] + '.' + Billing_Date[1] + '.' + Billing_Date[2] + " & " + Header[0]["Time"] + "</br>" + "Transporter Name &nbsp;&nbsp;&nbsp;&nbsp;: " + Header[0]["Transporter Name"] + "</br>" + "LR/RR No &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: " + Header[0]["LR_NO"] + "</br>" + "Lorry/Wagon No &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:" + Header[0]["VEHICLE_NO"] + "</br>" + "Gross Weight &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:" + GrossWeight + " KG " + "( " + GrossWeightinMt.toFixed(3) + " MT )" + "</br>" + "Net Weight &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:" + NetWeight + " KG " + "( " + NetWeightinMt.toFixed(3) + " MT )" + "</br>" + "E-Way Bill No  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:" + Header[0]["ZZEWAY_BILLNO"] + "";

                    var transportDetails_html = "Date & Time of Preperation : " + Billing_Date[0] + '.' + Billing_Date[1] + '.' + Billing_Date[2] + " & " + Header[0]["Time"] + "</br>" + "Transporter Name : " + Header[0]["Transporter Name"] + "</br>" + "LR/RR No : " + Header[0]["LR_NO"] + "</br>" + "Lorry/Wagon No : " + Header[0]["VEHICLE_NO"] + "</br>" + "Gross Weight : " + GrossWeight + " KG " + "( " + GrossWeightinMt.toFixed(3) + " MT )" + "</br>" + "Net Weight : " + NetWeight + " KG " + "( " + NetWeightinMt.toFixed(3) + " MT )" + "</br>" + "E-Way Bill No : " + Header[0]["ZZEWAY_BILLNO"] + "";


                    var ht = '<tr ><td>' + PlantDetails + '</td>';
                    ht += '<td>' + transportDetails + '</td></tr>';
                    $('#tbl_Inv_Details').append(ht);

                    var ht_html = '<tr><td >' + PlantDetails_html + '</td>';
                    ht_html += '<td>' + transportDetails_html + '</td></tr>';
                    $('#tbl_Inv_Details_html').append(ht_html);



                    var IgsttotAmt = parseFloat(parseFloat($("#testtot").text()) + parseFloat(Header[0]["IGST"])).toFixed(2);
                    var IgsttotAmt_html = parseFloat(parseFloat($("#testtot").text()) + parseFloat(Header[0]["IGST"])).toFixed(2);
                    var totAmt = parseFloat(parseFloat($("#testtot").text()) + parseFloat(Header[0]["CGST"]) + parseFloat(Header[0]["SGST"])).toFixed(2);
                    var totAmt_html = parseFloat(parseFloat($("#testtot").text()) + parseFloat(Header[0]["CGST"]) + parseFloat(Header[0]["SGST"])).toFixed(2);


                    $("#cgstp").text("@ " + Header[0]["CGSTP"] + " %");
                    $("#cgstp_html").text("@ " + Header[0]["CGSTP"] + " %");
                    $("#sgstp").text("@ " + Header[0]["SGSTP"] + " %");
                    $("#sgstp_html").text("@ " + Header[0]["SGSTP"] + " %");
                    $("#cgstamt").text(Header[0]["CGST"]);
                    $("#cgstamt_html").text(Header[0]["CGST"]);
                    $("#sgstamt").text(Header[0]["SGST"]);
                    $("#sgstamt_html").text(Header[0]["SGST"]);
                    $("#totAmt").text("0.00");
                    $("#totAmt_html").text("0.00");
                    $("#totAmtrnd").text("0.00");
                    $("#totAmtrnd_html").text("0.00");
                    $("#Igstp").text("@ " + Header[0]["IGSTP"] + " %");
                    $("#Igstp_html").text("@ " + Header[0]["IGSTP"] + " %");
                    $("#Igstamt").text(Header[0]["IGST"]);
                    $("#Igstamt_html").text(Header[0]["IGST"]);
                    $("#IgsttotAmt").text("0.00");
                    $("#IgsttotAmt_html").text("0.00");
                    $("#IgsttotAmtrnd").text("0.00");
                    $("#IgsttotAmtrnd_html").text("0.00");


                    if (parseFloat(Header[0]["IGST"]) == 0 || Header[0]["IGST"] == "" || Header[0]["IGST"] == undefined) {
                        $("#cgstsection").show();
                        $("#cgstsection_html").show();
                        $('#TotalAmtInWords').text("Nil");
                        $('#TotalAmtInWords_html').text("Nil");
                        var adda = parseFloat(parseFloat(Header[0]["CGST"]) + parseFloat(Header[0]["SGST"])).toFixed(2);
                        var adda_html = parseFloat(parseFloat(Header[0]["CGST"]) + parseFloat(Header[0]["SGST"])).toFixed(2);
                        $("#totaltaxamountinwords").text(toWordsINVOICE(adda));
                        $("#totaltaxamountinwords_html").text(toWordsINVOICE(adda_html));
                    }
                    else {
                        $("#igstsection").show();
                        $("#igstsection_html").show();
                        $('#TotalAmtInWords').text("Nil");
                        $('#TotalAmtInWords_html').text("Nil");
                        $("#totaltaxamountinwords").text(toWordsINVOICE(parseFloat(Header[0]["IGST"])));
                        $("#totaltaxamountinwords_html").text(toWordsINVOICE(parseFloat(Header[0]["IGST"])));
                    }


                    HideLoader();
                } else {
                    HideLoader();
                    alert("No Proper Data");
                }


            }, function errorCallback(response) {
                alert("Error : " + response);
            });
        }
    });
});

//Invoice ZFOC Depo Details
DIMS.controller('InvoiceDetail_ZFOC_Depo_GSTCtrl', function ($scope, $location, DIMSFactory, $http, $compile, $routeParams) {
    $scope.templatesettings = { HeaderTitle: "Invoice details" };
    MasterScope = $scope;
    $scope.go = function (path) {
        CheckUserSession();
        $location.path(path);
    };

    var width = $(window).width(), height = $(window).height();//---------

    var totalheight = height - 191;
    // var totalheight = height - 148;//--------    
    if (height <= 800) {
        totalheight = height - 148;
    }

    $('.content').css({ "max-height": totalheight, "overflow-y": "auto" });//-----------
    $('.content-header > h2').css({ "font-size": "18px", "font-weight": "500" });//----------

    angular.element(document).ready(function () {
        var EditId = $routeParams.ID;
        if (EditId == undefined || EditId == "") {
            EditId = 0;
        } else {
            var decryptedID = CryptoJS.AES.decrypt(EditId, "Secret Passphrase");
            var decryptedDocNo = decryptedID.toString(CryptoJS.enc.Utf8);
            ShowLoader();
            $http({
                method: 'POST',
                url: '../../SAP/Invoice_Details_Edit',
                data: { val: EditId }
            }).then(function successCallback(response) {
                var Data = response.data.tabledata;
                Data = JSON.parse(Data);
                var Header = Data["Header"];
                if (Header != "") {
                    var Plant = Data["Plant"];
                    var Biller = Data["Biller"];
                    var Shipper = Data["Shipper"];
                    var ChildTable = Data["ItemsTable"];
                    var PricingDetails = Data["PricingDetails"];

                    var Gross_Wt = 0;

                    //Sales Order

                    // $scope.BillingDoc = Header[0]["Billing Doc No."];
                    $('#BillingDoc').text(Header[0]["Billing Doc No."]);
                    $('#BillingDoc_html').text(Header[0]["Billing Doc No."]);
                    var ExciseInvdate = Header[0]["EXCISE_INV_DATE"].split('/');
                    // $scope.BillingDate = Header[0]["Billing Date"];
                    var Billing_Date = Header[0]["Billing Date"].split('/');
                    $('#BillingDate').text(Billing_Date[0] + '.' + Billing_Date[1] + '.' + Billing_Date[2]);
                    $('#BillingDate_html').text(Billing_Date[0] + '.' + Billing_Date[1] + '.' + Billing_Date[2]);
                    //$scope.SalesOrderNo = Header[0]["Sales Order"];
                    var SO_No = Header[0]["Sales Order"].split('/');
                    $('#SalesOrderNo').text(parseInt(SO_No[0]) + ' / ' + SO_No[1] + '.' + SO_No[2] + '.' + SO_No[3]);
                    $('#SalesOrderNo_html').text(parseInt(SO_No[0]) + ' / ' + SO_No[1] + '.' + SO_No[2] + '.' + SO_No[3]);

                    //$scope.CINNo = "L74999TG1955PLC000656";

                    $('#CINNo').text("L74999TG1955PLC000656");
                    $('#CINNo_html').text("L74999TG1955PLC000656");
                    // $scope.SoldTo = Shipper[0]["STOCKIST_ID"] + " ( " + Shipper[0]["STOCKIST_NAME"] + " )";
                    //$scope.SoldTo = Header[0]["Sold To"];
                    var Soldto = Header[0]["Sold To"];
                    $('#SoldTo').text(Soldto);
                    $('#SoldTo_html').text(Soldto);
                    var OR_Date = Header[0]["Order Ref Date"].split('/');
                    $('#OrderRefDate').text(OR_Date[0] + ' / ' + OR_Date[1] + '.' + OR_Date[2] + '.' + OR_Date[3]);
                    $('#OrderRefDate_html').text(OR_Date[0] + ' / ' + OR_Date[1] + '.' + OR_Date[2] + '.' + OR_Date[3]);
                    //Date of Preperation
                    var DOP = Header[0]["Billing Date"].split('/');
                    var DOT = Header[0]["Time"];
                    var ss = DOT.split(":");
                    var dt = new Date();
                    dt.setHours(ss[0]);
                    dt.setMinutes(ss[1]);
                    dt.setSeconds(ss[2]);
                    var dt2 = new Date(dt.valueOf() + 40000);
                    var DOT_Time = dt2.toTimeString().split(" ")[0];

                    //$('#DOPrep').text(DOP[0] + '.' + DOP[1] + '.' + DOP[2] + " " + Header[0]["Time"]);
                    //$('#DOPrep_html').text(DOP[0] + '.' + DOP[1] + '.' + DOP[2] + " " + Header[0]["Time"]);
                    //Date of Removal
                    //$('#DORemoval').text(DOP[0] + '.' + DOP[1] + '.' + DOP[2] + " " + DOT_Time);
                    //$('#DORemoval_html').text(DOP[0] + '.' + DOP[1] + '.' + DOP[2] + " " + DOT_Time);

                    $('#Delivery').text("EX Depot");
                    $('#Delivery_html').text("EX Depot");


                    $('#GrossAmnt').text(Header[0]["Gross Amount"]);



                    // $('#NetWeight').text(Header[0]["NET_WT"]);
                    $('#PaymentTerms').text(Header[0]["PAYMENT_TERMS"]);
                    $('#PaymentTerms_html').text(Header[0]["PAYMENT_TERMS"]);
                    $('#LRRNo').text(Header[0]["LR_NO"]);
                    $('#LRRNo_html').text(Header[0]["LR_NO"]);
                    $('#TransporterName').text(Header[0]["Transporter Name"]);
                    $('#TransporterName_html').text(Header[0]["Transporter Name"]);
                    $('#LorryNum').text(Header[0]["VEHICLE_NO"]);
                    $('#LorryNum_html').text(Header[0]["VEHICLE_NO"]);
                    $('#OBDNum').text(Header[0]["DELIVERY_NO"]);
                    $('#OBDNum_html').text(Header[0]["DELIVERY_NO"]);

                    if ((Header[0]["Delivery"] == "ZFR") || (Header[0]["Delivery"] == "FOR")) {
                        $("#lblInsuranceText_html").text("Insurance and Transportaion is being arranged on customer's request");
                    } else if (Header[0]["Delivery"] == "EXT") {
                        $("#lblInsuranceText_html").text("Freight to be paid to Transporter directly");
                    }

                    var BillToDetails = "<b>Payer Detail:</b>" + "</br>" + Biller[0]["SOLD_TO_PARTY_NO"] + "</br>";
                    BillToDetails += Biller[0]["STOCKIST_NAME"] + ",<br />" + Biller[0]["Biller Address"].substring(0, 27) + "<br />" + Biller[0]["Biller Address"].substring(27, Biller[0]["Biller Address"].length) + "," + Biller[0]["STATE_NAME"] + "</br>" + "Ph No :" + Biller[0]["PHONE1"] + "</br>" + "TIN No. :" + Biller[0]["TIN_NO"] + "</br>" + "CST No. :" + Biller[0]["CST_NO"] + "</br>" + "&nbsp;";

                    var BillToDetails_html = "<b>Payer Detail:</b>" + "</br>" + Biller[0]["SOLD_TO_PARTY_NO"] + "</br>";
                    BillToDetails_html += Biller[0]["STOCKIST_NAME"] + ",<br />" + Biller[0]["Biller Address"] + "," + Biller[0]["STATE_NAME"] + "</br>" + "Ph No :" + Biller[0]["PHONE1"] + "</br>" + "TIN No. :" + Biller[0]["TIN_NO"] + "</br>" + "CST No. :" + Biller[0]["CST_NO"] + "</br>" + "&nbsp;";


                    //  var ShipperDetails = Shipper[0][""]


                    var ShipperDetails = "<b>Delivery / Consignee:</b>" + "</br>" + Shipper[0]["SHIP_TO_PARTY_NO"] + "</br>";
                    ShipperDetails += Shipper[0]["STOCKIST_NAME"] + ",<br />" + Shipper[0]["Shipper Address"].substring(0, 27) + "<br />" + Shipper[0]["Shipper Address"].substring(27, Shipper[0]["Shipper Address"].length) + "," + Shipper[0]["STATE_NAME"] + "</br>" + "Ph No :" + Shipper[0]["PHONE1"] + "</br>" + "TIN No. :" + Shipper[0]["TIN_NO"] + "</br>" + "CST No. :" + Shipper[0]["CST_NO"] + "</br>" + "&nbsp;";

                    var ShipperDetails_html = "<b>Delivery / Consignee:</b>" + "</br>" + Shipper[0]["SHIP_TO_PARTY_NO"] + "</br>";
                    ShipperDetails_html += Shipper[0]["STOCKIST_NAME"] + ",<br />" + Shipper[0]["Shipper Address"] + "," + Shipper[0]["STATE_NAME"] + "</br>" + "Ph No :" + Shipper[0]["PHONE1"] + "</br>" + "TIN No. :" + Shipper[0]["TIN_NO"] + "</br>" + "CST No. :" + Shipper[0]["CST_NO"] + "</br>" + "&nbsp;";


                    var PlantDetails = "<b>Consigner Detail- HIL Limited</b>" + "</br>" + Plant[0]["NAME3"] + " " + Plant[0]["STREET2"] + " " + Plant[0]["STREET3"] + "<br />" + Plant[0]["STREET"] + " " + Plant[0]["STREET4"] + " " + Plant[0]["CITY_CODE"] + " ," + Plant[0]["DISTRICT"] + " ," + Plant[0]["ZIP_CODE"] + " ," + Plant[0]["STATE_NAME"] + "</br>" + "Email:" + Plant[0]["EMAIL"] + "</br>" + "Phone :" + Plant[0]["PHONE1"] + "</br>" + "TIN No. :" + Plant[0]["TIN_NO"] + "</br>" + "CST No. :" + Plant[0]["CST_NO"] + "</br>" + "&nbsp;";
                    var PlantDetails_html = "<b>Consigner Detail- HIL Limited</b>" + "</br>" + Plant[0]["NAME3"] + " " + Plant[0]["STREET2"] + " " + Plant[0]["STREET3"] + " <br />" + Plant[0]["STREET"] + " " + Plant[0]["STREET4"] + " " + Plant[0]["CITY_CODE"] + " ," + Plant[0]["DISTRICT"] + " ," + Plant[0]["ZIP_CODE"] + " ," + Plant[0]["STATE_NAME"] + "</br>" + "Email:" + Plant[0]["EMAIL"] + "</br>" + "Phone :" + Plant[0]["PHONE1"] + "</br>" + "TIN No. :" + Plant[0]["TIN_NO"] + "</br>" + "CST No. :" + Plant[0]["CST_NO"] + "</br>" + "&nbsp;";
                    $("#lblPlantName").html(Plant[0]["NAME3"] + "" + Plant[0]["STREET2"] + " " + Plant[0]["STREET3"] + " " + Plant[0]["STREET"] + " " + Plant[0]["STREET4"] + " " + Plant[0]["CITY_CODE"] + " " + Plant[0]["DISTRICT"] + " " + +Plant[0]["ZIP_CODE"] + " " + Plant[0]["STATE_NAME"]);
                    //For PDF
                    $("#lblPlantName_html").html(Plant[0]["NAME3"] + "" + Plant[0]["STREET2"] + " " + Plant[0]["STREET3"] + " " + Plant[0]["STREET"] + " " + Plant[0]["STREET4"] + " " + Plant[0]["CITY_CODE"] + " " + Plant[0]["DISTRICT"] + " " + +Plant[0]["ZIP_CODE"] + " " + Plant[0]["STATE_NAME"]);
                    $('#ExciseRange').append(Header[0]["EXCISE_RANGE"]);
                    $('#ExciseDivison').append(Header[0]["EXCISE_DIVISION"]);
                    $('#ExciseCommissionerate').append(Header[0]["EXCISE_COMMISIONARATE"]);

                    $('#ExciseRange_html').append(Header[0]["EXCISE_RANGE"]);
                    $('#ExciseDivison_html').append(Header[0]["EXCISE_DIVISION"]);
                    $('#ExciseCommissionerate_html').append(Header[0]["EXCISE_COMMISIONARATE"]);

                    $('#tbl_Inv_Details').dataTable().fnAddData([PlantDetails, BillToDetails, ShipperDetails]);
                    $('#tbl_Inv_Details_html').dataTable().fnAddData([PlantDetails_html, BillToDetails_html, ShipperDetails_html]);


                    TRCode = "";
                    for (var i = 0; i < ChildTable.length; i++) {
                        var TotalBasicAmt = (ChildTable[i]["BILL_QTY"]) * (ChildTable[i]["Unit Rate"]);
                        Gross_Wt += parseFloat(ChildTable[i]["Wt In Mt"]);
                        $('#tbl_Inv_Details1').dataTable().fnAddData([ChildTable[i]["MATERIAL_NO"], ChildTable[i]["PRODUCT_DESC"], ChildTable[i]["BILL_QTY"], ChildTable[i]["UOM"], ChildTable[i]["PROD_GRP"], Number(ChildTable[i]["Wt In Mt"]).toFixed(3), parseFloat(ChildTable[i]["Unit Rate"]).toFixed(2), parseFloat(TotalBasicAmt).toFixed(2)]);
                        //$('#tbl_Inv_Details1_html').dataTable().fnAddData([ChildTable[i]["MATERIAL_NO"], ChildTable[i]["PRODUCT_DESC"], ChildTable[i]["BILL_QTY"], ChildTable[i]["UOM"], ChildTable[i]["PROD_GRP"], Number(ChildTable[i]["Wt In Mt"]).toFixed(3), parseFloat(ChildTable[i]["Unit Rate"]).toFixed(2), parseFloat(TotalBasicAmt).toFixed(2)]);

                        TRCode = TRCode + "<tr>";
                        TRCode = TRCode + "<td align='center'>" + ChildTable[i]["MATERIAL_NO"] + "</td>";
                        TRCode = TRCode + "<td>" + ChildTable[i]["PRODUCT_DESC"] + "</td>";
                        TRCode = TRCode + "<td align='right'>" + ChildTable[i]["BILL_QTY"] + "</td>";
                        TRCode = TRCode + "<td align='center'>" + ChildTable[i]["UOM"] + "</td>";
                        TRCode = TRCode + "<td align='center'>" + ChildTable[i]["PROD_GRP"] + "</td>";
                        TRCode = TRCode + "<td align='right'>" + parseFloat(ChildTable[i]["Wt In Mt"]).toFixed(3) + "</td>";
                        TRCode = TRCode + "<td align='right'>" + parseFloat(ChildTable[i]["Unit Rate"]).toFixed(2) + "</td>";
                        TRCode = TRCode + "<td align='right'>" + parseFloat(TotalBasicAmt).toFixed(2) + "</td>";
                        TRCode = TRCode + "</tr>";

                        $("#lblChapter_Id_html").text(ChildTable[0]["CHAPTER_ID"]);
                        $("#lblChapter_Desc_html").text(ChildTable[0]["CHAPTER_DESC"]);
                    }
                    var Html = $compile(TRCode)($scope);
                    var el = angular.element($("#tbl_Inv_Details1_html tbody"));
                    el.append(Html);
                    $compile(Html)($scope);
                    $("#tbl_Inv_Details1_html").dataTable({
                        "bDestroy": true,
                        "bSort": false,
                        "bScrollCollapse": true,
                        "paging": false,
                        "ordering": false,
                        "info": false,
                        "bFilter": false,
                        "footerCallback": function (tfoot, data, start, end, display) {
                            var api = this.api();
                            $(api.column(7).footer()).html(
                                api.column(7).data().reduce(function (a, b) {
                                    var res = parseFloat(a) + parseFloat(b);
                                    return parseFloat(0).toFixed(2);
                                }, 0)
                            );
                        }
                    });
                    $("#Zinv_Depo_header").remove();
                    $("#Zinv_Depo_header_html").remove();
                    $("#Zfoc_Depo_Footer_Header_html").remove();


                    var GrossWeight = Gross_Wt;
                    GrossWeight = parseFloat(GrossWeight).toFixed(3);
                    var GrossWeightinMt = GrossWeight / 1000;


                    $('#GrossWeight').text(GrossWeight + " KG " + "( " + GrossWeightinMt.toFixed(3) + " MT )");
                    $('#GrossWeight_html').text(GrossWeight + " KG " + "( " + GrossWeightinMt.toFixed(3) + " MT )");

                    var NetWeight = Gross_Wt;
                    NetWeight = parseFloat(NetWeight).toFixed(3);
                    var NetWeightinMt = NetWeight / 1000;

                    $('#NetWeight').text(NetWeight + " KG " + "( " + NetWeightinMt.toFixed(3) + " MT )");
                    $('#NetWeight_html').text(NetWeight + " KG " + "( " + NetWeightinMt.toFixed(3) + " MT )");


                    var AssessableValue = 0;
                    var ExiceDuty = 0;
                    var EntryTax = 0;
                    var Turnover = 0;
                    var JCST = 0;
                    var ZSSC = 0;
                    var StateAddTax = 0;
                    var InsuranceTPND = 0;
                    var FreightAmt = 0;
                    var TotalFr = 0;
                    if (parseFloat(PricingDetails[0]["DISC"]) > 0) {
                        $('#Discount').text(Number(PricingDetails[0]["DISC"]).toFixed(2));
                    } else {
                        $("#lblDiscount").hide(); $("#Discount").hide();
                        $("#lblDiscount_html").hide(); $("#Discount_html").hide();
                    }
                    if (parseFloat(PricingDetails[0]["JCST"]) > 0) {
                        $("#lblAgainstCFORM").html("CST :");
                        $("#lblAgainstCFORM_html").html("CST :");
                        $('#AgainstCFORM').text(Number(PricingDetails[0]["JCST"]).toFixed(2));
                        $('#AgainstCFORM_html').text(Number(PricingDetails[0]["JCST"]).toFixed(2));
                    }
                    else {
                        if (parseFloat(PricingDetails[0]["ZVAT"]) > 0) {
                            $("#lblAgainstCFORM").html("VAT :");
                            $("#lblAgainstCFORM_html").html("VAT :");
                            $('#AgainstCFORM').text(Number(PricingDetails[0]["ZVAT"]).toFixed(2));
                            $('#AgainstCFORM_html').text(Number(PricingDetails[0]["ZVAT"]).toFixed(2));
                        } else {
                            $("#lblAgainstCFORM").hide(); $("#AgainstCFORM").hide();
                            $("#lblAgainstCFORM_html").hide(); $("#AgainstCFORM_html").hide();
                        }
                    }




                    if (Number(PricingDetails[0]["ZSSC"].toString()).toFixed(2) == "0.00") {
                        $("#idSteteSess").hide();
                        $("#idSteteSess_html").hide();

                    }
                    else {
                        $('#SteteSec').text(Number(PricingDetails[0]["ZSSC"]).toFixed(2));
                        $('#SteteSec_html').text(Number(PricingDetails[0]["ZSSC"]).toFixed(2));
                        $("#lblSteteSec").html("State Sec Cess  :");
                        $("#lblSteteSec_html").html("State Sec Cess  :");
                    }

                    if (Number(PricingDetails[0]["ZGTA"].toString()).toFixed(2) == "0.00") {
                        $("#idStateAddTax").hide();
                        $("#idStateAddTax_html").hide();
                    } else {
                        $('#StateAddTax').text(Number(PricingDetails[0]["ZGTA"]).toFixed(2));
                        $('#StateAddTax_html').text(Number(PricingDetails[0]["ZGTA"]).toFixed(2));

                        $("#lblStateAddTax").html("State Add Tax  :");
                        $("#lblStateAddTax_html").html("State Add Tax  :");
                    }
                    if (parseFloat(PricingDetails[0]["ASS"]) > 0) {
                        $('#AssessableValue').text(Number(PricingDetails[0]["ASS"]).toFixed(2));
                        $('#AssessableValue_html').text(Number(PricingDetails[0]["ASS"]).toFixed(2));
                    } else {
                        $("#lblAssessableValue").hide(); $("#AssessableValue").hide();
                        $("#lblAssessableValue_html").hide(); $("#AssessableValue_html").hide();
                    }
                    //$('#ExiceDuty').text(Number(PricingDetails[0]["JEXP"]).toFixed(2));
                    //if (Number(PricingDetails[0]["ZETX"].toString()).toFixed(2) == "0.00") {
                    //    $("#idEntryTax").hide();
                    //    $("#idEntryTax_html").hide();
                    //} else {
                    //    $('#EntryTax').text(Number(PricingDetails[0]["ZETX"]).toFixed(2));
                    //    $('#EntryTax_html').text(Number(PricingDetails[0]["ZETX"]).toFixed(2));
                    //}

                    if (parseFloat(PricingDetails[0]["ZINS"]) > 0) {
                        $('#InsuranceTPND').text(Number(PricingDetails[0]["ZINS"]).toFixed(2));
                        $('#InsuranceTPND_html').text(Number(PricingDetails[0]["ZINS"]).toFixed(2));
                    } else { $("#lblInsuranceTPND").hide(); $("#InsuranceTPND").hide(); $("#lblInsuranceTPND_html").hide(); $("#InsuranceTPND_html").hide(); }
                    if (parseFloat(PricingDetails[0]["ZF00"]) > 0) {
                        $('#FreightAmt').text(Number(PricingDetails[0]["ZF00"]).toFixed(2));
                        $('#FreightAmt_html').text(Number(PricingDetails[0]["ZF00"]).toFixed(2));
                    } else {
                        $("#lblFreightAmt").hide(); $("#FreightAmt").hide();
                        $("#lblFreightAmt_html").hide(); $("#FreightAmt_html").hide();
                    }


                    JCST += parseFloat(Number(PricingDetails[0]["ZVAT"]).toFixed(2));
                    Turnover = parseFloat(Number(PricingDetails[0]["ASS"]).toFixed(2)) + parseFloat(Number(PricingDetails[0]["JEXP"]).toFixed(2)) + parseFloat(Number(PricingDetails[0]["ZETX"]).toFixed(2));
                    $('#TaxTornover').text(Number(0).toFixed(2));
                    $('#TaxTornover_html').text(Number(0).toFixed(2));
                    var Total_Wt_Fr = parseFloat(Number(Turnover).toFixed(2)) + parseFloat(Number(PricingDetails[0]["JCST"]).toFixed(2)) + parseFloat(Number(PricingDetails[0]["ZVAT"]).toFixed(2)) + parseFloat(Number(PricingDetails[0]["ZGTA"]).toFixed(2)) + parseFloat(Number(PricingDetails[0]["ZSSC"]).toFixed(2)) + parseFloat(Number(PricingDetails[0]["ZETO"]).toFixed(2));
                    $('#Total').text(Number(0).toFixed(2));
                    $('#Total_html').text(Number(0).toFixed(2));
                    TotalFr = parseFloat(Number(Total_Wt_Fr).toFixed(2)) + parseFloat(Number(PricingDetails[0]["ZINS"]).toFixed(2)) + parseFloat(Number(PricingDetails[0]["ZF00"]).toFixed(2));
                    $('#TotalFr').text(Number(0).toFixed(2));
                    $('#TotalFr_html').text(Number(0).toFixed(2));
                    $('#TotalAmountRound').text(Math.round(Number(0).toFixed(2)) + ".00");
                    $('#TotalAmountRound_html').text(Math.round(Number(0).toFixed(2)) + ".00");
                    $('#TotalAmtInWords').text(toWordsINVOICE(Number(0).toFixed(2)));
                    $('#TotalAmtInWords_html').text(toWordsINVOICE(Number(0).toFixed(2)));
                    HideLoader();
                } else {
                    HideLoader();
                    alert("No Proper Data");
                }

            }, function errorCallback(response) {
                alert("Error : " + response);
            });
        }
    });
});



//Outstanding Details
DIMS.controller('OutstandingDetailCtrl', function ($scope, $location, DIMSFactory, $http, $compile, DIMSSAPFactory) {
    $scope.templatesettings = { HeaderTitle: "Outstanding Details" };
    AccountStatementScope = $scope;
    MasterScope = $scope;



    $("#OutstandingDiv").hide();
    $scope.go = function (path) {
        CheckUserSession();
        $location.path(path);
    };

    var width = $(window).width(), height = $(window).height();//---------

    var totalheight = height - 191;
    // var totalheight = height - 148;//--------    
    if (height <= 800) {
        totalheight = height - 148;
    }

    $('.content').css({ "max-height": totalheight, "overflow-y": "auto" });//-----------
    $('.content-header > h2').css({ "font-size": "18px", "font-weight": "500" });//----------
    $('.content').css({ "max-height": totalheight, "min-height": totalheight, "overflow-y": "auto" });//-----------

    var data_value = ""; var all_zones = ""; var all_states = ""; var all_territories = ""; var all_customers = ""; var CustomerArray = new Array();
    ShowLoader();
    if ((SessionValue == "ZH") || (SessionValue == "RCC") || (SessionValue == "ZSC")) {
        $("#Zone").attr("disabled", false); $("#State").attr("disabled", false); $("#TerriotryArea").attr("disabled", false); $("#CustomerCode").attr("disabled", false);
        //data_value = "{\"Role\":\"" + "ZH" + "\",\"UserCode\":\"" + "50001762" + "\"}";
        data_value = "{\"Role\":\"" + "ZH" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
            var FilterList = JSON.parse(res);
            all_zones = "";
            for (var i = 0; i < FilterList.dtZone.length; i++) {
                $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
                if (FilterList.dtZone.length == 0) {
                    all_zones = "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                } else if (i == FilterList.dtZone.length - 1) {
                    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                } else {
                    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'" + ',';
                }
            }
            $('select#Zone')[0].sumo.selectItem(0);
            $('#Zone').trigger("change");
            //all_states = "";
            //for (var i = 0; i < FilterList.dtState.length; i++) {
            //    if (FilterList.dtState.length == 0) {
            //        all_states = "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
            //    } else if (i == FilterList.dtState.length - 1) {
            //        all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
            //    } else {
            //        all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'" + ',';
            //    }
            //}
            //all_territories = "";
            //for (var i = 0; i < FilterList.dtTerritory.length; i++) {
            //    if (FilterList.dtTerritory.length == 0) {
            //        all_territories = "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
            //    } else if (i == FilterList.dtTerritory.length - 1) {
            //        all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
            //    } else {
            //        all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'" + ',';
            //    }
            //}
            //all_customers = "";
            //for (var i = 0; i < FilterList.dtCustomer.length; i++) {
            //$('#StockistID')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //$('#StockistName')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //if (FilterList.dtCustomer.length == 0) {
            //    all_customers = "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else if (i == FilterList.dtCustomer.length - 1) {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'" + ',';
            //}
            //}
        });
    } else if (SessionValue == "SH") {
        $("#Zone").attr("disabled", true); $("#State").attr("disabled", false); $("#TerriotryArea").attr("disabled", false); $("#CustomerCode").attr("disabled", false);
        //data_value = "{\"Role\":\"" + "SH" + "\",\"UserCode\":\"" + "50002430" + "\"}";
        data_value = "{\"Role\":\"" + "SH" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
            var FilterList = JSON.parse(res);
            //all_zones = "";
            for (var i = 0; i < FilterList.dtZone.length; i++) {
                $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
                //if (FilterList.dtZone.length == 0) {
                //    all_zones = "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else if (i == FilterList.dtZone.length - 1) {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'" + ',';
                //}
            }
            $('select#Zone')[0].sumo.selectItem(0);
            //all_states = "";
            for (var i = 0; i < FilterList.dtState.length; i++) {
                $('#State')[0].sumo.add(FilterList.dtState[i]["STATE_CODE"], FilterList.dtState[i]["STATE_NAME"]);
                //if (FilterList.dtState.length == 0) {
                //    all_states = "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else if (i == FilterList.dtState.length - 1) {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'" + ',';
                //}
            }
            $('select#State')[0].sumo.selectItem(0);
            $('#State').trigger("change");
            //all_territories = "";
            //for (var i = 0; i < FilterList.dtTerritory.length; i++) {
            //    if (FilterList.dtTerritory.length == 0) {
            //        all_territories = "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
            //    } else if (i == FilterList.dtTerritory.length - 1) {
            //        all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
            //    } else {
            //        all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'" + ',';
            //    }
            //}
            //all_customers = "";
            //for (var i = 0; i < FilterList.dtCustomer.length; i++) {
            // $('#StockistID')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //$('#StockistName')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //if (FilterList.dtCustomer.length == 0) {
            //    all_customers = "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else if (i == FilterList.dtCustomer.length - 1) {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'" + ',';
            //}
            // }
        });
    }

    else if (SessionValue == "TM") {
        $("#Zone").attr("disabled", true); $("#State").attr("disabled", true); $("#TerriotryArea").attr("disabled", false); $("#CustomerCode").attr("disabled", false);
        //data_value = "{\"Role\":\"" + "TM" + "\",\"UserCode\":\"" + "50001144" + "\"}";
        data_value = "{\"Role\":\"" + "TM" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
            var FilterList = JSON.parse(res);
            //all_zones = "";
            for (var i = 0; i < FilterList.dtZone.length; i++) {
                $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
                //if (FilterList.dtZone.length == 0) {
                //    all_zones = "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else if (i == FilterList.dtZone.length - 1) {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'" + ',';
                //}
            }
            $('select#Zone')[0].sumo.selectItem(0);
            //all_states = "";
            for (var i = 0; i < FilterList.dtState.length; i++) {
                $('#State')[0].sumo.add(FilterList.dtState[i]["STATE_CODE"], FilterList.dtState[i]["STATE_NAME"]);
                //if (FilterList.dtState.length == 0) {
                //    all_states = "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else if (i == FilterList.dtState.length - 1) {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'" + ',';
                //}
            }
            $('select#State')[0].sumo.selectItem(0);
            //all_territories = "";
            for (var i = 0; i < FilterList.dtTerritory.length; i++) {
                $('#TerriotryArea')[0].sumo.add(FilterList.dtTerritory[i]["TERRITORY_CODE"], FilterList.dtTerritory[i]["TERRITORY_NAME"]);
                //if (FilterList.dtTerritory.length == 0) {
                //    all_territories = "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                //} else if (i == FilterList.dtTerritory.length - 1) {
                //    all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                //} else {
                //    all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'" + ',';
                //}
            }
            //all_customers = "";
            // for (var i = 0; i < FilterList.dtCustomer.length; i++) {
            // $('#StockistID')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //$('#StockistName')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //if (FilterList.dtCustomer.length == 0) {
            //    all_customers = "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else if (i == FilterList.dtCustomer.length - 1) {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'" + ',';
            //}
            //}
        });
    }

    else if (SessionValue == "FSO" || SessionValue == "FSO_BU2") {
        $("#Zone").attr("disabled", true); $("#State").attr("disabled", false); $("#TerriotryArea").attr("disabled", false); $("#CustomerCode").attr("disabled", false);
        //data_value = "{\"Role\":\"" + "FSO" + "\",\"UserCode\":\"" + "50001906" + "\"}";
        if (SessionValue == "FSO") {
            data_value = "{\"Role\":\"" + "FSO" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        } else {
            data_value = "{\"Role\":\"" + "FSO_BU2" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        }
        $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
            var FilterList = JSON.parse(res);
            //all_zones = "";
            for (var i = 0; i < FilterList.dtZone.length; i++) {
                $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
                //if (FilterList.dtZone.length == 0) {
                //    all_zones = "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else if (i == FilterList.dtZone.length - 1) {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'" + ',';
                //}
            }
            $('select#Zone')[0].sumo.selectItem(0);
            //all_states = "";
            for (var i = 0; i < FilterList.dtState.length; i++) {
                $('#State')[0].sumo.add(FilterList.dtState[i]["STATE_CODE"], FilterList.dtState[i]["STATE_NAME"]);
                //if (FilterList.dtState.length == 0) {
                //    all_states = "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else if (i == FilterList.dtState.length - 1) {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'" + ',';
                //}
            }
            $('select#State')[0].sumo.selectItem(0);
            //all_territories = "";
            for (var i = 0; i < FilterList.dtTerritory.length; i++) {
                $('#TerriotryArea')[0].sumo.add(FilterList.dtTerritory[i]["TERRITORY_CODE"], FilterList.dtTerritory[i]["TERRITORY_NAME"]);
                //if (FilterList.dtTerritory.length == 0) {
                //    all_territories = "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                //} else if (i == FilterList.dtTerritory.length - 1) {
                //    all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                //} else {
                //    all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'" + ',';
                //}
            }
            $('select#TerriotryArea')[0].sumo.selectItem(0);
            $('#TerriotryArea').trigger("change");
            //all_customers = "";
            //for (var i = 0; i < FilterList.dtCustomer.length; i++) {
            // $('#StockistID')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //$('#StockistName')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //if (FilterList.dtCustomer.length == 0) {
            //    all_customers = "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else if (i == FilterList.dtCustomer.length - 1) {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'" + ',';
            //}
            // }
        });
    }

    else if ((SessionValue == "STOCKIST") || (SessionValue == "C&F")) {
        $("#Zone").attr("disabled", true); $("#State").attr("disabled", true); $("#TerriotryArea").attr("disabled", true); $("#CustomerCode").attr("disabled", true);
        //data_value = "{\"Role\":\"" + "STOCKIST" + "\",\"UserCode\":\"" + "1100002" + "\"}";
        data_value = "{\"Role\":\"" + "STOCKIST" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
            var FilterList = JSON.parse(res);
            //all_zones = "";
            for (var i = 0; i < FilterList.dtZone.length; i++) {
                $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
                //if (FilterList.dtZone.length == 0) {
                //    all_zones = "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else if (i == FilterList.dtZone.length - 1) {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'" + ',';
                //}
            }
            $('select#Zone')[0].sumo.selectItem(0);
            //all_states = "";
            for (var i = 0; i < FilterList.dtState.length; i++) {
                $('#State')[0].sumo.add(FilterList.dtState[i]["STATE_CODE"], FilterList.dtState[i]["STATE_NAME"]);
                //if (FilterList.dtState.length == 0) {
                //    all_states = "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else if (i == FilterList.dtState.length - 1) {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'" + ',';
                //}
            }
            $('select#State')[0].sumo.selectItem(0);
            //all_territories = "";
            for (var i = 0; i < FilterList.dtTerritory.length; i++) {
                $('#TerriotryArea')[0].sumo.add(FilterList.dtTerritory[i]["TERRITORY_CODE"], FilterList.dtTerritory[i]["TERRITORY_NAME"]);
                //if (FilterList.dtTerritory.length == 0) {
                //    all_territories = "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                //} else if (i == FilterList.dtTerritory.length - 1) {
                //    all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                //} else {
                //    all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'" + ',';
                //}
            }
            $('select#TerriotryArea')[0].sumo.selectItem(0);
            //all_customers = "";
            for (var i = 0; i < FilterList.dtCustomer.length; i++) {
                CustomerArray.push(FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
                $('#CustomerCode').val(FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
                //$('#StockistID').val(FilterList.dtCustomer[i]["CUSTOMER_CODE"] + " : " + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
                //$('#StockistName')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
                //if (FilterList.dtCustomer.length == 0) {
                //    all_customers = "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
                //} else if (i == FilterList.dtCustomer.length - 1) {
                //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
                //} else {
                //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'" + ',';
                //}
            }
            //$("#StockistID").typeahead({
            //    source: CustomerArray
            //});
            //$('select#StockistID')[0].sumo.selectItem(0);
        });
    } else {
        $("#Zone").attr("disabled", false); $("#State").attr("disabled", false); $("#TerriotryArea").attr("disabled", false); $("#CustomerCode").attr("disabled", false);
        //data_value = "{\"Role\":\"" + "ADMIN" + "\",\"UserCode\":\"" + "50001657" + "\"}";
        data_value = "{\"Role\":\"" + SessionValue + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
            var FilterList = JSON.parse(res);
            all_zones = "";
            for (var i = 0; i < FilterList.dtZone.length; i++) {
                $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
                if (FilterList.dtZone.length == 0) {
                    all_zones = "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                } else if (i == FilterList.dtZone.length - 1) {
                    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                } else {
                    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'" + ',';
                }
            }
            CustomerArray.length = 0;
            $("#CustomerCode").val("");
            if (FilterList.dtCustomer.length > 0) {
                for (var i = 0; i < FilterList.dtCustomer.length; i++) {
                    CustomerArray.push(FilterList.dtCustomer[i]["STOCKIST_ID"].toString() + ":" + FilterList.dtCustomer[i]["STOCKIST_NAME"].toString());
                }
            }
            //all_states = "";
            //for (var i = 0; i < FilterList.dtState.length; i++) {
            //    if (FilterList.dtState.length == 0) {
            //        all_states = "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
            //    } else if (i == FilterList.dtState.length - 1) {
            //        all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
            //    } else {
            //        all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'" + ',';
            //    }
            //}
            //all_territories = "";
            //for (var i = 0; i < FilterList.dtTerritory.length; i++) {
            //    if (FilterList.dtTerritory.length == 0) {
            //        all_territories = "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
            //    } else if (i == FilterList.dtTerritory.length - 1) {
            //        all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
            //    } else {
            //        all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'" + ',';
            //    }
            //}
            //all_customers = "";
            //for (var i = 0; i < FilterList.dtCustomer.length; i++) {
            //$('#StockistID')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //$('#StockistName')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //if (FilterList.dtCustomer.length == 0) {
            //    all_customers = "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else if (i == FilterList.dtCustomer.length - 1) {
            //   all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'" + ',';
            //}
            //}
        });
    }
    HideLoader();
    $('#Zone').on('keyup change', function () {
        ShowLoader();
        var Clear_State = $('#State option').length;
        for (var i = 0; i < Clear_State; i++) {
            $('#State')[0].sumo.remove(0);
        }

        //var Clear_Cust = $('#StockistID option').length;
        //for (var i = 0; i < Clear_Cust; i++) {
        //    $('#StockistID')[0].sumo.remove(0);
        //}

        CustomerArray.length = 0;
        $("#CustomerCode").val("");

        var Clear_Terrytory = $('#TerriotryArea option').length;
        for (var i = 0; i < Clear_Terrytory; i++) {
            $('#TerriotryArea')[0].sumo.remove(0);
        }

        var data_value = "{\"Zone_Code\":\"" + $("#Zone").val() + "\"}";
        $http({ url: '../../Home/GetStatesforZone', method: 'POST', data: { Data: data_value } }).success(function (res) {
            if (res != "") {
                var dtState = JSON.parse(res);
                for (var i = 0; i < dtState.length; i++) {
                    $('#State')[0].sumo.add(dtState[i]["STATE_CODE"], dtState[i]["STATE_NAME"]);
                }
                // HideLoader();
            } else {
                // HideLoader();
            }

            $http({ url: '../../Home/GetCustomersforZone', method: 'POST', data: { Data: data_value } }).success(function (Cust_res) {
                if (Cust_res != "") {
                    var dtCust = JSON.parse(Cust_res);
                    for (var i = 0; i < dtCust.length; i++) {
                        //  $('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"].toString(), dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                        CustomerArray.push(dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                    }
                }
            });
        });
        HideLoader();
    });

    var SelectedState = ""; var Actual_SelectedState = ""; var Actual_SelectedTerritory = "";
    $('#State').on('keyup change', function () {
        ShowLoader();
        Actual_SelectedState = "";
        var Clear_Territory = $('#TerriotryArea option').length;
        for (var i = 0; i < Clear_Territory; i++) {
            $('#TerriotryArea')[0].sumo.remove(0);
        }
        //var Clear_Cust = $('#StockistID option').length;
        //for (var i = 0; i < Clear_Cust; i++) {
        //    $('#StockistID')[0].sumo.remove(0);
        //}

        CustomerArray.length = 0;
        $("#CustomerCode").val("");

        if ($('#State').val() != null) {
            //ShowLoader();
            var seleState = $('#State').val();

            for (var k = 0; k < seleState.length; k++) {
                SelectedState += "'" + seleState[k] + "',";
                Actual_SelectedState += "'" + seleState[k] + "',";
            }
            SelectedState = SelectedState.substring(',', SelectedState.length - 1);//Selected States with ' '. 
            Actual_SelectedState = Actual_SelectedState.substring(',', Actual_SelectedState.length - 1);//Selected States with ' '. 
        }

        var data_value = "{\"State_Code\":\"" + SelectedState + "\"}";
        $http({ url: '../../Home/GetTerritoriesforState', method: 'POST', data: { Data: data_value } }).success(function (res) {
            if (res != "") {
                var dtTerritory = JSON.parse(res);
                for (var i = 0; i < dtTerritory.length; i++) {
                    $('#TerriotryArea')[0].sumo.add(dtTerritory[i]["TERRITORY_CODE"], dtTerritory[i]["TERRITORY_NAME"]);
                }
            }
            $http({ url: '../../Home/GetCustomersforState', method: 'POST', data: { Data: data_value } }).success(function (res) {
                if (res != "") {
                    var dtCust = JSON.parse(res);
                    for (var i = 0; i < dtCust.length; i++) {
                        //$('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"].toString(), dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                        CustomerArray.push(dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                    }
                    HideLoader();
                } else { HideLoader(); }

            });
        });

        if ($("#State").val() == null) {
            var data_value = "{\"Zone_Code\":\"" + $("#Zone").val() + "\"}";
            if ((SessionValue != "SH") && (SessionValue != "TM") && (SessionValue != "FSO") && (SessionValue != "FSO_BU2") && (SessionValue != "STOCKIST") && (SessionValue != "C&F")) {
                $http({ url: '../../Home/GetCustomersforZone', method: 'POST', data: { Data: data_value } }).success(function (Cust_res) {
                    if (Cust_res != "") {
                        var dtCust = JSON.parse(Cust_res);
                        for (var i = 0; i < dtCust.length; i++) {
                            //  $('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"].toString(), dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                            CustomerArray.push(dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                        }
                        HideLoader();
                    } else {
                        HideLoader();
                    }
                });
            }
            HideLoader();
        }
        SelectedState = "";
        //HideLoader();
    });

    var SelectedTerritory = "";
    $('#TerriotryArea').on('keyup change', function () {
        ShowLoader();
        Actual_SelectedTerritory = ""; Actual_SelectedState = "";
        if ((SessionValue == "TM") || (SessionValue == "FSO") || (SessionValue == "FSO_BU2")) {
            if ($("#TerriotryArea").val() == null) {
                //var Clear_Cust = $('#StockistID option').length;
                //for (var i = 0; i < Clear_Cust; i++) {
                //    $('#StockistID')[0].sumo.remove(0);
                //}

                CustomerArray.length = 0;
                $("#CustomerCode").val("");

                HideLoader();
            } else if ($("#TerriotryArea").val() != null) {
                var seleTerritory = $('#TerriotryArea').val();
                for (var k = 0; k < seleTerritory.length; k++) {
                    SelectedTerritory += "'" + seleTerritory[k] + "',";
                    Actual_SelectedTerritory += "'" + seleTerritory[k] + "',";
                }
                SelectedTerritory = SelectedTerritory.substring(',', SelectedTerritory.length - 1);//Selected Territories with ' '. 
                Actual_SelectedTerritory = Actual_SelectedTerritory.substring(',', Actual_SelectedTerritory.length - 1);//Selected Territories with ' '. 

                var data_value = "{\"Territory_Code\":\"" + SelectedTerritory + "\"}";
                $http({ url: '../../Home/GetCustomersforTerritory', method: 'POST', data: { Data: data_value } }).success(function (res) {
                    if (res != "") {
                        var dtCust = JSON.parse(res);
                        for (var i = 0; i < dtCust.length; i++) {
                            //$('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"], dtCust[i]["CUSTOMER_CODE"] + ":" + dtCust[i]["CUSTOMER_NAME"]);
                            CustomerArray.push(dtCust[i]["CUSTOMER_CODE"] + ":" + dtCust[i]["CUSTOMER_NAME"]);
                        }
                        HideLoader();
                    } else { HideLoader(); }

                });
            }
        } else {
            //var Clear_Cust = $('#StockistID option').length;
            //for (var i = 0; i < Clear_Cust; i++) {
            //    $('#StockistID')[0].sumo.remove(0);
            //}

            CustomerArray.length = 0;
            $("#CustomerCode").val("");


            if ($('#TerriotryArea').val() != null) {
                var seleTerritory = $('#TerriotryArea').val();
                for (var k = 0; k < seleTerritory.length; k++) {
                    SelectedTerritory += "'" + seleTerritory[k] + "',";
                    Actual_SelectedTerritory += "'" + seleTerritory[k] + "',";
                }
                SelectedTerritory = SelectedTerritory.substring(',', SelectedTerritory.length - 1);//Selected Territories with ' '. 
                Actual_SelectedTerritory = Actual_SelectedTerritory.substring(',', Actual_SelectedTerritory.length - 1);//Selected Territories with ' '. 
            }
            if ($("#TerriotryArea").val() == null) {
                var seleState = $('#State').val();

                for (var k = 0; k < seleState.length; k++) {
                    SelectedState += "'" + seleState[k] + "',";
                    Actual_SelectedState += "'" + seleState[k] + "',";
                }
                SelectedState = SelectedState.substring(',', SelectedState.length - 1);//Selected States with ' '. 
                Actual_SelectedState = Actual_SelectedState.substring(',', Actual_SelectedState.length - 1);//Selected States with ' '. 

                var data_value = "{\"State_Code\":\"" + SelectedState + "\"}";
                $http({ url: '../../Home/GetCustomersforState', method: 'POST', data: { Data: data_value } }).success(function (res) {
                    if (res != "") {
                        var dtCust = JSON.parse(res);
                        for (var i = 0; i < dtCust.length; i++) {
                            //$('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"].toString(), dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                            CustomerArray.push(dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                        }
                        HideLoader();
                    } else { HideLoader(); }

                });
            } else {
                var data_value = "{\"Territory_Code\":\"" + SelectedTerritory + "\"}";
                $http({ url: '../../Home/GetCustomersforTerritory', method: 'POST', data: { Data: data_value } }).success(function (res) {
                    if (res != "") {
                        var dtCust = JSON.parse(res);
                        for (var i = 0; i < dtCust.length; i++) {
                            //$('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"], dtCust[i]["CUSTOMER_CODE"] + ":" + dtCust[i]["CUSTOMER_NAME"]);
                            CustomerArray.push(dtCust[i]["CUSTOMER_CODE"] + ":" + dtCust[i]["CUSTOMER_NAME"]);
                        }
                        HideLoader();
                    } else { HideLoader(); }

                });
            }
        }
        SelectedTerritory = "";
        SelectedState = "";
    });
    $("#CustomerCode").typeahead({
        source: CustomerArray
    });
    var OutstandingDate;
    $scope.GetData = function () {
        var isValidCustCode = isValidCode_Cust($("#CustomerCode").val(), CustomerArray);
        if ($("#OrderFromDate").val() != "") {
            if ((SessionValue == "ZH")) {
                if ($("#Zone").val() == null) { alert("Please Select Your Zone"); }
                else if ((isValidCustCode == false) && ($("#CustomerCode").val() != "")) {
                    alert("please select proper customer code");
                } else {
                    GetOutstandingDetails();
                }
            } else if (SessionValue == "SH") {
                if ($("#State").val() == null) { alert("Please Select Your State"); } else if ((isValidCustCode == false) && ($("#CustomerCode").val() != "")) {
                    alert("please select proper customer code");
                } else {
                    GetOutstandingDetails();
                }
            } else if (SessionValue == "TM") {
                if ($("#TerriotryArea").val() == null) { alert("Please Select Your Sales Group"); } else if ((isValidCustCode == false) && ($("#CustomerCode").val() != "")) {
                    alert("please select proper customer code");
                } else {
                    GetOutstandingDetails();
                }
            }
            else if (SessionValue == "FSO" || (SessionValue == "FSO_BU2")) {
                if ($("#TerriotryArea").val() == null) { alert("Please Select Your Sales Group"); } else if ((isValidCustCode == false) && ($("#CustomerCode").val() != "")) {
                    alert("please select proper customer code");
                } else {
                    GetOutstandingDetails();
                }
            } else {
                if ((isValidCustCode == false) && ($("#CustomerCode").val() != "")) {
                    alert("please select proper customer code");
                } else {
                    GetOutstandingDetails();
                }
            }
        } else { alert("Please Select Date"); }
    }

    function GetOutstandingDetails() {
        ShowLoader();
        var DateRange = $("#OrderFromDate").val().split('/');
        OutstandingDate = DateRange;
        try {
            //var WhereClause = " where sod.aging_date='" + DateRange[2] + '/' + DateRange[1] + '/' + DateRange[0] + "' AND cast(sod.CUSTOMER_CODE as int)=cast(scm.STOCKIST_ID as int) and cast(sod.CUSTOMER_CODE as int)=cast(CustSales.STOCKIST_ID as int) and CustSales.SALES_ORGANISATION='1000'";

            //if ($("#CustomerCode").val() != "") {
            //    WhereClause += " and CAST(sod.CUSTOMER_CODE AS BIGINT) IN (" + $("#CustomerCode").val().split(':')[0] + ")";
            //} else if ($("#TerriotryArea").val() != null) {
            //    WhereClause += " and CAST(sod.CUSTOMER_CODE AS BIGINT) IN (select DISTINCT ecc.CUSTOMER_CODE from cms_employee_customer_configuration ecc inner join CUSTOMER_SALES_VIEW csv on CAST(ecc.CUSTOMER_CODE AS BIGINT)=CAST(csv.cust_code AS BIGINT) where ecc.ORG_LEVEL_ID IN(" + Actual_SelectedTerritory + "))";
            //} else if ($("#State").val() != null) {
            //    WhereClause += " and scm.STATE IN(" + Actual_SelectedState + ")";
            //}
            //else if ($("#Zone").val() != null) {
            //    WhereClause += " and CustSales.ZONE IN(" + $("#Zone").val() + ")";
            //}
            //if (($("#Zone").val() == null) && ($("#State").val() == null) && ($("#TerriotryArea").val() == null) && ($("#CustomerCode").val() == "")) {
            //    WhereClause += "";
            //}



            var WhereClause = " where aging_date='" + DateRange[2] + '/' + DateRange[1] + '/' + DateRange[0] + "'";
            WhereClause = "";
            if ($("#CustomerCode").val() != "") {
                WhereClause += " and CAST(CUSTOMER_CODE AS BIGINT) IN (" + $("#CustomerCode").val().split(':')[0] + ")";
            } else if ($("#TerriotryArea").val() != null) {
                WhereClause += " and CAST(CUSTOMER_CODE AS BIGINT) IN (select DISTINCT ecc.CUSTOMER_CODE from cms_employee_customer_configuration ecc inner join CUSTOMER_SALES_VIEW csv on CAST(ecc.CUSTOMER_CODE AS BIGINT)=CAST(csv.cust_code AS BIGINT) where ecc.ORG_LEVEL_ID IN(" + Actual_SelectedTerritory + "))";
            } else if ($("#State").val() != null) {
                WhereClause += " and STATE IN(" + Actual_SelectedState + ")";
            }
            else if ($("#Zone").val() != null) {
                WhereClause += " and ZONE IN(" + $("#Zone").val() + ")";
            }
            if (($("#Zone").val() == null) && ($("#State").val() == null) && ($("#TerriotryArea").val() == null) && ($("#CustomerCode").val() == "")) {
                WhereClause += "";
            }

            var sheet = $("#Sheets").val();

            //Edited By Manikanta

            if (sheet != "select") {
                WhereClause += " and CAST(CUSTOMER_CODE AS BIGINT) IN (select STOCKIST_ID from sap_customer_sales_master where DIVISION='" + sheet + "')";
            }




            var Data = JSON.stringify({
                MasterType: "OutstandingDetails",
                ID: "561",
                UserCode: $("#UserCode").val(),
                "Type": "Get",
                ReportName: "OutstandingDetails",
                WhereClause: WhereClause,
                aging_date: DateRange[2] + '/' + DateRange[1] + '/' + DateRange[0]
            });


            // ShowLoader();
            DIMSFactory.getReportListColumnNamesData(Data).success(function (response) {
                var Result = JSON.parse(response.tabledata);

                if (Result != "") {
                    $scope.UserDefaultListColumnNames = Result["UserDefaultListColumnNames"];
                    if (Result.hasOwnProperty('UserListColumnNames')) {
                        var data1 = JSON.parse(Result["UserListColumnNames"]);

                        var selectedcolumnname = data1["ColumnNames"];

                        CustomColumnID = Result["UserListID"];
                        $('#undo_redo_to').empty();
                        var ColArray = new Array();
                        for (var i = 0; i < selectedcolumnname.length; i++) {


                            ColArray.push({
                                "data": selectedcolumnname[i],
                                "name": selectedcolumnname[i], "bSortable": true
                            });
                            $("#undo_redo_to").append($("<option></option>").val(selectedcolumnname[i]).html(selectedcolumnname[i]));
                        }
                        //$scope.UserSelectedColumnName = ColArray;
                        UserSelectedColumnName = ColArray;
                    } else {

                        var data1 = JSON.parse(Result["UserDefaultListColumnNames"]);

                        var selectedcolumnname = data1["ColumnNames"];

                        CustomColumnID = "0";

                        $('#undo_redo_to').empty();
                        var ColArray = new Array();
                        for (var i = 0; i < selectedcolumnname.length; i++) {
                            ColArray.push({
                                "data": selectedcolumnname[i],
                                "name": selectedcolumnname[i],
                                "bSortable": "true"
                            });
                            $("#undo_redo_to").append($("<option></option>").val(selectedcolumnname[i]).html(selectedcolumnname[i]));
                        }
                        //$scope.UserSelectedColumnName = ColArray;
                        UserSelectedColumnName = ColArray;
                    }



                }
                //HideLoader();
                //ShowLoader();
                DIMSFactory.getReportData(Data).success(function (response) {


                    getLookUpData_Reports_ServerSideBinding("", "EnrollmentNodataLabel", "", "tbl_Outstanding_Details", UserSelectedColumnName);
                    $("#OutstandingDiv").show();
                });
                //HideLoader();
                

                WhereClause = " where aging_date='" + DateRange[2] + '/' + DateRange[1] + '/' + DateRange[0] + "'";
                WhereClause = "";
                if ($("#CustomerCode").val() != "") {
                    WhereClause += " and CAST(CUSTOMER_CODE AS BIGINT) IN (" + $("#CustomerCode").val().split(':')[0] + ")";
                } else if ($("#TerriotryArea").val() != null) {
                    WhereClause += " and CAST(CUSTOMER_CODE AS BIGINT) IN (select DISTINCT ecc.CUSTOMER_CODE from cms_employee_customer_configuration ecc inner join CUSTOMER_SALES_VIEW csv on CAST(ecc.CUSTOMER_CODE AS BIGINT)=CAST(csv.cust_code AS BIGINT) where ecc.ORG_LEVEL_ID IN(" + Actual_SelectedTerritory + "))";
                } else if ($("#State").val() != null) {
                    WhereClause += " and STATE IN(" + Actual_SelectedState + ")";
                }
                else if ($("#Zone").val() != null) {
                    WhereClause += " and ZONE IN(" + $("#Zone").val() + ")";
                }
                if (($("#Zone").val() == null) && ($("#State").val() == null) && ($("#TerriotryArea").val() == null) && ($("#CustomerCode").val() == "")) {
                    WhereClause += "";
                }

                var sheet = $("#Sheets").val();

                //Edited By Manikanta

                if (sheet != "select") {
                    WhereClause += " and CAST(CUSTOMER_CODE AS BIGINT) IN (select STOCKIST_ID from sap_customer_sales_master where DIVISION='" + sheet + "')";
                }

                
               
                var data1 = JSON.stringify({
                    MasterType: "OutstandingDetails",
                    ID: "561",
                    UserCode: $("#UserCode").val(),
                    "Type": "Get",
                    ReportName: "OutstandingDetails",
                    WhereClause: WhereClause,
                    aging_date: DateRange[2] + '/' + DateRange[1] + '/' + DateRange[0]
                });
               
                DIMSSAPFactory.GetTotalSumOutstanding(data1).success(function (res) {
                    var days_0015 = ""; var days_1630 = ""; var days_3145 = ""; var days_4660 = ""; var days_6175 = ""; var days_7690 = "";
                    var days_91120 = ""; var days_121150 = ""; var days_151179 = ""; var days_180 = ""; var days_ab180 = ""; var TotalAmount = "";
                    if (res != "False") {
                        var ResultOs = JSON.parse(res);
                        if (ResultOs.length == 0) { }
                        else {
                            if (parseFloat(ResultOs[0]["days_0015"]).toFixed(2) != "NaN") { days_0015 = parseFloat(ResultOs[0]["days_0015"]).toFixed(2); }
                            if (parseFloat(ResultOs[0]["days_1630"]).toFixed(2) != "NaN") { days_1630 = parseFloat(ResultOs[0]["days_1630"]).toFixed(2); }
                            if (parseFloat(ResultOs[0]["days_3145"]).toFixed(2) != "NaN") { days_3145 = parseFloat(ResultOs[0]["days_3145"]).toFixed(2); }
                            if (parseFloat(ResultOs[0]["days_4660"]).toFixed(2) != "NaN") { days_4660 = parseFloat(ResultOs[0]["days_4660"]).toFixed(2); }
                            if (parseFloat(ResultOs[0]["days_6175"]).toFixed(2) != "NaN") { days_6175 = parseFloat(ResultOs[0]["days_6175"]).toFixed(2); }
                            if (parseFloat(ResultOs[0]["days_7690"]).toFixed(2) != "NaN") { days_7690 = parseFloat(ResultOs[0]["days_7690"]).toFixed(2); }
                            if (parseFloat(ResultOs[0]["days_91120"]).toFixed(2) != "NaN") { days_91120 = parseFloat(ResultOs[0]["days_91120"]).toFixed(2); }
                            if (parseFloat(ResultOs[0]["days_121150"]).toFixed(2) != "NaN") { days_121150 = parseFloat(ResultOs[0]["days_121150"]).toFixed(2); }
                            if (parseFloat(ResultOs[0]["days_151179"]).toFixed(2) != "NaN") { days_151179 = parseFloat(ResultOs[0]["days_151179"]).toFixed(2); }
                            if (parseFloat(ResultOs[0]["days_180"]).toFixed(2) != "NaN") { days_180 = parseFloat(ResultOs[0]["days_180"]).toFixed(2); }
                            if (parseFloat(ResultOs[0]["days_AB180"]).toFixed(2) != "NaN") { days_ab180 = parseFloat(ResultOs[0]["days_AB180"]).toFixed(2); }
                            if (parseFloat(ResultOs[0]["TOTAL_OUTSTANDING"]).toFixed(2) != "NaN") { TotalAmount = parseFloat(ResultOs[0]["TOTAL_OUTSTANDING"]).toFixed(2); }
                        }
                        $('#txt015').val(days_0015);
                        $('#txt1630').val(days_1630);
                        $('#txt3145').val(days_3145);
                        $('#txt4660').val(days_4660);
                        $('#txt6175').val(days_6175);
                        $('#txt7690').val(days_7690);
                        $('#txt91120').val(days_91120);
                        $('#txt121150').val(days_121150);
                        $('#txt151179').val(days_151179);
                        $('#txt180').val(days_180);
                        $('#txt180ab').val(days_ab180);
                        $('#txtTotal').val(TotalAmount);
                        //$('#loader').css('display');
                        console.log("Please wait");
                    } else {
                        $('#txt015').val("");
                        $('#txt1630').val("");
                        $('#txt3145').val("");
                        $('#txt4660').val("");
                        $('#txt6175').val("");
                        $('#txt7690').val("");
                        $('#txt91120').val("");
                        $('#txt121150').val("");
                        $('#txt151179').val("");
                        $('#txt180').val("");
                        $('#txt180ab').val("");
                        $('#txtTotal').val("");
                    }
                });

            });
        } catch (Exception) { }
    }



    // Open popup for columns selection
    $scope.OpenColumnEditing = function () {

        $('#undo_redo').empty();
        var ColumnNames = JSON.parse($scope.UserDefaultListColumnNames);

        for (var i = 0; i < ColumnNames["ColumnNames"].length; i++) {
            $("#undo_redo").append($("<option></option>").val(ColumnNames["ColumnNames"][i]).html(ColumnNames["ColumnNames"][i]));
        }



        //   $('#undo_redo').refresh();

        $('#undo_redo').multiselect();
        if (ControllerName != "OutstandingDetailCtrl") {
            ControllerName = "OutstandingDetailCtrl";
            var elem = angular.element('#ColumnEditingModal');
            elem.removeAttr('ng-controller');
            elem.attr('ng-controller', "OutstandingDetailCtrl");

            $compile(elem.contents())(AccountStatementScope);
        }

        $("#ColumnEditingModal").modal('show');




    }
    // View Column selected it is like preview.We will send reportname,usercode and where condition to function
    $scope.ViewColumnEditing = function () {
        DIMSFactory.ViewColumnEditing("OutstandingDetails", $("#UserCode").val(), " where sod.DATE=" + OutstandingDate[0] + '/' + OutstandingDate[1] + '/' + OutstandingDate[2] + " AND cast(sod.CUSTOMER_CODE as int)=cast(scm.STOCKIST_ID as int) and cast(sod.CUSTOMER_CODE as int)=cast(CustSales.STOCKIST_ID as int) and CustSales.SALES_ORGANISATION='1000' group by CAST(sod.CUSTOMER_CODE AS INT),scm.STOCKIST_NAME,sod.FIRST_DURATION,sod.SECOND_DURATION,sod.THIRD_DURATION,sod.FOURTH_DURATION,sod.FIFTH_DURATION,sod.SIXTH_DURATION,sod.SEVENTH_DURATION,cast(scm.STOCKIST_ID as int),scm.STATE,sod.DATE"); // 1-Report Name ,2-UserCode(561),3-WhereClause

    }
    // Save Column selected it is like preview.We will send reportname,usercode and where condition to function
    $scope.SaveColumnEditingData = function () {
        var WhereClause = " where sod.DATE=" + OutstandingDate[0] + '/' + OutstandingDate[1] + '/' + OutstandingDate[2] + " AND cast(sod.CUSTOMER_CODE as int)=cast(scm.STOCKIST_ID as int) and cast(sod.CUSTOMER_CODE as int)=cast(CustSales.STOCKIST_ID as int) and CustSales.SALES_ORGANISATION='1000' group by CAST(sod.CUSTOMER_CODE AS INT),scm.STOCKIST_NAME,sod.FIRST_DURATION,sod.SECOND_DURATION,sod.THIRD_DURATION,sod.FOURTH_DURATION,sod.FIFTH_DURATION,sod.SIXTH_DURATION,sod.SEVENTH_DURATION,cast(scm.STOCKIST_ID as int),scm.STATE,sod.DATE";
        var Data = JSON.stringify({
            MasterType: "OutstandingDetails",
            ID: "561",
            UserCode: $("#UserCode").val(),
            "Type": "Get",
            ReportName: "OutstandingDetails",
            WhereClause: WhereClause
        });
        //DIMSFactory.SaveColumnEditingData("Compensation", $scope.UserCode, " ORDER BY ID DESC");
        DIMSFactory.SaveColumnEditingData_InputParameter("OutstandingDetails", $("#UserCode").val(), WhereClause, Data, "tbl_Outstanding_Details");
        // 1-Report Name ,2-UserCode(561),3-WhereClause,4-JsonData,5-Frontend datatable id


    }

    $scope.DownloadFile = function (filetype) {
        var isValidCustCode = isValidCode_Cust($("#CustomerCode").val(), CustomerArray);
        var SearchValue = $('input[type=search]').val();
        var FileName = "OutstandingDetails";
        var DateRange = $("#OrderFromDate").val().split('/');
        var UserCode = $("#UserCode").val();

        //var WhereClause = " where sod.aging_date='" + DateRange[2] + '/' + DateRange[1] + '/' + DateRange[0] + "' AND cast(sod.CUSTOMER_CODE as int)=cast(scm.STOCKIST_ID as int) and cast(sod.CUSTOMER_CODE as int)=cast(CustSales.STOCKIST_ID as int) and CustSales.SALES_ORGANISATION='1000'";
        //if ($("#CustomerCode").val() != "") {
        //    if ((isValidCustCode == false) && ($("#CustomerCode").val() != "")) {

        //    } else {
        //        WhereClause += " and CAST(sod.CUSTOMER_CODE AS BIGINT) IN (" + $("#CustomerCode").val().split(':')[0] + ")";
        //    }

        //} else if ($("#TerriotryArea").val() != null) {
        //    WhereClause += " and CAST(sod.CUSTOMER_CODE AS BIGINT) IN (select DISTINCT ecc.CUSTOMER_CODE from cms_employee_customer_configuration ecc inner join CUSTOMER_SALES_VIEW csv on CAST(ecc.CUSTOMER_CODE AS BIGINT)=CAST(csv.cust_code AS BIGINT) where ecc.ORG_LEVEL_ID IN(" + Actual_SelectedTerritory + "))";
        //} else if ($("#State").val() != null) {
        //    WhereClause += " and scm.STATE IN(" + Actual_SelectedState + ")";
        //}
        //else if ($("#Zone").val() != null) {
        //    WhereClause += " and CustSales.ZONE IN(" + $("#Zone").val() + ")";
        //}
        //if (($("#Zone").val() == null) && ($("#State").val() == null) && ($("#TerriotryArea").val() == null) && ($("#CustomerCode").val() == "")) {
        //    WhereClause += "";
        //}


        var WhereClause = " where aging_date='" + DateRange[2] + '/' + DateRange[1] + '/' + DateRange[0] + "'";

        if ($("#CustomerCode").val() != "") {
            WhereClause += " and CAST(CUSTOMER_CODE AS BIGINT) IN (" + $("#CustomerCode").val().split(':')[0] + ")";
        } else if ($("#TerriotryArea").val() != null) {
            WhereClause += " and CAST(CUSTOMER_CODE AS BIGINT) IN (select DISTINCT ecc.CUSTOMER_CODE from cms_employee_customer_configuration ecc inner join CUSTOMER_SALES_VIEW csv on CAST(ecc.CUSTOMER_CODE AS BIGINT)=CAST(csv.cust_code AS BIGINT) where ecc.ORG_LEVEL_ID IN(" + Actual_SelectedTerritory + "))";
        } else if ($("#State").val() != null) {
            WhereClause += " and STATE IN(" + Actual_SelectedState + ")";
        }
        else if ($("#Zone").val() != null) {
            WhereClause += " and ZONE IN(" + $("#Zone").val() + ")";
        }
        if (($("#Zone").val() == null) && ($("#State").val() == null) && ($("#TerriotryArea").val() == null) && ($("#CustomerCode").val() == "")) {
            WhereClause += "";
        }


        var sheet = $("#Sheets").val();

        //Edited By Manikanta

        if (sheet != "select") {
            WhereClause += " and CAST(CUSTOMER_CODE AS BIGINT) IN (select STOCKIST_ID from sap_customer_sales_master where DIVISION='" + sheet + "')";
        }



        var Table_DebitCount = $('#tbl_Outstanding_Details').DataTable().data().count();
        if (Table_DebitCount == 0) {
            alert("There is no data");
        } else {
            if ((isValidCustCode == false) && ($("#CustomerCode").val() != "")) { alert("please select proper customer code"); } else {
                var data_value = "{\"Role\":\"" + SessionValue + "\",\"Form_Code\":\"" + "OD" + "\",\"Action\":\"" + "Is_Export" + "\"}";
                $http({ url: '../../Home/Form_Access', method: 'POST', data: { Data: data_value } }).success(function (res) {
                    if (res == "True") {
                        CommonFunctionForExcelExport_SearchFilter("561", UserCode, SearchValue, FileName, FileName, WhereClause, filetype);
                    }
                    else {
                        alert("You are not allowed to export Outstanding Details");
                    }
                });
            }

        }
    }

});


//Credit Outstanding Details
DIMS.controller('CreditOutstandingDetailCtrl', function ($scope, $location, DIMSFactory, $http, $compile, DIMSSAPFactory) {
    $scope.templatesettings = { HeaderTitle: "Credit Outstanding Details" };
    AccountStatementScope = $scope;
    MasterScope = $scope;



    $("#OutstandingDiv").hide();
    $scope.go = function (path) {
        CheckUserSession();
        $location.path(path);
    };

    var width = $(window).width(), height = $(window).height();//---------

    var totalheight = height - 191;
    // var totalheight = height - 148;//--------    
    if (height <= 800) {
        totalheight = height - 148;
    }

    $('.content').css({ "max-height": totalheight, "overflow-y": "auto" });//-----------
    $('.content-header > h2').css({ "font-size": "18px", "font-weight": "500" });//----------
    $('.content').css({ "max-height": totalheight, "min-height": totalheight, "overflow-y": "auto" });//-----------

    var data_value = ""; var all_zones = ""; var all_states = ""; var all_territories = ""; var all_customers = ""; var CustomerArray = new Array();
    ShowLoader();
    if ((SessionValue == "ZH") || (SessionValue == "RCC") || (SessionValue == "ZSC")) {
        $("#Zone").attr("disabled", false); $("#State").attr("disabled", false); $("#TerriotryArea").attr("disabled", false); $("#CustomerCode").attr("disabled", false);
        //data_value = "{\"Role\":\"" + "ZH" + "\",\"UserCode\":\"" + "50001762" + "\"}";
        data_value = "{\"Role\":\"" + "ZH" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
            var FilterList = JSON.parse(res);
            all_zones = "";
            for (var i = 0; i < FilterList.dtZone.length; i++) {
                $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
                if (FilterList.dtZone.length == 0) {
                    all_zones = "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                } else if (i == FilterList.dtZone.length - 1) {
                    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                } else {
                    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'" + ',';
                }
            }
            $('select#Zone')[0].sumo.selectItem(0);
            $('#Zone').trigger("change");
        });
    } else if (SessionValue == "SH") {
        $("#Zone").attr("disabled", true); $("#State").attr("disabled", false); $("#TerriotryArea").attr("disabled", false); $("#CustomerCode").attr("disabled", false);
        //data_value = "{\"Role\":\"" + "SH" + "\",\"UserCode\":\"" + "50002430" + "\"}";
        data_value = "{\"Role\":\"" + "SH" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
            var FilterList = JSON.parse(res);
            //all_zones = "";
            for (var i = 0; i < FilterList.dtZone.length; i++) {
                $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
            }
            $('select#Zone')[0].sumo.selectItem(0);
            //all_states = "";
            for (var i = 0; i < FilterList.dtState.length; i++) {
                $('#State')[0].sumo.add(FilterList.dtState[i]["STATE_CODE"], FilterList.dtState[i]["STATE_NAME"]);
            }
            $('select#State')[0].sumo.selectItem(0);
            $('#State').trigger("change");
        });
    }

    else if (SessionValue == "TM") {
        $("#Zone").attr("disabled", true); $("#State").attr("disabled", true); $("#TerriotryArea").attr("disabled", false); $("#CustomerCode").attr("disabled", false);
        //data_value = "{\"Role\":\"" + "TM" + "\",\"UserCode\":\"" + "50001144" + "\"}";
        data_value = "{\"Role\":\"" + "TM" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
            var FilterList = JSON.parse(res);
            //all_zones = "";
            for (var i = 0; i < FilterList.dtZone.length; i++) {
                $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
            }
            $('select#Zone')[0].sumo.selectItem(0);
            //all_states = "";
            for (var i = 0; i < FilterList.dtState.length; i++) {
                $('#State')[0].sumo.add(FilterList.dtState[i]["STATE_CODE"], FilterList.dtState[i]["STATE_NAME"]);
            }
            $('select#State')[0].sumo.selectItem(0);
            //all_territories = "";
            for (var i = 0; i < FilterList.dtTerritory.length; i++) {
                $('#TerriotryArea')[0].sumo.add(FilterList.dtTerritory[i]["TERRITORY_CODE"], FilterList.dtTerritory[i]["TERRITORY_NAME"]);
            }
        });
    }

    else if (SessionValue == "FSO" || SessionValue == "FSO_BU2") {
        $("#Zone").attr("disabled", true); $("#State").attr("disabled", false); $("#TerriotryArea").attr("disabled", false); $("#CustomerCode").attr("disabled", false);
        //data_value = "{\"Role\":\"" + "FSO" + "\",\"UserCode\":\"" + "50001906" + "\"}";
        if (SessionValue == "FSO") {
            data_value = "{\"Role\":\"" + "FSO" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        } else {
            data_value = "{\"Role\":\"" + "FSO_BU2" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        }
        $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
            var FilterList = JSON.parse(res);
            //all_zones = "";
            for (var i = 0; i < FilterList.dtZone.length; i++) {
                $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
            }
            $('select#Zone')[0].sumo.selectItem(0);
            //all_states = "";
            for (var i = 0; i < FilterList.dtState.length; i++) {
                $('#State')[0].sumo.add(FilterList.dtState[i]["STATE_CODE"], FilterList.dtState[i]["STATE_NAME"]);
            }
            $('select#State')[0].sumo.selectItem(0);
            //all_territories = "";
            for (var i = 0; i < FilterList.dtTerritory.length; i++) {
                $('#TerriotryArea')[0].sumo.add(FilterList.dtTerritory[i]["TERRITORY_CODE"], FilterList.dtTerritory[i]["TERRITORY_NAME"]);
            }
            $('select#TerriotryArea')[0].sumo.selectItem(0);
            $('#TerriotryArea').trigger("change");
        });
    }

    else if ((SessionValue == "STOCKIST") || (SessionValue == "C&F")) {
        $("#Zone").attr("disabled", true); $("#State").attr("disabled", true); $("#TerriotryArea").attr("disabled", true); $("#CustomerCode").attr("disabled", true);
        //data_value = "{\"Role\":\"" + "STOCKIST" + "\",\"UserCode\":\"" + "1100002" + "\"}";
        data_value = "{\"Role\":\"" + "STOCKIST" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
            var FilterList = JSON.parse(res);
            //all_zones = "";
            for (var i = 0; i < FilterList.dtZone.length; i++) {
                $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
            }
            $('select#Zone')[0].sumo.selectItem(0);
            //all_states = "";
            for (var i = 0; i < FilterList.dtState.length; i++) {
                $('#State')[0].sumo.add(FilterList.dtState[i]["STATE_CODE"], FilterList.dtState[i]["STATE_NAME"]);
            }
            $('select#State')[0].sumo.selectItem(0);
            //all_territories = "";
            for (var i = 0; i < FilterList.dtTerritory.length; i++) {
                $('#TerriotryArea')[0].sumo.add(FilterList.dtTerritory[i]["TERRITORY_CODE"], FilterList.dtTerritory[i]["TERRITORY_NAME"]);
                //if (FilterList.dtTerritory.length == 0) {
                //    all_territories = "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                //} else if (i == FilterList.dtTerritory.length - 1) {
                //    all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                //} else {
                //    all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'" + ',';
                //}
            }
            $('select#TerriotryArea')[0].sumo.selectItem(0);
            //all_customers = "";
            for (var i = 0; i < FilterList.dtCustomer.length; i++) {
                CustomerArray.push(FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
                $('#CustomerCode').val(FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
                //$('#StockistID').val(FilterList.dtCustomer[i]["CUSTOMER_CODE"] + " : " + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
                //$('#StockistName')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
                //if (FilterList.dtCustomer.length == 0) {
                //    all_customers = "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
                //} else if (i == FilterList.dtCustomer.length - 1) {
                //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
                //} else {
                //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'" + ',';
                //}
            }
            //$("#StockistID").typeahead({
            //    source: CustomerArray
            //});
            //$('select#StockistID')[0].sumo.selectItem(0);
        });
    } else {
        $("#Zone").attr("disabled", false); $("#State").attr("disabled", false); $("#TerriotryArea").attr("disabled", false); $("#CustomerCode").attr("disabled", false);
        //data_value = "{\"Role\":\"" + "ADMIN" + "\",\"UserCode\":\"" + "50001657" + "\"}";
        data_value = "{\"Role\":\"" + SessionValue + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
            var FilterList = JSON.parse(res);
            all_zones = "";
            for (var i = 0; i < FilterList.dtZone.length; i++) {
                $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
                if (FilterList.dtZone.length == 0) {
                    all_zones = "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                } else if (i == FilterList.dtZone.length - 1) {
                    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                } else {
                    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'" + ',';
                }
            }
            CustomerArray.length = 0;
            $("#CustomerCode").val("");
            if (FilterList.dtCustomer.length > 0) {
                for (var i = 0; i < FilterList.dtCustomer.length; i++) {
                    CustomerArray.push(FilterList.dtCustomer[i]["STOCKIST_ID"].toString() + ":" + FilterList.dtCustomer[i]["STOCKIST_NAME"].toString());
                }
            }
            //all_states = "";
            //for (var i = 0; i < FilterList.dtState.length; i++) {
            //    if (FilterList.dtState.length == 0) {
            //        all_states = "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
            //    } else if (i == FilterList.dtState.length - 1) {
            //        all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
            //    } else {
            //        all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'" + ',';
            //    }
            //}
            //all_territories = "";
            //for (var i = 0; i < FilterList.dtTerritory.length; i++) {
            //    if (FilterList.dtTerritory.length == 0) {
            //        all_territories = "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
            //    } else if (i == FilterList.dtTerritory.length - 1) {
            //        all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
            //    } else {
            //        all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'" + ',';
            //    }
            //}
            //all_customers = "";
            //for (var i = 0; i < FilterList.dtCustomer.length; i++) {
            //$('#StockistID')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //$('#StockistName')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //if (FilterList.dtCustomer.length == 0) {
            //    all_customers = "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else if (i == FilterList.dtCustomer.length - 1) {
            //   all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'" + ',';
            //}
            //}
        });
    }
    HideLoader();
    $('#Zone').on('keyup change', function () {
        ShowLoader();
        var Clear_State = $('#State option').length;
        for (var i = 0; i < Clear_State; i++) {
            $('#State')[0].sumo.remove(0);
        }

        //var Clear_Cust = $('#StockistID option').length;
        //for (var i = 0; i < Clear_Cust; i++) {
        //    $('#StockistID')[0].sumo.remove(0);
        //}

        CustomerArray.length = 0;
        $("#CustomerCode").val("");

        var Clear_Terrytory = $('#TerriotryArea option').length;
        for (var i = 0; i < Clear_Terrytory; i++) {
            $('#TerriotryArea')[0].sumo.remove(0);
        }

        var data_value = "{\"Zone_Code\":\"" + $("#Zone").val() + "\"}";
        $http({ url: '../../Home/GetStatesforZone', method: 'POST', data: { Data: data_value } }).success(function (res) {
            if (res != "") {
                var dtState = JSON.parse(res);
                for (var i = 0; i < dtState.length; i++) {
                    $('#State')[0].sumo.add(dtState[i]["STATE_CODE"], dtState[i]["STATE_NAME"]);
                }
                // HideLoader();
            } else {
                // HideLoader();
            }

            $http({ url: '../../Home/GetCustomersforZone', method: 'POST', data: { Data: data_value } }).success(function (Cust_res) {
                if (Cust_res != "") {
                    var dtCust = JSON.parse(Cust_res);
                    for (var i = 0; i < dtCust.length; i++) {
                        //  $('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"].toString(), dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                        CustomerArray.push(dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                    }
                }
            });
        });
        HideLoader();
    });

    var SelectedState = ""; var Actual_SelectedState = ""; var Actual_SelectedTerritory = "";
    $('#State').on('keyup change', function () {
        ShowLoader();
        Actual_SelectedState = "";
        var Clear_Territory = $('#TerriotryArea option').length;
        for (var i = 0; i < Clear_Territory; i++) {
            $('#TerriotryArea')[0].sumo.remove(0);
        }
        //var Clear_Cust = $('#StockistID option').length;
        //for (var i = 0; i < Clear_Cust; i++) {
        //    $('#StockistID')[0].sumo.remove(0);
        //}

        CustomerArray.length = 0;
        $("#CustomerCode").val("");

        if ($('#State').val() != null) {
            //ShowLoader();
            var seleState = $('#State').val();

            for (var k = 0; k < seleState.length; k++) {
                SelectedState += "'" + seleState[k] + "',";
                Actual_SelectedState += "'" + seleState[k] + "',";
            }
            SelectedState = SelectedState.substring(',', SelectedState.length - 1);//Selected States with ' '. 
            Actual_SelectedState = Actual_SelectedState.substring(',', Actual_SelectedState.length - 1);//Selected States with ' '. 
        }

        var data_value = "{\"State_Code\":\"" + SelectedState + "\"}";
        $http({ url: '../../Home/GetTerritoriesforState', method: 'POST', data: { Data: data_value } }).success(function (res) {
            if (res != "") {
                var dtTerritory = JSON.parse(res);
                for (var i = 0; i < dtTerritory.length; i++) {
                    $('#TerriotryArea')[0].sumo.add(dtTerritory[i]["TERRITORY_CODE"], dtTerritory[i]["TERRITORY_NAME"]);
                }
            }
            $http({ url: '../../Home/GetCustomersforState', method: 'POST', data: { Data: data_value } }).success(function (res) {
                if (res != "") {
                    var dtCust = JSON.parse(res);
                    for (var i = 0; i < dtCust.length; i++) {
                        //$('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"].toString(), dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                        CustomerArray.push(dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                    }
                    HideLoader();
                } else { HideLoader(); }

            });
        });

        if ($("#State").val() == null) {
            var data_value = "{\"Zone_Code\":\"" + $("#Zone").val() + "\"}";
            if ((SessionValue != "SH") && (SessionValue != "TM") && (SessionValue != "FSO") && (SessionValue != "FSO_BU2") && (SessionValue != "STOCKIST") && (SessionValue != "C&F")) {
                $http({ url: '../../Home/GetCustomersforZone', method: 'POST', data: { Data: data_value } }).success(function (Cust_res) {
                    if (Cust_res != "") {
                        var dtCust = JSON.parse(Cust_res);
                        for (var i = 0; i < dtCust.length; i++) {
                            //  $('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"].toString(), dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                            CustomerArray.push(dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                        }
                        HideLoader();
                    } else {
                        HideLoader();
                    }
                });
            }
            HideLoader();
        }
        SelectedState = "";
        //HideLoader();
    });

    var SelectedTerritory = "";
    $('#TerriotryArea').on('keyup change', function () {
        ShowLoader();
        Actual_SelectedTerritory = ""; Actual_SelectedState = "";
        if ((SessionValue == "TM") || (SessionValue == "FSO") || (SessionValue == "FSO_BU2")) {
            if ($("#TerriotryArea").val() == null) {
                //var Clear_Cust = $('#StockistID option').length;
                //for (var i = 0; i < Clear_Cust; i++) {
                //    $('#StockistID')[0].sumo.remove(0);
                //}

                CustomerArray.length = 0;
                $("#CustomerCode").val("");

                HideLoader();
            } else if ($("#TerriotryArea").val() != null) {
                var seleTerritory = $('#TerriotryArea').val();
                for (var k = 0; k < seleTerritory.length; k++) {
                    SelectedTerritory += "'" + seleTerritory[k] + "',";
                    Actual_SelectedTerritory += "'" + seleTerritory[k] + "',";
                }
                SelectedTerritory = SelectedTerritory.substring(',', SelectedTerritory.length - 1);//Selected Territories with ' '. 
                Actual_SelectedTerritory = Actual_SelectedTerritory.substring(',', Actual_SelectedTerritory.length - 1);//Selected Territories with ' '. 

                var data_value = "{\"Territory_Code\":\"" + SelectedTerritory + "\"}";
                $http({ url: '../../Home/GetCustomersforTerritory', method: 'POST', data: { Data: data_value } }).success(function (res) {
                    if (res != "") {
                        var dtCust = JSON.parse(res);
                        for (var i = 0; i < dtCust.length; i++) {
                            //$('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"], dtCust[i]["CUSTOMER_CODE"] + ":" + dtCust[i]["CUSTOMER_NAME"]);
                            CustomerArray.push(dtCust[i]["CUSTOMER_CODE"] + ":" + dtCust[i]["CUSTOMER_NAME"]);
                        }
                        HideLoader();
                    } else { HideLoader(); }

                });
            }
        } else {
            //var Clear_Cust = $('#StockistID option').length;
            //for (var i = 0; i < Clear_Cust; i++) {
            //    $('#StockistID')[0].sumo.remove(0);
            //}

            CustomerArray.length = 0;
            $("#CustomerCode").val("");


            if ($('#TerriotryArea').val() != null) {
                var seleTerritory = $('#TerriotryArea').val();
                for (var k = 0; k < seleTerritory.length; k++) {
                    SelectedTerritory += "'" + seleTerritory[k] + "',";
                    Actual_SelectedTerritory += "'" + seleTerritory[k] + "',";
                }
                SelectedTerritory = SelectedTerritory.substring(',', SelectedTerritory.length - 1);//Selected Territories with ' '. 
                Actual_SelectedTerritory = Actual_SelectedTerritory.substring(',', Actual_SelectedTerritory.length - 1);//Selected Territories with ' '. 
            }
            if ($("#TerriotryArea").val() == null) {
                var seleState = $('#State').val();

                for (var k = 0; k < seleState.length; k++) {
                    SelectedState += "'" + seleState[k] + "',";
                    Actual_SelectedState += "'" + seleState[k] + "',";
                }
                SelectedState = SelectedState.substring(',', SelectedState.length - 1);//Selected States with ' '. 
                Actual_SelectedState = Actual_SelectedState.substring(',', Actual_SelectedState.length - 1);//Selected States with ' '. 

                var data_value = "{\"State_Code\":\"" + SelectedState + "\"}";
                $http({ url: '../../Home/GetCustomersforState', method: 'POST', data: { Data: data_value } }).success(function (res) {
                    if (res != "") {
                        var dtCust = JSON.parse(res);
                        for (var i = 0; i < dtCust.length; i++) {
                            //$('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"].toString(), dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                            CustomerArray.push(dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                        }
                        HideLoader();
                    } else { HideLoader(); }

                });
            } else {
                var data_value = "{\"Territory_Code\":\"" + SelectedTerritory + "\"}";
                $http({ url: '../../Home/GetCustomersforTerritory', method: 'POST', data: { Data: data_value } }).success(function (res) {
                    if (res != "") {
                        var dtCust = JSON.parse(res);
                        for (var i = 0; i < dtCust.length; i++) {
                            //$('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"], dtCust[i]["CUSTOMER_CODE"] + ":" + dtCust[i]["CUSTOMER_NAME"]);
                            CustomerArray.push(dtCust[i]["CUSTOMER_CODE"] + ":" + dtCust[i]["CUSTOMER_NAME"]);
                        }
                        HideLoader();
                    } else { HideLoader(); }

                });
            }
        }
        SelectedTerritory = "";
        SelectedState = "";
    });
    $("#CustomerCode").typeahead({
        source: CustomerArray
    });
    var OutstandingDate;
    $scope.GetData = function () {
        var isValidCustCode = isValidCode_Cust($("#CustomerCode").val(), CustomerArray);
        if ($("#OrderFromDate").val() != "") {
            if ((SessionValue == "ZH")) {
                if ($("#Zone").val() == null) { alert("Please Select Your Zone"); }
                else if ((isValidCustCode == false) && ($("#CustomerCode").val() != "")) {
                    alert("please select proper customer code");
                } else {
                    GetOutstandingDetails();
                }
            } else if (SessionValue == "SH") {
                if ($("#State").val() == null) { alert("Please Select Your State"); } else if ((isValidCustCode == false) && ($("#CustomerCode").val() != "")) {
                    alert("please select proper customer code");
                } else {
                    GetOutstandingDetails();
                }
            } else if (SessionValue == "TM") {
                if ($("#TerriotryArea").val() == null) { alert("Please Select Your Sales Group"); } else if ((isValidCustCode == false) && ($("#CustomerCode").val() != "")) {
                    alert("please select proper customer code");
                } else {
                    GetOutstandingDetails();
                }
            }
            else if (SessionValue == "FSO" || (SessionValue == "FSO_BU2")) {
                if ($("#TerriotryArea").val() == null) { alert("Please Select Your Sales Group"); } else if ((isValidCustCode == false) && ($("#CustomerCode").val() != "")) {
                    alert("please select proper customer code");
                } else {
                    GetOutstandingDetails();
                }
            } else {
                if ((isValidCustCode == false) && ($("#CustomerCode").val() != "")) {
                    alert("please select proper customer code");
                } else {
                    GetOutstandingDetails();
                }
            }
        } else { alert("Please Select Date"); }
    }

    function GetOutstandingDetails() {
        ShowLoader();
        var DateRange = $("#OrderFromDate").val().split('/');
        OutstandingDate = DateRange;
        try {
            //var WhereClause = " where sod.aging_date='" + DateRange[2] + '/' + DateRange[1] + '/' + DateRange[0] + "' AND cast(sod.CUSTOMER_CODE as int)=cast(scm.STOCKIST_ID as int) and cast(sod.CUSTOMER_CODE as int)=cast(CustSales.STOCKIST_ID as int) and CustSales.SALES_ORGANISATION='1000'";

            //if ($("#CustomerCode").val() != "") {
            //    WhereClause += " and CAST(sod.CUSTOMER_CODE AS BIGINT) IN (" + $("#CustomerCode").val().split(':')[0] + ")";
            //} else if ($("#TerriotryArea").val() != null) {
            //    WhereClause += " and CAST(sod.CUSTOMER_CODE AS BIGINT) IN (select DISTINCT ecc.CUSTOMER_CODE from cms_employee_customer_configuration ecc inner join CUSTOMER_SALES_VIEW csv on CAST(ecc.CUSTOMER_CODE AS BIGINT)=CAST(csv.cust_code AS BIGINT) where ecc.ORG_LEVEL_ID IN(" + Actual_SelectedTerritory + "))";
            //} else if ($("#State").val() != null) {
            //    WhereClause += " and scm.STATE IN(" + Actual_SelectedState + ")";
            //}
            //else if ($("#Zone").val() != null) {
            //    WhereClause += " and CustSales.ZONE IN(" + $("#Zone").val() + ")";
            //}
            //if (($("#Zone").val() == null) && ($("#State").val() == null) && ($("#TerriotryArea").val() == null) && ($("#CustomerCode").val() == "")) {
            //    WhereClause += "";
            //}



            var WhereClause = " where aging_date='" + DateRange[2] + '/' + DateRange[1] + '/' + DateRange[0] + "'";
            WhereClause = "";
            if ($("#CustomerCode").val() != "") {
                WhereClause += " and CAST(CUSTOMER_CODE AS BIGINT) IN (" + $("#CustomerCode").val().split(':')[0] + ")";
            } else if ($("#TerriotryArea").val() != null) {
                WhereClause += " and CAST(CUSTOMER_CODE AS BIGINT) IN (select DISTINCT ecc.CUSTOMER_CODE from cms_employee_customer_configuration ecc inner join CUSTOMER_SALES_VIEW csv on CAST(ecc.CUSTOMER_CODE AS BIGINT)=CAST(csv.cust_code AS BIGINT) where ecc.ORG_LEVEL_ID IN(" + Actual_SelectedTerritory + "))";
            } else if ($("#State").val() != null) {
                WhereClause += " and STATE IN(" + Actual_SelectedState + ")";
            }
            else if ($("#Zone").val() != null) {
                WhereClause += " and ZONE IN(" + $("#Zone").val() + ")";
            }
            if (($("#Zone").val() == null) && ($("#State").val() == null) && ($("#TerriotryArea").val() == null) && ($("#CustomerCode").val() == "")) {
                WhereClause += "";
            }

            var sheet = $("#Sheets").val();

            //Edited By Manikanta

            if (sheet != "select") {
                WhereClause += " and CAST(CUSTOMER_CODE AS BIGINT) IN (select STOCKIST_ID from sap_customer_sales_master where DIVISION='" + sheet + "')";
            }




            var Data = JSON.stringify({
                MasterType: "CreditOutstandingDetails",
                ID: "561",
                UserCode: $("#UserCode").val(),
                "Type": "Get",
                ReportName: "CreditOutstandingDetails",
                WhereClause: WhereClause,
                aging_date: DateRange[2] + '/' + DateRange[1] + '/' + DateRange[0]
            });


            // ShowLoader();
            DIMSFactory.getReportListColumnNamesData(Data).success(function (response) {
                var Result = JSON.parse(response.tabledata);

                if (Result != "") {
                    $scope.UserDefaultListColumnNames = Result["UserDefaultListColumnNames"];
                    if (Result.hasOwnProperty('UserListColumnNames')) {
                        var data1 = JSON.parse(Result["UserListColumnNames"]);

                        var selectedcolumnname = data1["ColumnNames"];

                        CustomColumnID = Result["UserListID"];
                        $('#undo_redo_to').empty();
                        var ColArray = new Array();
                        for (var i = 0; i < selectedcolumnname.length; i++) {


                            ColArray.push({
                                "data": selectedcolumnname[i],
                                "name": selectedcolumnname[i], "bSortable": true
                            });
                            $("#undo_redo_to").append($("<option></option>").val(selectedcolumnname[i]).html(selectedcolumnname[i]));
                        }
                        //$scope.UserSelectedColumnName = ColArray;
                        UserSelectedColumnName = ColArray;
                    } else {

                        var data1 = JSON.parse(Result["UserDefaultListColumnNames"]);

                        var selectedcolumnname = data1["ColumnNames"];

                        CustomColumnID = "0";

                        $('#undo_redo_to').empty();
                        var ColArray = new Array();
                        for (var i = 0; i < selectedcolumnname.length; i++) {
                            ColArray.push({
                                "data": selectedcolumnname[i],
                                "name": selectedcolumnname[i],
                                "bSortable": "true"
                            });
                            $("#undo_redo_to").append($("<option></option>").val(selectedcolumnname[i]).html(selectedcolumnname[i]));
                        }
                        //$scope.UserSelectedColumnName = ColArray;
                        UserSelectedColumnName = ColArray;
                    }



                }
                //HideLoader();
                //ShowLoader();
                DIMSFactory.getReportData(Data).success(function (response) {


                    getLookUpData_Reports_ServerSideBinding("", "EnrollmentNodataLabel", "", "tbl_Outstanding_Details", UserSelectedColumnName);
                    $("#OutstandingDiv").show();
                });
                //HideLoader();


                WhereClause = " where aging_date='" + DateRange[2] + '/' + DateRange[1] + '/' + DateRange[0] + "'";
                WhereClause = "";
                if ($("#CustomerCode").val() != "") {
                    WhereClause += " and CAST(CUSTOMER_CODE AS BIGINT) IN (" + $("#CustomerCode").val().split(':')[0] + ")";
                } else if ($("#TerriotryArea").val() != null) {
                    WhereClause += " and CAST(CUSTOMER_CODE AS BIGINT) IN (select DISTINCT ecc.CUSTOMER_CODE from cms_employee_customer_configuration ecc inner join CUSTOMER_SALES_VIEW csv on CAST(ecc.CUSTOMER_CODE AS BIGINT)=CAST(csv.cust_code AS BIGINT) where ecc.ORG_LEVEL_ID IN(" + Actual_SelectedTerritory + "))";
                } else if ($("#State").val() != null) {
                    WhereClause += " and STATE IN(" + Actual_SelectedState + ")";
                }
                else if ($("#Zone").val() != null) {
                    WhereClause += " and ZONE IN(" + $("#Zone").val() + ")";
                }
                if (($("#Zone").val() == null) && ($("#State").val() == null) && ($("#TerriotryArea").val() == null) && ($("#CustomerCode").val() == "")) {
                    WhereClause += "";
                }

                var sheet = $("#Sheets").val();

                //Edited By Manikanta

                if (sheet != "select") {
                    WhereClause += " and CAST(CUSTOMER_CODE AS BIGINT) IN (select STOCKIST_ID from sap_customer_sales_master where DIVISION='" + sheet + "')";
                }



                var data1 = JSON.stringify({
                    MasterType: "CreditOutstandingDetails",
                    ID: "561",
                    UserCode: $("#UserCode").val(),
                    "Type": "Get",
                    ReportName: "CreditOutstandingDetails",
                    WhereClause: WhereClause,
                    aging_date: DateRange[2] + '/' + DateRange[1] + '/' + DateRange[0]
                });

                DIMSSAPFactory.GetTotalSumOutstanding(data1).success(function (res) {
                    var days_0015 = ""; var days_1630 = ""; var days_3145 = ""; var days_4660 = ""; var days_6175 = ""; var days_7690 = "";
                    var days_91120 = ""; var days_121150 = ""; var days_151179 = ""; var days_180 = ""; var days_ab180 = ""; var TotalAmount = "";
                    if (res != "False") {
                        var ResultOs = JSON.parse(res);
                        if (ResultOs.length == 0) { }
                        else {
                            if (parseFloat(ResultOs[0]["days_0015"]).toFixed(2) != "NaN") { days_0015 = parseFloat(ResultOs[0]["days_0015"]).toFixed(2); }
                            if (parseFloat(ResultOs[0]["days_1630"]).toFixed(2) != "NaN") { days_1630 = parseFloat(ResultOs[0]["days_1630"]).toFixed(2); }
                            if (parseFloat(ResultOs[0]["days_3145"]).toFixed(2) != "NaN") { days_3145 = parseFloat(ResultOs[0]["days_3145"]).toFixed(2); }
                            if (parseFloat(ResultOs[0]["days_4660"]).toFixed(2) != "NaN") { days_4660 = parseFloat(ResultOs[0]["days_4660"]).toFixed(2); }
                            if (parseFloat(ResultOs[0]["days_6175"]).toFixed(2) != "NaN") { days_6175 = parseFloat(ResultOs[0]["days_6175"]).toFixed(2); }
                            if (parseFloat(ResultOs[0]["days_7690"]).toFixed(2) != "NaN") { days_7690 = parseFloat(ResultOs[0]["days_7690"]).toFixed(2); }
                            if (parseFloat(ResultOs[0]["days_91120"]).toFixed(2) != "NaN") { days_91120 = parseFloat(ResultOs[0]["days_91120"]).toFixed(2); }
                            if (parseFloat(ResultOs[0]["days_121150"]).toFixed(2) != "NaN") { days_121150 = parseFloat(ResultOs[0]["days_121150"]).toFixed(2); }
                            if (parseFloat(ResultOs[0]["days_151179"]).toFixed(2) != "NaN") { days_151179 = parseFloat(ResultOs[0]["days_151179"]).toFixed(2); }
                            if (parseFloat(ResultOs[0]["days_180"]).toFixed(2) != "NaN") { days_180 = parseFloat(ResultOs[0]["days_180"]).toFixed(2); }
                            if (parseFloat(ResultOs[0]["days_AB180"]).toFixed(2) != "NaN") { days_ab180 = parseFloat(ResultOs[0]["days_AB180"]).toFixed(2); }
                            if (parseFloat(ResultOs[0]["TOTAL_OUTSTANDING"]).toFixed(2) != "NaN") { TotalAmount = parseFloat(ResultOs[0]["TOTAL_OUTSTANDING"]).toFixed(2); }
                        }
                        $('#txt015').val(days_0015);
                        $('#txt1630').val(days_1630);
                        $('#txt3145').val(days_3145);
                        $('#txt4660').val(days_4660);
                        $('#txt6175').val(days_6175);
                        $('#txt7690').val(days_7690);
                        $('#txt91120').val(days_91120);
                        $('#txt121150').val(days_121150);
                        $('#txt151179').val(days_151179);
                        $('#txt180').val(days_180);
                        $('#txt180ab').val(days_ab180);
                        $('#txtTotal').val(TotalAmount);
                        //$('#loader').css('display');
                        console.log("Please wait");
                    } else {
                        $('#txt015').val("");
                        $('#txt1630').val("");
                        $('#txt3145').val("");
                        $('#txt4660').val("");
                        $('#txt6175').val("");
                        $('#txt7690').val("");
                        $('#txt91120').val("");
                        $('#txt121150').val("");
                        $('#txt151179').val("");
                        $('#txt180').val("");
                        $('#txt180ab').val("");
                        $('#txtTotal').val("");
                    }
                });

            });
        } catch (Exception) { }
    }



    // Open popup for columns selection
    $scope.OpenColumnEditing = function () {

        $('#undo_redo').empty();
        var ColumnNames = JSON.parse($scope.UserDefaultListColumnNames);

        for (var i = 0; i < ColumnNames["ColumnNames"].length; i++) {
            $("#undo_redo").append($("<option></option>").val(ColumnNames["ColumnNames"][i]).html(ColumnNames["ColumnNames"][i]));
        }



        //   $('#undo_redo').refresh();

        $('#undo_redo').multiselect();
        if (ControllerName != "OutstandingDetailCtrl") {
            ControllerName = "OutstandingDetailCtrl";
            var elem = angular.element('#ColumnEditingModal');
            elem.removeAttr('ng-controller');
            elem.attr('ng-controller', "OutstandingDetailCtrl");

            $compile(elem.contents())(AccountStatementScope);
        }

        $("#ColumnEditingModal").modal('show');




    }
    // View Column selected it is like preview.We will send reportname,usercode and where condition to function
    $scope.ViewColumnEditing = function () {
        DIMSFactory.ViewColumnEditing("OutstandingDetails", $("#UserCode").val(), " where sod.DATE=" + OutstandingDate[0] + '/' + OutstandingDate[1] + '/' + OutstandingDate[2] + " AND cast(sod.CUSTOMER_CODE as int)=cast(scm.STOCKIST_ID as int) and cast(sod.CUSTOMER_CODE as int)=cast(CustSales.STOCKIST_ID as int) and CustSales.SALES_ORGANISATION='1000' group by CAST(sod.CUSTOMER_CODE AS INT),scm.STOCKIST_NAME,sod.FIRST_DURATION,sod.SECOND_DURATION,sod.THIRD_DURATION,sod.FOURTH_DURATION,sod.FIFTH_DURATION,sod.SIXTH_DURATION,sod.SEVENTH_DURATION,cast(scm.STOCKIST_ID as int),scm.STATE,sod.DATE"); // 1-Report Name ,2-UserCode(561),3-WhereClause

    }
    // Save Column selected it is like preview.We will send reportname,usercode and where condition to function
    $scope.SaveColumnEditingData = function () {
        var WhereClause = " where sod.DATE=" + OutstandingDate[0] + '/' + OutstandingDate[1] + '/' + OutstandingDate[2] + " AND cast(sod.CUSTOMER_CODE as int)=cast(scm.STOCKIST_ID as int) and cast(sod.CUSTOMER_CODE as int)=cast(CustSales.STOCKIST_ID as int) and CustSales.SALES_ORGANISATION='1000' group by CAST(sod.CUSTOMER_CODE AS INT),scm.STOCKIST_NAME,sod.FIRST_DURATION,sod.SECOND_DURATION,sod.THIRD_DURATION,sod.FOURTH_DURATION,sod.FIFTH_DURATION,sod.SIXTH_DURATION,sod.SEVENTH_DURATION,cast(scm.STOCKIST_ID as int),scm.STATE,sod.DATE";
        var Data = JSON.stringify({
            MasterType: "CreditOutstandingDetails",
            ID: "561",
            UserCode: $("#UserCode").val(),
            "Type": "Get",
            ReportName: "CreditOutstandingDetails",
            WhereClause: WhereClause
        });
        //DIMSFactory.SaveColumnEditingData("Compensation", $scope.UserCode, " ORDER BY ID DESC");
        DIMSFactory.SaveColumnEditingData_InputParameter("OutstandingDetails", $("#UserCode").val(), WhereClause, Data, "tbl_Outstanding_Details");
        // 1-Report Name ,2-UserCode(561),3-WhereClause,4-JsonData,5-Frontend datatable id


    }

    $scope.DownloadFile = function (filetype) {
        var isValidCustCode = isValidCode_Cust($("#CustomerCode").val(), CustomerArray);
        var SearchValue = $('input[type=search]').val();
        var FileName = "DealerCreditBalance";
        var DateRange = $("#OrderFromDate").val().split('/');
        var UserCode = $("#UserCode").val();

        //var WhereClause = " where sod.aging_date='" + DateRange[2] + '/' + DateRange[1] + '/' + DateRange[0] + "' AND cast(sod.CUSTOMER_CODE as int)=cast(scm.STOCKIST_ID as int) and cast(sod.CUSTOMER_CODE as int)=cast(CustSales.STOCKIST_ID as int) and CustSales.SALES_ORGANISATION='1000'";
        //if ($("#CustomerCode").val() != "") {
        //    if ((isValidCustCode == false) && ($("#CustomerCode").val() != "")) {

        //    } else {
        //        WhereClause += " and CAST(sod.CUSTOMER_CODE AS BIGINT) IN (" + $("#CustomerCode").val().split(':')[0] + ")";
        //    }

        //} else if ($("#TerriotryArea").val() != null) {
        //    WhereClause += " and CAST(sod.CUSTOMER_CODE AS BIGINT) IN (select DISTINCT ecc.CUSTOMER_CODE from cms_employee_customer_configuration ecc inner join CUSTOMER_SALES_VIEW csv on CAST(ecc.CUSTOMER_CODE AS BIGINT)=CAST(csv.cust_code AS BIGINT) where ecc.ORG_LEVEL_ID IN(" + Actual_SelectedTerritory + "))";
        //} else if ($("#State").val() != null) {
        //    WhereClause += " and scm.STATE IN(" + Actual_SelectedState + ")";
        //}
        //else if ($("#Zone").val() != null) {
        //    WhereClause += " and CustSales.ZONE IN(" + $("#Zone").val() + ")";
        //}
        //if (($("#Zone").val() == null) && ($("#State").val() == null) && ($("#TerriotryArea").val() == null) && ($("#CustomerCode").val() == "")) {
        //    WhereClause += "";
        //}


        var WhereClause = " where aging_date='" + DateRange[2] + '/' + DateRange[1] + '/' + DateRange[0] + "'";

        if ($("#CustomerCode").val() != "") {
            WhereClause += " and CAST(CUSTOMER_CODE AS BIGINT) IN (" + $("#CustomerCode").val().split(':')[0] + ")";
        } else if ($("#TerriotryArea").val() != null) {
            WhereClause += " and CAST(CUSTOMER_CODE AS BIGINT) IN (select DISTINCT ecc.CUSTOMER_CODE from cms_employee_customer_configuration ecc inner join CUSTOMER_SALES_VIEW csv on CAST(ecc.CUSTOMER_CODE AS BIGINT)=CAST(csv.cust_code AS BIGINT) where ecc.ORG_LEVEL_ID IN(" + Actual_SelectedTerritory + "))";
        } else if ($("#State").val() != null) {
            WhereClause += " and STATE IN(" + Actual_SelectedState + ")";
        }
        else if ($("#Zone").val() != null) {
            WhereClause += " and ZONE IN(" + $("#Zone").val() + ")";
        }
        if (($("#Zone").val() == null) && ($("#State").val() == null) && ($("#TerriotryArea").val() == null) && ($("#CustomerCode").val() == "")) {
            WhereClause += "";
        }


        var sheet = $("#Sheets").val();

        //Edited By Manikanta

        if (sheet != "select") {
            WhereClause += " and CAST(CUSTOMER_CODE AS BIGINT) IN (select STOCKIST_ID from sap_customer_sales_master where DIVISION='" + sheet + "')";
        }



        var Table_DebitCount = $('#tbl_Outstanding_Details').DataTable().data().count();
        if (Table_DebitCount == 0) {
            alert("There is no data");
        } else {
            if ((isValidCustCode == false) && ($("#CustomerCode").val() != "")) { alert("please select proper customer code"); } else {
                var data_value = "{\"Role\":\"" + SessionValue + "\",\"Form_Code\":\"" + "OD" + "\",\"Action\":\"" + "Is_Export" + "\"}";
                $http({ url: '../../Home/Form_Access', method: 'POST', data: { Data: data_value } }).success(function (res) {
                    if (res == "True") {
                        CommonFunctionForExcelExport_SearchFilter("561", UserCode, SearchValue, FileName, FileName, WhereClause, filetype);
                    }
                    else {
                        alert("You are not allowed to export Outstanding Details");
                    }
                });
            }

        }
    }

});

//Payment By Stockist
DIMS.controller('PaymentByStockistCtrl', function ($scope, $location, DIMSFactory, $http, $compile, DIMSSAPFactory) {
    $scope.templatesettings = { HeaderTitle: "Debit Notes" };
    MasterScope = $scope;


    $("#StockistPaymentDiv").hide();
    $scope.go = function (path) {
        CheckUserSession();
        $location.path(path);
    };

    var width = $(window).width(), height = $(window).height();//---------

    var totalheight = height - 191;
    // var totalheight = height - 148;//--------    
    if (height <= 800) {
        totalheight = height - 148;
    }

    $('.content').css({ "max-height": totalheight, "overflow-y": "auto" });//-----------
    $('.content-header > h2').css({ "font-size": "18px", "font-weight": "500" });//----------
    $('.content').css({ "max-height": totalheight, "min-height": totalheight, "overflow-y": "auto" });//-----------

    var data_value = ""; var all_zones = ""; var all_states = ""; var all_territories = ""; var all_customers = ""; var CustomerArray = new Array();
    ShowLoader();
    if ((SessionValue == "ZH") || (SessionValue == "RCC") || (SessionValue == "ZSC")) {
        $("#Zone").attr("disabled", false); $("#State").attr("disabled", false); $("#TerriotryArea").attr("disabled", false); $("#CustomerCode").attr("disabled", false);
        //data_value = "{\"Role\":\"" + "ZH" + "\",\"UserCode\":\"" + "50001762" + "\"}";
        data_value = "{\"Role\":\"" + "ZH" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
            var FilterList = JSON.parse(res);
            all_zones = "";
            for (var i = 0; i < FilterList.dtZone.length; i++) {
                $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
                if (FilterList.dtZone.length == 0) {
                    all_zones = "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                } else if (i == FilterList.dtZone.length - 1) {
                    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                } else {
                    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'" + ',';
                }
            }

            $('select#Zone')[0].sumo.selectItem(0);
            $('#Zone').trigger("change");
            //all_states = "";
            //for (var i = 0; i < FilterList.dtState.length; i++) {
            //    if (FilterList.dtState.length == 0) {
            //        all_states = "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
            //    } else if (i == FilterList.dtState.length - 1) {
            //        all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
            //    } else {
            //        all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'" + ',';
            //    }
            //}
            //all_territories = "";
            //for (var i = 0; i < FilterList.dtTerritory.length; i++) {
            //    if (FilterList.dtTerritory.length == 0) {
            //        all_territories = "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
            //    } else if (i == FilterList.dtTerritory.length - 1) {
            //        all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
            //    } else {
            //        all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'" + ',';
            //    }
            //}
            //all_customers = "";
            //for (var i = 0; i < FilterList.dtCustomer.length; i++) {
            //$('#StockistID')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //$('#StockistName')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //if (FilterList.dtCustomer.length == 0) {
            //    all_customers = "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else if (i == FilterList.dtCustomer.length - 1) {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'" + ',';
            //}
            //}
        });
    } else if (SessionValue == "SH") {
        $("#Zone").attr("disabled", true); $("#State").attr("disabled", false); $("#TerriotryArea").attr("disabled", false); $("#CustomerCode").attr("disabled", false);
        //data_value = "{\"Role\":\"" + "SH" + "\",\"UserCode\":\"" + "50002430" + "\"}";
        data_value = "{\"Role\":\"" + "SH" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
            var FilterList = JSON.parse(res);
            //all_zones = "";
            for (var i = 0; i < FilterList.dtZone.length; i++) {
                $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
                //if (FilterList.dtZone.length == 0) {
                //    all_zones = "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else if (i == FilterList.dtZone.length - 1) {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'" + ',';
                //}
            }
            $('select#Zone')[0].sumo.selectItem(0);
            //all_states = "";
            for (var i = 0; i < FilterList.dtState.length; i++) {
                $('#State')[0].sumo.add(FilterList.dtState[i]["STATE_CODE"], FilterList.dtState[i]["STATE_NAME"]);
                //if (FilterList.dtState.length == 0) {
                //    all_states = "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else if (i == FilterList.dtState.length - 1) {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'" + ',';
                //}
            }
            $('select#State')[0].sumo.selectItem(0);
            $('#State').trigger("change");
            //all_territories = "";
            //for (var i = 0; i < FilterList.dtTerritory.length; i++) {
            //    if (FilterList.dtTerritory.length == 0) {
            //        all_territories = "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
            //    } else if (i == FilterList.dtTerritory.length - 1) {
            //        all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
            //    } else {
            //        all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'" + ',';
            //    }
            //}
            //all_customers = "";
            //for (var i = 0; i < FilterList.dtCustomer.length; i++) {
            // $('#StockistID')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //$('#StockistName')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //if (FilterList.dtCustomer.length == 0) {
            //    all_customers = "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else if (i == FilterList.dtCustomer.length - 1) {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'" + ',';
            //}
            // }
        });
    }

    else if (SessionValue == "TM") {
        $("#Zone").attr("disabled", true); $("#State").attr("disabled", true); $("#TerriotryArea").attr("disabled", false); $("#CustomerCode").attr("disabled", false);
        //data_value = "{\"Role\":\"" + "TM" + "\",\"UserCode\":\"" + "50001144" + "\"}";
        data_value = "{\"Role\":\"" + "TM" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
            var FilterList = JSON.parse(res);
            //all_zones = "";
            for (var i = 0; i < FilterList.dtZone.length; i++) {
                $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
                //if (FilterList.dtZone.length == 0) {
                //    all_zones = "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else if (i == FilterList.dtZone.length - 1) {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'" + ',';
                //}
            }
            $('select#Zone')[0].sumo.selectItem(0);
            //all_states = "";
            for (var i = 0; i < FilterList.dtState.length; i++) {
                $('#State')[0].sumo.add(FilterList.dtState[i]["STATE_CODE"], FilterList.dtState[i]["STATE_NAME"]);
                //if (FilterList.dtState.length == 0) {
                //    all_states = "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else if (i == FilterList.dtState.length - 1) {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'" + ',';
                //}
            }
            $('select#State')[0].sumo.selectItem(0);
            //all_territories = "";
            for (var i = 0; i < FilterList.dtTerritory.length; i++) {
                $('#TerriotryArea')[0].sumo.add(FilterList.dtTerritory[i]["TERRITORY_CODE"], FilterList.dtTerritory[i]["TERRITORY_NAME"]);
                //if (FilterList.dtTerritory.length == 0) {
                //    all_territories = "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                //} else if (i == FilterList.dtTerritory.length - 1) {
                //    all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                //} else {
                //    all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'" + ',';
                //}
            }
            //all_customers = "";
            // for (var i = 0; i < FilterList.dtCustomer.length; i++) {
            // $('#StockistID')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //$('#StockistName')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //if (FilterList.dtCustomer.length == 0) {
            //    all_customers = "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else if (i == FilterList.dtCustomer.length - 1) {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'" + ',';
            //}
            //}
        });
    }

    else if (SessionValue == "FSO" || (SessionValue == "FSO_BU2")) {
        $("#Zone").attr("disabled", true); $("#State").attr("disabled", true); $("#TerriotryArea").attr("disabled", false); $("#CustomerCode").attr("disabled", false);
        //data_value = "{\"Role\":\"" + "FSO" + "\",\"UserCode\":\"" + "50001906" + "\"}";
        if (SessionValue == "FSO_BU2") {
            data_value = "{\"Role\":\"" + "FSO" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        } else {
            data_value = "{\"Role\":\"" + "FSO_BU2" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        }
        $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
            var FilterList = JSON.parse(res);
            //all_zones = "";
            for (var i = 0; i < FilterList.dtZone.length; i++) {
                $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
                //if (FilterList.dtZone.length == 0) {
                //    all_zones = "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else if (i == FilterList.dtZone.length - 1) {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'" + ',';
                //}
            }
            $('select#Zone')[0].sumo.selectItem(0);
            //all_states = "";
            for (var i = 0; i < FilterList.dtState.length; i++) {
                $('#State')[0].sumo.add(FilterList.dtState[i]["STATE_CODE"], FilterList.dtState[i]["STATE_NAME"]);
                //if (FilterList.dtState.length == 0) {
                //    all_states = "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else if (i == FilterList.dtState.length - 1) {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'" + ',';
                //}
            }
            $('select#State')[0].sumo.selectItem(0);
            //all_territories = "";
            for (var i = 0; i < FilterList.dtTerritory.length; i++) {
                $('#TerriotryArea')[0].sumo.add(FilterList.dtTerritory[i]["TERRITORY_CODE"], FilterList.dtTerritory[i]["TERRITORY_NAME"]);
                //if (FilterList.dtTerritory.length == 0) {
                //    all_territories = "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                //} else if (i == FilterList.dtTerritory.length - 1) {
                //    all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                //} else {
                //    all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'" + ',';
                //}
            }
            $('select#TerriotryArea')[0].sumo.selectItem(0);
            $('#TerriotryArea').trigger("change");
            //all_customers = "";
            //for (var i = 0; i < FilterList.dtCustomer.length; i++) {
            // $('#StockistID')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //$('#StockistName')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //if (FilterList.dtCustomer.length == 0) {
            //    all_customers = "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else if (i == FilterList.dtCustomer.length - 1) {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'" + ',';
            //}
            // }
        });
    }

    else if ((SessionValue == "STOCKIST") || (SessionValue == "C&F")) {
        $("#Zone").attr("disabled", true); $("#State").attr("disabled", true); $("#TerriotryArea").attr("disabled", true); $("#CustomerCode").attr("disabled", true);
        //data_value = "{\"Role\":\"" + "STOCKIST" + "\",\"UserCode\":\"" + "1100002" + "\"}";
        data_value = "{\"Role\":\"" + "STOCKIST" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
            var FilterList = JSON.parse(res);
            //all_zones = "";
            for (var i = 0; i < FilterList.dtZone.length; i++) {
                $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
                //if (FilterList.dtZone.length == 0) {
                //    all_zones = "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else if (i == FilterList.dtZone.length - 1) {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'" + ',';
                //}
            }
            $('select#Zone')[0].sumo.selectItem(0);
            //all_states = "";
            for (var i = 0; i < FilterList.dtState.length; i++) {
                $('#State')[0].sumo.add(FilterList.dtState[i]["STATE_CODE"], FilterList.dtState[i]["STATE_NAME"]);
                //if (FilterList.dtState.length == 0) {
                //    all_states = "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else if (i == FilterList.dtState.length - 1) {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'" + ',';
                //}
            }
            $('select#State')[0].sumo.selectItem(0);
            //all_territories = "";
            for (var i = 0; i < FilterList.dtTerritory.length; i++) {
                $('#TerriotryArea')[0].sumo.add(FilterList.dtTerritory[i]["TERRITORY_CODE"], FilterList.dtTerritory[i]["TERRITORY_NAME"]);
                //if (FilterList.dtTerritory.length == 0) {
                //    all_territories = "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                //} else if (i == FilterList.dtTerritory.length - 1) {
                //    all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                //} else {
                //    all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'" + ',';
                //}
            }
            $('select#TerriotryArea')[0].sumo.selectItem(0);
            //all_customers = "";
            for (var i = 0; i < FilterList.dtCustomer.length; i++) {
                //$('#StockistID')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
                CustomerArray.push(FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
                $('#CustomerCode').val(FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
                //$('#StockistID').val(FilterList.dtCustomer[i]["CUSTOMER_CODE"] + " : " + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
                //$('#StockistName')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
                //if (FilterList.dtCustomer.length == 0) {
                //    all_customers = "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
                //} else if (i == FilterList.dtCustomer.length - 1) {
                //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
                //} else {
                //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'" + ',';
                //}
            }
            //$("#StockistID").typeahead({
            //    source: CustomerArray
            //});
            $('select#StockistID')[0].sumo.selectItem(0);
        });
    } else {
        $("#Zone").attr("disabled", false); $("#State").attr("disabled", false); $("#TerriotryArea").attr("disabled", false); $("#CustomerCode").attr("disabled", false);
        //data_value = "{\"Role\":\"" + "ADMIN" + "\",\"UserCode\":\"" + "50001657" + "\"}";
        data_value = "{\"Role\":\"" + SessionValue + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
            var FilterList = JSON.parse(res);
            all_zones = "";
            for (var i = 0; i < FilterList.dtZone.length; i++) {
                $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
                if (FilterList.dtZone.length == 0) {
                    all_zones = "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                } else if (i == FilterList.dtZone.length - 1) {
                    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                } else {
                    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'" + ',';
                }
            }
            CustomerArray.length = 0;
            $("#CustomerCode").val("");
            if (FilterList.dtCustomer.length > 0) {
                for (var i = 0; i < FilterList.dtCustomer.length; i++) {
                    CustomerArray.push(FilterList.dtCustomer[i]["STOCKIST_ID"].toString() + ":" + FilterList.dtCustomer[i]["STOCKIST_NAME"].toString());
                }
            }
            //all_states = "";
            //for (var i = 0; i < FilterList.dtState.length; i++) {
            //    if (FilterList.dtState.length == 0) {
            //        all_states = "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
            //    } else if (i == FilterList.dtState.length - 1) {
            //        all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
            //    } else {
            //        all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'" + ',';
            //    }
            //}
            //all_territories = "";
            //for (var i = 0; i < FilterList.dtTerritory.length; i++) {
            //    if (FilterList.dtTerritory.length == 0) {
            //        all_territories = "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
            //    } else if (i == FilterList.dtTerritory.length - 1) {
            //        all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
            //    } else {
            //        all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'" + ',';
            //    }
            //}
            //all_customers = "";
            //for (var i = 0; i < FilterList.dtCustomer.length; i++) {
            //$('#StockistID')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //$('#StockistName')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //if (FilterList.dtCustomer.length == 0) {
            //    all_customers = "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else if (i == FilterList.dtCustomer.length - 1) {
            //   all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'" + ',';
            //}
            //}
        });
    }
    HideLoader();
    $('#Zone').on('keyup change', function () {
        ShowLoader();
        var Clear_State = $('#State option').length;
        for (var i = 0; i < Clear_State; i++) {
            $('#State')[0].sumo.remove(0);
        }

        //var Clear_Cust = $('#StockistID option').length;
        //for (var i = 0; i < Clear_Cust; i++) {
        //    $('#StockistID')[0].sumo.remove(0);
        //}

        CustomerArray.length = 0;
        $("#CustomerCode").val("");

        var Clear_Terrytory = $('#TerriotryArea option').length;
        for (var i = 0; i < Clear_Terrytory; i++) {
            $('#TerriotryArea')[0].sumo.remove(0);
        }

        var data_value = "{\"Zone_Code\":\"" + $("#Zone").val() + "\"}";
        $http({ url: '../../Home/GetStatesforZone', method: 'POST', data: { Data: data_value } }).success(function (res) {
            if (res != "") {
                var dtState = JSON.parse(res);
                for (var i = 0; i < dtState.length; i++) {
                    $('#State')[0].sumo.add(dtState[i]["STATE_CODE"], dtState[i]["STATE_NAME"]);
                }
                // HideLoader();
            } else {
                // HideLoader();
            }

            $http({ url: '../../Home/GetCustomersforZone', method: 'POST', data: { Data: data_value } }).success(function (Cust_res) {
                if (Cust_res != "") {
                    var dtCust = JSON.parse(Cust_res);
                    for (var i = 0; i < dtCust.length; i++) {
                        //  $('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"].toString(), dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                        CustomerArray.push(dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                    }
                }
            });
        });
        HideLoader();
    });

    var SelectedState = ""; var Actual_SelectedState = ""; var Actual_SelectedTerritory = "";
    $('#State').on('keyup change', function () {
        ShowLoader();
        Actual_SelectedState = "";
        var Clear_Territory = $('#TerriotryArea option').length;
        for (var i = 0; i < Clear_Territory; i++) {
            $('#TerriotryArea')[0].sumo.remove(0);
        }
        //var Clear_Cust = $('#StockistID option').length;
        //for (var i = 0; i < Clear_Cust; i++) {
        //    $('#StockistID')[0].sumo.remove(0);
        //}

        CustomerArray.length = 0;
        $("#CustomerCode").val("");

        if ($('#State').val() != null) {
            var seleState = $('#State').val();

            for (var k = 0; k < seleState.length; k++) {
                SelectedState += "'" + seleState[k] + "',";
                Actual_SelectedState += "'" + seleState[k] + "',";
            }
            SelectedState = SelectedState.substring(',', SelectedState.length - 1);//Selected States with ' '. 
            Actual_SelectedState = Actual_SelectedState.substring(',', Actual_SelectedState.length - 1);//Selected States with ' '. 
        }

        var data_value = "{\"State_Code\":\"" + SelectedState + "\"}";
        $http({ url: '../../Home/GetTerritoriesforState', method: 'POST', data: { Data: data_value } }).success(function (res) {
            if (res != "") {
                var dtTerritory = JSON.parse(res);
                for (var i = 0; i < dtTerritory.length; i++) {
                    $('#TerriotryArea')[0].sumo.add(dtTerritory[i]["TERRITORY_CODE"], dtTerritory[i]["TERRITORY_NAME"]);
                }
            }
            $http({ url: '../../Home/GetCustomersforState', method: 'POST', data: { Data: data_value } }).success(function (res) {
                if (res != "") {
                    var dtCust = JSON.parse(res);
                    for (var i = 0; i < dtCust.length; i++) {
                        //$('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"].toString(), dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                        //$('#StockistName')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"].toString(), dtCust[i]["CUSTOMER_NAME"].toString());
                        CustomerArray.push(dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                    }
                    HideLoader();
                } else { HideLoader(); }

            });
        });

        if ($("#State").val() == null) {
            var data_value = "{\"Zone_Code\":\"" + $("#Zone").val() + "\"}";
            if ((SessionValue != "SH") && (SessionValue != "TM") && (SessionValue != "FSO") && (SessionValue != "FSO_BU2") && (SessionValue != "STOCKIST") && (SessionValue != "C&F")) {
                $http({ url: '../../Home/GetCustomersforZone', method: 'POST', data: { Data: data_value } }).success(function (Cust_res) {
                    if (Cust_res != "") {
                        var dtCust = JSON.parse(Cust_res);
                        for (var i = 0; i < dtCust.length; i++) {
                            //  $('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"].toString(), dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                            CustomerArray.push(dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                        }
                        HideLoader();
                    } else {
                        HideLoader();
                    }
                });
            }
            HideLoader();
        }

        SelectedState = "";
    });

    var SelectedTerritory = "";
    $('#TerriotryArea').on('keyup change', function () {
        ShowLoader();
        Actual_SelectedTerritory = ""; Actual_SelectedState = "";
        if ((SessionValue == "TM") || (SessionValue == "FSO") || (SessionValue == "FSO_BU2")) {
            if ($("#TerriotryArea").val() == null) {
                //var Clear_Cust = $('#StockistID option').length;
                //for (var i = 0; i < Clear_Cust; i++) {
                //    $('#StockistID')[0].sumo.remove(0);
                //}

                CustomerArray.length = 0;
                $("#CustomerCode").val("");
                HideLoader();
            } else if ($("#TerriotryArea").val() != null) {
                var seleTerritory = $('#TerriotryArea').val();
                for (var k = 0; k < seleTerritory.length; k++) {
                    SelectedTerritory += "'" + seleTerritory[k] + "',";
                    Actual_SelectedTerritory += "'" + seleTerritory[k] + "',";
                }
                SelectedTerritory = SelectedTerritory.substring(',', SelectedTerritory.length - 1);//Selected Territories with ' '. 
                Actual_SelectedTerritory = Actual_SelectedTerritory.substring(',', Actual_SelectedTerritory.length - 1);//Selected Territories with ' '. 

                var data_value = "{\"Territory_Code\":\"" + SelectedTerritory + "\"}";
                $http({ url: '../../Home/GetCustomersforTerritory', method: 'POST', data: { Data: data_value } }).success(function (res) {
                    if (res != "") {
                        var dtCust = JSON.parse(res);
                        for (var i = 0; i < dtCust.length; i++) {
                            //$('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"], dtCust[i]["CUSTOMER_CODE"] + ":" + dtCust[i]["CUSTOMER_NAME"]);
                            CustomerArray.push(dtCust[i]["CUSTOMER_CODE"] + ":" + dtCust[i]["CUSTOMER_NAME"]);
                        }
                        HideLoader();
                    } else { HideLoader(); }

                });
            }
        } else {
            //var Clear_Cust = $('#StockistID option').length;
            //for (var i = 0; i < Clear_Cust; i++) {
            //    $('#StockistID')[0].sumo.remove(0);
            //}

            CustomerArray.length = 0;
            $("#CustomerCode").val("");


            if ($('#TerriotryArea').val() != null) {
                var seleTerritory = $('#TerriotryArea').val();
                for (var k = 0; k < seleTerritory.length; k++) {
                    SelectedTerritory += "'" + seleTerritory[k] + "',";
                    Actual_SelectedTerritory += "'" + seleTerritory[k] + "',";
                }
                SelectedTerritory = SelectedTerritory.substring(',', SelectedTerritory.length - 1);//Selected Territories with ' '. 
                Actual_SelectedTerritory = Actual_SelectedTerritory.substring(',', Actual_SelectedTerritory.length - 1);//Selected Territories with ' '. 
            }
            if ($("#TerriotryArea").val() == null) {
                var seleState = $('#State').val();

                for (var k = 0; k < seleState.length; k++) {
                    SelectedState += "'" + seleState[k] + "',";
                    Actual_SelectedState += "'" + seleState[k] + "',";
                }
                SelectedState = SelectedState.substring(',', SelectedState.length - 1);//Selected States with ' '. 
                Actual_SelectedState = Actual_SelectedState.substring(',', Actual_SelectedState.length - 1);//Selected States with ' '. 

                var data_value = "{\"State_Code\":\"" + SelectedState + "\"}";
                $http({ url: '../../Home/GetCustomersforState', method: 'POST', data: { Data: data_value } }).success(function (res) {
                    if (res != "") {
                        var dtCust = JSON.parse(res);
                        for (var i = 0; i < dtCust.length; i++) {
                            //$('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"].toString(), dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                            CustomerArray.push(dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                        }
                        HideLoader();
                    } else { HideLoader(); }

                });
            } else {
                var data_value = "{\"Territory_Code\":\"" + SelectedTerritory + "\"}";
                $http({ url: '../../Home/GetCustomersforTerritory', method: 'POST', data: { Data: data_value } }).success(function (res) {
                    if (res != "") {
                        var dtCust = JSON.parse(res);
                        for (var i = 0; i < dtCust.length; i++) {
                            //$('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"], dtCust[i]["CUSTOMER_CODE"] + ":" + dtCust[i]["CUSTOMER_NAME"]);
                            CustomerArray.push(dtCust[i]["CUSTOMER_CODE"] + ":" + dtCust[i]["CUSTOMER_NAME"]);
                        }
                        HideLoader();
                    } else { HideLoader(); }

                });
            }
        }
        SelectedTerritory = "";
        SelectedState = "";
    });

    $("#CustomerCode").typeahead({
        source: CustomerArray
    });


    $scope.GetData = function () {
        var isValidCustCode = isValidCode_Cust($("#CustomerCode").val(), CustomerArray);
        if (($("#OrderFromDate").val() != "") && ($("#OrderToDate").val() != "")) {
            if ((SessionValue == "ZH")) {
                if ($("#Zone").val() == null) { alert("Please Select Your Zone"); }
                else if ((isValidCustCode == false) && ($("#CustomerCode").val() != "")) {
                    alert("please select proper customer code");
                } else {
                    GetSockistPaymentData();
                }
            } else if (SessionValue == "SH") {
                if ($("#State").val() == null) { alert("Please Select Your State"); } else if ((isValidCustCode == false) && ($("#CustomerCode").val() != "")) {
                    alert("please select proper customer code");
                } else {
                    GetSockistPaymentData();
                }
            } else if (SessionValue == "TM") {
                if ($("#TerriotryArea").val() == null) { alert("Please Select Your Sales Group"); } else if ((isValidCustCode == false) && ($("#CustomerCode").val() != "")) {
                    alert("please select proper customer code");
                } else {
                    GetSockistPaymentData();
                }
            }
            else if (SessionValue == "FSO" || SessionValue == "FSO_BU2") {
                if ($("#TerriotryArea").val() == null) { alert("Please Select Your Sales Group"); } else if ((isValidCustCode == false) && ($("#CustomerCode").val() != "")) {
                    alert("please select proper customer code");
                } else {
                    GetSockistPaymentData();
                }
            } else {
                if ((isValidCustCode == false) && ($("#CustomerCode").val() != "")) {
                    alert("please select proper customer code");
                } else {
                    GetSockistPaymentData();
                }
            }
        } else { alert("Please Select From Date and To Date"); }
    }

    function GetSockistPaymentData() {
        ShowLoader();
        var DateRange = DateSplitter('OrderFromDate', 'OrderToDate');
        try {
            var WhereClause = " WHERE doc_type='DZ' AND (POSTING_DATE between " + DateRange + ")";
            if ($("#CustomerCode").val() != "") {
                WhereClause += " and CAST(Customer_code AS BIGINT) IN (" + $("#CustomerCode").val().split(':')[0] + ")";
            } else if ($("#TerriotryArea").val() != null) {
                WhereClause += " and CAST(Customer_code AS BIGINT) IN (select DISTINCT ecc.CUSTOMER_CODE from cms_employee_customer_configuration ecc inner join CUSTOMER_SALES_VIEW csv on CAST(ecc.CUSTOMER_CODE AS BIGINT)=CAST(csv.cust_code AS BIGINT) where ecc.ORG_LEVEL_ID IN(" + Actual_SelectedTerritory + "))";
            } else if ($("#State").val() != null) {
                WhereClause += " and STATE IN(" + Actual_SelectedState + ")";
            }
            else if ($("#Zone").val() != null) {
                WhereClause += " and ZONE IN(" + $("#Zone").val() + ")";
            }
            if (($("#Zone").val() == null) && ($("#State").val() == null) && ($("#TerriotryArea").val() == null) && ($("#CustomerCode").val() == "")) {
                WhereClause += "";
            }
            //WhereClause += " order by POSTING_DATE DESC";

            var sheet = $("#Sheets").val();

            //Edited By Manikanta

            if (sheet != "select") {
                WhereClause += " and CAST(Customer_code AS BIGINT) IN (select STOCKIST_ID from sap_customer_sales_master where DIVISION='" + sheet + "')";
            }

            var Data = JSON.stringify({
                MasterType: "PaymentByStockist",
                ID: "561",
                UserCode: $("#UserCode").val(),
                "Type": "Get",
                ReportName: "PaymentByStockist",
                WhereClause: WhereClause
            });

            DIMSFactory.getReportListColumnNamesData(Data).success(function (response) {
                var Result = JSON.parse(response.tabledata);

                if (Result != "") {
                    $scope.UserDefaultListColumnNames = Result["UserDefaultListColumnNames"];
                    if (Result.hasOwnProperty('UserListColumnNames')) {
                        var data1 = JSON.parse(Result["UserListColumnNames"]);

                        var selectedcolumnname = data1["ColumnNames"];

                        CustomColumnID = Result["UserListID"];
                        $('#undo_redo_to').empty();
                        var ColArray = new Array();
                        for (var i = 0; i < selectedcolumnname.length; i++) {


                            ColArray.push({
                                "data": selectedcolumnname[i],
                                "name": selectedcolumnname[i], "bSortable": true
                            });
                            $("#undo_redo_to").append($("<option></option>").val(selectedcolumnname[i]).html(selectedcolumnname[i]));
                        }
                        //$scope.UserSelectedColumnName = ColArray;
                        UserSelectedColumnName = ColArray;
                    } else {

                        var data1 = JSON.parse(Result["UserDefaultListColumnNames"]);

                        var selectedcolumnname = data1["ColumnNames"];

                        CustomColumnID = "0";

                        $('#undo_redo_to').empty();
                        var ColArray = new Array();
                        for (var i = 0; i < selectedcolumnname.length; i++) {
                            ColArray.push({
                                "data": selectedcolumnname[i],
                                "name": selectedcolumnname[i],
                                "bSortable": "true"
                            });
                            $("#undo_redo_to").append($("<option></option>").val(selectedcolumnname[i]).html(selectedcolumnname[i]));
                        }
                        //$scope.UserSelectedColumnName = ColArray;
                        UserSelectedColumnName = ColArray;
                    }



                }
                DIMSFactory.getReportData(Data).success(function (response) {

                    getLookUpData_Reports_ServerSideBinding("", "EnrollmentNodataLabel", "", "tbl_PaymentByStockist", UserSelectedColumnName);
                    $("#StockistPaymentDiv").show();


                });
                //var WhereClause1 = " WHERE doc_type='DZ' AND (POSTING_DATE between " + DateRange + ") ";
                //var DataStockist = JSON.stringify({
                //    MasterType: "PaymentByStockist",
                //    ID: "561",
                //    UserCode: $("#UserCode").val(),
                //    "Type": "Get",
                //    ReportName: "PaymentByStockist",
                //    WhereClause: WhereClause1
                //});



                DIMSSAPFactory.GetTotalAmtpaymentStockist(Data).success(function (res) {
                    $('#TotalPayStockistAmnt').val(parseFloat(res).toFixed(2));
                });
            });
        } catch (Exception) { }
    }

    // Open popup for columns selection
    $scope.OpenColumnEditing = function () {

        $('#undo_redo').empty();
        var ColumnNames = JSON.parse($scope.UserDefaultListColumnNames);

        for (var i = 0; i < ColumnNames["ColumnNames"].length; i++) {
            $("#undo_redo").append($("<option></option>").val(ColumnNames["ColumnNames"][i]).html(ColumnNames["ColumnNames"][i]));
        }



        //   $('#undo_redo').refresh();

        $('#undo_redo').multiselect();
        if (ControllerName != "PaymentByStockistCtrl") {
            ControllerName = "PaymentByStockistCtrl";
            var elem = angular.element('#ColumnEditingModal');
            elem.removeAttr('ng-controller');
            elem.attr('ng-controller', "PaymentByStockistCtrl");

            $compile(elem.contents())(PaymentByStockistScope);
        }

        $("#ColumnEditingModal").modal('show');




    }
    // View Column selected it is like preview.We will send reportname,usercode and where condition to function
    $scope.ViewColumnEditing = function () {
        DIMSFactory.ViewColumnEditing("PaymentByStockist", $("#UserCode").val(), " CD.CUSTOMER_CODE=CM.STOCKIST_ID AND CD.DOC_TYPE='DZ'"); // 1-Report Name ,2-UserCode(561),3-WhereClause

    }
    // Save Column selected it is like preview.We will send reportname,usercode and where condition to function
    $scope.SaveColumnEditingData = function () {
        var WhereClause = " WHERE CD.CUSTOMER_CODE=CM.STOCKIST_ID AND CD.DOC_TYPE='DZ'";
        var Data = JSON.stringify({
            MasterType: "PaymentByStockist",
            ID: "561",
            UserCode: $("#UserCode").val(),
            "Type": "Get",
            ReportName: "PaymentByStockist",
            WhereClause: WhereClause
        });
        //DIMSFactory.SaveColumnEditingData("Compensation", $scope.UserCode, " ORDER BY ID DESC");
        DIMSFactory.SaveColumnEditingData_InputParameter("PaymentByStockist", $("#UserCode").val(), WhereClause, Data, "tbl_PaymentByStockist");
        // 1-Report Name ,2-UserCode(561),3-WhereClause,4-JsonData,5-Frontend datatable id


    }

    $scope.DownloadFile = function (filetype) {
        var isValidCustCode = isValidCode_Cust($("#CustomerCode").val(), CustomerArray);
        var SearchValue = $('input[type=search]').val();
        var FileName = "PaymentByStockist";
        var DateRange = DateSplitter('OrderFromDate', 'OrderToDate');
        var UserCode = $("#UserCode").val();

        var WhereClause = " WHERE doc_type='DZ' AND (POSTING_DATE between " + DateRange + ")";
        if ($("#CustomerCode").val() != "") {
            if ((isValidCustCode == false) && ($("#CustomerCode").val() != "")) {

            } else {
                WhereClause += " and CAST(Customer_code AS BIGINT) IN (" + $("#CustomerCode").val().split(':')[0] + ")";
            }

        } else if ($("#TerriotryArea").val() != null) {
            WhereClause += " and CAST(Customer_code AS BIGINT) IN (select DISTINCT ecc.CUSTOMER_CODE from cms_employee_customer_configuration ecc inner join CUSTOMER_SALES_VIEW csv on CAST(ecc.CUSTOMER_CODE AS BIGINT)=CAST(csv.cust_code AS BIGINT) where ecc.ORG_LEVEL_ID IN(" + Actual_SelectedTerritory + "))";
        } else if ($("#State").val() != null) {
            WhereClause += " and STATE IN(" + Actual_SelectedState + ")";
        }
        else if ($("#Zone").val() != null) {
            WhereClause += " and ZONE IN(" + $("#Zone").val() + ")";
        }
        if (($("#Zone").val() == null) && ($("#State").val() == null) && ($("#TerriotryArea").val() == null) && ($("#CustomerCode").val() == "")) {
            WhereClause += "";
        }
        //WhereClause += " order by POSTING_DATE DESC";

        var sheet = $("#Sheets").val();

        //Edited By Manikanta

        if (sheet != "select") {
            WhereClause += " and CAST(Customer_code AS BIGINT) IN (select STOCKIST_ID from sap_customer_sales_master where DIVISION='" + sheet + "')";
        }

        var Table_DebitCount = $('#tbl_PaymentByStockist').DataTable().data().count();
        if (Table_DebitCount == 0) {
            alert("There is no data");
        } else {
            if ((isValidCustCode == false) && ($("#CustomerCode").val() != "")) { alert("please select proper customer code"); }
            else {
                var data_value = "{\"Role\":\"" + SessionValue + "\",\"Form_Code\":\"" + "PBS" + "\",\"Action\":\"" + "Is_Export" + "\"}";
                $http({ url: '../../Home/Form_Access', method: 'POST', data: { Data: data_value } }).success(function (res) {
                    if (res == "True") {
                        CommonFunctionForExcelExport_SearchFilter("561", UserCode, SearchValue, FileName, FileName, WhereClause, filetype);
                    }
                    else {
                        alert("You are not allowed to export Outstanding Details");
                    }
                });
            }

        }
    }
})

//Pending C Forms
DIMS.controller('PendingCFormsCtrl', function ($scope, $location, DIMSFactory, $http, $compile) {
    $scope.templatesettings = { HeaderTitle: "TDS Certficates List" };
    TDSCertificateScope = $scope;
    MasterScope = $scope;

    $scope.go = function (path) {
        CheckUserSession();
        $location.path(path);
    };

    var width = $(window).width(), height = $(window).height();//---------

    var totalheight = height - 191;
    // var totalheight = height - 148;//--------    
    if (height <= 800) {
        totalheight = height - 148;
    }

    $('.content').css({ "max-height": totalheight, "overflow-y": "auto" });//-----------
    $('.content-header > h2').css({ "font-size": "18px", "font-weight": "500" });//----------
    $('.content').css({ "max-height": totalheight, "min-height": totalheight, "overflow-y": "auto" });//-----------

    var data_value = ""; var all_zones = ""; var all_states = ""; var all_territories = ""; var all_customers = ""; var CustomerArray = new Array();
    ShowLoader();
    if ((SessionValue == "ZH") || (SessionValue == "RCC") || (SessionValue == "ZSC")) {
        $("#FileUploadForm").hide();
        $("#Zone").attr("disabled", false); $("#State").attr("disabled", false); $("#TerriotryArea").attr("disabled", false); $("#CustomerCode").attr("disabled", false);
        //data_value = "{\"Role\":\"" + "ZH" + "\",\"UserCode\":\"" + "50001762" + "\"}";
        data_value = "{\"Role\":\"" + "ZH" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
            var FilterList = JSON.parse(res);
            all_zones = "";
            for (var i = 0; i < FilterList.dtZone.length; i++) {
                $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
                if (FilterList.dtZone.length == 0) {
                    all_zones = "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                } else if (i == FilterList.dtZone.length - 1) {
                    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                } else {
                    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'" + ',';
                }
            }
            $('select#Zone')[0].sumo.selectItem(0);
            $('#Zone').trigger("change");
            //all_states = "";
            //for (var i = 0; i < FilterList.dtState.length; i++) {
            //    if (FilterList.dtState.length == 0) {
            //        all_states = "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
            //    } else if (i == FilterList.dtState.length - 1) {
            //        all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
            //    } else {
            //        all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'" + ',';
            //    }
            //}
            //all_territories = "";
            //for (var i = 0; i < FilterList.dtTerritory.length; i++) {
            //    if (FilterList.dtTerritory.length == 0) {
            //        all_territories = "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
            //    } else if (i == FilterList.dtTerritory.length - 1) {
            //        all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
            //    } else {
            //        all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'" + ',';
            //    }
            //}
            //all_customers = "";
            //for (var i = 0; i < FilterList.dtCustomer.length; i++) {
            //$('#StockistID')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //$('#StockistName')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //if (FilterList.dtCustomer.length == 0) {
            //    all_customers = "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else if (i == FilterList.dtCustomer.length - 1) {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'" + ',';
            //}
            //}
        });
    } else if (SessionValue == "SH") {
        $("#Zone").attr("disabled", true); $("#State").attr("disabled", false); $("#TerriotryArea").attr("disabled", false); $("#CustomerCode").attr("disabled", false);
        //data_value = "{\"Role\":\"" + "SH" + "\",\"UserCode\":\"" + "50002430" + "\"}";
        data_value = "{\"Role\":\"" + "SH" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
            var FilterList = JSON.parse(res);
            //all_zones = "";
            for (var i = 0; i < FilterList.dtZone.length; i++) {
                $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
                //if (FilterList.dtZone.length == 0) {
                //    all_zones = "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else if (i == FilterList.dtZone.length - 1) {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'" + ',';
                //}
            }
            $('select#Zone')[0].sumo.selectItem(0);
            //all_states = "";
            for (var i = 0; i < FilterList.dtState.length; i++) {
                $('#State')[0].sumo.add(FilterList.dtState[i]["STATE_CODE"], FilterList.dtState[i]["STATE_NAME"]);
                //if (FilterList.dtState.length == 0) {
                //    all_states = "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else if (i == FilterList.dtState.length - 1) {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'" + ',';
                //}
            }
            $('select#State')[0].sumo.selectItem(0);
            $('#State').trigger("change");
            //all_territories = "";
            //for (var i = 0; i < FilterList.dtTerritory.length; i++) {
            //    if (FilterList.dtTerritory.length == 0) {
            //        all_territories = "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
            //    } else if (i == FilterList.dtTerritory.length - 1) {
            //        all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
            //    } else {
            //        all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'" + ',';
            //    }
            //}
            //all_customers = "";
            //for (var i = 0; i < FilterList.dtCustomer.length; i++) {
            // $('#StockistID')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //$('#StockistName')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //if (FilterList.dtCustomer.length == 0) {
            //    all_customers = "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else if (i == FilterList.dtCustomer.length - 1) {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'" + ',';
            //}
            // }
        });
    }

    else if (SessionValue == "TM") {
        $("#FileUploadForm").hide();
        $("#Zone").attr("disabled", true); $("#State").attr("disabled", true); $("#TerriotryArea").attr("disabled", false); $("#CustomerCode").attr("disabled", false);
        //data_value = "{\"Role\":\"" + "TM" + "\",\"UserCode\":\"" + "50001144" + "\"}";
        data_value = "{\"Role\":\"" + "TM" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
            var FilterList = JSON.parse(res);
            //all_zones = "";
            for (var i = 0; i < FilterList.dtZone.length; i++) {
                $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
                //if (FilterList.dtZone.length == 0) {
                //    all_zones = "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else if (i == FilterList.dtZone.length - 1) {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'" + ',';
                //}
            }
            $('select#Zone')[0].sumo.selectItem(0);
            //all_states = "";
            for (var i = 0; i < FilterList.dtState.length; i++) {
                $('#State')[0].sumo.add(FilterList.dtState[i]["STATE_CODE"], FilterList.dtState[i]["STATE_NAME"]);
                //if (FilterList.dtState.length == 0) {
                //    all_states = "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else if (i == FilterList.dtState.length - 1) {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'" + ',';
                //}
            }
            $('select#State')[0].sumo.selectItem(0);
            //all_territories = "";
            for (var i = 0; i < FilterList.dtTerritory.length; i++) {
                $('#TerriotryArea')[0].sumo.add(FilterList.dtTerritory[i]["TERRITORY_CODE"], FilterList.dtTerritory[i]["TERRITORY_NAME"]);
                //if (FilterList.dtTerritory.length == 0) {
                //    all_territories = "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                //} else if (i == FilterList.dtTerritory.length - 1) {
                //    all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                //} else {
                //    all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'" + ',';
                //}
            }
            //all_customers = "";
            // for (var i = 0; i < FilterList.dtCustomer.length; i++) {
            // $('#StockistID')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //$('#StockistName')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //if (FilterList.dtCustomer.length == 0) {
            //    all_customers = "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else if (i == FilterList.dtCustomer.length - 1) {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'" + ',';
            //}
            //}
        });
    }

    else if (SessionValue == "FSO" || (SessionValue == "FSO_BU2")) {
        $("#FileUploadForm").hide();
        $("#Zone").attr("disabled", true); $("#State").attr("disabled", true); $("#TerriotryArea").attr("disabled", false); $("#CustomerCode").attr("disabled", false);
        //data_value = "{\"Role\":\"" + "FSO" + "\",\"UserCode\":\"" + "50001906" + "\"}";
        if (SessionValue == "FSO") {
            data_value = "{\"Role\":\"" + "FSO" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        } else {
            data_value = "{\"Role\":\"" + "FSO_BU2" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        }
        $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
            var FilterList = JSON.parse(res);
            //all_zones = "";
            for (var i = 0; i < FilterList.dtZone.length; i++) {
                $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
                //if (FilterList.dtZone.length == 0) {
                //    all_zones = "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else if (i == FilterList.dtZone.length - 1) {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'" + ',';
                //}
            }
            $('select#Zone')[0].sumo.selectItem(0);
            //all_states = "";
            for (var i = 0; i < FilterList.dtState.length; i++) {
                $('#State')[0].sumo.add(FilterList.dtState[i]["STATE_CODE"], FilterList.dtState[i]["STATE_NAME"]);
                //if (FilterList.dtState.length == 0) {
                //    all_states = "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else if (i == FilterList.dtState.length - 1) {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'" + ',';
                //}
            }
            $('select#State')[0].sumo.selectItem(0);
            //all_territories = "";
            for (var i = 0; i < FilterList.dtTerritory.length; i++) {
                $('#TerriotryArea')[0].sumo.add(FilterList.dtTerritory[i]["TERRITORY_CODE"], FilterList.dtTerritory[i]["TERRITORY_NAME"]);
                //if (FilterList.dtTerritory.length == 0) {
                //    all_territories = "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                //} else if (i == FilterList.dtTerritory.length - 1) {
                //    all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                //} else {
                //    all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'" + ',';
                //}
            }
            $('select#TerriotryArea')[0].sumo.selectItem(0);
            $('#TerriotryArea').trigger("change");
            //all_customers = "";
            //for (var i = 0; i < FilterList.dtCustomer.length; i++) {
            // $('#StockistID')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //$('#StockistName')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //if (FilterList.dtCustomer.length == 0) {
            //    all_customers = "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else if (i == FilterList.dtCustomer.length - 1) {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'" + ',';
            //}
            // }
        });
    }

    else if ((SessionValue == "STOCKIST") || (SessionValue == "C&F")) {
        $("#FileUploadForm").hide();
        $("#Zone").attr("disabled", true); $("#State").attr("disabled", true); $("#TerriotryArea").attr("disabled", true); $("#CustomerCode").attr("disabled", true);
        //data_value = "{\"Role\":\"" + "STOCKIST" + "\",\"UserCode\":\"" + "1100002" + "\"}";
        data_value = "{\"Role\":\"" + "STOCKIST" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
            var FilterList = JSON.parse(res);
            //all_zones = "";
            for (var i = 0; i < FilterList.dtZone.length; i++) {
                $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
                //if (FilterList.dtZone.length == 0) {
                //    all_zones = "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else if (i == FilterList.dtZone.length - 1) {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'" + ',';
                //}
            }
            $('select#Zone')[0].sumo.selectItem(0);
            //all_states = "";
            for (var i = 0; i < FilterList.dtState.length; i++) {
                $('#State')[0].sumo.add(FilterList.dtState[i]["STATE_CODE"], FilterList.dtState[i]["STATE_NAME"]);
                //if (FilterList.dtState.length == 0) {
                //    all_states = "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else if (i == FilterList.dtState.length - 1) {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'" + ',';
                //}
            }
            $('select#State')[0].sumo.selectItem(0);
            //all_territories = "";
            for (var i = 0; i < FilterList.dtTerritory.length; i++) {
                $('#TerriotryArea')[0].sumo.add(FilterList.dtTerritory[i]["TERRITORY_CODE"], FilterList.dtTerritory[i]["TERRITORY_NAME"]);
                //if (FilterList.dtTerritory.length == 0) {
                //    all_territories = "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                //} else if (i == FilterList.dtTerritory.length - 1) {
                //    all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                //} else {
                //    all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'" + ',';
                //}
            }
            $('select#TerriotryArea')[0].sumo.selectItem(0);
            //all_customers = "";
            for (var i = 0; i < FilterList.dtCustomer.length; i++) {
                //$('#StockistID')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
                CustomerArray.push(FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
                $('#CustomerCode').val(FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
                //$('#StockistID').val(FilterList.dtCustomer[i]["CUSTOMER_CODE"] + " : " + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
                //$('#StockistName')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
                //if (FilterList.dtCustomer.length == 0) {
                //    all_customers = "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
                //} else if (i == FilterList.dtCustomer.length - 1) {
                //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
                //} else {
                //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'" + ',';
                //}
            }
            //$("#StockistID").typeahead({
            //    source: CustomerArray
            //});
            //$('select#StockistID')[0].sumo.selectItem(0);
        });

    }
    else {

        $("#Zone").attr("disabled", false); $("#State").attr("disabled", false); $("#TerriotryArea").attr("disabled", false); $("#CustomerCode").attr("disabled", false);
        //data_value = "{\"Role\":\"" + "ADMIN" + "\",\"UserCode\":\"" + "50001657" + "\"}";
        data_value = "{\"Role\":\"" + SessionValue + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
            var FilterList = JSON.parse(res);
            all_zones = "";
            for (var i = 0; i < FilterList.dtZone.length; i++) {
                $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
                if (FilterList.dtZone.length == 0) {
                    all_zones = "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                } else if (i == FilterList.dtZone.length - 1) {
                    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                } else {
                    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'" + ',';
                }
            }
            CustomerArray.length = 0;
            $("#CustomerCode").val("");
            if (FilterList.dtCustomer.length > 0) {
                for (var i = 0; i < FilterList.dtCustomer.length; i++) {
                    CustomerArray.push(FilterList.dtCustomer[i]["STOCKIST_ID"].toString() + ":" + FilterList.dtCustomer[i]["STOCKIST_NAME"].toString());
                }
            }
            //all_states = "";
            //for (var i = 0; i < FilterList.dtState.length; i++) {
            //    if (FilterList.dtState.length == 0) {
            //        all_states = "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
            //    } else if (i == FilterList.dtState.length - 1) {
            //        all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
            //    } else {
            //        all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'" + ',';
            //    }
            //}
            //all_territories = "";
            //for (var i = 0; i < FilterList.dtTerritory.length; i++) {
            //    if (FilterList.dtTerritory.length == 0) {
            //        all_territories = "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
            //    } else if (i == FilterList.dtTerritory.length - 1) {
            //        all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
            //    } else {
            //        all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'" + ',';
            //    }
            //}
            //all_customers = "";
            //for (var i = 0; i < FilterList.dtCustomer.length; i++) {
            //$('#StockistID')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //$('#StockistName')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //if (FilterList.dtCustomer.length == 0) {
            //    all_customers = "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else if (i == FilterList.dtCustomer.length - 1) {
            //   all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'" + ',';
            //}
            //}
        });
    }
    HideLoader();
    $('#Zone').on('keyup change', function () {
        ShowLoader();
        var Clear_State = $('#State option').length;
        for (var i = 0; i < Clear_State; i++) {
            $('#State')[0].sumo.remove(0);
        }

        //var Clear_Cust = $('#StockistID option').length;
        //for (var i = 0; i < Clear_Cust; i++) {
        //    $('#StockistID')[0].sumo.remove(0);
        //}

        CustomerArray.length = 0;
        $("#CustomerCode").val("");

        var Clear_Terrytory = $('#TerriotryArea option').length;
        for (var i = 0; i < Clear_Terrytory; i++) {
            $('#TerriotryArea')[0].sumo.remove(0);
        }

        var data_value = "{\"Zone_Code\":\"" + $("#Zone").val() + "\"}";
        $http({ url: '../../Home/GetStatesforZone', method: 'POST', data: { Data: data_value } }).success(function (res) {
            if (res != "") {
                var dtState = JSON.parse(res);
                for (var i = 0; i < dtState.length; i++) {
                    $('#State')[0].sumo.add(dtState[i]["STATE_CODE"], dtState[i]["STATE_NAME"]);
                }
                //HideLoader();
            } else {
                //HideLoader();
            }
            $http({ url: '../../Home/GetCustomersforZone', method: 'POST', data: { Data: data_value } }).success(function (Cust_res) {
                if (Cust_res != "") {
                    var dtCust = JSON.parse(Cust_res);
                    for (var i = 0; i < dtCust.length; i++) {
                        //  $('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"].toString(), dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                        CustomerArray.push(dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                    }
                }
            });
        });
        HideLoader();
    });

    var SelectedState = ""; var Actual_SelectedState = ""; var Actual_SelectedTerritory = "";
    $('#State').on('keyup change', function () {
        ShowLoader();
        Actual_SelectedState = "";
        var Clear_Territory = $('#TerriotryArea option').length;
        for (var i = 0; i < Clear_Territory; i++) {
            $('#TerriotryArea')[0].sumo.remove(0);
        }
        //var Clear_Cust = $('#StockistID option').length;
        //for (var i = 0; i < Clear_Cust; i++) {
        //    $('#StockistID')[0].sumo.remove(0);
        //}

        CustomerArray.length = 0;
        $("#CustomerCode").val("");


        if ($('#State').val() != null) {
            var seleState = $('#State').val();

            for (var k = 0; k < seleState.length; k++) {
                SelectedState += "'" + seleState[k] + "',";
                Actual_SelectedState += "'" + seleState[k] + "',";
            }
            SelectedState = SelectedState.substring(',', SelectedState.length - 1);//Selected States with ' '. 
            Actual_SelectedState = Actual_SelectedState.substring(',', Actual_SelectedState.length - 1);//Selected States with ' '. 
        }

        var data_value = "{\"State_Code\":\"" + SelectedState + "\"}";
        $http({ url: '../../Home/GetTerritoriesforState', method: 'POST', data: { Data: data_value } }).success(function (res) {
            if (res != "") {
                var dtTerritory = JSON.parse(res);
                for (var i = 0; i < dtTerritory.length; i++) {
                    $('#TerriotryArea')[0].sumo.add(dtTerritory[i]["TERRITORY_CODE"], dtTerritory[i]["TERRITORY_NAME"]);
                }
            }
            $http({ url: '../../Home/GetCustomersforState', method: 'POST', data: { Data: data_value } }).success(function (res) {
                if (res != "") {
                    var dtCust = JSON.parse(res);
                    for (var i = 0; i < dtCust.length; i++) {
                        //$('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"].toString(), dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                        CustomerArray.push(dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                        //$('#StockistName')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"].toString(), dtCust[i]["CUSTOMER_NAME"].toString());
                    }
                    HideLoader();
                } else {
                    HideLoader();
                }
            });
        });
        if ($("#State").val() == null) {
            var data_value = "{\"Zone_Code\":\"" + $("#Zone").val() + "\"}";
            if ((SessionValue != "SH") && (SessionValue != "TM") && (SessionValue != "FSO") && (SessionValue != "FSO_BU2") && (SessionValue != "STOCKIST") && (SessionValue != "C&F")) {
                $http({ url: '../../Home/GetCustomersforZone', method: 'POST', data: { Data: data_value } }).success(function (Cust_res) {
                    if (Cust_res != "") {
                        var dtCust = JSON.parse(Cust_res);
                        for (var i = 0; i < dtCust.length; i++) {
                            //  $('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"].toString(), dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                            CustomerArray.push(dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                        }
                        HideLoader();
                    } else {
                        HideLoader();
                    }
                });
            }
            HideLoader();
        }

        SelectedState = "";
        //HideLoader();
    });

    var SelectedTerritory = "";
    $('#TerriotryArea').on('keyup change', function () {
        ShowLoader();
        Actual_SelectedTerritory = ""; Actual_SelectedState = "";
        if ((SessionValue == "TM") || (SessionValue == "FSO") || (SessionValue == "FSO_BU2")) {
            if ($("#TerriotryArea").val() == null) {
                //var Clear_Cust = $('#StockistID option').length;
                //for (var i = 0; i < Clear_Cust; i++) {
                //    $('#StockistID')[0].sumo.remove(0);
                //}
                CustomerArray.length = 0;
                $("#CustomerCode").val("");

                HideLoader();
            } else if ($("#TerriotryArea").val() != null) {
                var seleTerritory = $('#TerriotryArea').val();
                for (var k = 0; k < seleTerritory.length; k++) {
                    SelectedTerritory += "'" + seleTerritory[k] + "',";
                    Actual_SelectedTerritory += "'" + seleTerritory[k] + "',";
                }
                SelectedTerritory = SelectedTerritory.substring(',', SelectedTerritory.length - 1);//Selected Territories with ' '. 
                Actual_SelectedTerritory = Actual_SelectedTerritory.substring(',', Actual_SelectedTerritory.length - 1);//Selected Territories with ' '. 

                var data_value = "{\"Territory_Code\":\"" + SelectedTerritory + "\"}";
                $http({ url: '../../Home/GetCustomersforTerritory', method: 'POST', data: { Data: data_value } }).success(function (res) {
                    if (res != "") {
                        var dtCust = JSON.parse(res);
                        for (var i = 0; i < dtCust.length; i++) {
                            //$('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"], dtCust[i]["CUSTOMER_CODE"] + ":" + dtCust[i]["CUSTOMER_NAME"]);
                            CustomerArray.push(dtCust[i]["CUSTOMER_CODE"] + ":" + dtCust[i]["CUSTOMER_NAME"]);
                        }
                        HideLoader();
                    } else { HideLoader(); }
                });
            }
        } else {
            //var Clear_Cust = $('#StockistID option').length;
            //for (var i = 0; i < Clear_Cust; i++) {
            //    $('#StockistID')[0].sumo.remove(0);
            //}

            CustomerArray.length = 0;
            $("#CustomerCode").val("");


            if ($('#TerriotryArea').val() != null) {
                var seleTerritory = $('#TerriotryArea').val();
                for (var k = 0; k < seleTerritory.length; k++) {
                    SelectedTerritory += "'" + seleTerritory[k] + "',";
                    Actual_SelectedTerritory += "'" + seleTerritory[k] + "',";
                }
                SelectedTerritory = SelectedTerritory.substring(',', SelectedTerritory.length - 1);//Selected Territories with ' '. 
                Actual_SelectedTerritory = Actual_SelectedTerritory.substring(',', Actual_SelectedTerritory.length - 1);//Selected Territories with ' '. 
            }
            if ($("#TerriotryArea").val() == null) {
                var seleState = $('#State').val();

                for (var k = 0; k < seleState.length; k++) {
                    SelectedState += "'" + seleState[k] + "',";
                    Actual_SelectedState += "'" + seleState[k] + "',";
                }
                SelectedState = SelectedState.substring(',', SelectedState.length - 1);//Selected States with ' '. 
                Actual_SelectedState = Actual_SelectedState.substring(',', Actual_SelectedState.length - 1);//Selected States with ' '. 

                var data_value = "{\"State_Code\":\"" + SelectedState + "\"}";
                $http({ url: '../../Home/GetCustomersforState', method: 'POST', data: { Data: data_value } }).success(function (res) {
                    if (res != "") {
                        var dtCust = JSON.parse(res);
                        for (var i = 0; i < dtCust.length; i++) {
                            CustomerArray.push(dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                        }
                        HideLoader();
                    } else { HideLoader(); }
                });
            } else {
                var data_value = "{\"Territory_Code\":\"" + SelectedTerritory + "\"}";
                $http({ url: '../../Home/GetCustomersforTerritory', method: 'POST', data: { Data: data_value } }).success(function (res) {
                    if (res != "") {
                        var dtCust = JSON.parse(res);
                        for (var i = 0; i < dtCust.length; i++) {
                            CustomerArray.push(dtCust[i]["CUSTOMER_CODE"] + ":" + dtCust[i]["CUSTOMER_NAME"]);
                        }
                        HideLoader();
                    } else { HideLoader(); }
                });
            }
        }
        SelectedTerritory = "";
        SelectedState = "";
    });
    $("#CustomerCode").typeahead({
        source: CustomerArray
    });


    $scope.GetData = function () {
        var isValidCustCode = isValidCode_Cust($("#CustomerCode").val(), CustomerArray);
        if (($("#OrderFromDate").val() != "") && ($("#OrderToDate").val() != "")) {
            if ((SessionValue == "ZH")) {
                if ($("#Zone").val() == null) { alert("Please Select Your Zone"); } else if ((isValidCustCode == false) && ($("#CustomerCode").val() != "")) {
                    alert("please select proper customer code");
                } else {
                    GetPendingCFormData();
                }
            } else if (SessionValue == "SH") {
                if ($("#State").val() == null) { alert("Please Select Your State"); } else if ((isValidCustCode == false) && ($("#CustomerCode").val() != "")) {
                    alert("please select proper customer code");
                } else {
                    GetPendingCFormData();
                }
            } else if (SessionValue == "TM") {
                if ($("#TerriotryArea").val() == null) { alert("Please Select Your Sales Group"); } else if ((isValidCustCode == false) && ($("#CustomerCode").val() != "")) {
                    alert("please select proper customer code");
                } else {
                    GetPendingCFormData();
                }
            }
            else if (SessionValue == "FSO" || (SessionValue == "FSO_BU2")) {
                if ($("#TerriotryArea").val() == null) { alert("Please Select Your Sales Group"); } else if ((isValidCustCode == false) && ($("#CustomerCode").val() != "")) {
                    alert("please select proper customer code");
                } else {
                    GetPendingCFormData();
                }
            } else {
                if ((isValidCustCode == false) && ($("#CustomerCode").val() != "")) {
                    alert("please select proper customer code");
                } else {
                    GetPendingCFormData();
                }
            }
        } else { alert("Please Select From Date and To Date"); }
    }

    function GetPendingCFormData() {
        try {
            //ShowLoader();

            var DateRange = DateSplitter('OrderFromDate', 'OrderToDate');
            var WhereClause = " WHERE PCF.DEL_FLAG='True' AND (PCF.BILL_DATE between " + DateRange + ") and cast(pcf.CUSTOMER_CODE as bigint)=cast(scm.stockist_id as bigint) and cast(pcf.CUSTOMER_CODE as bigint)=cast(scsm.stockist_id as bigint) and scsm.SALES_ORGANISATION='1000' ";

            if ($("#CustomerCode").val() != "") {
                WhereClause += " and CAST(PCF.CUSTOMER_CODE AS BIGINT) IN (" + $("#CustomerCode").val().split(':')[0] + ")";

                //if (isValidCustCode == false) {
                //    alert("please select proper customer code");
                //} else {
                //    WhereClause += " and SOLD_TO_PARTY_NO IN (" + $("#CustomerCode").val().split(':')[0] + ")";
                //}
            } else if ($("#TerriotryArea").val() != null) {
                WhereClause += " and CAST(PCF.CUSTOMER_CODE AS BIGINT) IN (select DISTINCT ecc.CUSTOMER_CODE from cms_employee_customer_configuration ecc inner join CUSTOMER_SALES_VIEW csv on CAST(ecc.CUSTOMER_CODE AS BIGINT)=CAST(csv.cust_code AS BIGINT) where ecc.ORG_LEVEL_ID IN(" + Actual_SelectedTerritory + "))";
            } else if ($("#State").val() != null) {
                WhereClause += " and scm.STATE IN(" + Actual_SelectedState + ")";
            }
            else if ($("#Zone").val() != null) {
                WhereClause += " and scsm.ZONE IN(" + $("#Zone").val() + ")";
            }
            if (($("#Zone").val() == null) && ($("#State").val() == null) && ($("#TerriotryArea").val() == null) && ($("#CustomerCode").val() == "")) {
                WhereClause += "";
            }


            var sheet = $("#Sheets").val();

            //Edited By Manikanta

            if (sheet != "select") {
                WhereClause += " and scsm.DIVISION='" + sheet + "'";
            }


            var Data = JSON.stringify({
                MasterType: "PendingCForms",
                ID: "561",
                UserCode: $("#UserCode").val(),
                "Type": "Get",
                ReportName: "PendingCForms",
                WhereClause: WhereClause
            });
            //ShowLoader();
            DIMSFactory.getReportListColumnNamesData(Data).success(function (response) {

                var Result = JSON.parse(response.tabledata);

                if (Result != "") {
                    $scope.UserDefaultListColumnNames = Result["UserDefaultListColumnNames"];
                    if (Result.hasOwnProperty('UserListColumnNames')) {
                        var data1 = JSON.parse(Result["UserListColumnNames"]);

                        var selectedcolumnname = data1["ColumnNames"];

                        CustomColumnID = Result["UserListID"];
                        $('#undo_redo_to').empty();
                        var ColArray = new Array();
                        for (var i = 0; i < selectedcolumnname.length; i++) {


                            ColArray.push({
                                "data": selectedcolumnname[i],
                                "name": selectedcolumnname[i], "bSortable": true
                            });
                            $("#undo_redo_to").append($("<option></option>").val(selectedcolumnname[i]).html(selectedcolumnname[i]));
                        }
                        //$scope.UserSelectedColumnName = ColArray;
                        UserSelectedColumnName = ColArray;
                    } else {

                        var data1 = JSON.parse(Result["UserDefaultListColumnNames"]);

                        var selectedcolumnname = data1["ColumnNames"];

                        CustomColumnID = "0";

                        $('#undo_redo_to').empty();
                        var ColArray = new Array();
                        for (var i = 0; i < selectedcolumnname.length; i++) {
                            ColArray.push({
                                "data": selectedcolumnname[i],
                                "name": selectedcolumnname[i],
                                "bSortable": "true"
                            });
                            $("#undo_redo_to").append($("<option></option>").val(selectedcolumnname[i]).html(selectedcolumnname[i]));
                        }
                        //$scope.UserSelectedColumnName = ColArray;
                        UserSelectedColumnName = ColArray;
                    }



                }

                DIMSFactory.getReportData(Data).success(function (response) {

                    getLookUpData_Reports_ServerSideBinding("", "EnrollmentNodataLabel", "", "tbl_PendingCForms", UserSelectedColumnName);
                    GetTotalTaxableIncome(Data);
                    $('#tbl_PendingCForms tbody').on('click', 'tr', function () {
                        if ($(this).hasClass('selected')) {
                            $(this).removeClass('selected');
                        }
                        else {
                            $('tr.selected').removeClass('selected');
                            $(this).addClass('selected');
                        }
                    });


                });
                //HideLoader();
            });
            //HideLoader();
        } catch (Exception) { }
    }

    function GetTotalTaxableIncome(Data) {
        $.ajax({
            url: '../../SAP/GetTotalTaxableIncome',
            type: 'POST',
            data: { Data: Data },
            async: false,
            success: function (Resp) {
                var Result = JSON.parse(Resp);
                if (Resp != "" || Resp != null) {
                    if (Result[0]["Received"] != "NULL" || Result[0]["Received"] != "") {
                        $("#TotalReceived").val(Result[0]["Received"]);
                    }
                    else {
                        $("#TotalReceived").val("0");
                    }
                    if (Result[0]["NotReceived"] == "NULL" || Result[0]["NotReceived"] == "" || Result[0]["NotReceived"] == "null" || Result[0]["NotReceived"] == null) {
                        $("#TotalNotReceived").val("0");
                    }
                    else {
                        $("#TotalNotReceived").val(Result[0]["NotReceived"]);

                    }
                }
            }
        })
    }

    // Open popup for columns selection
    $scope.OpenColumnEditing = function () {

        $('#undo_redo').empty();
        var ColumnNames = JSON.parse($scope.UserDefaultListColumnNames);

        for (var i = 0; i < ColumnNames["ColumnNames"].length; i++) {
            $("#undo_redo").append($("<option></option>").val(ColumnNames["ColumnNames"][i]).html(ColumnNames["ColumnNames"][i]));
        }



        //   $('#undo_redo').refresh();

        $('#undo_redo').multiselect();
        if (ControllerName != "PendingCFormsCtrl") {
            ControllerName = "PendingCFormsCtrl";
            var elem = angular.element('#ColumnEditingModal');
            elem.removeAttr('ng-controller');
            elem.attr('ng-controller', "PendingCFormsCtrl");

            $compile(elem.contents())(TDSCertificateScope);
        }

        $("#ColumnEditingModal").modal('show');




    }
    // View Column selected it is like preview.We will send reportname,usercode and where condition to function
    $scope.ViewColumnEditing = function () {
        DIMSFactory.ViewColumnEditing("PendingCForms", $("#UserCode").val(), " PCF.DEL_FLAG='True'"); // 1-Report Name ,2-UserCode(561),3-WhereClause

    }
    // Save Column selected it is like preview.We will send reportname,usercode and where condition to function
    $scope.SaveColumnEditingData = function () {
        var WhereClause = " WHERE PCF.DEL_FLAG='True'";
        var Data = JSON.stringify({
            MasterType: "PendingCForms",
            ID: "561",
            UserCode: $("#UserCode").val(),
            "Type": "Get",
            ReportName: "PendingCForms",
            WhereClause: WhereClause
        });
        //DIMSFactory.SaveColumnEditingData("Compensation", $scope.UserCode, " ORDER BY ID DESC");
        DIMSFactory.SaveColumnEditingData_InputParameter("PendingCForms", $("#UserCode").val(), WhereClause, Data, "tbl_PendingCForms");
        // 1-Report Name ,2-UserCode(561),3-WhereClause,4-JsonData,5-Frontend datatable id


    }

    $scope.DownloadFile = function (filetype) {
        var isValidCustCode = isValidCode_Cust($("#CustomerCode").val(), CustomerArray);
        var SearchValue = $('input[type=search]').val();
        var FileName = "PendingCForms";
        var DateRange = DateSplitter('OrderFromDate', 'OrderToDate');
        var UserCode = $("#UserCode").val();

        var DateRange = DateSplitter('OrderFromDate', 'OrderToDate');
        var WhereClause = " WHERE PCF.DEL_FLAG='True' AND (PCF.BILL_DATE between " + DateRange + ") and cast(pcf.CUSTOMER_CODE as bigint)=cast(scm.stockist_id as bigint) and cast(pcf.CUSTOMER_CODE as bigint)=cast(scsm.stockist_id as bigint) ";

        if ($("#CustomerCode").val() != "") {
            if ((isValidCustCode == false) && ($("#CustomerCode").val() != "")) {

            } else {
                WhereClause += " and CAST(PCF.CUSTOMER_CODE AS BIGINT) IN (" + $("#CustomerCode").val().split(':')[0] + ")";
            }

        } else if ($("#TerriotryArea").val() != null) {
            WhereClause += " and CAST(PCF.CUSTOMER_CODE AS BIGINT) IN (select DISTINCT ecc.CUSTOMER_CODE from cms_employee_customer_configuration ecc inner join CUSTOMER_SALES_VIEW csv on CAST(ecc.CUSTOMER_CODE AS BIGINT)=CAST(csv.cust_code AS BIGINT) where ecc.ORG_LEVEL_ID IN(" + Actual_SelectedTerritory + "))";
        } else if ($("#State").val() != null) {
            WhereClause += " and scm.STATE IN(" + Actual_SelectedState + ")";
        }
        else if ($("#Zone").val() != null) {
            WhereClause += " and scsm.ZONE IN(" + $("#Zone").val() + ")";
        }
        if (($("#Zone").val() == null) && ($("#State").val() == null) && ($("#TerriotryArea").val() == null) && ($("#CustomerCode").val() == "")) {
            WhereClause += "";
        }

        var sheet = $("#Sheets").val();

        //Edited By Manikanta

        if (sheet != "select") {
            WhereClause += " and scsm.DIVISION='" + sheet + "'";
        }

        var UserRole = SessionValue;
        if (UserRole == "STOCKIST") {
            filetype = 'PDF';
        }

        var Table_DebitCount = $('#tbl_PendingCForms').DataTable().data().count();
        if (Table_DebitCount == 0) {
            alert("There is no data");
        } else {
            if ((isValidCustCode == false) && ($("#CustomerCode").val() != "")) { alert("please select proper customer code"); } else {
                var data_value = "{\"Role\":\"" + SessionValue + "\",\"Form_Code\":\"" + "PCF" + "\",\"Action\":\"" + "Is_Export" + "\"}";
                $http({ url: '../../Home/Form_Access', method: 'POST', data: { Data: data_value } }).success(function (res) {
                    if (res == "True") {
                        CommonFunctionForExcelExport_SearchFilter("561", UserCode, SearchValue, FileName, FileName, WhereClause, filetype);
                    }
                    else {
                        alert("You are not allowed to export Pending C-Forms");
                    }
                });
            }


            //CommonFunctionForExcelExport_SearchFilter("561", "561", SearchValue, FileName, FileName, WhereClause, filetype);

        }
    }
    //});
});

function GetPendingCForms() {

}

DIMS.controller('SAP_DashBoardCtrl', function ($scope, $location, DIMSFactory, $http, $compile) {
    $scope.templatesettings = { HeaderTitle: "SAP Dash Board" };
    MasterScope = $scope;


    $scope.go = function (path) {
        CheckUserSession();
        $location.path(path);
    };

    $scope.DownloadFile = function (fileType) {
        var FinancialTxData = $('#SAP_DB_Fin_Transactions').DataTable().data().count();
        var AgeingData = $('#SAP_DB_Ageing_Outstanding_Summary').DataTable().data().count();
        var CFormData;
        if ((SessionValue != "FSO") && (SessionValue != "FSO_BU2") && (SessionValue != "STOCKIST")) {
            CFormData = $('#SAP_DB_C_FormSummary').DataTable().data().count();
        } else {
            CFormData = 1;
        }
        if (FinancialTxData == 0 && AgeingData == 0 && CFormData == 0) {
            alert("There is no data");
        } else {
            var data_value = "{\"Role\":\"" + SessionValue + "\",\"Form_Code\":\"" + "FD" + "\",\"Action\":\"" + "Is_Export" + "\"}";
            $http({ url: '../../Home/Form_Access', method: 'POST', data: { Data: data_value } }).success(function (res) {
                if (res == "True") {
                    var FinancialTxHtml = "<table border='1'>" + $('#SAP_DB_Fin_Transactions thead').html() + $('#SAP_DB_Fin_Transactions tbody').html() + $('#SAP_DB_Fin_Transactions tfoot').html() + "</table>  <div style='height: 25px;'></div>";
                    var AgeingHtml = "<table border='1'>" + $('#SAP_DB_Ageing_Outstanding_Summary thead').html() + $('#SAP_DB_Ageing_Outstanding_Summary tbody').html() + $('#SAP_DB_Ageing_Outstanding_Summary tfoot').html() + "</table> <div style='height: 25px;'></div>";
                    var CFormHtml = "";
                    if ((SessionValue != "FSO") && (SessionValue != "FSO_BU2") && (SessionValue != "STOCKIST")) {
                        CFormHtml = "<table border='1'>" + $('#SAP_DB_C_FormSummary thead').html() + $('#SAP_DB_C_FormSummary tbody').html() + $('#SAP_DB_C_FormSummary tfoot').html() + "</table>";
                    }
                    var TotalHtml = FinancialTxHtml + AgeingHtml + CFormHtml;

                    $.ajax({
                        url: '/Home/ExportdataFinanceDashboard',
                        type: 'POST',
                        beforeSend: function () {
                            //ShowLoader();
                        },
                        data: { QueryVal: TotalHtml },
                        success: function (result) {
                            if (result == "ok") {

                                window.location.href = "../../Home/GetExcelFinaceDashBoard?reportname=FinanceDashboard_" + $("#SAPOrderToDate").val() + "";
                                //$("#PrintReport").css("display", "block");
                                //if (userRole == "STOCKIST") {
                                //    $.ajax({
                                //        type: 'POST',
                                //        async: false,
                                //        data: { reportname: "CreditNote_" + $("#DocNo").text() + "" },
                                //        //datatype: 'JSON',
                                //        url: '../../HOME/GetPDF_STOCKIST',
                                //        success: function (data) {
                                //            if (data == "MailSentSuccessfully") {
                                //                alert("Mail Sent Successfully");
                                //            } else {
                                //                alert(data);
                                //            }
                                //        },
                                //        error: function (e) {
                                //            alert("Technical Error Occured");
                                //        }
                                //    });

                                //    //   window.location.href = "../../Home/GetPDF_STOCKIST?reportname=CreditNote_" + $("#DocNo").text() + "";
                                //} else {
                                //    window.location.href = "../../Home/GetExcelFinaceDashBoard?reportname=FinanceDashboard_" + $("#SAPOrderToDate").val() + "";
                                //}
                            }
                        },
                        error: function (e) {
                            alert(e);
                        }
                    });
                }
                else {
                    alert("You are not allowed to export Dash Board");
                }
            });
        }
    }
});

//TDS Certificate Download
DIMS.controller('TDSCertificateCtrl', function ($scope, $location, DIMSSAPFactory, $http, $compile, $routeParams) {
    $scope.templatesettings = { HeaderTitle: "TDS Certficates" };
    MasterScope = $scope;



    $scope.go = function (path) {
        CheckUserSession();
        $location.path(path);
    };

    var width = $(window).width(), height = $(window).height();//---------

    var totalheight = height - 191;
    // var totalheight = height - 148;//--------    
    if (height <= 800) {
        totalheight = height - 148;
    }

    $('.content').css({ "max-height": totalheight, "overflow-y": "auto" });//-----------
    $('.content-header > h2').css({ "font-size": "18px", "font-weight": "500" });//----------
    $('.content').css({ "max-height": totalheight, "min-height": totalheight, "overflow-y": "auto" });//-----------

    var EditId = $routeParams.ID;
    if (EditId == undefined || EditId == "") {
        EditId = 0;
    } else {
        DIMSSAPFactory.GetCustomerDetails(EditId).success(function (resp) {
            if (resp != "FALSE") {
                var Response = JSON.parse(resp);
                $('#StockistID').val(EditId);
                $('#StockistName').val(Response[0]["STOCKIST_NAME"]);
                $('#PanNo').val(Response[0]["PAN_NO"]);
            }
        });
        DIMSSAPFactory.GetYearNamesFor().success(function (res) {
            if (res != "FALSE") {
                var Res = JSON.parse(res);
                $("#Year").empty();
                // $("#Year").append($("<option></option>").val("").html("Select"));
                for (var j = 0; j < Res.length; j++) {
                    $("#Year").append($("<option></option>").val(Res[j]["tds_year"]).html(Res[j]["tds_year"]));
                }
            }
        });
    }
    $scope.GetTDSCertificate = function (Q) {
        var UserType = $('#SessionUserType').val();
        if ($("#StockistID").val() == "") {
            alert("Please Enter Customer Code");
        } else if ($('#PanNo').val() == "") {
            alert("PAN No is mandatorily required for accessing TDS Certificate");
        }
        else {
            try {
                ShowLoader();
                var StockisstId = $("#StockistID").val();
                var PanNo = $('#PanNo').val();
                var SelectedYear = $('#Year').val();
                var LoginEmpCode = $('#SessionUserCode').val();
                var Data = JSON.stringify({
                    "CustomerCode": StockisstId,
                    "UserCode": LoginEmpCode,
                    "UserType": UserType,
                    "PanNo": PanNo,
                    "SelectedYear": SelectedYear,
                    "Quarter": Q
                });
                DIMSSAPFactory.GetTDS_Certificate(Data).success(function (res) {
                    HideLoader();
                    if (res.tabledata == "True") {
                        alert("mail sent successfully");
                    } else if (res.tabledata == "FALSE") {
                        alert("Error")
                    } else {
                        alert(res.tabledata);
                    }
                });

            } catch (Exception) { }
        }

    }
});

//TDS Certificate List
DIMS.controller('TDSCertificateListCtrl', function ($scope, $location, DIMSFactory, $http, $compile, $routeParams) {
    $scope.templatesettings = { HeaderTitle: "TDS Certficates List" };
    TDSCertificateScope = $scope;
    MasterScope = $scope;

    $('#TDS_Cust').hide();

    $scope.go = function (path) {
        CheckUserSession();
        $location.path(path);
    };
    var width = $(window).width(), height = $(window).height();//---------

    var totalheight = height - 191;
    // var totalheight = height - 148;//--------    
    if (height <= 800) {
        totalheight = height - 148;
    }

    $('.content').css({ "max-height": totalheight, "overflow-y": "auto" });//-----------
    $('.content-header > h2').css({ "font-size": "18px", "font-weight": "500" });//----------
    $('.content').css({ "max-height": totalheight, "min-height": totalheight, "overflow-y": "auto" });//-----------


    var data_value = ""; var all_zones = ""; var all_states = ""; var all_territories = ""; var all_customers = ""; var CustomerArray = new Array();
    ShowLoader();
    if ((SessionValue == "ZH") || (SessionValue == "RCC") || (SessionValue == "ZSC")) {
        $("#zonelbl").append('<span class="Mandatory">*</span>');
        $("#Zone").attr("disabled", false); $("#State").attr("disabled", false); $("#TerriotryArea").attr("disabled", false); $("#CustomerCode").attr("disabled", false);
        //data_value = "{\"Role\":\"" + "ZH" + "\",\"UserCode\":\"" + "50001762" + "\"}";
        data_value = "{\"Role\":\"" + "ZH" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
            var FilterList = JSON.parse(res);
            all_zones = "";
            for (var i = 0; i < FilterList.dtZone.length; i++) {
                $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
                if (FilterList.dtZone.length == 0) {
                    all_zones = "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                } else if (i == FilterList.dtZone.length - 1) {
                    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                } else {
                    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'" + ',';
                }
            }
            $('select#Zone')[0].sumo.selectItem(0);
            $('#Zone').trigger("change");
            //all_states = "";
            //for (var i = 0; i < FilterList.dtState.length; i++) {
            //    if (FilterList.dtState.length == 0) {
            //        all_states = "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
            //    } else if (i == FilterList.dtState.length - 1) {
            //        all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
            //    } else {
            //        all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'" + ',';
            //    }
            //}
            //all_territories = "";
            //for (var i = 0; i < FilterList.dtTerritory.length; i++) {
            //    if (FilterList.dtTerritory.length == 0) {
            //        all_territories = "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
            //    } else if (i == FilterList.dtTerritory.length - 1) {
            //        all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
            //    } else {
            //        all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'" + ',';
            //    }
            //}
            //all_customers = "";
            //for (var i = 0; i < FilterList.dtCustomer.length; i++) {
            //$('#StockistID')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //$('#StockistName')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //if (FilterList.dtCustomer.length == 0) {
            //    all_customers = "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else if (i == FilterList.dtCustomer.length - 1) {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'" + ',';
            //}
            //}
        });
    } else if (SessionValue == "SH") {
        $("#Zone").attr("disabled", true); $("#State").attr("disabled", false); $("#TerriotryArea").attr("disabled", false); $("#CustomerCode").attr("disabled", false);
        //data_value = "{\"Role\":\"" + "SH" + "\",\"UserCode\":\"" + "50002430" + "\"}";
        data_value = "{\"Role\":\"" + "SH" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
            var FilterList = JSON.parse(res);
            //all_zones = "";
            for (var i = 0; i < FilterList.dtZone.length; i++) {
                $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
                //if (FilterList.dtZone.length == 0) {
                //    all_zones = "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else if (i == FilterList.dtZone.length - 1) {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'" + ',';
                //}
            }
            $('select#Zone')[0].sumo.selectItem(0);
            //all_states = "";
            for (var i = 0; i < FilterList.dtState.length; i++) {
                $('#State')[0].sumo.add(FilterList.dtState[i]["STATE_CODE"], FilterList.dtState[i]["STATE_NAME"]);
                //if (FilterList.dtState.length == 0) {
                //    all_states = "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else if (i == FilterList.dtState.length - 1) {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'" + ',';
                //}
            }
            $('select#State')[0].sumo.selectItem(0);
            $('#State').trigger("change");
            //all_territories = "";
            //for (var i = 0; i < FilterList.dtTerritory.length; i++) {
            //    if (FilterList.dtTerritory.length == 0) {
            //        all_territories = "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
            //    } else if (i == FilterList.dtTerritory.length - 1) {
            //        all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
            //    } else {
            //        all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'" + ',';
            //    }
            //}
            //all_customers = "";
            //for (var i = 0; i < FilterList.dtCustomer.length; i++) {
            // $('#StockistID')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //$('#StockistName')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //if (FilterList.dtCustomer.length == 0) {
            //    all_customers = "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else if (i == FilterList.dtCustomer.length - 1) {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'" + ',';
            //}
            // }
        });
    }

    else if (SessionValue == "TM") {
        $("#Zone").attr("disabled", true); $("#State").attr("disabled", true); $("#TerriotryArea").attr("disabled", false); $("#CustomerCode").attr("disabled", false);
        //data_value = "{\"Role\":\"" + "TM" + "\",\"UserCode\":\"" + "50001144" + "\"}";
        data_value = "{\"Role\":\"" + "TM" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
            var FilterList = JSON.parse(res);
            //all_zones = "";
            for (var i = 0; i < FilterList.dtZone.length; i++) {
                $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
                //if (FilterList.dtZone.length == 0) {
                //    all_zones = "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else if (i == FilterList.dtZone.length - 1) {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'" + ',';
                //}
            }
            $('select#Zone')[0].sumo.selectItem(0);
            //all_states = "";
            for (var i = 0; i < FilterList.dtState.length; i++) {
                $('#State')[0].sumo.add(FilterList.dtState[i]["STATE_CODE"], FilterList.dtState[i]["STATE_NAME"]);
                //if (FilterList.dtState.length == 0) {
                //    all_states = "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else if (i == FilterList.dtState.length - 1) {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'" + ',';
                //}
            }
            $('select#State')[0].sumo.selectItem(0);
            //all_territories = "";
            for (var i = 0; i < FilterList.dtTerritory.length; i++) {
                $('#TerriotryArea')[0].sumo.add(FilterList.dtTerritory[i]["TERRITORY_CODE"], FilterList.dtTerritory[i]["TERRITORY_NAME"]);
                //if (FilterList.dtTerritory.length == 0) {
                //    all_territories = "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                //} else if (i == FilterList.dtTerritory.length - 1) {
                //    all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                //} else {
                //    all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'" + ',';
                //}
            }
            //all_customers = "";
            // for (var i = 0; i < FilterList.dtCustomer.length; i++) {
            // $('#StockistID')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //$('#StockistName')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //if (FilterList.dtCustomer.length == 0) {
            //    all_customers = "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else if (i == FilterList.dtCustomer.length - 1) {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'" + ',';
            //}
            //}
        });
    }

    else if (SessionValue == "FSO" || SessionValue == "FSO_BU2") {
        $("#Zone").attr("disabled", true); $("#State").attr("disabled", true); $("#TerriotryArea").attr("disabled", false); $("#CustomerCode").attr("disabled", false);
        //data_value = "{\"Role\":\"" + "FSO" + "\",\"UserCode\":\"" + "50001906" + "\"}";
        if (SessionValue == "FSO") {
            data_value = "{\"Role\":\"" + "FSO" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        } else {
            data_value = "{\"Role\":\"" + "FSO_BU2" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        }
        $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
            var FilterList = JSON.parse(res);
            //all_zones = "";
            for (var i = 0; i < FilterList.dtZone.length; i++) {
                $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
                //if (FilterList.dtZone.length == 0) {
                //    all_zones = "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else if (i == FilterList.dtZone.length - 1) {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'" + ',';
                //}
            }
            $('select#Zone')[0].sumo.selectItem(0);
            //all_states = "";
            for (var i = 0; i < FilterList.dtState.length; i++) {
                $('#State')[0].sumo.add(FilterList.dtState[i]["STATE_CODE"], FilterList.dtState[i]["STATE_NAME"]);
                //if (FilterList.dtState.length == 0) {
                //    all_states = "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else if (i == FilterList.dtState.length - 1) {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'" + ',';
                //}
            }
            $('select#State')[0].sumo.selectItem(0);
            //all_territories = "";
            for (var i = 0; i < FilterList.dtTerritory.length; i++) {
                $('#TerriotryArea')[0].sumo.add(FilterList.dtTerritory[i]["TERRITORY_CODE"], FilterList.dtTerritory[i]["TERRITORY_NAME"]);
                //if (FilterList.dtTerritory.length == 0) {
                //    all_territories = "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                //} else if (i == FilterList.dtTerritory.length - 1) {
                //    all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                //} else {
                //    all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'" + ',';
                //}
            }
            $('select#TerriotryArea')[0].sumo.selectItem(0);
            $('#TerriotryArea').trigger("change");
            //all_customers = "";
            //for (var i = 0; i < FilterList.dtCustomer.length; i++) {
            // $('#StockistID')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //$('#StockistName')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //if (FilterList.dtCustomer.length == 0) {
            //    all_customers = "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else if (i == FilterList.dtCustomer.length - 1) {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'" + ',';
            //}
            // }
        });
    }

    else if ((SessionValue == "STOCKIST") || (SessionValue == "C&F")) {
        $("#Zone").attr("disabled", true); $("#State").attr("disabled", true); $("#TerriotryArea").attr("disabled", true); $("#CustomerCode").attr("disabled", true);
        //data_value = "{\"Role\":\"" + "STOCKIST" + "\",\"UserCode\":\"" + "1100002" + "\"}";
        data_value = "{\"Role\":\"" + "STOCKIST" + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
            var FilterList = JSON.parse(res);
            //all_zones = "";
            for (var i = 0; i < FilterList.dtZone.length; i++) {
                $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
                //if (FilterList.dtZone.length == 0) {
                //    all_zones = "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else if (i == FilterList.dtZone.length - 1) {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                //} else {
                //    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'" + ',';
                //}
            }
            $('select#Zone')[0].sumo.selectItem(0);
            //all_states = "";
            for (var i = 0; i < FilterList.dtState.length; i++) {
                $('#State')[0].sumo.add(FilterList.dtState[i]["STATE_CODE"], FilterList.dtState[i]["STATE_NAME"]);
                //if (FilterList.dtState.length == 0) {
                //    all_states = "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else if (i == FilterList.dtState.length - 1) {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
                //} else {
                //    all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'" + ',';
                //}
            }
            $('select#State')[0].sumo.selectItem(0);
            //all_territories = "";
            for (var i = 0; i < FilterList.dtTerritory.length; i++) {
                $('#TerriotryArea')[0].sumo.add(FilterList.dtTerritory[i]["TERRITORY_CODE"], FilterList.dtTerritory[i]["TERRITORY_NAME"]);
                //if (FilterList.dtTerritory.length == 0) {
                //    all_territories = "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                //} else if (i == FilterList.dtTerritory.length - 1) {
                //    all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
                //} else {
                //    all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'" + ',';
                //}
            }
            $('select#TerriotryArea')[0].sumo.selectItem(0);
            //all_customers = "";
            for (var i = 0; i < FilterList.dtCustomer.length; i++) {
                //                $('#StockistID')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);

                CustomerArray.push(FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
                $('#CustomerCode').val(FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);

                //$('#StockistID').val(FilterList.dtCustomer[i]["CUSTOMER_CODE"] + " : " + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
                //$('#StockistName')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
                //if (FilterList.dtCustomer.length == 0) {
                //    all_customers = "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
                //} else if (i == FilterList.dtCustomer.length - 1) {
                //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
                //} else {
                //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'" + ',';
                //}
            }

            //$("#StockistID").typeahead({
            //    source: CustomerArray
            //});
            // $('select#StockistID')[0].sumo.selectItem(0);
        });
    } else {
        $("#Zone").attr("disabled", false); $("#State").attr("disabled", false); $("#TerriotryArea").attr("disabled", false); $("#CustomerCode").attr("disabled", false);
        //data_value = "{\"Role\":\"" + "ADMIN" + "\",\"UserCode\":\"" + "50001657" + "\"}";
        data_value = "{\"Role\":\"" + SessionValue + "\",\"UserCode\":\"" + $("#UserCode").val() + "\"}";
        $http({ url: '../../Home/GetFilters', method: 'POST', data: { Data: data_value } }).success(function (res) {
            var FilterList = JSON.parse(res);
            all_zones = "";
            for (var i = 0; i < FilterList.dtZone.length; i++) {
                $('#Zone')[0].sumo.add(FilterList.dtZone[i]["ZONE_CODE"], FilterList.dtZone[i]["ZONE_NAME"]);
                if (FilterList.dtZone.length == 0) {
                    all_zones = "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                } else if (i == FilterList.dtZone.length - 1) {
                    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'";
                } else {
                    all_zones += "'" + FilterList.dtZone[i]["ZONE_CODE"] + "'" + ',';
                }
            }
            CustomerArray.length = 0;
            $("#CustomerCode").val("");
            if (FilterList.dtCustomer.length > 0) {
                for (var i = 0; i < FilterList.dtCustomer.length; i++) {
                    CustomerArray.push(FilterList.dtCustomer[i]["STOCKIST_ID"].toString() + ":" + FilterList.dtCustomer[i]["STOCKIST_NAME"].toString());
                }
            }
            HideLoader();
            //all_states = "";
            //for (var i = 0; i < FilterList.dtState.length; i++) {
            //    if (FilterList.dtState.length == 0) {
            //        all_states = "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
            //    } else if (i == FilterList.dtState.length - 1) {
            //        all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'";
            //    } else {
            //        all_states += "'" + FilterList.dtState[i]["STATE_CODE"] + "'" + ',';
            //    }
            //}
            //all_territories = "";
            //for (var i = 0; i < FilterList.dtTerritory.length; i++) {
            //    if (FilterList.dtTerritory.length == 0) {
            //        all_territories = "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
            //    } else if (i == FilterList.dtTerritory.length - 1) {
            //        all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'";
            //    } else {
            //        all_territories += "'" + FilterList.dtTerritory[i]["TERRITORY_CODE"] + "'" + ',';
            //    }
            //}
            //all_customers = "";
            //for (var i = 0; i < FilterList.dtCustomer.length; i++) {
            //$('#StockistID')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_CODE"] + ":" + FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //$('#StockistName')[0].sumo.add(FilterList.dtCustomer[i]["CUSTOMER_CODE"], FilterList.dtCustomer[i]["CUSTOMER_NAME"]);
            //if (FilterList.dtCustomer.length == 0) {
            //    all_customers = "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else if (i == FilterList.dtCustomer.length - 1) {
            //   all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'";
            //} else {
            //    all_customers += "'" + FilterList.dtCustomer[i]["CUSTOMER_CODE"] + "'" + ',';
            //}
            //}
        });
    }
    HideLoader();
    $('#Zone').on('keyup change', function () {
        ShowLoader();
        var Clear_State = $('#State option').length;
        for (var i = 0; i < Clear_State; i++) {
            $('#State')[0].sumo.remove(0);
        }

        //var Clear_Cust = $('#StockistID option').length;
        //for (var i = 0; i < Clear_Cust; i++) {
        //    $('#StockistID')[0].sumo.remove(0);
        //}
        CustomerArray.length = 0;
        $('#CustomerCode').val("");

        var Clear_Terrytory = $('#TerriotryArea option').length;
        for (var i = 0; i < Clear_Terrytory; i++) {
            $('#TerriotryArea')[0].sumo.remove(0);
        }

        var data_value = "{\"Zone_Code\":\"" + $("#Zone").val() + "\"}";
        $http({ url: '../../Home/GetStatesforZone', method: 'POST', data: { Data: data_value } }).success(function (res) {
            if (res != "") {
                var dtState = JSON.parse(res);
                for (var i = 0; i < dtState.length; i++) {
                    $('#State')[0].sumo.add(dtState[i]["STATE_CODE"], dtState[i]["STATE_NAME"]);
                }
                HideLoader();
            } else { HideLoader(); }
            $http({ url: '../../Home/GetCustomersforZone', method: 'POST', data: { Data: data_value } }).success(function (Cust_res) {
                var dtCust = JSON.parse(Cust_res);
                for (var i = 0; i < dtCust.length; i++) {
                    // $('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"].toString(), dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                    CustomerArray.push(dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                }
            });
        });
    });

    var SelectedState = ""; var Actual_SelectedState = ""; var Actual_SelectedTerritory = "";
    $('#State').on('keyup change', function () {
        ShowLoader();
        Actual_SelectedState = "";
        var Clear_Territory = $('#TerriotryArea option').length;
        for (var i = 0; i < Clear_Territory; i++) {
            $('#TerriotryArea')[0].sumo.remove(0);
        }
        //var Clear_Cust = $('#StockistID option').length;
        //for (var i = 0; i < Clear_Cust; i++) {
        //    $('#StockistID')[0].sumo.remove(0);
        //}
        CustomerArray.length = 0;
        $('#CustomerCode').val('');

        if ($('#State').val() != null) {
            var seleState = $('#State').val();

            for (var k = 0; k < seleState.length; k++) {
                SelectedState += "'" + seleState[k] + "',";
                Actual_SelectedState += "'" + seleState[k] + "',";
            }
            SelectedState = SelectedState.substring(',', SelectedState.length - 1);//Selected States with ' '. 
            Actual_SelectedState = Actual_SelectedState.substring(',', Actual_SelectedState.length - 1);//Selected States with ' '. 
        }

        var data_value = "{\"State_Code\":\"" + SelectedState + "\"}";
        $http({ url: '../../Home/GetTerritoriesforState', method: 'POST', data: { Data: data_value } }).success(function (res) {
            if (res != "") {
                var dtTerritory = JSON.parse(res);
                for (var i = 0; i < dtTerritory.length; i++) {
                    $('#TerriotryArea')[0].sumo.add(dtTerritory[i]["TERRITORY_CODE"], dtTerritory[i]["TERRITORY_NAME"]);
                }
            }
            $http({ url: '../../Home/GetCustomersforState', method: 'POST', data: { Data: data_value } }).success(function (res) {
                if (res != "") {
                    var dtCust = JSON.parse(res);
                    for (var i = 0; i < dtCust.length; i++) {
                        //  $('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"].toString(), dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                        //$('#StockistName')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"].toString(), dtCust[i]["CUSTOMER_NAME"].toString());
                        CustomerArray.push(dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());

                    }
                    HideLoader();
                } else { HideLoader(); }
            });
        });

        if ($("#State").val() == null) {
            var data_value = "{\"Zone_Code\":\"" + $("#Zone").val() + "\"}";
            if ((SessionValue != "SH") && (SessionValue != "TM") && (SessionValue != "FSO") && (SessionValue != "FSO_BU2") && (SessionValue != "STOCKIST") && (SessionValue != "C&F")) {
                $http({ url: '../../Home/GetCustomersforZone', method: 'POST', data: { Data: data_value } }).success(function (Cust_res) {
                    if (Cust_res != "") {
                        var dtCust = JSON.parse(Cust_res);
                        for (var i = 0; i < dtCust.length; i++) {
                            //  $('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"].toString(), dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                            CustomerArray.push(dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                        }
                        HideLoader();
                    } else {
                        HideLoader();
                    }
                });
            }
            HideLoader();
        }

        SelectedState = "";
        // HideLoader();
    });

    var SelectedTerritory = "";
    $('#TerriotryArea').on('keyup change', function () {
        ShowLoader();
        Actual_SelectedTerritory = ""; Actual_SelectedState = "";
        if ((SessionValue == "TM") || (SessionValue == "FSO") || (SessionValue == "FSO_BU2")) {
            if ($("#TerriotryArea").val() == null) {
                //var Clear_Cust = $('#StockistID option').length;
                //for (var i = 0; i < Clear_Cust; i++) {
                //    $('#StockistID')[0].sumo.remove(0);
                //}
                CustomerArray.length = 0;
                $('#CustomerCode').val('');


                HideLoader();
            } else if ($("#TerriotryArea").val() != null) {
                var seleTerritory = $('#TerriotryArea').val();
                for (var k = 0; k < seleTerritory.length; k++) {
                    SelectedTerritory += "'" + seleTerritory[k] + "',";
                    Actual_SelectedTerritory += "'" + seleTerritory[k] + "',";
                }
                SelectedTerritory = SelectedTerritory.substring(',', SelectedTerritory.length - 1);//Selected Territories with ' '. 
                Actual_SelectedTerritory = Actual_SelectedTerritory.substring(',', Actual_SelectedTerritory.length - 1);//Selected Territories with ' '. 

                var data_value = "{\"Territory_Code\":\"" + SelectedTerritory + "\"}";
                $http({ url: '../../Home/GetCustomersforTerritory', method: 'POST', data: { Data: data_value } }).success(function (res) {
                    if (res != "") {
                        var dtCust = JSON.parse(res);
                        for (var i = 0; i < dtCust.length; i++) {
                            // $('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"], dtCust[i]["CUSTOMER_CODE"] + ":" + dtCust[i]["CUSTOMER_NAME"]);
                            CustomerArray.push(dtCust[i]["CUSTOMER_CODE"] + ":" + dtCust[i]["CUSTOMER_NAME"]);
                        }
                        HideLoader();
                    } else { HideLoader(); }
                });
            }
        } else {
            //var Clear_Cust = $('#StockistID option').length;
            //for (var i = 0; i < Clear_Cust; i++) {
            //    $('#StockistID')[0].sumo.remove(0);
            //}

            CustomerArray.length = 0;
            $('#CustomerCode').val('');

            if ($('#TerriotryArea').val() != null) {
                var seleTerritory = $('#TerriotryArea').val();
                for (var k = 0; k < seleTerritory.length; k++) {
                    SelectedTerritory += "'" + seleTerritory[k] + "',";
                    Actual_SelectedTerritory += "'" + seleTerritory[k] + "',";
                }
                SelectedTerritory = SelectedTerritory.substring(',', SelectedTerritory.length - 1);//Selected Territories with ' '. 
                Actual_SelectedTerritory = Actual_SelectedTerritory.substring(',', Actual_SelectedTerritory.length - 1);//Selected Territories with ' '. 
            }
            if ($("#TerriotryArea").val() == null) {
                var seleState = $('#State').val();

                for (var k = 0; k < seleState.length; k++) {
                    SelectedState += "'" + seleState[k] + "',";
                    Actual_SelectedState += "'" + seleState[k] + "',";
                }
                SelectedState = SelectedState.substring(',', SelectedState.length - 1);//Selected States with ' '. 
                Actual_SelectedState = Actual_SelectedState.substring(',', Actual_SelectedState.length - 1);//Selected States with ' '. 

                var data_value = "{\"State_Code\":\"" + SelectedState + "\"}";
                $http({ url: '../../Home/GetCustomersforState', method: 'POST', data: { Data: data_value } }).success(function (res) {
                    if (res != "") {
                        var dtCust = JSON.parse(res);
                        for (var i = 0; i < dtCust.length; i++) {
                            // $('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"].toString(), dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());

                            CustomerArray.push(dtCust[i]["CUSTOMER_CODE"].toString() + ":" + dtCust[i]["CUSTOMER_NAME"].toString());
                        }
                        HideLoader();
                    } else { HideLoader(); }
                });
            } else {
                var data_value = "{\"Territory_Code\":\"" + SelectedTerritory + "\"}";
                $http({ url: '../../Home/GetCustomersforTerritory', method: 'POST', data: { Data: data_value } }).success(function (res) {
                    if (res != "") {
                        var dtCust = JSON.parse(res);
                        for (var i = 0; i < dtCust.length; i++) {
                            //  $('#StockistID')[0].sumo.add(dtCust[i]["CUSTOMER_CODE"], dtCust[i]["CUSTOMER_CODE"] + ":" + dtCust[i]["CUSTOMER_NAME"]);
                            CustomerArray.push(dtCust[i]["CUSTOMER_CODE"] + ":" + dtCust[i]["CUSTOMER_NAME"]);
                        }
                        HideLoader();
                    } else { HideLoader(); }
                });
            }
        }
        SelectedTerritory = "";
        SelectedState = "";
    });

    $scope.GetData = function () {
        var isValidCustCode = isValidCode_Cust($("#CustomerCode").val(), CustomerArray);
        if ((SessionValue == "ZH")) {
            if ($("#Zone").val() == null) { alert("Please Select Your Zone"); }
            else if ((isValidCustCode == false) && ($("#CustomerCode").val() != "")) {
                alert("please select proper customer code");
            }
            else { GetTDSCertificateList(); }
        } else if (SessionValue == "SH") {
            if ($("#State").val() == null) { alert("Please Select Your State"); }
            else if ((isValidCustCode == false) && ($("#CustomerCode").val() != "")) {
                alert("please select proper customer code");
            }
            else {
                GetTDSCertificateList();
            }
        } else if (SessionValue == "TM") {
            if ($("#TerriotryArea").val() == null) { alert("Please Select Your Sales Group"); }
            else if ((isValidCustCode == false) && ($("#CustomerCode").val() != "")) {
                alert("please select proper customer code");
            }
            else {
                GetTDSCertificateList();
            }
        }
        else if (SessionValue == "FSO" || SessionValue == "FSO_BU2") {
            if ($("#TerriotryArea").val() == null) { alert("Please Select Your Sales Group"); }
            else if ((isValidCustCode == false) && ($("#CustomerCode").val() != "")) {
                alert("please select proper customer code");
            }
            else {
                GetTDSCertificateList();
            }
        } else {
            if ((isValidCustCode == false) && ($("#CustomerCode").val() != "")) {
                alert("please select proper customer code");
            }
            else { GetTDSCertificateList(); }
        }
    }
    $("#CustomerCode").typeahead({
        source: CustomerArray
    });
    function GetTDSCertificateList() {
        try {
            var sheet = $("#Sheets").val();
            var isValidCustCode = isValidCode_Cust($("#CustomerCode").val(), CustomerArray);
            var WhereClause = "";
            if ($("#CustomerCode").val() != "") {
                if ((isValidCustCode == false) && ($("#CustomerCode").val() != "")) { } else {
                    WhereClause += " WHERE CAST(cust_code AS BIGINT) IN (" + $("#CustomerCode").val().split(':')[0] + ")";
                    //Edited By Manikanta

                    if (sheet != "select") {
                        WhereClause += " and CAST(cust_code AS BIGINT) IN (select STOCKIST_ID from sap_customer_sales_master where DIVISION='" + sheet + "')";
                    }

                }
            } else if ($("#TerriotryArea").val() != null) {
                WhereClause += " WHERE CAST(cust_code AS BIGINT) IN (select DISTINCT ecc.CUSTOMER_CODE from cms_employee_customer_configuration ecc inner join CUSTOMER_SALES_VIEW csv on CAST(ecc.CUSTOMER_CODE AS BIGINT)=CAST(csv.cust_code AS BIGINT) where ecc.ORG_LEVEL_ID IN(" + Actual_SelectedTerritory + "))";
                //Edited By Manikanta

                if (sheet != "select") {
                    WhereClause += " and CAST(cust_code AS BIGINT) IN (select STOCKIST_ID from sap_customer_sales_master where DIVISION='" + sheet + "')";
                }

            } else if ($("#State").val() != null) {
                WhereClause += " WHERE STATE IN(" + Actual_SelectedState + ")";
                //Edited By Manikanta

                if (sheet != "select") {
                    WhereClause += " and CAST(cust_code AS BIGINT) IN (select STOCKIST_ID from sap_customer_sales_master where DIVISION='" + sheet + "')";
                }

            }
            else if ($("#Zone").val() != null) {
                WhereClause += " WHERE ZONE IN(" + $("#Zone").val() + ")";
                //Edited By Manikanta

                if (sheet != "select") {
                    WhereClause += " and CAST(cust_code AS BIGINT) IN (select STOCKIST_ID from sap_customer_sales_master where DIVISION='" + sheet + "')";
                }

            }
            if (($("#Zone").val() == null) && ($("#State").val() == null) && ($("#TerriotryArea").val() == null) && ($("#CustomerCode").val() == "")) {
                WhereClause += "";
                //Edited By Manikanta

                if (sheet != "select") {
                    WhereClause += " where CAST(cust_code AS BIGINT) IN (select STOCKIST_ID from sap_customer_sales_master where DIVISION='" + sheet + "')";
                }

            }




            var Data = JSON.stringify({
                MasterType: "TDSCertificate",
                ID: "561",
                UserCode: $("#UserCode").val(),
                "Type": "Get",
                ReportName: "TDSCertificate",
                WhereClause: WhereClause
            });
            //ShowLoader();
            DIMSFactory.getReportListColumnNamesData(Data).success(function (response) {
                var Result = JSON.parse(response.tabledata);

                if (Result != "") {
                    $scope.UserDefaultListColumnNames = Result["UserDefaultListColumnNames"];
                    if (Result.hasOwnProperty('UserListColumnNames')) {
                        var data1 = JSON.parse(Result["UserListColumnNames"]);

                        var selectedcolumnname = data1["ColumnNames"];

                        CustomColumnID = Result["UserListID"];
                        $('#undo_redo_to').empty();
                        var ColArray = new Array();
                        for (var i = 0; i < selectedcolumnname.length; i++) {


                            ColArray.push({
                                "data": selectedcolumnname[i],
                                "name": selectedcolumnname[i], "bSortable": true
                            });
                            $("#undo_redo_to").append($("<option></option>").val(selectedcolumnname[i]).html(selectedcolumnname[i]));
                        }
                        //$scope.UserSelectedColumnName = ColArray;
                        UserSelectedColumnName = ColArray;
                    } else {

                        var data1 = JSON.parse(Result["UserDefaultListColumnNames"]);

                        var selectedcolumnname = data1["ColumnNames"];

                        CustomColumnID = "0";

                        $('#undo_redo_to').empty();
                        var ColArray = new Array();
                        for (var i = 0; i < selectedcolumnname.length; i++) {
                            ColArray.push({
                                "data": selectedcolumnname[i],
                                "name": selectedcolumnname[i],
                                "bSortable": "true"
                            });
                            $("#undo_redo_to").append($("<option></option>").val(selectedcolumnname[i]).html(selectedcolumnname[i]));
                        }
                        //$scope.UserSelectedColumnName = ColArray;
                        UserSelectedColumnName = ColArray;
                    }



                }
                DIMSFactory.getReportData(Data).success(function (response) {

                    getLookUpData_Reports_ServerSideBinding("", "EnrollmentNodataLabel", "", "tbl_TDS_Customer", UserSelectedColumnName);
                    $('#TDS_Cust').show();
                    $('#tbl_TDS_Customer tbody').on('click', 'tr', function () {
                        var ID = $(this).find('td:eq(0)').text();
                        if (ID != "") {
                            var scope = angular.element($("#TDS_Certificate")).scope();
                            scope.$apply(function () {
                                $scope.go("TDSCertificate/" + ID);
                            })
                            //var scope = angular.element($("#TDS_Certificate")).scope();
                            //scope.$apply(function () {
                            //    $scope.go("TDSCertificate/" + ID);
                            //})
                        }

                        if ($(this).hasClass('selected')) {
                            $(this).removeClass('selected');
                        }
                        else {
                            $('tr.selected').removeClass('selected');
                            $(this).addClass('selected');
                        }
                    });


                });

            });
            // HideLoader();
            //  }
        } catch (Exception) { }
    }
    // Open popup for columns selection
    $scope.OpenColumnEditing = function () {

        $('#undo_redo').empty();
        var ColumnNames = JSON.parse($scope.UserDefaultListColumnNames);

        for (var i = 0; i < ColumnNames["ColumnNames"].length; i++) {
            $("#undo_redo").append($("<option></option>").val(ColumnNames["ColumnNames"][i]).html(ColumnNames["ColumnNames"][i]));
        }



        //   $('#undo_redo').refresh();

        $('#undo_redo').multiselect();
        if (ControllerName != "TDSCertificateListCtrl") {
            ControllerName = "TDSCertificateListCtrl";
            var elem = angular.element('#ColumnEditingModal');
            elem.removeAttr('ng-controller');
            elem.attr('ng-controller', "TDSCertificateListCtrl");

            $compile(elem.contents())(TDSCertificateScope);
        }

        $("#ColumnEditingModal").modal('show');




    }
    // View Column selected it is like preview.We will send reportname,usercode and where condition to function
    $scope.ViewColumnEditing = function () {
        DIMSFactory.ViewColumnEditing("TDSCertificate", $("#UserCode").val(), " CD.CUSTOMER_CODE=CM.STOCKIST_ID and CD.CUSTOMER_CODE in (select scd.CUSTOMER_CODE from sap_credit_debit scd, sap_customer_sales_master scsm where scsm.DIVISION in('11','14' ) and scd.CUSTOMER_CODE=scsm.STOCKIST_ID)"); // 1-Report Name ,2-UserCode(561),3-WhereClause

    }
    // Save Column selected it is like preview.We will send reportname,usercode and where condition to function
    $scope.SaveColumnEditingData = function () {
        var WhereClause = " WHERE CD.CUSTOMER_CODE=CM.STOCKIST_ID and CD.CUSTOMER_CODE in (select scd.CUSTOMER_CODE from sap_credit_debit scd, sap_customer_sales_master scsm where scsm.DIVISION in('11','14' ) and scd.CUSTOMER_CODE=scsm.STOCKIST_ID)";
        var Data = JSON.stringify({
            MasterType: "TDSCertificate",
            ID: "561",
            UserCode: $("#UserCode").val(),
            "Type": "Get",
            ReportName: "TDSCertificate",
            WhereClause: WhereClause
        });
        //DIMSFactory.SaveColumnEditingData("Compensation", $scope.UserCode, " ORDER BY ID DESC");
        DIMSFactory.SaveColumnEditingData_InputParameter("TDSCertificate", $("#UserCode").val(), WhereClause, Data, "tbl_TDS_Customer");
        // 1-Report Name ,2-UserCode(561),3-WhereClause,4-JsonData,5-Frontend datatable id


    }

    $scope.DownloadFile = function (filetype) {


        var SearchValue = $('input[type=search]').val();
        var FileName = "TDSCertificate";
        //  var DateRange = DateSplitter('OrderFromDate', 'OrderToDate');
        var UserCode = $("#UserCode").val();

        var isValidCustCode = isValidCode_Cust($("#CustomerCode").val(), CustomerArray);
        var sheet = $("#Sheets").val();
        var WhereClause = "";
        if ($("#CustomerCode").val() != "") {
            if (($("#CustomerCode").val() != "") && (isValidCustCode == false)) {
            } else {
                WhereClause += " WHERE CAST(cust_code AS BIGINT) IN (" + $("#CustomerCode").val() + ")";
                //Edited By Manikanta

                if (sheet != "select") {
                    WhereClause += " and CAST(cust_code AS BIGINT) IN (select STOCKIST_ID from sap_customer_sales_master where DIVISION='" + sheet + "')";
                }
            }
        } else if ($("#TerriotryArea").val() != null) {
            WhereClause += " WHERE CAST(cust_code AS BIGINT) IN (select DISTINCT ecc.CUSTOMER_CODE from cms_employee_customer_configuration ecc inner join CUSTOMER_SALES_VIEW csv on CAST(ecc.CUSTOMER_CODE AS BIGINT)=CAST(csv.cust_code AS BIGINT) where ecc.ORG_LEVEL_ID IN(" + Actual_SelectedTerritory + "))";
            //Edited By Manikanta

            if (sheet != "select") {
                WhereClause += " and CAST(cust_code AS BIGINT) IN (select STOCKIST_ID from sap_customer_sales_master where DIVISION='" + sheet + "')";
            }

        } else if ($("#State").val() != null) {
            WhereClause += " WHERE STATE IN(" + Actual_SelectedState + ")";
            //Edited By Manikanta

            if (sheet != "select") {
                WhereClause += " and CAST(cust_code AS BIGINT) IN (select STOCKIST_ID from sap_customer_sales_master where DIVISION='" + sheet + "')";
            }
        }
        else if ($("#Zone").val() != null) {
            WhereClause += " WHERE ZONE IN(" + $("#Zone").val() + ")";
            //Edited By Manikanta

            if (sheet != "select") {
                WhereClause += " and CAST(cust_code AS BIGINT) IN (select STOCKIST_ID from sap_customer_sales_master where DIVISION='" + sheet + "')";
            }
        }
        if (($("#Zone").val() == null) && ($("#State").val() == null) && ($("#TerriotryArea").val() == null) && ($("#CustomerCode").val() == "")) {
            WhereClause += "";
            //Edited By Manikanta

            if (sheet != "select") {
                WhereClause += " where CAST(cust_code AS BIGINT) IN (select STOCKIST_ID from sap_customer_sales_master where DIVISION='" + sheet + "')";
            }
        }




        var Table_DebitCount = $('#tbl_TDS_Customer').DataTable().data().count();
        if (Table_DebitCount == 0) {
            alert("There is no data");
        } else {
            if (($("#CustomerCode").val() != "") && (isValidCustCode == false)) { alert("please select proper customer code"); } else {
                var data_value = "{\"Role\":\"" + SessionValue + "\",\"Form_Code\":\"" + "TDSC" + "\",\"Action\":\"" + "Is_Export" + "\"}";
                $http({ url: '../../Home/Form_Access', method: 'POST', data: { Data: data_value } }).success(function (res) {
                    if (res == "True") {
                        CommonFunctionForExcelExport_SearchFilter("561", UserCode, SearchValue, FileName, FileName, WhereClause, filetype);
                    }
                    else {
                        alert("You are not allowed to export TDS Certificate List");
                    }
                });
            }
        }
    }
    //});
})

//Employee Role Cofiguration
DIMS.controller('EmpRoleConfiguration', function ($scope, $location, DIMSSAPFactory, $http, $compile) {
    $scope.templatesettings = { HeaderTitle: "Employee Role Configuration" };
    var width = $(window).width(), height = $(window).height();//---------

    var totalheight = height - 191;
    // var totalheight = height - 148;//--------    
    if (height <= 800) {
        totalheight = height - 148;
    }
    $('.content').css({ "max-height": totalheight, "overflow-y": "auto" });//-----------
    $scope.go = function (path) {
        CheckUserSession();
        $location.path(path);
    };
    $scope.Pageload = function () {
        // $('#EmpRoleConfig').dataTable({});
        $('#EmpRoleConfig').dataTable().fnClearTable();
        DIMSSAPFactory.GetOrgLevelList().success(function (res) {
            if (res != "") {
                var EmploeeList = JSON.parse(res.tabledata);
                for (var i = 0; i < EmploeeList.length; i++) {
                    $('#EmpRoleConfig').dataTable().fnAddData([EmploeeList[i]["Org_Level_Name"], EmploeeList[i]["EMPLOYEE_CODE"], EmploeeList[i]["Designation"], EmploeeList[i]["ZONE"], EmploeeList[i]["STATE"], EmploeeList[i]["REPORT_TO_WHOOM"], EmploeeList[i]["USER_ROLE"]]);
                }
            }
        });
    }
    angular.element(document).ready(function () {
        var table = $('#EmpRoleConfig').DataTable({
            "columnDefs": [
           { className: "Edit", "targets": [1, 3, 4, 6] }
            ]
        });

        $scope.Pageload();

        myCallbackFunction = function (updatedCell, updatedRow) {
            console.log("The new value for the cell is: " + updatedCell.data());
            console.log("The values for each cell in that row are: " + (updatedRow.data()[3]));
            console.log("Column Index :" + currentColumnIndex);

            var RowData = updatedRow.data();

            var RoleConfig = new Array();
            //var columnname = "";
            //if (currentColumnIndex == 3) {
            //    columnname = "Zone";
            //} else if (currentColumnIndex == 4) {
            //    columnname = "State";
            //} else if (currentColumnIndex == 5) {
            //    columnname = "DepoCoordinator";
            //} else if (currentColumnIndex == 6) {
            //    columnname = "PlantCoordinator";
            //} else if (currentColumnIndex == 7) {
            //    columnname = "ReportToWhom";
            //} else if (currentColumnIndex == 8) {
            //    columnname = "Role";
            //}

            RoleConfig.push({
                OrgLevelName: RowData[0],
                EmployeeCode: RowData[1],
                ZoneCode: RowData[3],
                StateCode: RowData[4],
                DepoCoordinator: "",
                PlantCoordinator: "",
                ReportToWhom: RowData[5],
                RoleCode: RowData[6]
            });

            var TotalEmpRoleConfigData = JSON.stringify({
                "RoleConfigData": RoleConfig
            });

            DIMSSAPFactory.SaveEmpRoleConfigData(TotalEmpRoleConfigData).success(function (response) {
                if (response == "Insert") {
                    alert("Saved successfully");
                    $scope.Pageload();
                    //  $scope.go('DailyOrderTracking');
                } else if (response == "Fail") {
                    alert("Error Occured while Saving");
                } else if (response == "Update") {
                    alert("Update Successfully");
                    $scope.Pageload();
                    //  $scope.go('DailyOrderTracking');
                } else if (response == "UpdateFail") {
                    alert("Error Occured while Update");
                } else {
                    alert(response);
                }
            });

            //if ((currentColumnIndex == 5) || (currentColumnIndex == 6) || (currentColumnIndex == 7)) {
            //    var valid = isValidCode(updatedCell.data());
            //    if (valid == false) {
            //        alert("Please Select proper Coordinator Code");
            //    }
            //}

        };
        table.MakeCellsEditable({
            "onUpdate": myCallbackFunction,
            "inputCss": 'my-input-class',
            "columns": [1, 3, 4, 6],
            "allowNulls": {
                "columns": [1, 3, 4, 6],
                "errorClass": 'error'
            },
            "FormName": 'EmpRoleConfig',
            "confirmationButton": {
                "confirmCss": 'my-confirm-class',
                "cancelCss": 'my-cancel-class'
            },
            "onkeypress": ''
        });

    });
    DIMSSAPFactoryEmpRole = DIMSSAPFactory;


    //$scope.SaveEmployeeRoleConfig = function () {
    //    var RoleConfig = new Array();
    //    $('#EmpRoleConfig tbody tr').each(function () {
    //        var $tds = $(this).find('td');
    //        RoleConfig.push({
    //            EmployeeCode: $tds.eq(0).text(),
    //            ZoneCode: $tds.eq(3).text(),
    //            StateCode: $tds.eq(4).text(),
    //            DepoCoordinator: $tds.eq(5).text(),
    //            PlantCoordinator: $tds.eq(6).text(),
    //            ReportToWhom: $tds.eq(7).text(),
    //            RoleCode: $tds.eq(8).text()
    //        });

    //        var TotalEmpRoleConfigData = JSON.stringify({
    //            "RoleConfigData": RoleConfig
    //        });
    //        DIMSSAPFactory.SaveEmpRoleConfigData(TotalEmpRoleConfigData).success(function (response) {
    //            if (response == "Insert") {
    //                alert("Saved successfully");
    //                $scope.go('DailyOrderTracking');
    //            } else if (response == "Fail") {
    //                alert("Error Occured while Saving");
    //            } else if (response == "Update") {
    //                alert("Update Successfully");
    //                $scope.go('DailyOrderTracking');
    //            } else if (response == "UpdateFail") {
    //                alert("Error Occured while Update");
    //            } else {
    //                alert(response);
    //            }
    //        });
    //    });
    //}
});

//Employee Customer Cofiguration
DIMS.controller('EmpCustomerConfiguration', function ($scope, $location, DIMSSAPFactory, DIMSFactory, $http, $compile) {
    $scope.templatesettings = { HeaderTitle: "Employee Customer Configuration" };
    var width = $(window).width(), height = $(window).height();//---------

    var totalheight = height - 191;
    // var totalheight = height - 148;//--------    
    if (height <= 800) {
        totalheight = height - 148;
    }
    $('.content').css({ "max-height": totalheight, "overflow-y": "auto" });//-----------


    $scope.go = function (path) {
        CheckUserSession();
        $location.path(path);
    };


    $scope.Pageload = function () {

        //$('#EmpCustomerConfig').dataTable().fnClearTable();
        //DIMSSAPFactory.GetCustomerList().success(function (res) {
        //    if (res != "") {
        //        var EmploeeList = JSON.parse(res);
        //        for (var i = 0; i < EmploeeList.length; i++) {
        //            $('#EmpCustomerConfig').dataTable().fnAddData([EmploeeList[i]["Stockist ID"], EmploeeList[i]["Stockist Name"], EmploeeList[i]["Zone"], EmploeeList[i]["State"], EmploeeList[i]["City"], EmploeeList[i]["Org_Level_Name"]]);
        //        }
        //    }
        //});


        var WhereClause = "";
        var Data = JSON.stringify({
            ID: "561",
            UserCode: $("#UserCode").val(),
            "Type": "Get",
            ReportName: "EmployeeCustomerConfiguration",
            WhereClause: WhereClause
        });

        DIMSFactory.getReportListColumnNamesData(Data).success(function (response) {
            var Result = JSON.parse(response.tabledata);

            if (Result != "") {
                $scope.UserDefaultListColumnNames = Result["UserDefaultListColumnNames"];
                if (Result.hasOwnProperty('UserListColumnNames')) {
                    var data1 = JSON.parse(Result["UserListColumnNames"]);

                    var selectedcolumnname = data1["ColumnNames"];

                    CustomColumnID = Result["UserListID"];
                    $('#undo_redo_to').empty();
                    var ColArray = new Array();
                    for (var i = 0; i < selectedcolumnname.length; i++) {


                        ColArray.push({
                            "data": selectedcolumnname[i],
                            "name": selectedcolumnname[i], "bSortable": true
                        });
                        $("#undo_redo_to").append($("<option></option>").val(selectedcolumnname[i]).html(selectedcolumnname[i]));
                    }
                    //$scope.UserSelectedColumnName = ColArray;
                    UserSelectedColumnName = ColArray;
                }
                else {

                    var data1 = JSON.parse(Result["UserDefaultListColumnNames"]);

                    var selectedcolumnname = data1["ColumnNames"];

                    CustomColumnID = "0";

                    $('#undo_redo_to').empty();
                    var ColArray = new Array();
                    for (var i = 0; i < selectedcolumnname.length; i++) {
                        ColArray.push({
                            "data": selectedcolumnname[i],
                            "name": selectedcolumnname[i],
                            "bSortable": "true"
                        });
                        $("#undo_redo_to").append($("<option></option>").val(selectedcolumnname[i]).html(selectedcolumnname[i]));
                    }
                    //$scope.UserSelectedColumnName = ColArray;
                    UserSelectedColumnName = ColArray;
                }
            }
            DIMSFactory.getReportData(Data).success(function (response) {

                getLookUpData_Customers_ServerSideBinding("", "", "", "EmpCustomerConfig", UserSelectedColumnName);

                var table_CustomerMapping = $('#EmpCustomerConfig').DataTable();

                table_CustomerMapping.MakeCellsEditable({
                    "onUpdate": myCallbackFunction,
                    "inputCss": 'my-input-class',
                    "columns": [5],
                    "allowNulls": {
                        "columns": [5],
                        "errorClass": 'error'
                    },
                    "FormName": 'EmpCustomerConfig',
                    "confirmationButton": {
                        "confirmCss": 'my-confirm-class',
                        "cancelCss": 'my-cancel-class'
                    },
                    "onkeypress": ''
                });

            });

        });
    }


    angular.element(document).ready(function () {
        //var table = $('#EmpCustomerConfig').DataTable({
        //    "columnDefs": [
        //   { className: "Edit", "targets": [5] }
        //    ]
        //});

        $scope.Pageload();



        myCallbackFunction = function (updatedCell, updatedRow) {
            console.log("The new value for the cell is: " + updatedCell.data());
            console.log("The values for each cell in that row are: " + (updatedRow.data()[3]));
            console.log("Column Index :" + currentColumnIndex);

            var RowData = updatedRow.data();
            var CustomerConfig = new Array();

            CustomerConfig.push({
                CustomerCode: RowData["Customer Code"],
                OrgLevelId: RowData["Organization Level Name"]
            });

            var TotalEmpCustomerConfigData = JSON.stringify({
                "CustomerConfigData": CustomerConfig
            });

            DIMSSAPFactory.SaveEmpCustomerConfigData(TotalEmpCustomerConfigData).success(function (response) {
                if (response == "Insert") {
                    alert("Saved successfully");
                    $scope.Pageload();
                    //  $scope.go('DailyOrderTracking');
                } else if (response == "Fail") {
                    alert("Error Occured while Saving");
                } else if (response == "Update") {
                    alert("Updated Successfully");
                    $scope.Pageload();
                    //  $scope.go('DailyOrderTracking');
                } else if (response == "UpdateFail") {
                    alert("Error Occured while Update");
                } else {
                    alert(response);
                }
            });

            //if ((currentColumnIndex == 5) || (currentColumnIndex == 6) || (currentColumnIndex == 7)) {
            //    var valid = isValidCode(updatedCell.data());
            //    if (valid == false) {
            //        alert("Please Select proper Coordinator Code");
            //    }
            //}

        };



    });

    $scope.GetEmpCustomerConfig = function () {
        var WhereCondition = "";

        if ($("#Type").val() == "Select" || $("#Type").val() == undefined) {
            alert("Select any type");
            return;
        } else {
            if ($("#Type").val() == "All") {
                WhereCondition = "where (ecc.ORG_LEVEL_ID is null or ecc.ORG_LEVEL_ID is not null)";

            }
            else if ($("#Type").val() == "unmapped") {
                WhereCondition = "where ecc.ORG_LEVEL_ID is null";
            }
            else {
                WhereCondition = "where ecc.ORG_LEVEL_ID is not null";
            }
        }

        if ($("#Sales_organization").val() == "Select" || $("#Sales_organization").val() == undefined) {
            alert("Select Any Organization");
            return;
        } else {
            if ($("#Sales_organization").val() == "All") {

            } else if ($("#Sales_organization").val() == "1000") {
                WhereCondition = WhereCondition + " AND CM.STOCKIST_ID in (select STOCKIST_ID from sap_customer_sales_master where SALES_ORGANISATION='" + $("#Sales_organization").val() + "') ";
            }
            else if ($("#Sales_organization").val() == "2000") {
                WhereCondition = WhereCondition + " AND CM.STOCKIST_ID in (select STOCKIST_ID from sap_customer_sales_master where SALES_ORGANISATION='" + $("#Sales_organization").val() + "') ";
            }
            else if ($("#Sales_organization").val() == "3000") {
                WhereCondition = WhereCondition + " AND CM.STOCKIST_ID in (select STOCKIST_ID from sap_customer_sales_master where SALES_ORGANISATION='" + $("#Sales_organization").val() + "') ";
            }
            else {
                WhereCondition = WhereCondition + " AND CM.STOCKIST_ID in (select STOCKIST_ID from sap_customer_sales_master where SALES_ORGANISATION='" + $("#Sales_organization").val() + "') ";
            }
        }

        if ($("#Sheet_Type").val() == "Select" || $("#Sheet_Type").val() == undefined) {
            alert("Select any Sheet");
            return;
        } else {
            if ($("#Sheet_Type").val() == "All") {
                // WhereCondition =WhereCondition+ "AND ecc.ORG_LEVEL_ID is null or ecc.ORG_LEVEL_ID is not null";

            }
            else if ($("#Sheet_Type").val() == "11") {
                WhereCondition = WhereCondition + "AND cm.STOCKIST_ID in(select STOCKIST_ID from sap_customer_sales_master where DIVISION='" + $("#Sheet_Type").val() + "')";
            }
            else {
                WhereCondition = WhereCondition + "AND cm.STOCKIST_ID in(select STOCKIST_ID from sap_customer_sales_master where DIVISION='" + $("#Sheet_Type").val() + "')";
            }
        }

        if ($("#Sales_Zone").val() == "Select" || $("#Sales_Zone").val() == undefined) {
            alert("Select Any Zone");
            return;
        }
        else if ($("#Sales_organization").val() == "All") {

        }
        else if ($("#Sales_Zone").val() == "All") {

        }
        else {
            WhereCondition += "AND cm.STOCKIST_ID in(select STOCKIST_ID from sap_customer_sales_master where ZONE='" + $("#Sales_Zone").val() + "')"
        }
        var Data = JSON.stringify({
            ID: "561",
            UserCode: $("#UserCode").val(),
            "Type": "Get",
            ReportName: "EmployeeCustomerConfiguration",
            WhereClause: WhereCondition
        });

        DIMSFactory.getReportListColumnNamesData(Data).success(function (response) {
            var Result = JSON.parse(response.tabledata);

            if (Result != "") {
                $scope.UserDefaultListColumnNames = Result["UserDefaultListColumnNames"];
                if (Result.hasOwnProperty('UserListColumnNames')) {
                    var data1 = JSON.parse(Result["UserListColumnNames"]);

                    var selectedcolumnname = data1["ColumnNames"];

                    CustomColumnID = Result["UserListID"];
                    $('#undo_redo_to').empty();
                    var ColArray = new Array();
                    for (var i = 0; i < selectedcolumnname.length; i++) {


                        ColArray.push({
                            "data": selectedcolumnname[i],
                            "name": selectedcolumnname[i], "bSortable": true
                        });
                        $("#undo_redo_to").append($("<option></option>").val(selectedcolumnname[i]).html(selectedcolumnname[i]));
                    }
                    //$scope.UserSelectedColumnName = ColArray;
                    UserSelectedColumnName = ColArray;
                }
                else {

                    var data1 = JSON.parse(Result["UserDefaultListColumnNames"]);

                    var selectedcolumnname = data1["ColumnNames"];

                    CustomColumnID = "0";

                    $('#undo_redo_to').empty();
                    var ColArray = new Array();
                    for (var i = 0; i < selectedcolumnname.length; i++) {
                        ColArray.push({
                            "data": selectedcolumnname[i],
                            "name": selectedcolumnname[i],
                            "bSortable": "true"
                        });
                        $("#undo_redo_to").append($("<option></option>").val(selectedcolumnname[i]).html(selectedcolumnname[i]));
                    }
                    //$scope.UserSelectedColumnName = ColArray;
                    UserSelectedColumnName = ColArray;
                }
            }
            DIMSFactory.getReportData(Data).success(function (response) {

                getLookUpData_Customers_ServerSideBinding("", "", "", "EmpCustomerConfig", UserSelectedColumnName);

                var table_CustomerMapping = $('#EmpCustomerConfig').DataTable();

                table_CustomerMapping.MakeCellsEditable({
                    "onUpdate": myCallbackFunction,
                    "inputCss": 'my-input-class',
                    "columns": [5],
                    "allowNulls": {
                        "columns": [5],
                        "errorClass": 'error'
                    },
                    "FormName": 'EmpCustomerConfig',
                    "confirmationButton": {
                        "confirmCss": 'my-confirm-class',
                        "cancelCss": 'my-cancel-class'
                    },
                    "onkeypress": ''
                });

            });

        });
    }

    angular.element(document).on('change', '#Sales_organization', function () {
        ShowLoader();
        if ($("#Sales_organization").val() == "All") {
            $("#Sales_Zone").empty();
            $("#Sales_Zone").append($("<option></option>").val("All").html("ALL"));
            HideLoader();
            return;
        }
        else {
            var Data = JSON.stringify({
                Sales_organizationcode: $("#Sales_organization").val(),
            });
            DIMSFactory.GetZonesForSalesorganization(Data).success(function (response) {
                if (response != "" || response != undefined || response != null) {
                    var Result = JSON.parse(response);
                    $("#Sales_Zone").empty();
                    $("#Sales_Zone").append($("<option></option>").val("All").html("ALL"));
                    for (var i = 0; i < Result.length; i++) {
                        $("#Sales_Zone").append($("<option></option>").val(Result[i]["ZONE_CODE"]).html(Result[i]["ZONE_NAME"]));
                    }
                    HideLoader();
                }
                else {
                    HideLoader();
                }
            })
        }
    });

    $scope.DownloadFile = function (typeoffile) {

        var FileName = "EmployeeCustomerConfiguration";
        var SearchValue = $('input[type=search]').val();
        var WhereCondition = "";

        if ($("#Type").val() == "Select" || $("#Type").val() == undefined) {
            alert("Select any type");
            return;
        } else {
            if ($("#Type").val() == "All") {
                WhereCondition = "where (ecc.ORG_LEVEL_ID is null or ecc.ORG_LEVEL_ID is not null)";

            }
            else if ($("#Type").val() == "unmapped") {
                WhereCondition = "where ecc.ORG_LEVEL_ID is null";
            }
            else {
                WhereCondition = "where ecc.ORG_LEVEL_ID is not null";
            }
        }

        if ($("#Sales_organization").val() == "Select" || $("#Sales_organization").val() == undefined) {
            alert("Select Any Organization");
            return;
        } else {
            if ($("#Sales_organization").val() == "All") {

            } else if ($("#Sales_organization").val() == "1000") {
                WhereCondition = WhereCondition + " AND CM.STOCKIST_ID in (select STOCKIST_ID from sap_customer_sales_master where SALES_ORGANISATION='" + $("#Sales_organization").val() + "') ";
            }
            else if ($("#Sales_organization").val() == "2000") {
                WhereCondition = WhereCondition + " AND CM.STOCKIST_ID in (select STOCKIST_ID from sap_customer_sales_master where SALES_ORGANISATION='" + $("#Sales_organization").val() + "') ";
            }
            else if ($("#Sales_organization").val() == "3000") {
                WhereCondition = WhereCondition + " AND CM.STOCKIST_ID in (select STOCKIST_ID from sap_customer_sales_master where SALES_ORGANISATION='" + $("#Sales_organization").val() + "') ";
            }
            else {
                WhereCondition = WhereCondition + " AND CM.STOCKIST_ID in (select STOCKIST_ID from sap_customer_sales_master where SALES_ORGANISATION='" + $("#Sales_organization").val() + "') ";
            }
        }

        if ($("#Sheet_Type").val() == "Select" || $("#Sheet_Type").val() == undefined) {
            alert("Select any Sheet");
            return;
        } else {
            if ($("#Sheet_Type").val() == "All") {
                // WhereCondition =WhereCondition+ "AND ecc.ORG_LEVEL_ID is null or ecc.ORG_LEVEL_ID is not null";

            }
            else if ($("#Sheet_Type").val() == "11") {
                WhereCondition = WhereCondition + "AND cm.STOCKIST_ID in(select STOCKIST_ID from sap_customer_sales_master where DIVISION='" + $("#Sheet_Type").val() + "')";
            }
            else {
                WhereCondition = WhereCondition + "AND cm.STOCKIST_ID in(select STOCKIST_ID from sap_customer_sales_master where DIVISION='" + $("#Sheet_Type").val() + "')";
            }
        }

        if ($("#Sales_Zone").val() == "Select" || $("#Sales_Zone").val() == undefined) {
            alert("Select Any Zone");
            return;
        }
        else if ($("#Sales_organization").val() == "All") {

        }
        else if ($("#Sales_Zone").val() == "All") {

        }
        else {
            WhereCondition += "AND cm.STOCKIST_ID in(select STOCKIST_ID from sap_customer_sales_master where ZONE='" + $("#Sales_Zone").val() + "')"
        }
        if (!$('#EmpCustomerConfig').DataTable().data().count()) {
            alert("No Data Available");
            return;
        }
        //else {
        //  CommonFunctionForExcelExport_SearchFilter("561", $("#UserCode").val(), SearchValue, FileName, FileName, WhereCondition, typeoffile);

        //if (($("#CustomerCode").val() != "") && (isValidCustCode == false)) { alert("please select proper customer code"); } else {
        //    var data_value = "{\"Role\":\"" + SessionValue + "\",\"Form_Code\":\"" + "DN" + "\",\"Action\":\"" + "Is_Export" + "\"}";
        //    $http({ url: '../../Home/Form_Access', method: 'POST', data: { Data: data_value } }).success(function (res) {
        //        if (res == "True") {
        //            CommonFunctionForExcelExport_SearchFilter("561", UserCode, SearchValue, FileName, FileName, WhereClause, filetype);
        //        }
        //        else {
        //            alert("You are not allowed to export Debit Notes List");
        //        }
        //    });
        //}
        //  }


        var Data = JSON.stringify({
            ID: "561",
            UserCode: $("#UserCode").val(),
            ReportName: "EmployeeCustomerConfiguration",
            WhereClause: WhereCondition
        });

        $.ajax({

            url: '../../Home/SetInputData',
            type: "POST",
            datatype: "JSON",
            data: { InputData: Data, ReportType: typeoffile, FileName: FileName },
            async: false,
            cache: false,
            beforeSend: function () {
                ShowLoader();
            },
            success: function (response) {
                window.location.href = '../../Home/GenerateReport_CustomerMapping';
            },
            complete: function () {
                HideLoader();
            },
            error: function () {
                alert("Technical error has been occured.Please try again later");
                HideLoader();

            }
        });


    }

    DIMSSAPFactoryEmpCustomer = DIMSSAPFactory;
});

//Role Access Cofiguration
DIMS.controller('RoleAccessConfigurationCtrl', function ($scope, $location, DIMSFactory, $http, $compile, $routeParams) {
    $scope.templatesettings = { HeaderTitle: "Role Access Configuration" };
    MasterScope = $scope;



    $scope.go = function (path) {
        CheckUserSession();
        $location.path(path);
    };


    try {
        var arrRoles = new Array();
        //Fill Dropdown for Role
        DIMSFactory.getMasterClickData("GetRoleData").success(function (response) {
            var data = JSON.parse(response.tabledata);
            $.map(data, function (item) {
                arrRoles.push(item.USER_ROLE_NAME);
            });
            $scope.list = arrRoles;
        });

        var RoleName = "";
        $scope.GetRoleFormAccess = function (cmbRole) {
            RoleName = cmbRole;
            //Fill Table for Form Names
            DIMSFactory.getMasterClickData("GetFormData$" + cmbRole + "").success(function (response) {
                var data = JSON.parse(response.tabledata);
                MasterName = "GetFormData";
                $("#MasterTable").dataTable().fnDestroy();
                $('#MasterTable').empty();

                var columns = addAllColumnHeadersForFormMaster(data, "MasterTable");
                for (var i = 0 ; i < data.length ; i++) {
                    var Assgn_row$ = $('<tr />');
                    for (var colIndex = 0 ; colIndex < columns.length ; colIndex++) {
                        var cellValue = data[i][columns[colIndex]];
                        if (cellValue == null) { cellValue = ""; }
                        Assgn_row$.append($('<td/>').html(cellValue));
                    }
                    Assgn_row$.append($('<td />').html('<label>' + data[i]["Form Name"] + '</label>'));
                    if (data[i]["View"].toString() == "true") {
                        if (data[i]["IS_VIEW"].toString() == "true") { Assgn_row$.append($('<td />').html('<input type="checkbox" id="' + data[i]["FORM_CODE"] + '@IS_VIEW" checked />')); } else { Assgn_row$.append($('<td />').html('<input type="checkbox" id="' + data[i]["FORM_CODE"] + '@IS_VIEW" />')); }
                    } else {
                        Assgn_row$.append($('<td />').html('<input type="checkbox" id="' + data[i]["FORM_CODE"] + '@IS_VIEW" disabled />'));
                    }
                    if (data[i]["Add"].toString() == "true") {
                        if (data[i]["IS_ADD"].toString() == "true") { Assgn_row$.append($('<td />').html('<input type="checkbox" id="' + data[i]["FORM_CODE"] + '@IS_ADD" checked />')); } else { Assgn_row$.append($('<td />').html('<input type="checkbox" id="' + data[i]["FORM_CODE"] + '@IS_ADD" />')); }
                    } else {
                        Assgn_row$.append($('<td />').html('<input type="checkbox" id="' + data[i]["FORM_CODE"] + '@IS_UPDATE" disabled />'));
                    }
                    if (data[i]["Update"].toString() == "true") {
                        if (data[i]["IS_UPDATE"].toString() == "true") { Assgn_row$.append($('<td />').html('<input type="checkbox" id="' + data[i]["FORM_CODE"] + '@IS_UPDATE" checked />')); } else { Assgn_row$.append($('<td />').html('<input type="checkbox" id="' + data[i]["FORM_CODE"] + '@IS_UPDATE" />')); }
                    } else {
                        Assgn_row$.append($('<td />').html('<input type="checkbox" id="' + data[i]["FORM_CODE"] + '@IS_APPROVE" disabled />'));
                    }
                    if (data[i]["Approve"].toString() == "true") {
                        if (data[i]["IS_APPROVE"].toString() == "true") { Assgn_row$.append($('<td />').html('<input type="checkbox" id="' + data[i]["FORM_CODE"] + '@IS_APPROVE" checked />')); } else { Assgn_row$.append($('<td />').html('<input type="checkbox" id="' + data[i]["FORM_CODE"] + '@IS_APPROVE" />')); }
                    } else {
                        Assgn_row$.append($('<td />').html('<input type="checkbox" id="' + data[i]["FORM_CODE"] + '@IS_EXPORT_TO_EXCEL" disabled />'));
                    }
                    if (data[i]["Export"].toString() == "true") {
                        if (data[i]["IS_EXPORT_TO_EXCEL"].toString() == "true") { Assgn_row$.append($('<td />').html('<input type="checkbox" id="' + data[i]["FORM_CODE"] + '@IS_EXPORT_TO_EXCEL" checked />')); } else { Assgn_row$.append($('<td />').html('<input type="checkbox" id="' + data[i]["FORM_CODE"] + '@IS_EXPORT_TO_EXCEL" />')); }
                    } else {
                        Assgn_row$.append($('<td />').html('<input type="checkbox" id="' + data[i]["FORM_CODE"] + '@IS_EXPORT_TO_EXCEL" disabled />'));
                    }
                    $("#MasterTable").append(Assgn_row$);
                }

                $("#MasterTable tr td:nth-child(2)").hide();
                $("#MasterTable tr th:nth-child(2)").hide();
                //$("#MasterTable tr td:nth-child(3)").hide();
                $("#MasterTable tr th:nth-child(3)").hide();
                $("#MasterTable tr td:nth-child(4)").hide();
                //$("#MasterTable tr th:nth-child(4)").hide();
                $("#MasterTable tr td:nth-child(5)").hide();
                $("#MasterTable tr th:nth-child(5)").hide();
                $("#MasterTable tr td:nth-child(6)").hide();
                $("#MasterTable tr th:nth-child(6)").hide();
                $("#MasterTable tr td:nth-child(7)").hide();
                $("#MasterTable tr th:nth-child(7)").hide();
                $("#MasterTable tr td:nth-child(8)").hide();
                $("#MasterTable tr th:nth-child(8)").hide();
                $("#MasterTable tr td:nth-child(9)").hide();
                $("#MasterTable tr th:nth-child(9)").hide();
                $("#MasterTable tr td:nth-child(10)").hide();
                $("#MasterTable tr th:nth-child(10)").hide();
                $("#MasterTable tr td:nth-child(11)").hide();
                $("#MasterTable tr th:nth-child(11)").hide();
                $("#MasterTable tr td:nth-child(12)").hide();
                $("#MasterTable tr th:nth-child(12)").hide();
                $("#MasterTable tr td:nth-child(13)").hide();
                $("#MasterTable tr th:nth-child(13)").hide();
                $("#MasterTable tr td:nth-child(14)").hide();
                $("#MasterTable tr th:nth-child(14)").hide();

                var table = $("#MasterTable").dataTable({
                    "bDestroy": true,
                    'scroll': true,
                    'bPaginate': false,
                    'bFilter': false,
                    scrollY: "200px",
                    scrollX: true,
                    scrollCollapse: true,
                    //paging: true,
                    fixedColumns: {
                        leftColumns: 0
                    },
                });
            });
        }
    } catch (Exception) { }

    $scope.SaveRoleAccess = function () {
        var Action_Values = "";
        $('#MasterTable tr').each(function () {
            $(this).find('td').each(function () {
                if ($(this).find("input[type=checkbox]").is(":checked")) {
                    var asd = $(this).html();
                    var theid = $(asd).attr('id');
                    Action_Values += theid + "#";
                }
            });
            Action_Values += "$";
        });
        //var Action_Values = $("#MasterTable input[type=checkbox]:checked").map(function (i, el) { return $(el).attr("id"); }).get();

        var MasterType = "{\"MasterType\":\"" + "RoleFormAccess" + "\",\"FormActionValues\":\"" + Action_Values + "\",\"RoleName\":\"" + RoleName + "\"}";
        DIMSFactory.SaveMasterData(MasterType).success(function (response) {
            alert("Role Access Updated Successfully");
        });

    }
});


//CMS Dashboard
DIMS.controller('CMSDashboardCtrl', function ($scope, $location, DIMSFactory, $http, $compile, $routeParams) {
    $scope.templatesettings = { HeaderTitle: "CMS Dashboard" };
    MasterScope = $scope;



    $scope.go = function (path) {
        CheckUserSession();
        $location.path(path);
    };

});

//svprasadk 01-09-2020 getting CMS Graphical Dashboard start
DIMS.controller('CMSGraphicalDashboardCtrl', function ($scope, $location, DIMSFactory, $http, $compile, $routeParams) {
    $scope.templatesettings = { HeaderTitle: "CMS Graphical Dashboard" };
    MasterScope = $scope;

    $scope.go = function (path) {
        CheckUserSession();
        $location.path(path);
    };

});
//svprasadk 01-09-2020 getting CMS Graphical Dashboard start

var Coordinator = new Array();
function FillZoneDropDown(id) {
    DIMSSAPFactoryEmpRole.GetZoneDropdownEmpRole().success(function (res) {
        var data = JSON.parse(res.tabledata);
        $("#" + id).empty();
        $("#" + id).append($("<option></option>").val('').html("Select Zone"));
        for (var i = 0; i < data.length; i++) {
            $("#" + id).append($("<option></option>").val(data[i]["Zone_Code"] + ":" + data[i]["Zone_Name"]).html(data[i]["Zone_Code"] + ":" + data[i]["Zone_Name"]));
        }
    });
}

function FillStateDropDown(id) {
    DIMSSAPFactoryEmpRole.GetStateDropdownEmpRole().success(function (res) {
        var data = JSON.parse(res.tabledata);
        $("#" + id).empty();
        $("#" + id).append($("<option></option>").val('').html("Select State"));
        for (var i = 0; i < data.length; i++) {
            $("#" + id).append($("<option></option>").val(data[i]["STATE_CODE"] + ":" + data[i]["STATE_DESC"]).html(data[i]["STATE_CODE"] + ":" + data[i]["STATE_DESC"]));
        }
    });
}

function CoordinatorList(id) {
    DIMSSAPFactoryEmpRole.GetEmployeeList().success(function (res) {
        if (res != "") {
            var EmploeeList = JSON.parse(res.tabledata);
            for (var i = 0; i < EmploeeList.length; i++) {
                Coordinator.push(EmploeeList[i]["Employee_Code"] + " : " + EmploeeList[i]["Employee_Name"])
            }
            $("#" + id).typeahead({
                source: Coordinator
            });
        }
    });
}

var FSO = new Array();
function FSOList(id) {
    FSO = new Array();
    DIMSSAPFactoryEmpCustomer.GetFSOList().success(function (res) {
        if (res != "") {
            var EmploeeList = JSON.parse(res.tabledata);
            for (var i = 0; i < EmploeeList.length; i++) {
                FSO.push(EmploeeList[i]["ORG_LEVEL_ID"] + " : " + EmploeeList[i]["ORG_LEVEL_NAME"])
            }
            $("#" + id).typeahead({
                source: FSO
            });
        }
    });
}



function isValidCode(code) {
    return ($.inArray(code, Coordinator) > -1);
}

function isFSOValidCode(code) {
    return ($.inArray(code, FSO) > -1);
}

function FillRoleDropDown(id) {
    DIMSSAPFactoryEmpRole.GetRoleDropdownEmpRole().success(function (res) {
        var data = JSON.parse(res.tabledata);
        $("#" + id).empty();
        $("#" + id).append($("<option></option>").val('').html("Select Role"));
        for (var i = 0; i < data.length; i++) {
            $("#" + id).append($("<option></option>").val(data[i]["USER_ROLE_CODE"] + ":" + data[i]["USER_ROLE_NAME"]).html(data[i]["USER_ROLE_CODE"] + ":" + data[i]["USER_ROLE_NAME"]));
        }
    });

}


var th = ['', 'THOUSAND', 'MILLION', 'BILLION', 'TRILLION'];

var dg = ['ZERO', 'ONE', 'TWO', 'THREE', 'FOUR', 'FIVE', 'SIX', 'SEVEN', 'EIGHT', 'NINE'];

var tn = ['TEN', 'ELEVEN', 'TWELVE', 'THIRTEEN', 'FOURTEEN', 'FIFTEEN', 'SIXTEEN', 'SEVENTEEN', 'EIGHTEEN', 'NINETEEN'];

var tw = ['TWENTY', 'THIRTY', 'FORTY', 'FIFTY', 'SIXTY', 'SEVENTY', 'EIGHTY', 'NINTY'];

// function to convert number to words
function toWordsINVOICE(value) {

    //s = s.toString();
    //s = s.replace(/[\, ]/g, '');
    //// alert(s);
    //if (s != parseFloat(s)) return 'not a number';
    //var x = s.indexOf('.');
    //// alert(x)
    //if (x == -1) x = s.length;
    //if (x > 15) return 'too big';
    //var n = s.split('');
    ////alert(n)
    //var str = '';
    //var sk = 0;
    //for (var i = 0; i < x; i++) {
    //    if ((x - i) % 3 == 2) {
    //        if (n[i] == '1') {
    //            str += tn[Number(n[i + 1])] + ' ';
    //            i++;
    //            sk = 1;
    //        } else if (n[i] != 0) {
    //            str += tw[n[i] - 2] + ' ';
    //            sk = 1;
    //        }
    //    } else if (n[i] != 0) {
    //        str += dg[n[i]] + ' ';
    //        if ((x - i) % 3 == 0) str += 'HUNDRED ';
    //        sk = 1;
    //    }
    //    if ((x - i) % 3 == 1) {
    //        if (sk) str += th[(x - i - 1) / 3] + ' ';
    //        sk = 0;
    //    }
    //}
    //if (x != s.length) {
    //    var y = s.length;
    //    str += 'AND PAISE ';
    //    for (var i = x + 1; i < y; i++) {
    //        str += dg[n[i]] + ' ';
    //    }
    //    str += 'ONLY ';
    //}
    //return str.replace(/\s+/g, ' ');


    var fraction = Math.round(frac(value) * 100);
    var f_text = "";

    if (fraction > 0) {
        f_text = " AND PAISE " + convert_number(fraction);
    } else if (fraction == 0) {
        f_text = " AND PAISE ZERO";
    }

    if (convert_number(value) == "ZERO") {
        return "NIL";
    } else {
        return "RUPEES " + convert_number(value) + f_text + " ONLY";
    }
}

function frac(f) {
    return f % 1;
}

function convert_number(number) {
    if ((number < 0) || (number > 999999999)) {
        return "NUMBER OUT OF RANGE!";
    }
    var Gn = Math.floor(number / 10000000);  /* Crore */
    number -= Gn * 10000000;
    var kn = Math.floor(number / 100000);     /* lakhs */
    number -= kn * 100000;
    var Hn = Math.floor(number / 1000);      /* thousand */
    number -= Hn * 1000;
    var Dn = Math.floor(number / 100);       /* Tens (deca) */
    number = number % 100;               /* Ones */
    var tn = Math.floor(number / 10);
    var one = Math.floor(number % 10);
    var res = "";

    if (Gn > 0) {
        res += (convert_number(Gn) + " CRORE");
    }
    if (kn > 0) {
        res += (((res == "") ? "" : " ") +
        convert_number(kn) + " LAKH");
    }
    if (Hn > 0) {
        res += (((res == "") ? "" : " ") +
            convert_number(Hn) + " THOUSAND");
    }

    if (Dn) {
        res += (((res == "") ? "" : " ") +
            convert_number(Dn) + " HUNDRED");
    }


    var ones = Array("", "ONE", "TWO", "THREE", "FOUR", "FIVE", "SIX", "SEVEN", "EIGHT", "NINE", "TEN", "ELEVEN", "TWELVE", "THIRTEEN", "FOURTEEN", "FIFTEEN", "SIXTEEN", "SEVENTEEN", "EIGHTEEN", "NINETEEN");
    var tens = Array("", "", "TWENTY", "THIRTY", "FOURTY", "FIFTY", "SIXTY", "SEVENTY", "EIGHTY", "NINETY");

    if (tn > 0 || one > 0) {
        if (!(res == "")) {
            res += " ";
        }
        if (tn < 2) {
            res += ones[tn * 10 + one];
        }
        else {

            res += tens[tn];
            if (one > 0) {
                res += ("-" + ones[one]);
            }
        }
    }

    if (res == "") {
        res = "ZERO";
    }
    return res;
}

function fnResetAllFilters(oTable) {
    var oSettings = oTable.fnSettings();
    for (iCol = 0; iCol < oSettings.aoPreSearchCols.length; iCol++) {
        oSettings.aoPreSearchCols[iCol].sSearch = '';
    }
    oSettings.oPreviousSearch.sSearch = '';
    oTable.fnDraw();
}

function DateValidation(FromDate, ToDate) {
    if ($("#" + FromDate).val() != "") {
        $("#" + ToDate).datepicker('setStartDate', $("#" + FromDate).val());
        //$("#" + ToDate).datepicker('option', 'minDate', $("#" + MyDate).val());
        //$("#"+ToDate).val("");
    }
}

function DateSplitter(FromDate, ToDate) {
    var From_Dt = $("#" + FromDate).val().split('/'); var To_Dt = $("#" + ToDate).val().split('/');
    var Dates = "'" + From_Dt[2] + '/' + From_Dt[1] + '/' + From_Dt[0] + "'" + ' and ' + "'" + To_Dt[2] + '/' + To_Dt[1] + '/' + To_Dt[0] + "'";
    return Dates;
}

function CommonFunctionForExcelExport_SearchFilter(ID, UserCode, SearchboxValue, ExcelFileName, BackendReportName, WhereClause, FileType) {
    if (ID != "" && UserCode != "" && ExcelFileName != "" && BackendReportName != "" && WhereClause != "") {
        ShowLoader();
        var Data = JSON.stringify({
            ID: ID,
            UserCode: UserCode,
            ReportName: BackendReportName,
            WhereClause: WhereClause,
            "SearchValue": SearchboxValue
        });

        var UserRole = SessionValue;

        $.ajax({
            url: '../../Home/SetInputData',
            type: "POST",
            datatype: "JSON",
            data: { InputData: Data, ReportType: FileType, FileName: ExcelFileName },
            async: false,
            cache: false,
            success: function (response) {
                if ((UserRole == "STOCKIST") || (UserRole == "C&F")) {
                    if (BackendReportName == "PendingCForms") {
                        $.ajax({
                            method: 'POST',
                            contentType: "application/json; charset=utf-8",
                            url: '../../HOME/GenerateReport_SAP_CFORM_STOCKIST',
                        }).then(function successCallback(response) {
                            if (response != "") {
                                ShowLoader();
                                $('#HidenData').html(response);
                                GetPDFFile_CFORM();
                            } else {
                                HideLoader();
                                alert("No data");
                            }
                            //if (result == "MailSent") {
                            //    alert("Mail Sent Successfully");
                            //} else {
                            //    alert("Mail Not Sent")
                            //}
                        },
                       function errorCallback(response) {
                           $.ajax({
                               url: "../../HOME/GenerateReport_SAP_STOCKIST_MailStatus", success: function (result) {
                                   if (result == "MailSent") {
                                       alert("Mail Sent Successfully");
                                   } else {
                                       alert("Mail Not Sent")
                                   }
                               }
                           });
                       });
                    } else {
                        $.ajax({
                            method: 'POST',
                            contentType: "application/json; charset=utf-8",
                            url: '../../HOME/GenerateReport_SAP_STOCKIST',
                        }).then(function successCallback(response) {
                            if (result == "MailSent") {
                                alert("Mail Sent Successfully");
                            } else {
                                alert("Mail Not Sent")
                            }
                        },
                        function errorCallback(response) {
                            $.ajax({
                                url: "../../HOME/GenerateReport_SAP_STOCKIST_MailStatus", success: function (result) {
                                    if (result == "MailSent") {
                                        alert("Mail Sent Successfully");
                                    } else {
                                        alert("Mail Not Sent")
                                    }
                                }
                            });
                        });
                    }
                } else {
                    ShowLoader();
                    window.location.href = '../../Home/GenerateReport_SAP';
                    HideLoader();
                }

            },
            error: function () {
                alert("Technical error has been occured.Please try again later");
            }
        });
    } else {
        return;
    }
}


function GetPDFFile_CFORM() {
    ShowLoader();
    $.ajax({
        url: '/Home/Exportdata',
        type: 'POST',
        beforeSend: function () {
            //ShowLoader();
        },
        data: { QueryVal: $('#HidenData').html() },
        success: function (result) {
            if (result == "ok") {
                //   userRole = "STOCKIST";
                //$("#PrintReport").css("display", "block");
                if ((userRole == "STOCKIST") || (userRole == "C&F")) {
                    ShowLoader();
                    //  window.location.href = "../../Home/GetPDF?reportname=PendingCForms";
                    $.ajax({
                        type: 'POST',
                        async: false,
                        data: { reportname: "PendingCForms" },
                        //datatype: 'JSON',
                        url: '../../HOME/GetPDF_STOCKIST',
                        success: function (data) {
                            if (data == "MailSentSuccessfully") {
                                HideLoader();
                                alert("Mail Sent Successfully");
                            } else {
                                HideLoader();
                                alert(data);
                            }
                        },
                        error: function (e) {
                            HideLoader();
                            alert("Technical Error Occured");
                        }
                    });

                    //   window.location.href = "../../Home/GetPDF_STOCKIST?reportname=CreditNote_" + $("#DocNo").text() + "";
                } else {
                    ShowLoader();
                    window.location.href = "../../Home/GetPDF?reportname=CreditNote_" + $("#DocNo").text() + "";
                    HideLoader();
                }
            }
        },
        error: function (e) {
            alert(e);
        }
    });
}